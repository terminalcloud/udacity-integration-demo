(function(window,undefined){var document=window.document,navigator=window.navigator,location=window.location;var jQuery=function(){var jQuery=function(selector,context){return new jQuery.fn.init(selector,context,rootjQuery)},_jQuery=window.jQuery,_$=window.$,rootjQuery,quickExpr=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,rnotwhite=/\S/,trimLeft=/^\s+/,trimRight=/\s+$/,rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,rvalidchars=/^[\],:{}\s]*$/,rvalidescape=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rvalidtokens=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rvalidbraces=/(?:^|:|,)(?:\s*\[)+/g,rwebkit=/(webkit)[ \/]([\w.]+)/,ropera=/(opera)(?:.*version)?[ \/]([\w.]+)/,rmsie=/(msie) ([\w.]+)/,rmozilla=/(mozilla)(?:.*? rv:([\w.]+))?/,rdashAlpha=/-([a-z]|[0-9])/gi,rmsPrefix=/^-ms-/,fcamelCase=function(all,letter){return(letter+"").toUpperCase()},userAgent=navigator.userAgent,browserMatch,readyList,DOMContentLoaded,toString=Object.prototype.toString,hasOwn=Object.prototype.hasOwnProperty,push=Array.prototype.push,slice=Array.prototype.slice,trim=String.prototype.trim,indexOf=Array.prototype.indexOf,class2type={};jQuery.fn=jQuery.prototype={constructor:jQuery,init:function(selector,context,rootjQuery){var match,elem,ret,doc;if(!selector){return this}if(selector.nodeType){this.context=this[0]=selector;this.length=1;return this}if(selector==="body"&&!context&&document.body){this.context=document;this[0]=document.body;this.selector=selector;this.length=1;return this}if(typeof selector==="string"){if(selector.charAt(0)==="<"&&selector.charAt(selector.length-1)===">"&&selector.length>=3){match=[null,selector,null]}else{match=quickExpr.exec(selector)}if(match&&(match[1]||!context)){if(match[1]){context=context instanceof jQuery?context[0]:context;doc=context?context.ownerDocument||context:document;ret=rsingleTag.exec(selector);if(ret){if(jQuery.isPlainObject(context)){selector=[document.createElement(ret[1])];jQuery.fn.attr.call(selector,context,true)}else{selector=[doc.createElement(ret[1])]}}else{ret=jQuery.buildFragment([match[1]],[doc]);selector=(ret.cacheable?jQuery.clone(ret.fragment):ret.fragment).childNodes}return jQuery.merge(this,selector)}else{elem=document.getElementById(match[2]);if(elem&&elem.parentNode){if(elem.id!==match[2]){return rootjQuery.find(selector)}this.length=1;this[0]=elem}this.context=document;this.selector=selector;return this}}else if(!context||context.jquery){return(context||rootjQuery).find(selector)}else{return this.constructor(context).find(selector)}}else if(jQuery.isFunction(selector)){return rootjQuery.ready(selector)}if(selector.selector!==undefined){this.selector=selector.selector;this.context=selector.context}return jQuery.makeArray(selector,this)},selector:"",jquery:"1.7.1",length:0,size:function(){return this.length},toArray:function(){return slice.call(this,0)},get:function(num){return num==null?this.toArray():num<0?this[this.length+num]:this[num]},pushStack:function(elems,name,selector){var ret=this.constructor();if(jQuery.isArray(elems)){push.apply(ret,elems)}else{jQuery.merge(ret,elems)}ret.prevObject=this;ret.context=this.context;if(name==="find"){ret.selector=this.selector+(this.selector?" ":"")+selector}else if(name){ret.selector=this.selector+"."+name+"("+selector+")"}return ret},each:function(callback,args){return jQuery.each(this,callback,args)},ready:function(fn){jQuery.bindReady();readyList.add(fn);return this},eq:function(i){i=+i;return i===-1?this.slice(i):this.slice(i,i+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(slice.apply(this,arguments),"slice",slice.call(arguments).join(","))},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},end:function(){return this.prevObject||this.constructor(null)},push:push,sort:[].sort,splice:[].splice};jQuery.fn.init.prototype=jQuery.fn;jQuery.extend=jQuery.fn.extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=false;if(typeof target==="boolean"){deep=target;target=arguments[1]||{};i=2}if(typeof target!=="object"&&!jQuery.isFunction(target)){target={}}if(length===i){target=this;--i}for(;i<length;i++){if((options=arguments[i])!=null){for(name in options){src=target[name];copy=options[name];if(target===copy){continue}if(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&jQuery.isArray(src)?src:[]}else{clone=src&&jQuery.isPlainObject(src)?src:{}}target[name]=jQuery.extend(deep,clone,copy)}else if(copy!==undefined){target[name]=copy}}}}return target};jQuery.extend({noConflict:function(deep){if(window.$===jQuery){window.$=_$}if(deep&&window.jQuery===jQuery){window.jQuery=_jQuery}return jQuery},isReady:false,readyWait:1,holdReady:function(hold){if(hold){jQuery.readyWait++}else{jQuery.ready(true)}},ready:function(wait){if(wait===true&&!--jQuery.readyWait||wait!==true&&!jQuery.isReady){if(!document.body){return setTimeout(jQuery.ready,1)}jQuery.isReady=true;if(wait!==true&&--jQuery.readyWait>0){return}readyList.fireWith(document,[jQuery]);if(jQuery.fn.trigger){jQuery(document).trigger("ready").off("ready")}}},bindReady:function(){if(readyList){return}readyList=jQuery.Callbacks("once memory");if(document.readyState==="complete"){return setTimeout(jQuery.ready,1)}if(document.addEventListener){document.addEventListener("DOMContentLoaded",DOMContentLoaded,false);window.addEventListener("load",jQuery.ready,false)}else if(document.attachEvent){document.attachEvent("onreadystatechange",DOMContentLoaded);window.attachEvent("onload",jQuery.ready);var toplevel=false;try{toplevel=window.frameElement==null}catch(e){}if(document.documentElement.doScroll&&toplevel){doScrollCheck()}}},isFunction:function(obj){return jQuery.type(obj)==="function"},isArray:Array.isArray||function(obj){return jQuery.type(obj)==="array"},isWindow:function(obj){return obj&&typeof obj==="object"&&"setInterval"in obj},isNumeric:function(obj){return!isNaN(parseFloat(obj))&&isFinite(obj)},type:function(obj){return obj==null?String(obj):class2type[toString.call(obj)]||"object"},isPlainObject:function(obj){if(!obj||jQuery.type(obj)!=="object"||obj.nodeType||jQuery.isWindow(obj)){return false}try{if(obj.constructor&&!hasOwn.call(obj,"constructor")&&!hasOwn.call(obj.constructor.prototype,"isPrototypeOf")){return false}}catch(e){return false}var key;for(key in obj){}return key===undefined||hasOwn.call(obj,key)},isEmptyObject:function(obj){for(var name in obj){return false}return true},error:function(msg){throw new Error(msg)},parseJSON:function(data){if(typeof data!=="string"||!data){return null}data=jQuery.trim(data);if(window.JSON&&window.JSON.parse){return window.JSON.parse(data)}if(rvalidchars.test(data.replace(rvalidescape,"@").replace(rvalidtokens,"]").replace(rvalidbraces,""))){return new Function("return "+data)()}jQuery.error("Invalid JSON: "+data)},parseXML:function(data){var xml,tmp;try{if(window.DOMParser){tmp=new DOMParser;xml=tmp.parseFromString(data,"text/xml")}else{xml=new ActiveXObject("Microsoft.XMLDOM");xml.async="false";xml.loadXML(data)}}catch(e){xml=undefined}if(!xml||!xml.documentElement||xml.getElementsByTagName("parsererror").length){jQuery.error("Invalid XML: "+data)}return xml},noop:function(){},globalEval:function(data){if(data&&rnotwhite.test(data)){(window.execScript||function(data){window["eval"].call(window,data)})(data)}},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toUpperCase()===name.toUpperCase()},each:function(object,callback,args){var name,i=0,length=object.length,isObj=length===undefined||jQuery.isFunction(object);if(args){if(isObj){for(name in object){if(callback.apply(object[name],args)===false){break}}}else{for(;i<length;){if(callback.apply(object[i++],args)===false){break}}}}else{if(isObj){for(name in object){if(callback.call(object[name],name,object[name])===false){break}}}else{for(;i<length;){if(callback.call(object[i],i,object[i++])===false){break}}}}return object},trim:trim?function(text){return text==null?"":trim.call(text)}:function(text){return text==null?"":text.toString().replace(trimLeft,"").replace(trimRight,"")},makeArray:function(array,results){var ret=results||[];if(array!=null){var type=jQuery.type(array);if(array.length==null||type==="string"||type==="function"||type==="regexp"||jQuery.isWindow(array)){push.call(ret,array)}else{jQuery.merge(ret,array)}}return ret},inArray:function(elem,array,i){var len;if(array){if(indexOf){return indexOf.call(array,elem,i)}len=array.length;i=i?i<0?Math.max(0,len+i):i:0;for(;i<len;i++){if(i in array&&array[i]===elem){return i}}}return-1},merge:function(first,second){var i=first.length,j=0;if(typeof second.length==="number"){for(var l=second.length;j<l;j++){first[i++]=second[j]}}else{while(second[j]!==undefined){first[i++]=second[j++]}}first.length=i;return first},grep:function(elems,callback,inv){var ret=[],retVal;inv=!!inv;for(var i=0,length=elems.length;i<length;i++){retVal=!!callback(elems[i],i);if(inv!==retVal){ret.push(elems[i])}}return ret},map:function(elems,callback,arg){var value,key,ret=[],i=0,length=elems.length,isArray=elems instanceof jQuery||length!==undefined&&typeof length==="number"&&(length>0&&elems[0]&&elems[length-1]||length===0||jQuery.isArray(elems));if(isArray){for(;i<length;i++){value=callback(elems[i],i,arg);if(value!=null){ret[ret.length]=value}}}else{for(key in elems){value=callback(elems[key],key,arg);if(value!=null){ret[ret.length]=value}}}return ret.concat.apply([],ret)},guid:1,proxy:function(fn,context){if(typeof context==="string"){var tmp=fn[context];context=fn;fn=tmp}if(!jQuery.isFunction(fn)){return undefined}var args=slice.call(arguments,2),proxy=function(){return fn.apply(context,args.concat(slice.call(arguments)))};proxy.guid=fn.guid=fn.guid||proxy.guid||jQuery.guid++;return proxy},access:function(elems,key,value,exec,fn,pass){var length=elems.length;if(typeof key==="object"){for(var k in key){jQuery.access(elems,k,key[k],exec,fn,value)}return elems}if(value!==undefined){exec=!pass&&exec&&jQuery.isFunction(value);for(var i=0;i<length;i++){fn(elems[i],key,exec?value.call(elems[i],i,fn(elems[i],key)):value,pass)}return elems}return length?fn(elems[0],key):undefined},now:function(){return(new Date).getTime()},uaMatch:function(ua){ua=ua.toLowerCase();var match=rwebkit.exec(ua)||ropera.exec(ua)||rmsie.exec(ua)||ua.indexOf("compatible")<0&&rmozilla.exec(ua)||[];return{browser:match[1]||"",version:match[2]||"0"}},sub:function(){function jQuerySub(selector,context){return new jQuerySub.fn.init(selector,context)}jQuery.extend(true,jQuerySub,this);jQuerySub.superclass=this;jQuerySub.fn=jQuerySub.prototype=this();jQuerySub.fn.constructor=jQuerySub;jQuerySub.sub=this.sub;jQuerySub.fn.init=function init(selector,context){if(context&&context instanceof jQuery&&!(context instanceof jQuerySub)){context=jQuerySub(context)}return jQuery.fn.init.call(this,selector,context,rootjQuerySub)};jQuerySub.fn.init.prototype=jQuerySub.fn;var rootjQuerySub=jQuerySub(document);return jQuerySub},browser:{}});jQuery.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()});browserMatch=jQuery.uaMatch(userAgent);if(browserMatch.browser){jQuery.browser[browserMatch.browser]=true;jQuery.browser.version=browserMatch.version}if(jQuery.browser.webkit){jQuery.browser.safari=true}if(rnotwhite.test("Â ")){trimLeft=/^[\s\xA0]+/;trimRight=/[\s\xA0]+$/}rootjQuery=jQuery(document);if(document.addEventListener){DOMContentLoaded=function(){document.removeEventListener("DOMContentLoaded",DOMContentLoaded,false);jQuery.ready()}}else if(document.attachEvent){DOMContentLoaded=function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",DOMContentLoaded);jQuery.ready()}}}function doScrollCheck(){if(jQuery.isReady){return}try{document.documentElement.doScroll("left")}catch(e){setTimeout(doScrollCheck,1);return}jQuery.ready()}return jQuery}();var flagsCache={};function createFlags(flags){var object=flagsCache[flags]={},i,length;flags=flags.split(/\s+/);for(i=0,length=flags.length;i<length;i++){object[flags[i]]=true}return object}jQuery.Callbacks=function(flags){flags=flags?flagsCache[flags]||createFlags(flags):{};var list=[],stack=[],memory,firing,firingStart,firingLength,firingIndex,add=function(args){var i,length,elem,type,actual;for(i=0,length=args.length;i<length;i++){elem=args[i];type=jQuery.type(elem);if(type==="array"){add(elem)}else if(type==="function"){if(!flags.unique||!self.has(elem)){list.push(elem)}}}},fire=function(context,args){args=args||[];memory=!flags.memory||[context,args];firing=true;firingIndex=firingStart||0;firingStart=0;firingLength=list.length;for(;list&&firingIndex<firingLength;firingIndex++){if(list[firingIndex].apply(context,args)===false&&flags.stopOnFalse){memory=true;break}}firing=false;if(list){if(!flags.once){if(stack&&stack.length){memory=stack.shift();self.fireWith(memory[0],memory[1])}}else if(memory===true){self.disable()}else{list=[]}}},self={add:function(){if(list){var length=list.length;add(arguments);if(firing){firingLength=list.length}else if(memory&&memory!==true){firingStart=length;fire(memory[0],memory[1])}}return this},remove:function(){if(list){var args=arguments,argIndex=0,argLength=args.length;for(;argIndex<argLength;argIndex++){for(var i=0;i<list.length;i++){if(args[argIndex]===list[i]){if(firing){if(i<=firingLength){firingLength--;if(i<=firingIndex){firingIndex--}}}list.splice(i--,1);if(flags.unique){break}}}}}return this},has:function(fn){if(list){var i=0,length=list.length;for(;i<length;i++){if(fn===list[i]){return true}}}return false},empty:function(){list=[];return this},disable:function(){list=stack=memory=undefined;return this},disabled:function(){return!list},lock:function(){stack=undefined;if(!memory||memory===true){self.disable()}return this},locked:function(){return!stack},fireWith:function(context,args){if(stack){if(firing){if(!flags.once){stack.push([context,args])}}else if(!(flags.once&&memory)){fire(context,args)}}return this},fire:function(){self.fireWith(this,arguments);return this},fired:function(){return!!memory}};return self};var sliceDeferred=[].slice;jQuery.extend({Deferred:function(func){var doneList=jQuery.Callbacks("once memory"),failList=jQuery.Callbacks("once memory"),progressList=jQuery.Callbacks("memory"),state="pending",lists={resolve:doneList,reject:failList,notify:progressList},promise={done:doneList.add,fail:failList.add,progress:progressList.add,state:function(){return state},isResolved:doneList.fired,isRejected:failList.fired,then:function(doneCallbacks,failCallbacks,progressCallbacks){deferred.done(doneCallbacks).fail(failCallbacks).progress(progressCallbacks);return this},always:function(){deferred.done.apply(deferred,arguments).fail.apply(deferred,arguments);return this},pipe:function(fnDone,fnFail,fnProgress){return jQuery.Deferred(function(newDefer){jQuery.each({done:[fnDone,"resolve"],fail:[fnFail,"reject"],progress:[fnProgress,"notify"]},function(handler,data){var fn=data[0],action=data[1],returned;if(jQuery.isFunction(fn)){deferred[handler](function(){returned=fn.apply(this,arguments);if(returned&&jQuery.isFunction(returned.promise)){returned.promise().then(newDefer.resolve,newDefer.reject,newDefer.notify)}else{newDefer[action+"With"](this===deferred?newDefer:this,[returned])}})}else{deferred[handler](newDefer[action])}})}).promise()},promise:function(obj){if(obj==null){obj=promise}else{for(var key in promise){obj[key]=promise[key]}}return obj}},deferred=promise.promise({}),key;for(key in lists){deferred[key]=lists[key].fire;deferred[key+"With"]=lists[key].fireWith}deferred.done(function(){state="resolved"},failList.disable,progressList.lock).fail(function(){state="rejected"},doneList.disable,progressList.lock);if(func){func.call(deferred,deferred)}return deferred},when:function(firstParam){var args=sliceDeferred.call(arguments,0),i=0,length=args.length,pValues=new Array(length),count=length,pCount=length,deferred=length<=1&&firstParam&&jQuery.isFunction(firstParam.promise)?firstParam:jQuery.Deferred(),promise=deferred.promise();function resolveFunc(i){return function(value){args[i]=arguments.length>1?sliceDeferred.call(arguments,0):value;if(!--count){deferred.resolveWith(deferred,args)}}}function progressFunc(i){return function(value){pValues[i]=arguments.length>1?sliceDeferred.call(arguments,0):value;deferred.notifyWith(promise,pValues)}}if(length>1){for(;i<length;i++){if(args[i]&&args[i].promise&&jQuery.isFunction(args[i].promise)){args[i].promise().then(resolveFunc(i),deferred.reject,progressFunc(i))}else{--count}}if(!count){deferred.resolveWith(deferred,args)}}else if(deferred!==firstParam){deferred.resolveWith(deferred,length?[firstParam]:[])}return promise}});jQuery.support=function(){var support,all,a,select,opt,input,marginDiv,fragment,tds,events,eventName,i,isSupported,div=document.createElement("div"),documentElement=document.documentElement;div.setAttribute("className","t");div.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>";all=div.getElementsByTagName("*");a=div.getElementsByTagName("a")[0];if(!all||!all.length||!a){return{}}select=document.createElement("select");opt=select.appendChild(document.createElement("option"));input=div.getElementsByTagName("input")[0];support={leadingWhitespace:div.firstChild.nodeType===3,tbody:!div.getElementsByTagName("tbody").length,htmlSerialize:!!div.getElementsByTagName("link").length,style:/top/.test(a.getAttribute("style")),hrefNormalized:a.getAttribute("href")==="/a",opacity:/^0.55/.test(a.style.opacity),cssFloat:!!a.style.cssFloat,checkOn:input.value==="on",optSelected:opt.selected,getSetAttribute:div.className!=="t",enctype:!!document.createElement("form").enctype,html5Clone:document.createElement("nav").cloneNode(true).outerHTML!=="<:nav></:nav>",submitBubbles:true,changeBubbles:true,focusinBubbles:false,deleteExpando:true,noCloneEvent:true,inlineBlockNeedsLayout:false,shrinkWrapBlocks:false,reliableMarginRight:true};input.checked=true;support.noCloneChecked=input.cloneNode(true).checked;select.disabled=true;support.optDisabled=!opt.disabled;try{delete div.test}catch(e){support.deleteExpando=false}if(!div.addEventListener&&div.attachEvent&&div.fireEvent){div.attachEvent("onclick",function(){support.noCloneEvent=false});div.cloneNode(true).fireEvent("onclick")}input=document.createElement("input");input.value="t";input.setAttribute("type","radio");support.radioValue=input.value==="t";input.setAttribute("checked","checked");div.appendChild(input);fragment=document.createDocumentFragment();fragment.appendChild(div.lastChild);support.checkClone=fragment.cloneNode(true).cloneNode(true).lastChild.checked;support.appendChecked=input.checked;fragment.removeChild(input);fragment.appendChild(div);div.innerHTML="";if(window.getComputedStyle){marginDiv=document.createElement("div");marginDiv.style.width="0";marginDiv.style.marginRight="0";div.style.width="2px";div.appendChild(marginDiv);support.reliableMarginRight=(parseInt((window.getComputedStyle(marginDiv,null)||{marginRight:0}).marginRight,10)||0)===0}if(div.attachEvent){for(i in{submit:1,change:1,focusin:1}){eventName="on"+i;isSupported=eventName in div;if(!isSupported){div.setAttribute(eventName,"return;");isSupported=typeof div[eventName]==="function"}support[i+"Bubbles"]=isSupported}}fragment.removeChild(div);fragment=select=opt=marginDiv=div=input=null;jQuery(function(){var container,outer,inner,table,td,offsetSupport,conMarginTop,ptlm,vb,style,html,body=document.getElementsByTagName("body")[0];if(!body){return}conMarginTop=1;ptlm="position:absolute;top:0;left:0;width:1px;height:1px;margin:0;";vb="visibility:hidden;border:0;";style="style='"+ptlm+"border:5px solid #000;padding:0;'";html="<div "+style+"><div></div></div>"+"<table "+style+" cellpadding='0' cellspacing='0'>"+"<tr><td></td></tr></table>";container=document.createElement("div");container.style.cssText=vb+"width:0;height:0;position:static;top:0;margin-top:"+conMarginTop+"px";body.insertBefore(container,body.firstChild);div=document.createElement("div");container.appendChild(div);div.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>";tds=div.getElementsByTagName("td");isSupported=tds[0].offsetHeight===0;tds[0].style.display="";tds[1].style.display="none";support.reliableHiddenOffsets=isSupported&&tds[0].offsetHeight===0;div.innerHTML="";div.style.width=div.style.paddingLeft="1px";jQuery.boxModel=support.boxModel=div.offsetWidth===2;if(typeof div.style.zoom!=="undefined"){div.style.display="inline";div.style.zoom=1;support.inlineBlockNeedsLayout=div.offsetWidth===2;div.style.display="";div.innerHTML="<div style='width:4px;'></div>";support.shrinkWrapBlocks=div.offsetWidth!==2}div.style.cssText=ptlm+vb;div.innerHTML=html;outer=div.firstChild;inner=outer.firstChild;td=outer.nextSibling.firstChild.firstChild;offsetSupport={doesNotAddBorder:inner.offsetTop!==5,doesAddBorderForTableAndCells:td.offsetTop===5};inner.style.position="fixed";inner.style.top="20px";offsetSupport.fixedPosition=inner.offsetTop===20||inner.offsetTop===15;inner.style.position=inner.style.top="";outer.style.overflow="hidden";outer.style.position="relative";offsetSupport.subtractsBorderForOverflowNotVisible=inner.offsetTop===-5;offsetSupport.doesNotIncludeMarginInBodyOffset=body.offsetTop!==conMarginTop;body.removeChild(container);div=container=null;jQuery.extend(support,offsetSupport)});return support}();var rbrace=/^(?:\{.*\}|\[.*\])$/,rmultiDash=/([A-Z])/g;jQuery.extend({cache:{},uuid:0,expando:"jQuery"+(jQuery.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:true,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:true},hasData:function(elem){elem=elem.nodeType?jQuery.cache[elem[jQuery.expando]]:elem[jQuery.expando];return!!elem&&!isEmptyDataObject(elem)},data:function(elem,name,data,pvt){if(!jQuery.acceptData(elem)){return}var privateCache,thisCache,ret,internalKey=jQuery.expando,getByName=typeof name==="string",isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[internalKey]:elem[internalKey]&&internalKey,isEvents=name==="events";if((!id||!cache[id]||!isEvents&&!pvt&&!cache[id].data)&&getByName&&data===undefined){return}if(!id){if(isNode){elem[internalKey]=id=++jQuery.uuid}else{id=internalKey}}if(!cache[id]){cache[id]={};if(!isNode){cache[id].toJSON=jQuery.noop}}if(typeof name==="object"||typeof name==="function"){if(pvt){cache[id]=jQuery.extend(cache[id],name)}else{cache[id].data=jQuery.extend(cache[id].data,name)}}privateCache=thisCache=cache[id];if(!pvt){if(!thisCache.data){thisCache.data={}}thisCache=thisCache.data}if(data!==undefined){thisCache[jQuery.camelCase(name)]=data}if(isEvents&&!thisCache[name]){return privateCache.events}if(getByName){ret=thisCache[name];if(ret==null){ret=thisCache[jQuery.camelCase(name)]}}else{ret=thisCache}return ret},removeData:function(elem,name,pvt){if(!jQuery.acceptData(elem)){return}var thisCache,i,l,internalKey=jQuery.expando,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[internalKey]:internalKey;if(!cache[id]){return}if(name){thisCache=pvt?cache[id]:cache[id].data;if(thisCache){if(!jQuery.isArray(name)){if(name in thisCache){name=[name]}else{name=jQuery.camelCase(name);if(name in thisCache){name=[name]}else{name=name.split(" ")}}}for(i=0,l=name.length;i<l;i++){delete thisCache[name[i]]}if(!(pvt?isEmptyDataObject:jQuery.isEmptyObject)(thisCache)){return}}}if(!pvt){delete cache[id].data;if(!isEmptyDataObject(cache[id])){return}}if(jQuery.support.deleteExpando||!cache.setInterval){delete cache[id]}else{cache[id]=null}if(isNode){if(jQuery.support.deleteExpando){delete elem[internalKey]}else if(elem.removeAttribute){elem.removeAttribute(internalKey)}else{elem[internalKey]=null}}},_data:function(elem,name,data){return jQuery.data(elem,name,data,true)},acceptData:function(elem){if(elem.nodeName){var match=jQuery.noData[elem.nodeName.toLowerCase()];if(match){return!(match===true||elem.getAttribute("classid")!==match)}}return true}});jQuery.fn.extend({data:function(key,value){var parts,attr,name,data=null;if(typeof key==="undefined"){if(this.length){data=jQuery.data(this[0]);if(this[0].nodeType===1&&!jQuery._data(this[0],"parsedAttrs")){attr=this[0].attributes;for(var i=0,l=attr.length;i<l;i++){name=attr[i].name;if(name.indexOf("data-")===0){name=jQuery.camelCase(name.substring(5));dataAttr(this[0],name,data[name])}}jQuery._data(this[0],"parsedAttrs",true)}}return data}else if(typeof key==="object"){return this.each(function(){jQuery.data(this,key)})}parts=key.split(".");parts[1]=parts[1]?"."+parts[1]:"";if(value===undefined){data=this.triggerHandler("getData"+parts[1]+"!",[parts[0]]);if(data===undefined&&this.length){data=jQuery.data(this[0],key);data=dataAttr(this[0],key,data)}return data===undefined&&parts[1]?this.data(parts[0]):data}else{return this.each(function(){var self=jQuery(this),args=[parts[0],value];self.triggerHandler("setData"+parts[1]+"!",args);jQuery.data(this,key,value);self.triggerHandler("changeData"+parts[1]+"!",args)})}},removeData:function(key){return this.each(function(){jQuery.removeData(this,key)})}});function dataAttr(elem,key,data){if(data===undefined&&elem.nodeType===1){var name="data-"+key.replace(rmultiDash,"-$1").toLowerCase();data=elem.getAttribute(name);if(typeof data==="string"){try{data=data==="true"?true:data==="false"?false:data==="null"?null:jQuery.isNumeric(data)?parseFloat(data):rbrace.test(data)?jQuery.parseJSON(data):data}catch(e){}jQuery.data(elem,key,data)}else{data=undefined}}return data}function isEmptyDataObject(obj){for(var name in obj){if(name==="data"&&jQuery.isEmptyObject(obj[name])){continue}if(name!=="toJSON"){return false}}return true}function handleQueueMarkDefer(elem,type,src){var deferDataKey=type+"defer",queueDataKey=type+"queue",markDataKey=type+"mark",defer=jQuery._data(elem,deferDataKey);if(defer&&(src==="queue"||!jQuery._data(elem,queueDataKey))&&(src==="mark"||!jQuery._data(elem,markDataKey))){setTimeout(function(){if(!jQuery._data(elem,queueDataKey)&&!jQuery._data(elem,markDataKey)){jQuery.removeData(elem,deferDataKey,true);defer.fire()}},0)}}jQuery.extend({_mark:function(elem,type){if(elem){type=(type||"fx")+"mark";jQuery._data(elem,type,(jQuery._data(elem,type)||0)+1)}},_unmark:function(force,elem,type){if(force!==true){type=elem;elem=force;force=false}if(elem){type=type||"fx";var key=type+"mark",count=force?0:(jQuery._data(elem,key)||1)-1;if(count){jQuery._data(elem,key,count)}else{jQuery.removeData(elem,key,true);handleQueueMarkDefer(elem,type,"mark")}}},queue:function(elem,type,data){var q;if(elem){type=(type||"fx")+"queue";q=jQuery._data(elem,type);if(data){if(!q||jQuery.isArray(data)){q=jQuery._data(elem,type,jQuery.makeArray(data))}else{q.push(data)}}return q||[]}},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),fn=queue.shift(),hooks={};if(fn==="inprogress"){fn=queue.shift()}if(fn){if(type==="fx"){queue.unshift("inprogress")}jQuery._data(elem,type+".run",hooks);fn.call(elem,function(){jQuery.dequeue(elem,type)},hooks)}if(!queue.length){jQuery.removeData(elem,type+"queue "+type+".run",true);handleQueueMarkDefer(elem,type,"queue")}}});jQuery.fn.extend({queue:function(type,data){if(typeof type!=="string"){data=type;type="fx"}if(data===undefined){return jQuery.queue(this[0],type)}return this.each(function(){var queue=jQuery.queue(this,type,data);if(type==="fx"&&queue[0]!=="inprogress"){jQuery.dequeue(this,type)}})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},delay:function(time,type){time=jQuery.fx?jQuery.fx.speeds[time]||time:time;type=type||"fx";return this.queue(type,function(next,hooks){var timeout=setTimeout(next,time);hooks.stop=function(){clearTimeout(timeout)}})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,object){if(typeof type!=="string"){object=type;type=undefined}type=type||"fx";var defer=jQuery.Deferred(),elements=this,i=elements.length,count=1,deferDataKey=type+"defer",queueDataKey=type+"queue",markDataKey=type+"mark",tmp;function resolve(){if(!--count){defer.resolveWith(elements,[elements])}}while(i--){if(tmp=jQuery.data(elements[i],deferDataKey,undefined,true)||(jQuery.data(elements[i],queueDataKey,undefined,true)||jQuery.data(elements[i],markDataKey,undefined,true))&&jQuery.data(elements[i],deferDataKey,jQuery.Callbacks("once memory"),true)){count++;tmp.add(resolve)}}resolve();return defer.promise()}});var rclass=/[\n\t\r]/g,rspace=/\s+/,rreturn=/\r/g,rtype=/^(?:button|input)$/i,rfocusable=/^(?:button|input|object|select|textarea)$/i,rclickable=/^a(?:rea)?$/i,rboolean=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,getSetAttribute=jQuery.support.getSetAttribute,nodeHook,boolHook,fixSpecified;jQuery.fn.extend({attr:function(name,value){return jQuery.access(this,name,value,true,jQuery.attr)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})},prop:function(name,value){return jQuery.access(this,name,value,true,jQuery.prop)},removeProp:function(name){name=jQuery.propFix[name]||name;return this.each(function(){try{this[name]=undefined;delete this[name]}catch(e){}})},addClass:function(value){var classNames,i,l,elem,setClass,c,cl;if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.className))})}if(value&&typeof value==="string"){classNames=value.split(rspace);for(i=0,l=this.length;i<l;i++){elem=this[i];if(elem.nodeType===1){if(!elem.className&&classNames.length===1){elem.className=value}else{setClass=" "+elem.className+" ";for(c=0,cl=classNames.length;c<cl;c++){if(!~setClass.indexOf(" "+classNames[c]+" ")){setClass+=classNames[c]+" "}}elem.className=jQuery.trim(setClass)}}}}return this},removeClass:function(value){var classNames,i,l,elem,className,c,cl;if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.className))})}if(value&&typeof value==="string"||value===undefined){classNames=(value||"").split(rspace);for(i=0,l=this.length;i<l;i++){elem=this[i];if(elem.nodeType===1&&elem.className){if(value){className=(" "+elem.className+" ").replace(rclass," ");for(c=0,cl=classNames.length;c<cl;c++){className=className.replace(" "+classNames[c]+" "," ")}elem.className=jQuery.trim(className)}else{elem.className=""}}}}return this},toggleClass:function(value,stateVal){var type=typeof value,isBool=typeof stateVal==="boolean";if(jQuery.isFunction(value)){return this.each(function(i){jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal)})}return this.each(function(){if(type==="string"){var className,i=0,self=jQuery(this),state=stateVal,classNames=value.split(rspace);while(className=classNames[i++]){state=isBool?state:!self.hasClass(className);self[state?"addClass":"removeClass"](className)}}else if(type==="undefined"||type==="boolean"){if(this.className){jQuery._data(this,"__className__",this.className)}this.className=this.className||value===false?"":jQuery._data(this,"__className__")||""}})},hasClass:function(selector){var className=" "+selector+" ",i=0,l=this.length;for(;i<l;i++){if(this[i].nodeType===1&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>-1){return true}}return false},val:function(value){var hooks,ret,isFunction,elem=this[0];if(!arguments.length){if(elem){hooks=jQuery.valHooks[elem.nodeName.toLowerCase()]||jQuery.valHooks[elem.type];if(hooks&&"get"in hooks&&(ret=hooks.get(elem,"value"))!==undefined){return ret}ret=elem.value;return typeof ret==="string"?ret.replace(rreturn,""):ret==null?"":ret}return}isFunction=jQuery.isFunction(value);

return this.each(function(i){var self=jQuery(this),val;if(this.nodeType!==1){return}if(isFunction){val=value.call(this,i,self.val())}else{val=value}if(val==null){val=""}else if(typeof val==="number"){val+=""}else if(jQuery.isArray(val)){val=jQuery.map(val,function(value){return value==null?"":value+""})}hooks=jQuery.valHooks[this.nodeName.toLowerCase()]||jQuery.valHooks[this.type];if(!hooks||!("set"in hooks)||hooks.set(this,val,"value")===undefined){this.value=val}})}});jQuery.extend({valHooks:{option:{get:function(elem){var val=elem.attributes.value;return!val||val.specified?elem.value:elem.text}},select:{get:function(elem){var value,i,max,option,index=elem.selectedIndex,values=[],options=elem.options,one=elem.type==="select-one";if(index<0){return null}i=one?index:0;max=one?index+1:options.length;for(;i<max;i++){option=options[i];if(option.selected&&(jQuery.support.optDisabled?!option.disabled:option.getAttribute("disabled")===null)&&(!option.parentNode.disabled||!jQuery.nodeName(option.parentNode,"optgroup"))){value=jQuery(option).val();if(one){return value}values.push(value)}}if(one&&!values.length&&options.length){return jQuery(options[index]).val()}return values},set:function(elem,value){var values=jQuery.makeArray(value);jQuery(elem).find("option").each(function(){this.selected=jQuery.inArray(jQuery(this).val(),values)>=0});if(!values.length){elem.selectedIndex=-1}return values}}},attrFn:{val:true,css:true,html:true,text:true,data:true,width:true,height:true,offset:true},attr:function(elem,name,value,pass){var ret,hooks,notxml,nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return}if(pass&&name in jQuery.attrFn){return jQuery(elem)[name](value)}if(typeof elem.getAttribute==="undefined"){return jQuery.prop(elem,name,value)}notxml=nType!==1||!jQuery.isXMLDoc(elem);if(notxml){name=name.toLowerCase();hooks=jQuery.attrHooks[name]||(rboolean.test(name)?boolHook:nodeHook)}if(value!==undefined){if(value===null){jQuery.removeAttr(elem,name);return}else if(hooks&&"set"in hooks&&notxml&&(ret=hooks.set(elem,value,name))!==undefined){return ret}else{elem.setAttribute(name,""+value);return value}}else if(hooks&&"get"in hooks&&notxml&&(ret=hooks.get(elem,name))!==null){return ret}else{ret=elem.getAttribute(name);return ret===null?undefined:ret}},removeAttr:function(elem,value){var propName,attrNames,name,l,i=0;if(value&&elem.nodeType===1){attrNames=value.toLowerCase().split(rspace);l=attrNames.length;for(;i<l;i++){name=attrNames[i];if(name){propName=jQuery.propFix[name]||name;jQuery.attr(elem,name,"");elem.removeAttribute(getSetAttribute?name:propName);if(rboolean.test(name)&&propName in elem){elem[propName]=false}}}}},attrHooks:{type:{set:function(elem,value){if(rtype.test(elem.nodeName)&&elem.parentNode){jQuery.error("type property can't be changed")}else if(!jQuery.support.radioValue&&value==="radio"&&jQuery.nodeName(elem,"input")){var val=elem.value;elem.setAttribute("type",value);if(val){elem.value=val}return value}}},value:{get:function(elem,name){if(nodeHook&&jQuery.nodeName(elem,"button")){return nodeHook.get(elem,name)}return name in elem?elem.value:null},set:function(elem,value,name){if(nodeHook&&jQuery.nodeName(elem,"button")){return nodeHook.set(elem,value,name)}elem.value=value}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(elem,name,value){var ret,hooks,notxml,nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return}notxml=nType!==1||!jQuery.isXMLDoc(elem);if(notxml){name=jQuery.propFix[name]||name;hooks=jQuery.propHooks[name]}if(value!==undefined){if(hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined){return ret}else{return elem[name]=value}}else{if(hooks&&"get"in hooks&&(ret=hooks.get(elem,name))!==null){return ret}else{return elem[name]}}},propHooks:{tabIndex:{get:function(elem){var attributeNode=elem.getAttributeNode("tabindex");return attributeNode&&attributeNode.specified?parseInt(attributeNode.value,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:undefined}}}});jQuery.attrHooks.tabindex=jQuery.propHooks.tabIndex;boolHook={get:function(elem,name){var attrNode,property=jQuery.prop(elem,name);return property===true||typeof property!=="boolean"&&(attrNode=elem.getAttributeNode(name))&&attrNode.nodeValue!==false?name.toLowerCase():undefined},set:function(elem,value,name){var propName;if(value===false){jQuery.removeAttr(elem,name)}else{propName=jQuery.propFix[name]||name;if(propName in elem){elem[propName]=true}elem.setAttribute(name,name.toLowerCase())}return name}};if(!getSetAttribute){fixSpecified={name:true,id:true};nodeHook=jQuery.valHooks.button={get:function(elem,name){var ret;ret=elem.getAttributeNode(name);return ret&&(fixSpecified[name]?ret.nodeValue!=="":ret.specified)?ret.nodeValue:undefined},set:function(elem,value,name){var ret=elem.getAttributeNode(name);if(!ret){ret=document.createAttribute(name);elem.setAttributeNode(ret)}return ret.nodeValue=value+""}};jQuery.attrHooks.tabindex.set=nodeHook.set;jQuery.each(["width","height"],function(i,name){jQuery.attrHooks[name]=jQuery.extend(jQuery.attrHooks[name],{set:function(elem,value){if(value===""){elem.setAttribute(name,"auto");return value}}})});jQuery.attrHooks.contenteditable={get:nodeHook.get,set:function(elem,value,name){if(value===""){value="false"}nodeHook.set(elem,value,name)}}}if(!jQuery.support.hrefNormalized){jQuery.each(["href","src","width","height"],function(i,name){jQuery.attrHooks[name]=jQuery.extend(jQuery.attrHooks[name],{get:function(elem){var ret=elem.getAttribute(name,2);return ret===null?undefined:ret}})})}if(!jQuery.support.style){jQuery.attrHooks.style={get:function(elem){return elem.style.cssText.toLowerCase()||undefined},set:function(elem,value){return elem.style.cssText=""+value}}}if(!jQuery.support.optSelected){jQuery.propHooks.selected=jQuery.extend(jQuery.propHooks.selected,{get:function(elem){var parent=elem.parentNode;if(parent){parent.selectedIndex;if(parent.parentNode){parent.parentNode.selectedIndex}}return null}})}if(!jQuery.support.enctype){jQuery.propFix.enctype="encoding"}if(!jQuery.support.checkOn){jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={get:function(elem){return elem.getAttribute("value")===null?"on":elem.value}}})}jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]=jQuery.extend(jQuery.valHooks[this],{set:function(elem,value){if(jQuery.isArray(value)){return elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0}}})});var rformElems=/^(?:textarea|input|select)$/i,rtypenamespace=/^([^\.]*)?(?:\.(.+))?$/,rhoverHack=/\bhover(\.\S+)?\b/,rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rquickIs=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,quickParse=function(selector){var quick=rquickIs.exec(selector);if(quick){quick[1]=(quick[1]||"").toLowerCase();quick[3]=quick[3]&&new RegExp("(?:^|\\s)"+quick[3]+"(?:\\s|$)")}return quick},quickIs=function(elem,m){var attrs=elem.attributes||{};return(!m[1]||elem.nodeName.toLowerCase()===m[1])&&(!m[2]||(attrs.id||{}).value===m[2])&&(!m[3]||m[3].test((attrs["class"]||{}).value))},hoverHack=function(events){return jQuery.event.special.hover?events:events.replace(rhoverHack,"mouseenter$1 mouseleave$1")};jQuery.event={add:function(elem,types,handler,data,selector){var elemData,eventHandle,events,t,tns,type,namespaces,handleObj,handleObjIn,quick,handlers,special;if(elem.nodeType===3||elem.nodeType===8||!types||!handler||!(elemData=jQuery._data(elem))){return}if(handler.handler){handleObjIn=handler;handler=handleObjIn.handler}if(!handler.guid){handler.guid=jQuery.guid++}events=elemData.events;if(!events){elemData.events=events={}}eventHandle=elemData.handle;if(!eventHandle){elemData.handle=eventHandle=function(e){return typeof jQuery!=="undefined"&&(!e||jQuery.event.triggered!==e.type)?jQuery.event.dispatch.apply(eventHandle.elem,arguments):undefined};eventHandle.elem=elem}types=jQuery.trim(hoverHack(types)).split(" ");for(t=0;t<types.length;t++){tns=rtypenamespace.exec(types[t])||[];type=tns[1];namespaces=(tns[2]||"").split(".").sort();special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;special=jQuery.event.special[type]||{};handleObj=jQuery.extend({type:type,origType:tns[1],data:data,handler:handler,guid:handler.guid,selector:selector,quick:quickParse(selector),namespace:namespaces.join(".")},handleObjIn);handlers=events[type];if(!handlers){handlers=events[type]=[];handlers.delegateCount=0;if(!special.setup||special.setup.call(elem,data,namespaces,eventHandle)===false){if(elem.addEventListener){elem.addEventListener(type,eventHandle,false)}else if(elem.attachEvent){elem.attachEvent("on"+type,eventHandle)}}}if(special.add){special.add.call(elem,handleObj);if(!handleObj.handler.guid){handleObj.handler.guid=handler.guid}}if(selector){handlers.splice(handlers.delegateCount++,0,handleObj)}else{handlers.push(handleObj)}jQuery.event.global[type]=true}elem=null},global:{},remove:function(elem,types,handler,selector,mappedTypes){var elemData=jQuery.hasData(elem)&&jQuery._data(elem),t,tns,type,origType,namespaces,origCount,j,events,special,handle,eventType,handleObj;if(!elemData||!(events=elemData.events)){return}types=jQuery.trim(hoverHack(types||"")).split(" ");for(t=0;t<types.length;t++){tns=rtypenamespace.exec(types[t])||[];type=origType=tns[1];namespaces=tns[2];if(!type){for(type in events){jQuery.event.remove(elem,type+types[t],handler,selector,true)}continue}special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;eventType=events[type]||[];origCount=eventType.length;namespaces=namespaces?new RegExp("(^|\\.)"+namespaces.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null;for(j=0;j<eventType.length;j++){handleObj=eventType[j];if((mappedTypes||origType===handleObj.origType)&&(!handler||handler.guid===handleObj.guid)&&(!namespaces||namespaces.test(handleObj.namespace))&&(!selector||selector===handleObj.selector||selector==="**"&&handleObj.selector)){eventType.splice(j--,1);if(handleObj.selector){eventType.delegateCount--}if(special.remove){special.remove.call(elem,handleObj)}}}if(eventType.length===0&&origCount!==eventType.length){if(!special.teardown||special.teardown.call(elem,namespaces)===false){jQuery.removeEvent(elem,type,elemData.handle)}delete events[type]}}if(jQuery.isEmptyObject(events)){handle=elemData.handle;if(handle){handle.elem=null}jQuery.removeData(elem,["events","handle"],true)}},customEvent:{getData:true,setData:true,changeData:true},trigger:function(event,data,elem,onlyHandlers){if(elem&&(elem.nodeType===3||elem.nodeType===8)){return}var type=event.type||event,namespaces=[],cache,exclusive,i,cur,old,ontype,special,handle,eventPath,bubbleType;if(rfocusMorph.test(type+jQuery.event.triggered)){return}if(type.indexOf("!")>=0){type=type.slice(0,-1);exclusive=true}if(type.indexOf(".")>=0){namespaces=type.split(".");type=namespaces.shift();namespaces.sort()}if((!elem||jQuery.event.customEvent[type])&&!jQuery.event.global[type]){return}event=typeof event==="object"?event[jQuery.expando]?event:new jQuery.Event(type,event):new jQuery.Event(type);event.type=type;event.isTrigger=true;event.exclusive=exclusive;event.namespace=namespaces.join(".");event.namespace_re=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.)?")+"(\\.|$)"):null;ontype=type.indexOf(":")<0?"on"+type:"";if(!elem){cache=jQuery.cache;for(i in cache){if(cache[i].events&&cache[i].events[type]){jQuery.event.trigger(event,data,cache[i].handle.elem,true)}}return}event.result=undefined;if(!event.target){event.target=elem}data=data!=null?jQuery.makeArray(data):[];data.unshift(event);special=jQuery.event.special[type]||{};if(special.trigger&&special.trigger.apply(elem,data)===false){return}eventPath=[[elem,special.bindType||type]];if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){bubbleType=special.delegateType||type;cur=rfocusMorph.test(bubbleType+type)?elem:elem.parentNode;old=null;for(;cur;cur=cur.parentNode){eventPath.push([cur,bubbleType]);old=cur}if(old&&old===elem.ownerDocument){eventPath.push([old.defaultView||old.parentWindow||window,bubbleType])}}for(i=0;i<eventPath.length&&!event.isPropagationStopped();i++){cur=eventPath[i][0];event.type=eventPath[i][1];handle=(jQuery._data(cur,"events")||{})[event.type]&&jQuery._data(cur,"handle");if(handle){handle.apply(cur,data)}handle=ontype&&cur[ontype];if(handle&&jQuery.acceptData(cur)&&handle.apply(cur,data)===false){event.preventDefault()}}event.type=type;if(!onlyHandlers&&!event.isDefaultPrevented()){if((!special._default||special._default.apply(elem.ownerDocument,data)===false)&&!(type==="click"&&jQuery.nodeName(elem,"a"))&&jQuery.acceptData(elem)){if(ontype&&elem[type]&&(type!=="focus"&&type!=="blur"||event.target.offsetWidth!==0)&&!jQuery.isWindow(elem)){old=elem[ontype];if(old){elem[ontype]=null}jQuery.event.triggered=type;elem[type]();jQuery.event.triggered=undefined;if(old){elem[ontype]=old}}}}return event.result},dispatch:function(event){event=jQuery.event.fix(event||window.event);var handlers=(jQuery._data(this,"events")||{})[event.type]||[],delegateCount=handlers.delegateCount,args=[].slice.call(arguments,0),run_all=!event.exclusive&&!event.namespace,handlerQueue=[],i,j,cur,jqcur,ret,selMatch,matched,matches,handleObj,sel,related;args[0]=event;event.delegateTarget=this;if(delegateCount&&!event.target.disabled&&!(event.button&&event.type==="click")){jqcur=jQuery(this);jqcur.context=this.ownerDocument||this;for(cur=event.target;cur!=this;cur=cur.parentNode||this){selMatch={};matches=[];jqcur[0]=cur;for(i=0;i<delegateCount;i++){handleObj=handlers[i];sel=handleObj.selector;if(selMatch[sel]===undefined){selMatch[sel]=handleObj.quick?quickIs(cur,handleObj.quick):jqcur.is(sel)}if(selMatch[sel]){matches.push(handleObj)}}if(matches.length){handlerQueue.push({elem:cur,matches:matches})}}}if(handlers.length>delegateCount){handlerQueue.push({elem:this,matches:handlers.slice(delegateCount)})}for(i=0;i<handlerQueue.length&&!event.isPropagationStopped();i++){matched=handlerQueue[i];event.currentTarget=matched.elem;for(j=0;j<matched.matches.length&&!event.isImmediatePropagationStopped();j++){handleObj=matched.matches[j];if(run_all||!event.namespace&&!handleObj.namespace||event.namespace_re&&event.namespace_re.test(handleObj.namespace)){event.data=handleObj.data;event.handleObj=handleObj;ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args);if(ret!==undefined){event.result=ret;if(ret===false){event.preventDefault();event.stopPropagation()}}}}}return event.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(event,original){if(event.which==null){event.which=original.charCode!=null?original.charCode:original.keyCode}return event}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(event,original){var eventDoc,doc,body,button=original.button,fromElement=original.fromElement;if(event.pageX==null&&original.clientX!=null){eventDoc=event.target.ownerDocument||document;doc=eventDoc.documentElement;body=eventDoc.body;event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0);event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)}if(!event.relatedTarget&&fromElement){event.relatedTarget=fromElement===event.target?original.toElement:fromElement}if(!event.which&&button!==undefined){event.which=button&1?1:button&2?3:button&4?2:0}return event}},fix:function(event){if(event[jQuery.expando]){return event}var i,prop,originalEvent=event,fixHook=jQuery.event.fixHooks[event.type]||{},copy=fixHook.props?this.props.concat(fixHook.props):this.props;event=jQuery.Event(originalEvent);for(i=copy.length;i;){prop=copy[--i];event[prop]=originalEvent[prop]}if(!event.target){event.target=originalEvent.srcElement||document}if(event.target.nodeType===3){event.target=event.target.parentNode}if(event.metaKey===undefined){event.metaKey=event.ctrlKey}return fixHook.filter?fixHook.filter(event,originalEvent):event},special:{ready:{setup:jQuery.bindReady},load:{noBubble:true},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(data,namespaces,eventHandle){if(jQuery.isWindow(this)){this.onbeforeunload=eventHandle}},teardown:function(namespaces,eventHandle){if(this.onbeforeunload===eventHandle){this.onbeforeunload=null}}}},simulate:function(type,elem,event,bubble){var e=jQuery.extend(new jQuery.Event,event,{type:type,isSimulated:true,originalEvent:{}});if(bubble){jQuery.event.trigger(e,null,elem)}else{jQuery.event.dispatch.call(elem,e)}if(e.isDefaultPrevented()){event.preventDefault()}}};jQuery.event.handle=jQuery.event.dispatch;jQuery.removeEvent=document.removeEventListener?function(elem,type,handle){if(elem.removeEventListener){elem.removeEventListener(type,handle,false)}}:function(elem,type,handle){if(elem.detachEvent){elem.detachEvent("on"+type,handle)}};jQuery.Event=function(src,props){if(!(this instanceof jQuery.Event)){return new jQuery.Event(src,props)}if(src&&src.type){this.originalEvent=src;this.type=src.type;this.isDefaultPrevented=src.defaultPrevented||src.returnValue===false||src.getPreventDefault&&src.getPreventDefault()?returnTrue:returnFalse}else{this.type=src}if(props){jQuery.extend(this,props)}this.timeStamp=src&&src.timeStamp||jQuery.now();this[jQuery.expando]=true};function returnFalse(){return false}function returnTrue(){return true}jQuery.Event.prototype={preventDefault:function(){this.isDefaultPrevented=returnTrue;var e=this.originalEvent;if(!e){return}if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}},stopPropagation:function(){this.isPropagationStopped=returnTrue;var e=this.originalEvent;if(!e){return}if(e.stopPropagation){e.stopPropagation()}e.cancelBubble=true},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=returnTrue;this.stopPropagation()},isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse};jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var target=this,related=event.relatedTarget,handleObj=event.handleObj,selector=handleObj.selector,ret;if(!related||related!==target&&!jQuery.contains(target,related)){event.type=handleObj.origType;ret=handleObj.handler.apply(this,arguments);event.type=fix}return ret}}});if(!jQuery.support.submitBubbles){jQuery.event.special.submit={setup:function(){if(jQuery.nodeName(this,"form")){return false}jQuery.event.add(this,"click._submit keypress._submit",function(e){var elem=e.target,form=jQuery.nodeName(elem,"input")||jQuery.nodeName(elem,"button")?elem.form:undefined;if(form&&!form._submit_attached){jQuery.event.add(form,"submit._submit",function(event){if(this.parentNode&&!event.isTrigger){jQuery.event.simulate("submit",this.parentNode,event,true)}});form._submit_attached=true}})},teardown:function(){if(jQuery.nodeName(this,"form")){return false}jQuery.event.remove(this,"._submit")}}}if(!jQuery.support.changeBubbles){jQuery.event.special.change={setup:function(){if(rformElems.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio"){jQuery.event.add(this,"propertychange._change",function(event){if(event.originalEvent.propertyName==="checked"){this._just_changed=true}});jQuery.event.add(this,"click._change",function(event){if(this._just_changed&&!event.isTrigger){this._just_changed=false;jQuery.event.simulate("change",this,event,true)}})}return false}jQuery.event.add(this,"beforeactivate._change",function(e){var elem=e.target;if(rformElems.test(elem.nodeName)&&!elem._change_attached){jQuery.event.add(elem,"change._change",function(event){if(this.parentNode&&!event.isSimulated&&!event.isTrigger){jQuery.event.simulate("change",this.parentNode,event,true)}});elem._change_attached=true}})},handle:function(event){var elem=event.target;if(this!==elem||event.isSimulated||event.isTrigger||elem.type!=="radio"&&elem.type!=="checkbox"){return event.handleObj.handler.apply(this,arguments)}},teardown:function(){jQuery.event.remove(this,"._change");return rformElems.test(this.nodeName)}}}if(!jQuery.support.focusinBubbles){jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var attaches=0,handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event),true)};jQuery.event.special[fix]={setup:function(){if(attaches++===0){document.addEventListener(orig,handler,true)}},teardown:function(){if(--attaches===0){document.removeEventListener(orig,handler,true)}}}})}jQuery.fn.extend({on:function(types,selector,data,fn,one){var origFn,type;if(typeof types==="object"){if(typeof selector!=="string"){data=selector;selector=undefined}for(type in types){this.on(type,selector,data,types[type],one)}return this}if(data==null&&fn==null){fn=selector;data=selector=undefined}else if(fn==null){if(typeof selector==="string"){fn=data;data=undefined}else{fn=data;data=selector;selector=undefined}}if(fn===false){fn=returnFalse}else if(!fn){return this}if(one===1){origFn=fn;fn=function(event){jQuery().off(event);return origFn.apply(this,arguments)};fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)}return this.each(function(){jQuery.event.add(this,types,fn,data,selector)})},one:function(types,selector,data,fn){return this.on.call(this,types,selector,data,fn,1)},off:function(types,selector,fn){if(types&&types.preventDefault&&types.handleObj){var handleObj=types.handleObj;jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.type+"."+handleObj.namespace:handleObj.type,handleObj.selector,handleObj.handler);return this}if(typeof types==="object"){for(var type in types){this.off(type,selector,types[type])}return this}if(selector===false||typeof selector==="function"){fn=selector;selector=undefined}if(fn===false){fn=returnFalse}return this.each(function(){jQuery.event.remove(this,types,fn,selector)})},bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},live:function(types,data,fn){jQuery(this.context).on(types,this.selector,data,fn);return this},die:function(types,fn){jQuery(this.context).off(types,this.selector||"**",fn);return this},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return arguments.length==1?this.off(selector,"**"):this.off(types,selector,fn)},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){if(this[0]){return jQuery.event.trigger(type,data,this[0],true)}},toggle:function(fn){var args=arguments,guid=fn.guid||jQuery.guid++,i=0,toggler=function(event){var lastToggle=(jQuery._data(this,"lastToggle"+fn.guid)||0)%i;jQuery._data(this,"lastToggle"+fn.guid,lastToggle+1);event.preventDefault();return args[lastToggle].apply(this,arguments)||false};toggler.guid=guid;while(i<args.length){args[i++].guid=guid}return this.click(toggler)},hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)}});jQuery.each(("blur focus focusin focusout load resize scroll unload click dblclick "+"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave "+"change select submit keydown keypress keyup error contextmenu").split(" "),function(i,name){jQuery.fn[name]=function(data,fn){if(fn==null){fn=data;data=null}return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)};if(jQuery.attrFn){jQuery.attrFn[name]=true}if(rkeyEvent.test(name)){jQuery.event.fixHooks[name]=jQuery.event.keyHooks}if(rmouseEvent.test(name)){jQuery.event.fixHooks[name]=jQuery.event.mouseHooks}});(function(){var chunker=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,expando="sizcache"+(Math.random()+"").replace(".",""),done=0,toString=Object.prototype.toString,hasDuplicate=false,baseHasDuplicate=true,rBackslash=/\\/g,rReturn=/\r\n/g,rNonWord=/\W/;[0,0].sort(function(){baseHasDuplicate=false;return 0});var Sizzle=function(selector,context,results,seed){results=results||[];context=context||document;var origContext=context;if(context.nodeType!==1&&context.nodeType!==9){return[]}if(!selector||typeof selector!=="string"){return results}var m,set,checkSet,extra,ret,cur,pop,i,prune=true,contextXML=Sizzle.isXML(context),parts=[],soFar=selector;do{chunker.exec("");m=chunker.exec(soFar);if(m){soFar=m[3];parts.push(m[1]);if(m[2]){extra=m[3];break}}}while(m);if(parts.length>1&&origPOS.exec(selector)){if(parts.length===2&&Expr.relative[parts[0]]){set=posProcess(parts[0]+parts[1],context,seed)}else{set=Expr.relative[parts[0]]?[context]:Sizzle(parts.shift(),context);while(parts.length){selector=parts.shift();if(Expr.relative[selector]){selector+=parts.shift()}set=posProcess(selector,set,seed)}}}else{if(!seed&&parts.length>1&&context.nodeType===9&&!contextXML&&Expr.match.ID.test(parts[0])&&!Expr.match.ID.test(parts[parts.length-1])){ret=Sizzle.find(parts.shift(),context,contextXML);context=ret.expr?Sizzle.filter(ret.expr,ret.set)[0]:ret.set[0]}if(context){ret=seed?{expr:parts.pop(),set:makeArray(seed)}:Sizzle.find(parts.pop(),parts.length===1&&(parts[0]==="~"||parts[0]==="+")&&context.parentNode?context.parentNode:context,contextXML);set=ret.expr?Sizzle.filter(ret.expr,ret.set):ret.set;if(parts.length>0){checkSet=makeArray(set)}else{prune=false}while(parts.length){cur=parts.pop();pop=cur;if(!Expr.relative[cur]){cur=""}else{pop=parts.pop()}if(pop==null){pop=context}Expr.relative[cur](checkSet,pop,contextXML)}}else{checkSet=parts=[]}}if(!checkSet){checkSet=set}if(!checkSet){Sizzle.error(cur||selector)}if(toString.call(checkSet)==="[object Array]"){if(!prune){results.push.apply(results,checkSet)}else if(context&&context.nodeType===1){for(i=0;checkSet[i]!=null;i++){if(checkSet[i]&&(checkSet[i]===true||checkSet[i].nodeType===1&&Sizzle.contains(context,checkSet[i]))){results.push(set[i])}}}else{for(i=0;checkSet[i]!=null;i++){if(checkSet[i]&&checkSet[i].nodeType===1){results.push(set[i])}}}}else{makeArray(checkSet,results)}if(extra){Sizzle(extra,origContext,results,seed);Sizzle.uniqueSort(results)}return results};Sizzle.uniqueSort=function(results){if(sortOrder){hasDuplicate=baseHasDuplicate;results.sort(sortOrder);if(hasDuplicate){for(var i=1;i<results.length;i++){if(results[i]===results[i-1]){results.splice(i--,1)}}}}return results};Sizzle.matches=function(expr,set){return Sizzle(expr,null,null,set)};Sizzle.matchesSelector=function(node,expr){return Sizzle(expr,null,null,[node]).length>0};Sizzle.find=function(expr,context,isXML){var set,i,len,match,type,left;if(!expr){return[]}for(i=0,len=Expr.order.length;i<len;i++){type=Expr.order[i];if(match=Expr.leftMatch[type].exec(expr)){left=match[1];match.splice(1,1);if(left.substr(left.length-1)!=="\\"){match[1]=(match[1]||"").replace(rBackslash,"");set=Expr.find[type](match,context,isXML);if(set!=null){expr=expr.replace(Expr.match[type],"");break}}}}if(!set){set=typeof context.getElementsByTagName!=="undefined"?context.getElementsByTagName("*"):[]}return{set:set,expr:expr}};Sizzle.filter=function(expr,set,inplace,not){var match,anyFound,type,found,item,filter,left,i,pass,old=expr,result=[],curLoop=set,isXMLFilter=set&&set[0]&&Sizzle.isXML(set[0]);while(expr&&set.length){for(type in Expr.filter){if((match=Expr.leftMatch[type].exec(expr))!=null&&match[2]){filter=Expr.filter[type];left=match[1];anyFound=false;match.splice(1,1);if(left.substr(left.length-1)==="\\"){continue}if(curLoop===result){result=[]}if(Expr.preFilter[type]){match=Expr.preFilter[type](match,curLoop,inplace,result,not,isXMLFilter);if(!match){anyFound=found=true}else if(match===true){continue}}if(match){for(i=0;(item=curLoop[i])!=null;i++){if(item){found=filter(item,match,i,curLoop);pass=not^found;if(inplace&&found!=null){if(pass){anyFound=true}else{curLoop[i]=false}}else if(pass){result.push(item);anyFound=true}}}}if(found!==undefined){if(!inplace){curLoop=result}expr=expr.replace(Expr.match[type],"");if(!anyFound){return[]}break}}}if(expr===old){if(anyFound==null){Sizzle.error(expr)}else{break}}old=expr}return curLoop};Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)};var getText=Sizzle.getText=function(elem){var i,node,nodeType=elem.nodeType,ret="";if(nodeType){if(nodeType===1||nodeType===9){if(typeof elem.textContent==="string"){return elem.textContent}else if(typeof elem.innerText==="string"){return elem.innerText.replace(rReturn,"")}else{for(elem=elem.firstChild;elem;elem=elem.nextSibling){ret+=getText(elem)}}}else if(nodeType===3||nodeType===4){return elem.nodeValue}}else{for(i=0;node=elem[i];i++){if(node.nodeType!==8){ret+=getText(node)}}}return ret};var Expr=Sizzle.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(elem){return elem.getAttribute("href")},type:function(elem){return elem.getAttribute("type")}},relative:{"+":function(checkSet,part){var isPartStr=typeof part==="string",isTag=isPartStr&&!rNonWord.test(part),isPartStrNotTag=isPartStr&&!isTag;if(isTag){part=part.toLowerCase()}for(var i=0,l=checkSet.length,elem;i<l;i++){if(elem=checkSet[i]){while((elem=elem.previousSibling)&&elem.nodeType!==1){}checkSet[i]=isPartStrNotTag||elem&&elem.nodeName.toLowerCase()===part?elem||false:elem===part}}if(isPartStrNotTag){Sizzle.filter(part,checkSet,true)}},">":function(checkSet,part){var elem,isPartStr=typeof part==="string",i=0,l=checkSet.length;if(isPartStr&&!rNonWord.test(part)){part=part.toLowerCase();for(;i<l;i++){elem=checkSet[i];if(elem){var parent=elem.parentNode;checkSet[i]=parent.nodeName.toLowerCase()===part?parent:false}}}else{for(;i<l;i++){elem=checkSet[i];if(elem){checkSet[i]=isPartStr?elem.parentNode:elem.parentNode===part}}if(isPartStr){Sizzle.filter(part,checkSet,true)}}},"":function(checkSet,part,isXML){var nodeCheck,doneName=done++,checkFn=dirCheck;if(typeof part==="string"&&!rNonWord.test(part)){part=part.toLowerCase();nodeCheck=part;checkFn=dirNodeCheck}checkFn("parentNode",part,doneName,checkSet,nodeCheck,isXML)},"~":function(checkSet,part,isXML){var nodeCheck,doneName=done++,checkFn=dirCheck;if(typeof part==="string"&&!rNonWord.test(part)){part=part.toLowerCase();nodeCheck=part;checkFn=dirNodeCheck}checkFn("previousSibling",part,doneName,checkSet,nodeCheck,isXML)}},find:{ID:function(match,context,isXML){if(typeof context.getElementById!=="undefined"&&!isXML){var m=context.getElementById(match[1]);return m&&m.parentNode?[m]:[]}},NAME:function(match,context){if(typeof context.getElementsByName!=="undefined"){var ret=[],results=context.getElementsByName(match[1]);for(var i=0,l=results.length;i<l;i++){if(results[i].getAttribute("name")===match[1]){ret.push(results[i])}}return ret.length===0?null:ret;

}},TAG:function(match,context){if(typeof context.getElementsByTagName!=="undefined"){return context.getElementsByTagName(match[1])}}},preFilter:{CLASS:function(match,curLoop,inplace,result,not,isXML){match=" "+match[1].replace(rBackslash,"")+" ";if(isXML){return match}for(var i=0,elem;(elem=curLoop[i])!=null;i++){if(elem){if(not^(elem.className&&(" "+elem.className+" ").replace(/[\t\n\r]/g," ").indexOf(match)>=0)){if(!inplace){result.push(elem)}}else if(inplace){curLoop[i]=false}}}return false},ID:function(match){return match[1].replace(rBackslash,"")},TAG:function(match,curLoop){return match[1].replace(rBackslash,"").toLowerCase()},CHILD:function(match){if(match[1]==="nth"){if(!match[2]){Sizzle.error(match[0])}match[2]=match[2].replace(/^\+|\s*/g,"");var test=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(match[2]==="even"&&"2n"||match[2]==="odd"&&"2n+1"||!/\D/.test(match[2])&&"0n+"+match[2]||match[2]);match[2]=test[1]+(test[2]||1)-0;match[3]=test[3]-0}else if(match[2]){Sizzle.error(match[0])}match[0]=done++;return match},ATTR:function(match,curLoop,inplace,result,not,isXML){var name=match[1]=match[1].replace(rBackslash,"");if(!isXML&&Expr.attrMap[name]){match[1]=Expr.attrMap[name]}match[4]=(match[4]||match[5]||"").replace(rBackslash,"");if(match[2]==="~="){match[4]=" "+match[4]+" "}return match},PSEUDO:function(match,curLoop,inplace,result,not){if(match[1]==="not"){if((chunker.exec(match[3])||"").length>1||/^\w/.test(match[3])){match[3]=Sizzle(match[3],null,null,curLoop)}else{var ret=Sizzle.filter(match[3],curLoop,inplace,true^not);if(!inplace){result.push.apply(result,ret)}return false}}else if(Expr.match.POS.test(match[0])||Expr.match.CHILD.test(match[0])){return true}return match},POS:function(match){match.unshift(true);return match}},filters:{enabled:function(elem){return elem.disabled===false&&elem.type!=="hidden"},disabled:function(elem){return elem.disabled===true},checked:function(elem){return elem.checked===true},selected:function(elem){if(elem.parentNode){elem.parentNode.selectedIndex}return elem.selected===true},parent:function(elem){return!!elem.firstChild},empty:function(elem){return!elem.firstChild},has:function(elem,i,match){return!!Sizzle(match[3],elem).length},header:function(elem){return/h\d/i.test(elem.nodeName)},text:function(elem){var attr=elem.getAttribute("type"),type=elem.type;return elem.nodeName.toLowerCase()==="input"&&"text"===type&&(attr===type||attr===null)},radio:function(elem){return elem.nodeName.toLowerCase()==="input"&&"radio"===elem.type},checkbox:function(elem){return elem.nodeName.toLowerCase()==="input"&&"checkbox"===elem.type},file:function(elem){return elem.nodeName.toLowerCase()==="input"&&"file"===elem.type},password:function(elem){return elem.nodeName.toLowerCase()==="input"&&"password"===elem.type},submit:function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&"submit"===elem.type},image:function(elem){return elem.nodeName.toLowerCase()==="input"&&"image"===elem.type},reset:function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&"reset"===elem.type},button:function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&"button"===elem.type||name==="button"},input:function(elem){return/input|select|textarea|button/i.test(elem.nodeName)},focus:function(elem){return elem===elem.ownerDocument.activeElement}},setFilters:{first:function(elem,i){return i===0},last:function(elem,i,match,array){return i===array.length-1},even:function(elem,i){return i%2===0},odd:function(elem,i){return i%2===1},lt:function(elem,i,match){return i<match[3]-0},gt:function(elem,i,match){return i>match[3]-0},nth:function(elem,i,match){return match[3]-0===i},eq:function(elem,i,match){return match[3]-0===i}},filter:{PSEUDO:function(elem,match,i,array){var name=match[1],filter=Expr.filters[name];if(filter){return filter(elem,i,match,array)}else if(name==="contains"){return(elem.textContent||elem.innerText||getText([elem])||"").indexOf(match[3])>=0}else if(name==="not"){var not=match[3];for(var j=0,l=not.length;j<l;j++){if(not[j]===elem){return false}}return true}else{Sizzle.error(name)}},CHILD:function(elem,match){var first,last,doneName,parent,cache,count,diff,type=match[1],node=elem;switch(type){case"only":case"first":while(node=node.previousSibling){if(node.nodeType===1){return false}}if(type==="first"){return true}node=elem;case"last":while(node=node.nextSibling){if(node.nodeType===1){return false}}return true;case"nth":first=match[2];last=match[3];if(first===1&&last===0){return true}doneName=match[0];parent=elem.parentNode;if(parent&&(parent[expando]!==doneName||!elem.nodeIndex)){count=0;for(node=parent.firstChild;node;node=node.nextSibling){if(node.nodeType===1){node.nodeIndex=++count}}parent[expando]=doneName}diff=elem.nodeIndex-last;if(first===0){return diff===0}else{return diff%first===0&&diff/first>=0}}},ID:function(elem,match){return elem.nodeType===1&&elem.getAttribute("id")===match},TAG:function(elem,match){return match==="*"&&elem.nodeType===1||!!elem.nodeName&&elem.nodeName.toLowerCase()===match},CLASS:function(elem,match){return(" "+(elem.className||elem.getAttribute("class"))+" ").indexOf(match)>-1},ATTR:function(elem,match){var name=match[1],result=Sizzle.attr?Sizzle.attr(elem,name):Expr.attrHandle[name]?Expr.attrHandle[name](elem):elem[name]!=null?elem[name]:elem.getAttribute(name),value=result+"",type=match[2],check=match[4];return result==null?type==="!=":!type&&Sizzle.attr?result!=null:type==="="?value===check:type==="*="?value.indexOf(check)>=0:type==="~="?(" "+value+" ").indexOf(check)>=0:!check?value&&result!==false:type==="!="?value!==check:type==="^="?value.indexOf(check)===0:type==="$="?value.substr(value.length-check.length)===check:type==="|="?value===check||value.substr(0,check.length+1)===check+"-":false},POS:function(elem,match,i,array){var name=match[2],filter=Expr.setFilters[name];if(filter){return filter(elem,i,match,array)}}}};var origPOS=Expr.match.POS,fescape=function(all,num){return"\\"+(num-0+1)};for(var type in Expr.match){Expr.match[type]=new RegExp(Expr.match[type].source+/(?![^\[]*\])(?![^\(]*\))/.source);Expr.leftMatch[type]=new RegExp(/(^(?:.|\r|\n)*?)/.source+Expr.match[type].source.replace(/\\(\d+)/g,fescape))}var makeArray=function(array,results){array=Array.prototype.slice.call(array,0);if(results){results.push.apply(results,array);return results}return array};try{Array.prototype.slice.call(document.documentElement.childNodes,0)[0].nodeType}catch(e){makeArray=function(array,results){var i=0,ret=results||[];if(toString.call(array)==="[object Array]"){Array.prototype.push.apply(ret,array)}else{if(typeof array.length==="number"){for(var l=array.length;i<l;i++){ret.push(array[i])}}else{for(;array[i];i++){ret.push(array[i])}}}return ret}}var sortOrder,siblingCheck;if(document.documentElement.compareDocumentPosition){sortOrder=function(a,b){if(a===b){hasDuplicate=true;return 0}if(!a.compareDocumentPosition||!b.compareDocumentPosition){return a.compareDocumentPosition?-1:1}return a.compareDocumentPosition(b)&4?-1:1}}else{sortOrder=function(a,b){if(a===b){hasDuplicate=true;return 0}else if(a.sourceIndex&&b.sourceIndex){return a.sourceIndex-b.sourceIndex}var al,bl,ap=[],bp=[],aup=a.parentNode,bup=b.parentNode,cur=aup;if(aup===bup){return siblingCheck(a,b)}else if(!aup){return-1}else if(!bup){return 1}while(cur){ap.unshift(cur);cur=cur.parentNode}cur=bup;while(cur){bp.unshift(cur);cur=cur.parentNode}al=ap.length;bl=bp.length;for(var i=0;i<al&&i<bl;i++){if(ap[i]!==bp[i]){return siblingCheck(ap[i],bp[i])}}return i===al?siblingCheck(a,bp[i],-1):siblingCheck(ap[i],b,1)};siblingCheck=function(a,b,ret){if(a===b){return ret}var cur=a.nextSibling;while(cur){if(cur===b){return-1}cur=cur.nextSibling}return 1}}(function(){var form=document.createElement("div"),id="script"+(new Date).getTime(),root=document.documentElement;form.innerHTML="<a name='"+id+"'/>";root.insertBefore(form,root.firstChild);if(document.getElementById(id)){Expr.find.ID=function(match,context,isXML){if(typeof context.getElementById!=="undefined"&&!isXML){var m=context.getElementById(match[1]);return m?m.id===match[1]||typeof m.getAttributeNode!=="undefined"&&m.getAttributeNode("id").nodeValue===match[1]?[m]:undefined:[]}};Expr.filter.ID=function(elem,match){var node=typeof elem.getAttributeNode!=="undefined"&&elem.getAttributeNode("id");return elem.nodeType===1&&node&&node.nodeValue===match}}root.removeChild(form);root=form=null})();(function(){var div=document.createElement("div");div.appendChild(document.createComment(""));if(div.getElementsByTagName("*").length>0){Expr.find.TAG=function(match,context){var results=context.getElementsByTagName(match[1]);if(match[1]==="*"){var tmp=[];for(var i=0;results[i];i++){if(results[i].nodeType===1){tmp.push(results[i])}}results=tmp}return results}}div.innerHTML="<a href='#'></a>";if(div.firstChild&&typeof div.firstChild.getAttribute!=="undefined"&&div.firstChild.getAttribute("href")!=="#"){Expr.attrHandle.href=function(elem){return elem.getAttribute("href",2)}}div=null})();if(document.querySelectorAll){(function(){var oldSizzle=Sizzle,div=document.createElement("div"),id="__sizzle__";div.innerHTML="<p class='TEST'></p>";if(div.querySelectorAll&&div.querySelectorAll(".TEST").length===0){return}Sizzle=function(query,context,extra,seed){context=context||document;if(!seed&&!Sizzle.isXML(context)){var match=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(query);if(match&&(context.nodeType===1||context.nodeType===9)){if(match[1]){return makeArray(context.getElementsByTagName(query),extra)}else if(match[2]&&Expr.find.CLASS&&context.getElementsByClassName){return makeArray(context.getElementsByClassName(match[2]),extra)}}if(context.nodeType===9){if(query==="body"&&context.body){return makeArray([context.body],extra)}else if(match&&match[3]){var elem=context.getElementById(match[3]);if(elem&&elem.parentNode){if(elem.id===match[3]){return makeArray([elem],extra)}}else{return makeArray([],extra)}}try{return makeArray(context.querySelectorAll(query),extra)}catch(qsaError){}}else if(context.nodeType===1&&context.nodeName.toLowerCase()!=="object"){var oldContext=context,old=context.getAttribute("id"),nid=old||id,hasParent=context.parentNode,relativeHierarchySelector=/^\s*[+~]/.test(query);if(!old){context.setAttribute("id",nid)}else{nid=nid.replace(/'/g,"\\$&")}if(relativeHierarchySelector&&hasParent){context=context.parentNode}try{if(!relativeHierarchySelector||hasParent){return makeArray(context.querySelectorAll("[id='"+nid+"'] "+query),extra)}}catch(pseudoError){}finally{if(!old){oldContext.removeAttribute("id")}}}}return oldSizzle(query,context,extra,seed)};for(var prop in oldSizzle){Sizzle[prop]=oldSizzle[prop]}div=null})()}(function(){var html=document.documentElement,matches=html.matchesSelector||html.mozMatchesSelector||html.webkitMatchesSelector||html.msMatchesSelector;if(matches){var disconnectedMatch=!matches.call(document.createElement("div"),"div"),pseudoWorks=false;try{matches.call(document.documentElement,"[test!='']:sizzle")}catch(pseudoError){pseudoWorks=true}Sizzle.matchesSelector=function(node,expr){expr=expr.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!Sizzle.isXML(node)){try{if(pseudoWorks||!Expr.match.PSEUDO.test(expr)&&!/!=/.test(expr)){var ret=matches.call(node,expr);if(ret||!disconnectedMatch||node.document&&node.document.nodeType!==11){return ret}}}catch(e){}}return Sizzle(expr,null,null,[node]).length>0}}})();(function(){var div=document.createElement("div");div.innerHTML="<div class='test e'></div><div class='test'></div>";if(!div.getElementsByClassName||div.getElementsByClassName("e").length===0){return}div.lastChild.className="e";if(div.getElementsByClassName("e").length===1){return}Expr.order.splice(1,0,"CLASS");Expr.find.CLASS=function(match,context,isXML){if(typeof context.getElementsByClassName!=="undefined"&&!isXML){return context.getElementsByClassName(match[1])}};div=null})();function dirNodeCheck(dir,cur,doneName,checkSet,nodeCheck,isXML){for(var i=0,l=checkSet.length;i<l;i++){var elem=checkSet[i];if(elem){var match=false;elem=elem[dir];while(elem){if(elem[expando]===doneName){match=checkSet[elem.sizset];break}if(elem.nodeType===1&&!isXML){elem[expando]=doneName;elem.sizset=i}if(elem.nodeName.toLowerCase()===cur){match=elem;break}elem=elem[dir]}checkSet[i]=match}}}function dirCheck(dir,cur,doneName,checkSet,nodeCheck,isXML){for(var i=0,l=checkSet.length;i<l;i++){var elem=checkSet[i];if(elem){var match=false;elem=elem[dir];while(elem){if(elem[expando]===doneName){match=checkSet[elem.sizset];break}if(elem.nodeType===1){if(!isXML){elem[expando]=doneName;elem.sizset=i}if(typeof cur!=="string"){if(elem===cur){match=true;break}}else if(Sizzle.filter(cur,[elem]).length>0){match=elem;break}}elem=elem[dir]}checkSet[i]=match}}}if(document.documentElement.contains){Sizzle.contains=function(a,b){return a!==b&&(a.contains?a.contains(b):true)}}else if(document.documentElement.compareDocumentPosition){Sizzle.contains=function(a,b){return!!(a.compareDocumentPosition(b)&16)}}else{Sizzle.contains=function(){return false}}Sizzle.isXML=function(elem){var documentElement=(elem?elem.ownerDocument||elem:0).documentElement;return documentElement?documentElement.nodeName!=="HTML":false};var posProcess=function(selector,context,seed){var match,tmpSet=[],later="",root=context.nodeType?[context]:context;while(match=Expr.match.PSEUDO.exec(selector)){later+=match[0];selector=selector.replace(Expr.match.PSEUDO,"")}selector=Expr.relative[selector]?selector+"*":selector;for(var i=0,l=root.length;i<l;i++){Sizzle(selector,root[i],tmpSet,seed)}return Sizzle.filter(later,tmpSet)};Sizzle.attr=jQuery.attr;Sizzle.selectors.attrMap={};jQuery.find=Sizzle;jQuery.expr=Sizzle.selectors;jQuery.expr[":"]=jQuery.expr.filters;jQuery.unique=Sizzle.uniqueSort;jQuery.text=Sizzle.getText;jQuery.isXMLDoc=Sizzle.isXML;jQuery.contains=Sizzle.contains})();var runtil=/Until$/,rparentsprev=/^(?:parents|prevUntil|prevAll)/,rmultiselector=/,/,isSimple=/^.[^:#\[\.,]*$/,slice=Array.prototype.slice,POS=jQuery.expr.match.POS,guaranteedUnique={children:true,contents:true,next:true,prev:true};jQuery.fn.extend({find:function(selector){var self=this,i,l;if(typeof selector!=="string"){return jQuery(selector).filter(function(){for(i=0,l=self.length;i<l;i++){if(jQuery.contains(self[i],this)){return true}}})}var ret=this.pushStack("","find",selector),length,n,r;for(i=0,l=this.length;i<l;i++){length=ret.length;jQuery.find(selector,this[i],ret);if(i>0){for(n=length;n<ret.length;n++){for(r=0;r<length;r++){if(ret[r]===ret[n]){ret.splice(n--,1);break}}}}}return ret},has:function(target){var targets=jQuery(target);return this.filter(function(){for(var i=0,l=targets.length;i<l;i++){if(jQuery.contains(this,targets[i])){return true}}})},not:function(selector){return this.pushStack(winnow(this,selector,false),"not",selector)},filter:function(selector){return this.pushStack(winnow(this,selector,true),"filter",selector)},is:function(selector){return!!selector&&(typeof selector==="string"?POS.test(selector)?jQuery(selector,this.context).index(this[0])>=0:jQuery.filter(selector,this).length>0:this.filter(selector).length>0)},closest:function(selectors,context){var ret=[],i,l,cur=this[0];if(jQuery.isArray(selectors)){var level=1;while(cur&&cur.ownerDocument&&cur!==context){for(i=0;i<selectors.length;i++){if(jQuery(cur).is(selectors[i])){ret.push({selector:selectors[i],elem:cur,level:level})}}cur=cur.parentNode;level++}return ret}var pos=POS.test(selectors)||typeof selectors!=="string"?jQuery(selectors,context||this.context):0;for(i=0,l=this.length;i<l;i++){cur=this[i];while(cur){if(pos?pos.index(cur)>-1:jQuery.find.matchesSelector(cur,selectors)){ret.push(cur);break}else{cur=cur.parentNode;if(!cur||!cur.ownerDocument||cur===context||cur.nodeType===11){break}}}}ret=ret.length>1?jQuery.unique(ret):ret;return this.pushStack(ret,"closest",selectors)},index:function(elem){if(!elem){return this[0]&&this[0].parentNode?this.prevAll().length:-1}if(typeof elem==="string"){return jQuery.inArray(this[0],jQuery(elem))}return jQuery.inArray(elem.jquery?elem[0]:elem,this)},add:function(selector,context){var set=typeof selector==="string"?jQuery(selector,context):jQuery.makeArray(selector&&selector.nodeType?[selector]:selector),all=jQuery.merge(this.get(),set);return this.pushStack(isDisconnected(set[0])||isDisconnected(all[0])?all:jQuery.unique(all))},andSelf:function(){return this.add(this.prevObject)}});function isDisconnected(node){return!node||!node.parentNode||node.parentNode.nodeType===11}jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&parent.nodeType!==11?parent:null},parents:function(elem){return jQuery.dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return jQuery.dir(elem,"parentNode",until)},next:function(elem){return jQuery.nth(elem,2,"nextSibling")},prev:function(elem){return jQuery.nth(elem,2,"previousSibling")},nextAll:function(elem){return jQuery.dir(elem,"nextSibling")},prevAll:function(elem){return jQuery.dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return jQuery.dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return jQuery.dir(elem,"previousSibling",until)},siblings:function(elem){return jQuery.sibling(elem.parentNode.firstChild,elem)},children:function(elem){return jQuery.sibling(elem.firstChild)},contents:function(elem){return jQuery.nodeName(elem,"iframe")?elem.contentDocument||elem.contentWindow.document:jQuery.makeArray(elem.childNodes)}},function(name,fn){jQuery.fn[name]=function(until,selector){var ret=jQuery.map(this,fn,until);if(!runtil.test(name)){selector=until}if(selector&&typeof selector==="string"){ret=jQuery.filter(selector,ret)}ret=this.length>1&&!guaranteedUnique[name]?jQuery.unique(ret):ret;if((this.length>1||rmultiselector.test(selector))&&rparentsprev.test(name)){ret=ret.reverse()}return this.pushStack(ret,name,slice.call(arguments).join(","))}});jQuery.extend({filter:function(expr,elems,not){if(not){expr=":not("+expr+")"}return elems.length===1?jQuery.find.matchesSelector(elems[0],expr)?[elems[0]]:[]:jQuery.find.matches(expr,elems)},dir:function(elem,dir,until){var matched=[],cur=elem[dir];while(cur&&cur.nodeType!==9&&(until===undefined||cur.nodeType!==1||!jQuery(cur).is(until))){if(cur.nodeType===1){matched.push(cur)}cur=cur[dir]}return matched},nth:function(cur,result,dir,elem){result=result||1;var num=0;for(;cur;cur=cur[dir]){if(cur.nodeType===1&&++num===result){break}}return cur},sibling:function(n,elem){var r=[];for(;n;n=n.nextSibling){if(n.nodeType===1&&n!==elem){r.push(n)}}return r}});function winnow(elements,qualifier,keep){qualifier=qualifier||0;if(jQuery.isFunction(qualifier)){return jQuery.grep(elements,function(elem,i){var retVal=!!qualifier.call(elem,i,elem);return retVal===keep})}else if(qualifier.nodeType){return jQuery.grep(elements,function(elem,i){return elem===qualifier===keep})}else if(typeof qualifier==="string"){var filtered=jQuery.grep(elements,function(elem){return elem.nodeType===1});if(isSimple.test(qualifier)){return jQuery.filter(qualifier,filtered,!keep)}else{qualifier=jQuery.filter(qualifier,filtered)}}return jQuery.grep(elements,function(elem,i){return jQuery.inArray(elem,qualifier)>=0===keep})}function createSafeFragment(document){var list=nodeNames.split("|"),safeFrag=document.createDocumentFragment();if(safeFrag.createElement){while(list.length){safeFrag.createElement(list.pop())}}return safeFrag}var nodeNames="abbr|article|aside|audio|canvas|datalist|details|figcaption|figure|footer|"+"header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",rinlinejQuery=/ jQuery\d+="(?:\d+|null)"/g,rleadingWhitespace=/^\s+/,rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rtbody=/<tbody/i,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style)/i,rnocache=/<(?:script|object|embed|option|style)/i,rnoshimcache=new RegExp("<(?:"+nodeNames+")","i"),rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/\/(java|ecma)script/i,rcleanScript=/^\s*<!(?:\[CDATA\[|\-\-)/,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},safeFragment=createSafeFragment(document);wrapMap.optgroup=wrapMap.option;wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead;wrapMap.th=wrapMap.td;if(!jQuery.support.htmlSerialize){wrapMap._default=[1,"div<div>","</div>"]}jQuery.fn.extend({text:function(text){if(jQuery.isFunction(text)){return this.each(function(i){var self=jQuery(this);self.text(text.call(this,i,self.text()))})}if(typeof text!=="object"&&text!==undefined){return this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(text))}return jQuery.text(this)},wrapAll:function(html){if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapAll(html.call(this,i))})}if(this[0]){var wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){wrap.insertBefore(this[0])}wrap.map(function(){var elem=this;while(elem.firstChild&&elem.firstChild.nodeType===1){elem=elem.firstChild}return elem}).append(this)}return this},wrapInner:function(html){if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapInner(html.call(this,i))})}return this.each(function(){var self=jQuery(this),contents=self.contents();if(contents.length){contents.wrapAll(html)}else{self.append(html)}})},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)})},unwrap:function(){return this.parent().each(function(){if(!jQuery.nodeName(this,"body")){jQuery(this).replaceWith(this.childNodes)}}).end()},append:function(){return this.domManip(arguments,true,function(elem){if(this.nodeType===1){this.appendChild(elem)}})},prepend:function(){return this.domManip(arguments,true,function(elem){if(this.nodeType===1){this.insertBefore(elem,this.firstChild)}})},before:function(){if(this[0]&&this[0].parentNode){return this.domManip(arguments,false,function(elem){this.parentNode.insertBefore(elem,this)})}else if(arguments.length){var set=jQuery.clean(arguments);set.push.apply(set,this.toArray());return this.pushStack(set,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode){return this.domManip(arguments,false,function(elem){this.parentNode.insertBefore(elem,this.nextSibling)})}else if(arguments.length){var set=this.pushStack(this,"after",arguments);set.push.apply(set,jQuery.clean(arguments));return set}},remove:function(selector,keepData){for(var i=0,elem;(elem=this[i])!=null;i++){if(!selector||jQuery.filter(selector,[elem]).length){if(!keepData&&elem.nodeType===1){jQuery.cleanData(elem.getElementsByTagName("*"));jQuery.cleanData([elem])}if(elem.parentNode){elem.parentNode.removeChild(elem)}}}return this},empty:function(){for(var i=0,elem;(elem=this[i])!=null;i++){if(elem.nodeType===1){jQuery.cleanData(elem.getElementsByTagName("*"))}while(elem.firstChild){elem.removeChild(elem.firstChild)}}return this},clone:function(dataAndEvents,deepDataAndEvents){dataAndEvents=dataAndEvents==null?false:dataAndEvents;deepDataAndEvents=deepDataAndEvents==null?dataAndEvents:deepDataAndEvents;return this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){if(value===undefined){return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(rinlinejQuery,""):null}else if(typeof value==="string"&&!rnoInnerhtml.test(value)&&(jQuery.support.leadingWhitespace||!rleadingWhitespace.test(value))&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=value.replace(rxhtmlTag,"<$1></$2>");try{for(var i=0,l=this.length;i<l;i++){if(this[i].nodeType===1){jQuery.cleanData(this[i].getElementsByTagName("*"));this[i].innerHTML=value}}}catch(e){this.empty().append(value)}}else if(jQuery.isFunction(value)){this.each(function(i){var self=jQuery(this);self.html(value.call(this,i,self.html()))})}else{this.empty().append(value)}return this},replaceWith:function(value){if(this[0]&&this[0].parentNode){if(jQuery.isFunction(value)){return this.each(function(i){var self=jQuery(this),old=self.html();self.replaceWith(value.call(this,i,old))})}if(typeof value!=="string"){value=jQuery(value).detach()}return this.each(function(){var next=this.nextSibling,parent=this.parentNode;jQuery(this).remove();if(next){jQuery(next).before(value)}else{jQuery(parent).append(value)}})}else{return this.length?this.pushStack(jQuery(jQuery.isFunction(value)?value():value),"replaceWith",value):this}},detach:function(selector){return this.remove(selector,true)},domManip:function(args,table,callback){var results,first,fragment,parent,value=args[0],scripts=[];if(!jQuery.support.checkClone&&arguments.length===3&&typeof value==="string"&&rchecked.test(value)){return this.each(function(){jQuery(this).domManip(args,table,callback,true)})}if(jQuery.isFunction(value)){return this.each(function(i){var self=jQuery(this);args[0]=value.call(this,i,table?self.html():undefined);self.domManip(args,table,callback)})}if(this[0]){parent=value&&value.parentNode;if(jQuery.support.parentNode&&parent&&parent.nodeType===11&&parent.childNodes.length===this.length){results={fragment:parent}}else{results=jQuery.buildFragment(args,this,scripts)}fragment=results.fragment;if(fragment.childNodes.length===1){first=fragment=fragment.firstChild}else{first=fragment.firstChild}if(first){table=table&&jQuery.nodeName(first,"tr");for(var i=0,l=this.length,lastIndex=l-1;i<l;i++){callback.call(table?root(this[i],first):this[i],results.cacheable||l>1&&i<lastIndex?jQuery.clone(fragment,true,true):fragment)}}if(scripts.length){jQuery.each(scripts,evalScript)}}return this}});function root(elem,cur){return jQuery.nodeName(elem,"table")?elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody")):elem}function cloneCopyEvent(src,dest){if(dest.nodeType!==1||!jQuery.hasData(src)){return}var type,i,l,oldData=jQuery._data(src),curData=jQuery._data(dest,oldData),events=oldData.events;if(events){delete curData.handle;curData.events={};for(type in events){for(i=0,l=events[type].length;i<l;i++){jQuery.event.add(dest,type+(events[type][i].namespace?".":"")+events[type][i].namespace,events[type][i],events[type][i].data)}}}if(curData.data){curData.data=jQuery.extend({},curData.data)}}function cloneFixAttributes(src,dest){var nodeName;if(dest.nodeType!==1){return}if(dest.clearAttributes){dest.clearAttributes()}if(dest.mergeAttributes){dest.mergeAttributes(src)}nodeName=dest.nodeName.toLowerCase();if(nodeName==="object"){dest.outerHTML=src.outerHTML}else if(nodeName==="input"&&(src.type==="checkbox"||src.type==="radio")){if(src.checked){dest.defaultChecked=dest.checked=src.checked}if(dest.value!==src.value){dest.value=src.value}}else if(nodeName==="option"){dest.selected=src.defaultSelected}else if(nodeName==="input"||nodeName==="textarea"){dest.defaultValue=src.defaultValue}dest.removeAttribute(jQuery.expando)}jQuery.buildFragment=function(args,nodes,scripts){var fragment,cacheable,cacheresults,doc,first=args[0];if(nodes&&nodes[0]){doc=nodes[0].ownerDocument||nodes[0]}if(!doc.createDocumentFragment){doc=document}if(args.length===1&&typeof first==="string"&&first.length<512&&doc===document&&first.charAt(0)==="<"&&!rnocache.test(first)&&(jQuery.support.checkClone||!rchecked.test(first))&&(jQuery.support.html5Clone||!rnoshimcache.test(first))){cacheable=true;cacheresults=jQuery.fragments[first];if(cacheresults&&cacheresults!==1){fragment=cacheresults}}if(!fragment){fragment=doc.createDocumentFragment();jQuery.clean(args,doc,fragment,scripts)}if(cacheable){jQuery.fragments[first]=cacheresults?fragment:1}return{fragment:fragment,cacheable:cacheable}};jQuery.fragments={};jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){var ret=[],insert=jQuery(selector),parent=this.length===1&&this[0].parentNode;if(parent&&parent.nodeType===11&&parent.childNodes.length===1&&insert.length===1){insert[original](this[0]);return this}else{for(var i=0,l=insert.length;i<l;i++){var elems=(i>0?this.clone(true):this).get();jQuery(insert[i])[original](elems);ret=ret.concat(elems)}return this.pushStack(ret,name,insert.selector)}}});function getAll(elem){if(typeof elem.getElementsByTagName!=="undefined"){return elem.getElementsByTagName("*")}else if(typeof elem.querySelectorAll!=="undefined"){return elem.querySelectorAll("*")}else{return[]}}function fixDefaultChecked(elem){if(elem.type==="checkbox"||elem.type==="radio"){elem.defaultChecked=elem.checked}}function findInputs(elem){var nodeName=(elem.nodeName||"").toLowerCase();if(nodeName==="input"){fixDefaultChecked(elem)}else if(nodeName!=="script"&&typeof elem.getElementsByTagName!=="undefined"){jQuery.grep(elem.getElementsByTagName("input"),fixDefaultChecked)}}function shimCloneNode(elem){var div=document.createElement("div");safeFragment.appendChild(div);div.innerHTML=elem.outerHTML;return div.firstChild}jQuery.extend({clone:function(elem,dataAndEvents,deepDataAndEvents){var srcElements,destElements,i,clone=jQuery.support.html5Clone||!rnoshimcache.test("<"+elem.nodeName)?elem.cloneNode(true):shimCloneNode(elem);if((!jQuery.support.noCloneEvent||!jQuery.support.noCloneChecked)&&(elem.nodeType===1||elem.nodeType===11)&&!jQuery.isXMLDoc(elem)){cloneFixAttributes(elem,clone);srcElements=getAll(elem);destElements=getAll(clone);for(i=0;srcElements[i];++i){if(destElements[i]){cloneFixAttributes(srcElements[i],destElements[i])}}}if(dataAndEvents){cloneCopyEvent(elem,clone);if(deepDataAndEvents){srcElements=getAll(elem);destElements=getAll(clone);for(i=0;srcElements[i];++i){cloneCopyEvent(srcElements[i],destElements[i])}}}srcElements=destElements=null;return clone},clean:function(elems,context,fragment,scripts){var checkScriptType;context=context||document;if(typeof context.createElement==="undefined"){context=context.ownerDocument||context[0]&&context[0].ownerDocument||document}var ret=[],j;for(var i=0,elem;(elem=elems[i])!=null;i++){if(typeof elem==="number"){elem+=""}if(!elem){continue}if(typeof elem==="string"){if(!rhtml.test(elem)){elem=context.createTextNode(elem)}else{elem=elem.replace(rxhtmlTag,"<$1></$2>");var tag=(rtagName.exec(elem)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,depth=wrap[0],div=context.createElement("div");if(context===document){safeFragment.appendChild(div)}else{createSafeFragment(context).appendChild(div)}div.innerHTML=wrap[1]+elem+wrap[2];while(depth--){div=div.lastChild}if(!jQuery.support.tbody){var hasBody=rtbody.test(elem),tbody=tag==="table"&&!hasBody?div.firstChild&&div.firstChild.childNodes:wrap[1]==="<table>"&&!hasBody?div.childNodes:[];for(j=tbody.length-1;j>=0;--j){if(jQuery.nodeName(tbody[j],"tbody")&&!tbody[j].childNodes.length){tbody[j].parentNode.removeChild(tbody[j])}}}if(!jQuery.support.leadingWhitespace&&rleadingWhitespace.test(elem)){div.insertBefore(context.createTextNode(rleadingWhitespace.exec(elem)[0]),div.firstChild)}elem=div.childNodes}}var len;if(!jQuery.support.appendChecked){if(elem[0]&&typeof(len=elem.length)==="number"){for(j=0;j<len;j++){findInputs(elem[j])}}else{findInputs(elem)}}if(elem.nodeType){ret.push(elem)}else{ret=jQuery.merge(ret,elem)}}if(fragment){checkScriptType=function(elem){return!elem.type||rscriptType.test(elem.type)};for(i=0;ret[i];i++){if(scripts&&jQuery.nodeName(ret[i],"script")&&(!ret[i].type||ret[i].type.toLowerCase()==="text/javascript")){scripts.push(ret[i].parentNode?ret[i].parentNode.removeChild(ret[i]):ret[i])}else{if(ret[i].nodeType===1){var jsTags=jQuery.grep(ret[i].getElementsByTagName("script"),checkScriptType);ret.splice.apply(ret,[i+1,0].concat(jsTags));

}fragment.appendChild(ret[i])}}}return ret},cleanData:function(elems){var data,id,cache=jQuery.cache,special=jQuery.event.special,deleteExpando=jQuery.support.deleteExpando;for(var i=0,elem;(elem=elems[i])!=null;i++){if(elem.nodeName&&jQuery.noData[elem.nodeName.toLowerCase()]){continue}id=elem[jQuery.expando];if(id){data=cache[id];if(data&&data.events){for(var type in data.events){if(special[type]){jQuery.event.remove(elem,type)}else{jQuery.removeEvent(elem,type,data.handle)}}if(data.handle){data.handle.elem=null}}if(deleteExpando){delete elem[jQuery.expando]}else if(elem.removeAttribute){elem.removeAttribute(jQuery.expando)}delete cache[id]}}}});function evalScript(i,elem){if(elem.src){jQuery.ajax({url:elem.src,async:false,dataType:"script"})}else{jQuery.globalEval((elem.text||elem.textContent||elem.innerHTML||"").replace(rcleanScript,"/*$0*/"))}if(elem.parentNode){elem.parentNode.removeChild(elem)}}var ralpha=/alpha\([^)]*\)/i,ropacity=/opacity=([^)]*)/,rupper=/([A-Z]|^ms)/g,rnumpx=/^-?\d+(?:px)?$/i,rnum=/^-?\d/,rrelNum=/^([\-+])=([\-+.\de]+)/,cssShow={position:"absolute",visibility:"hidden",display:"block"},cssWidth=["Left","Right"],cssHeight=["Top","Bottom"],curCSS,getComputedStyle,currentStyle;jQuery.fn.css=function(name,value){if(arguments.length===2&&value===undefined){return this}return jQuery.access(this,name,value,true,function(elem,name,value){return value!==undefined?jQuery.style(elem,name,value):jQuery.css(elem,name)})};jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity","opacity");return ret===""?"1":ret}else{return elem.style.opacity}}}},cssNumber:{fillOpacity:true,fontWeight:true,lineHeight:true,opacity:true,orphans:true,widows:true,zIndex:true,zoom:true},cssProps:{"float":jQuery.support.cssFloat?"cssFloat":"styleFloat"},style:function(elem,name,value,extra){if(!elem||elem.nodeType===3||elem.nodeType===8||!elem.style){return}var ret,type,origName=jQuery.camelCase(name),style=elem.style,hooks=jQuery.cssHooks[origName];name=jQuery.cssProps[origName]||origName;if(value!==undefined){type=typeof value;if(type==="string"&&(ret=rrelNum.exec(value))){value=+(ret[1]+1)*+ret[2]+parseFloat(jQuery.css(elem,name));type="number"}if(value==null||type==="number"&&isNaN(value)){return}if(type==="number"&&!jQuery.cssNumber[origName]){value+="px"}if(!hooks||!("set"in hooks)||(value=hooks.set(elem,value))!==undefined){try{style[name]=value}catch(e){}}}else{if(hooks&&"get"in hooks&&(ret=hooks.get(elem,false,extra))!==undefined){return ret}return style[name]}},css:function(elem,name,extra){var ret,hooks;name=jQuery.camelCase(name);hooks=jQuery.cssHooks[name];name=jQuery.cssProps[name]||name;if(name==="cssFloat"){name="float"}if(hooks&&"get"in hooks&&(ret=hooks.get(elem,true,extra))!==undefined){return ret}else if(curCSS){return curCSS(elem,name)}},swap:function(elem,options,callback){var old={};for(var name in options){old[name]=elem.style[name];elem.style[name]=options[name]}callback.call(elem);for(name in options){elem.style[name]=old[name]}}});jQuery.curCSS=jQuery.css;jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){var val;if(computed){if(elem.offsetWidth!==0){return getWH(elem,name,extra)}else{jQuery.swap(elem,cssShow,function(){val=getWH(elem,name,extra)})}return val}},set:function(elem,value){if(rnumpx.test(value)){value=parseFloat(value);if(value>=0){return value+"px"}}else{return value}}}});if(!jQuery.support.opacity){jQuery.cssHooks.opacity={get:function(elem,computed){return ropacity.test((computed&&elem.currentStyle?elem.currentStyle.filter:elem.style.filter)||"")?parseFloat(RegExp.$1)/100+"":computed?"1":""},set:function(elem,value){var style=elem.style,currentStyle=elem.currentStyle,opacity=jQuery.isNumeric(value)?"alpha(opacity="+value*100+")":"",filter=currentStyle&&currentStyle.filter||style.filter||"";style.zoom=1;if(value>=1&&jQuery.trim(filter.replace(ralpha,""))===""){style.removeAttribute("filter");if(currentStyle&&!currentStyle.filter){return}}style.filter=ralpha.test(filter)?filter.replace(ralpha,opacity):filter+" "+opacity}}}jQuery(function(){if(!jQuery.support.reliableMarginRight){jQuery.cssHooks.marginRight={get:function(elem,computed){var ret;jQuery.swap(elem,{display:"inline-block"},function(){if(computed){ret=curCSS(elem,"margin-right","marginRight")}else{ret=elem.style.marginRight}});return ret}}}});if(document.defaultView&&document.defaultView.getComputedStyle){getComputedStyle=function(elem,name){var ret,defaultView,computedStyle;name=name.replace(rupper,"-$1").toLowerCase();if((defaultView=elem.ownerDocument.defaultView)&&(computedStyle=defaultView.getComputedStyle(elem,null))){ret=computedStyle.getPropertyValue(name);if(ret===""&&!jQuery.contains(elem.ownerDocument.documentElement,elem)){ret=jQuery.style(elem,name)}}return ret}}if(document.documentElement.currentStyle){currentStyle=function(elem,name){var left,rsLeft,uncomputed,ret=elem.currentStyle&&elem.currentStyle[name],style=elem.style;if(ret===null&&style&&(uncomputed=style[name])){ret=uncomputed}if(!rnumpx.test(ret)&&rnum.test(ret)){left=style.left;rsLeft=elem.runtimeStyle&&elem.runtimeStyle.left;if(rsLeft){elem.runtimeStyle.left=elem.currentStyle.left}style.left=name==="fontSize"?"1em":ret||0;ret=style.pixelLeft+"px";style.left=left;if(rsLeft){elem.runtimeStyle.left=rsLeft}}return ret===""?"auto":ret}}curCSS=getComputedStyle||currentStyle;function getWH(elem,name,extra){var val=name==="width"?elem.offsetWidth:elem.offsetHeight,which=name==="width"?cssWidth:cssHeight,i=0,len=which.length;if(val>0){if(extra!=="border"){for(;i<len;i++){if(!extra){val-=parseFloat(jQuery.css(elem,"padding"+which[i]))||0}if(extra==="margin"){val+=parseFloat(jQuery.css(elem,extra+which[i]))||0}else{val-=parseFloat(jQuery.css(elem,"border"+which[i]+"Width"))||0}}}return val+"px"}val=curCSS(elem,name,name);if(val<0||val==null){val=elem.style[name]||0}val=parseFloat(val)||0;if(extra){for(;i<len;i++){val+=parseFloat(jQuery.css(elem,"padding"+which[i]))||0;if(extra!=="padding"){val+=parseFloat(jQuery.css(elem,"border"+which[i]+"Width"))||0}if(extra==="margin"){val+=parseFloat(jQuery.css(elem,extra+which[i]))||0}}}return val+"px"}if(jQuery.expr&&jQuery.expr.filters){jQuery.expr.filters.hidden=function(elem){var width=elem.offsetWidth,height=elem.offsetHeight;return width===0&&height===0||!jQuery.support.reliableHiddenOffsets&&(elem.style&&elem.style.display||jQuery.css(elem,"display"))==="none"};jQuery.expr.filters.visible=function(elem){return!jQuery.expr.filters.hidden(elem)}}var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rhash=/#.*$/,rheaders=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,rinput=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,rlocalProtocol=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rquery=/\?/,rscript=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,rselectTextarea=/^(?:select|textarea)/i,rspacesAjax=/\s+/,rts=/([?&])_=[^&]*/,rurl=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,_load=jQuery.fn.load,prefilters={},transports={},ajaxLocation,ajaxLocParts,allTypes=["*/"]+["*"];try{ajaxLocation=location.href}catch(e){ajaxLocation=document.createElement("a");ajaxLocation.href="";ajaxLocation=ajaxLocation.href}ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[];function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){if(typeof dataTypeExpression!=="string"){func=dataTypeExpression;dataTypeExpression="*"}if(jQuery.isFunction(func)){var dataTypes=dataTypeExpression.toLowerCase().split(rspacesAjax),i=0,length=dataTypes.length,dataType,list,placeBefore;for(;i<length;i++){dataType=dataTypes[i];placeBefore=/^\+/.test(dataType);if(placeBefore){dataType=dataType.substr(1)||"*"}list=structure[dataType]=structure[dataType]||[];list[placeBefore?"unshift":"push"](func)}}}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR,dataType,inspected){dataType=dataType||options.dataTypes[0];inspected=inspected||{};inspected[dataType]=true;var list=structure[dataType],i=0,length=list?list.length:0,executeOnly=structure===prefilters,selection;for(;i<length&&(executeOnly||!selection);i++){selection=list[i](options,originalOptions,jqXHR);if(typeof selection==="string"){if(!executeOnly||inspected[selection]){selection=undefined}else{options.dataTypes.unshift(selection);selection=inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR,selection,inspected)}}}if((executeOnly||!selection)&&!inspected["*"]){selection=inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR,"*",inspected)}return selection}function ajaxExtend(target,src){var key,deep,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src){if(src[key]!==undefined){(flatOptions[key]?target:deep||(deep={}))[key]=src[key]}}if(deep){jQuery.extend(true,target,deep)}}jQuery.fn.extend({load:function(url,params,callback){if(typeof url!=="string"&&_load){return _load.apply(this,arguments)}else if(!this.length){return this}var off=url.indexOf(" ");if(off>=0){var selector=url.slice(off,url.length);url=url.slice(0,off)}var type="GET";if(params){if(jQuery.isFunction(params)){callback=params;params=undefined}else if(typeof params==="object"){params=jQuery.param(params,jQuery.ajaxSettings.traditional);type="POST"}}var self=this;jQuery.ajax({url:url,type:type,dataType:"html",data:params,complete:function(jqXHR,status,responseText){responseText=jqXHR.responseText;if(jqXHR.isResolved()){jqXHR.done(function(r){responseText=r});self.html(selector?jQuery("<div>").append(responseText.replace(rscript,"")).find(selector):responseText)}if(callback){self.each(callback,[responseText,status,jqXHR])}}});return this},serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?jQuery.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||rselectTextarea.test(this.nodeName)||rinput.test(this.type))}).map(function(i,elem){var val=jQuery(this).val();return val==null?null:jQuery.isArray(val)?jQuery.map(val,function(val,i){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}});jQuery.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(i,o){jQuery.fn[o]=function(f){return this.on(o,f)}});jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){if(jQuery.isFunction(data)){type=type||callback;callback=data;data=undefined}return jQuery.ajax({type:method,url:url,data:data,success:callback,dataType:type})}});jQuery.extend({getScript:function(url,callback){return jQuery.get(url,undefined,callback,"script")},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},ajaxSetup:function(target,settings){if(settings){ajaxExtend(target,jQuery.ajaxSettings)}else{settings=target;target=jQuery.ajaxSettings}ajaxExtend(target,settings);return target},ajaxSettings:{url:ajaxLocation,isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:true,type:"GET",contentType:"application/x-www-form-urlencoded",processData:true,async:true,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":allTypes},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":window.String,"text html":true,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{context:true,url:true}},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){if(typeof url==="object"){options=url;url=undefined}options=options||{};var s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=callbackContext!==s&&(callbackContext.nodeType||callbackContext instanceof jQuery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},ifModifiedKey,requestHeaders={},requestHeadersNames={},responseHeadersString,responseHeaders,transport,timeoutTimer,parts,state=0,fireGlobals,i,jqXHR={readyState:0,setRequestHeader:function(name,value){if(!state){var lname=name.toLowerCase();name=requestHeadersNames[lname]=requestHeadersNames[lname]||name;requestHeaders[name]=value}return this},getAllResponseHeaders:function(){return state===2?responseHeadersString:null},getResponseHeader:function(key){var match;if(state===2){if(!responseHeaders){responseHeaders={};while(match=rheaders.exec(responseHeadersString)){responseHeaders[match[1].toLowerCase()]=match[2]}}match=responseHeaders[key.toLowerCase()]}return match===undefined?null:match},overrideMimeType:function(type){if(!state){s.mimeType=type}return this},abort:function(statusText){statusText=statusText||"abort";if(transport){transport.abort(statusText)}done(0,statusText);return this}};function done(status,nativeStatusText,responses,headers){if(state===2){return}state=2;if(timeoutTimer){clearTimeout(timeoutTimer)}transport=undefined;responseHeadersString=headers||"";jqXHR.readyState=status>0?4:0;var isSuccess,success,error,statusText=nativeStatusText,response=responses?ajaxHandleResponses(s,jqXHR,responses):undefined,lastModified,etag;if(status>=200&&status<300||status===304){if(s.ifModified){if(lastModified=jqXHR.getResponseHeader("Last-Modified")){jQuery.lastModified[ifModifiedKey]=lastModified}if(etag=jqXHR.getResponseHeader("Etag")){jQuery.etag[ifModifiedKey]=etag}}if(status===304){statusText="notmodified";isSuccess=true}else{try{success=ajaxConvert(s,response);statusText="success";isSuccess=true}catch(e){statusText="parsererror";error=e}}}else{error=statusText;if(!statusText||status){statusText="error";if(status<0){status=0}}}jqXHR.status=status;jqXHR.statusText=""+(nativeStatusText||statusText);if(isSuccess){deferred.resolveWith(callbackContext,[success,statusText,jqXHR])}else{deferred.rejectWith(callbackContext,[jqXHR,statusText,error])}jqXHR.statusCode(statusCode);statusCode=undefined;if(fireGlobals){globalEventContext.trigger("ajax"+(isSuccess?"Success":"Error"),[jqXHR,s,isSuccess?success:error])}completeDeferred.fireWith(callbackContext,[jqXHR,statusText]);if(fireGlobals){globalEventContext.trigger("ajaxComplete",[jqXHR,s]);if(!--jQuery.active){jQuery.event.trigger("ajaxStop")}}}deferred.promise(jqXHR);jqXHR.success=jqXHR.done;jqXHR.error=jqXHR.fail;jqXHR.complete=completeDeferred.add;jqXHR.statusCode=function(map){if(map){var tmp;if(state<2){for(tmp in map){statusCode[tmp]=[statusCode[tmp],map[tmp]]}}else{tmp=map[jqXHR.status];jqXHR.then(tmp,tmp)}}return this};s.url=((url||s.url)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//");s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().split(rspacesAjax);if(s.crossDomain==null){parts=rurl.exec(s.url.toLowerCase());s.crossDomain=!!(parts&&(parts[1]!=ajaxLocParts[1]||parts[2]!=ajaxLocParts[2]||(parts[3]||(parts[1]==="http:"?80:443))!=(ajaxLocParts[3]||(ajaxLocParts[1]==="http:"?80:443))))}if(s.data&&s.processData&&typeof s.data!=="string"){s.data=jQuery.param(s.data,s.traditional)}inspectPrefiltersOrTransports(prefilters,s,options,jqXHR);if(state===2){return false}fireGlobals=s.global;s.type=s.type.toUpperCase();s.hasContent=!rnoContent.test(s.type);if(fireGlobals&&jQuery.active++===0){jQuery.event.trigger("ajaxStart")}if(!s.hasContent){if(s.data){s.url+=(rquery.test(s.url)?"&":"?")+s.data;delete s.data}ifModifiedKey=s.url;if(s.cache===false){var ts=jQuery.now(),ret=s.url.replace(rts,"$1_="+ts);s.url=ret+(ret===s.url?(rquery.test(s.url)?"&":"?")+"_="+ts:"")}}if(s.data&&s.hasContent&&s.contentType!==false||options.contentType){jqXHR.setRequestHeader("Content-Type",s.contentType)}if(s.ifModified){ifModifiedKey=ifModifiedKey||s.url;if(jQuery.lastModified[ifModifiedKey]){jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[ifModifiedKey])}if(jQuery.etag[ifModifiedKey]){jqXHR.setRequestHeader("If-None-Match",jQuery.etag[ifModifiedKey])}}jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+(s.dataTypes[0]!=="*"?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers){jqXHR.setRequestHeader(i,s.headers[i])}if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===false||state===2)){jqXHR.abort();return false}for(i in{success:1,error:1,complete:1}){jqXHR[i](s[i])}transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR);if(!transport){done(-1,"No Transport")}else{jqXHR.readyState=1;if(fireGlobals){globalEventContext.trigger("ajaxSend",[jqXHR,s])}if(s.async&&s.timeout>0){timeoutTimer=setTimeout(function(){jqXHR.abort("timeout")},s.timeout)}try{state=1;transport.send(requestHeaders,done)}catch(e){if(state<2){done(-1,e)}else{throw e}}}return jqXHR},param:function(a,traditional){var s=[],add=function(key,value){value=jQuery.isFunction(value)?value():value;s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value)};if(traditional===undefined){traditional=jQuery.ajaxSettings.traditional}if(jQuery.isArray(a)||a.jquery&&!jQuery.isPlainObject(a)){jQuery.each(a,function(){add(this.name,this.value)})}else{for(var prefix in a){buildParams(prefix,a[prefix],traditional,add)}}return s.join("&").replace(r20,"+")}});function buildParams(prefix,obj,traditional,add){if(jQuery.isArray(obj)){jQuery.each(obj,function(i,v){if(traditional||rbracket.test(prefix)){add(prefix,v)}else{buildParams(prefix+"["+(typeof v==="object"||jQuery.isArray(v)?i:"")+"]",v,traditional,add)}})}else if(!traditional&&obj!=null&&typeof obj==="object"){for(var name in obj){buildParams(prefix+"["+name+"]",obj[name],traditional,add)}}else{add(prefix,obj)}}jQuery.extend({active:0,lastModified:{},etag:{}});function ajaxHandleResponses(s,jqXHR,responses){var contents=s.contents,dataTypes=s.dataTypes,responseFields=s.responseFields,ct,type,finalDataType,firstDataType;for(type in responseFields){if(type in responses){jqXHR[responseFields[type]]=responses[type]}}while(dataTypes[0]==="*"){dataTypes.shift();if(ct===undefined){ct=s.mimeType||jqXHR.getResponseHeader("content-type")}}if(ct){for(type in contents){if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}}}if(dataTypes[0]in responses){finalDataType=dataTypes[0]}else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}if(!firstDataType){firstDataType=type}}finalDataType=finalDataType||firstDataType}if(finalDataType){if(finalDataType!==dataTypes[0]){dataTypes.unshift(finalDataType)}return responses[finalDataType]}}function ajaxConvert(s,response){if(s.dataFilter){response=s.dataFilter(response,s.dataType)}var dataTypes=s.dataTypes,converters={},i,key,length=dataTypes.length,tmp,current=dataTypes[0],prev,conversion,conv,conv1,conv2;for(i=1;i<length;i++){if(i===1){for(key in s.converters){if(typeof key==="string"){converters[key.toLowerCase()]=s.converters[key]}}}prev=current;current=dataTypes[i];if(current==="*"){current=prev}else if(prev!=="*"&&prev!==current){conversion=prev+" "+current;conv=converters[conversion]||converters["* "+current];if(!conv){conv2=undefined;for(conv1 in converters){tmp=conv1.split(" ");if(tmp[0]===prev||tmp[0]==="*"){conv2=converters[tmp[1]+" "+current];if(conv2){conv1=converters[conv1];if(conv1===true){conv=conv2}else if(conv2===true){conv=conv1}break}}}}if(!(conv||conv2)){jQuery.error("No conversion from "+conversion.replace(" "," to "))}if(conv!==true){response=conv?conv(response):conv2(conv1(response))}}}return response}var jsc=jQuery.now(),jsre=/(\=)\?(&|$)|\?\?/i;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return jQuery.expando+"_"+jsc++}});jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var inspectData=s.contentType==="application/x-www-form-urlencoded"&&typeof s.data==="string";if(s.dataTypes[0]==="jsonp"||s.jsonp!==false&&(jsre.test(s.url)||inspectData&&jsre.test(s.data))){var responseContainer,jsonpCallback=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,previous=window[jsonpCallback],url=s.url,data=s.data,replace="$1"+jsonpCallback+"$2";if(s.jsonp!==false){url=url.replace(jsre,replace);if(s.url===url){if(inspectData){data=data.replace(jsre,replace)}if(s.data===data){url+=(/\?/.test(url)?"&":"?")+s.jsonp+"="+jsonpCallback}}}s.url=url;s.data=data;window[jsonpCallback]=function(response){responseContainer=[response]};jqXHR.always(function(){window[jsonpCallback]=previous;if(responseContainer&&jQuery.isFunction(previous)){window[jsonpCallback](responseContainer[0])}});s.converters["script json"]=function(){if(!responseContainer){jQuery.error(jsonpCallback+" was not called")}return responseContainer[0]};s.dataTypes[0]="json";return"script"}});jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(text){jQuery.globalEval(text);return text}}});jQuery.ajaxPrefilter("script",function(s){if(s.cache===undefined){s.cache=false}if(s.crossDomain){s.type="GET";s.global=false}});jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,head=document.head||document.getElementsByTagName("head")[0]||document.documentElement;return{send:function(_,callback){script=document.createElement("script");script.async="async";if(s.scriptCharset){script.charset=s.scriptCharset}script.src=s.url;script.onload=script.onreadystatechange=function(_,isAbort){if(isAbort||!script.readyState||/loaded|complete/.test(script.readyState)){script.onload=script.onreadystatechange=null;if(head&&script.parentNode){head.removeChild(script)}script=undefined;if(!isAbort){callback(200,"success")}}};head.insertBefore(script,head.firstChild)},abort:function(){if(script){script.onload(0,1)}}}}});var xhrOnUnloadAbort=window.ActiveXObject?function(){for(var key in xhrCallbacks){xhrCallbacks[key](0,1)}}:false,xhrId=0,xhrCallbacks;function createStandardXHR(){try{return new window.XMLHttpRequest}catch(e){}}function createActiveXHR(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}jQuery.ajaxSettings.xhr=window.ActiveXObject?function(){return!this.isLocal&&createStandardXHR()||createActiveXHR()}:createStandardXHR;(function(xhr){jQuery.extend(jQuery.support,{ajax:!!xhr,cors:!!xhr&&"withCredentials"in xhr})})(jQuery.ajaxSettings.xhr());if(jQuery.support.ajax){jQuery.ajaxTransport(function(s){if(!s.crossDomain||jQuery.support.cors){var callback;return{send:function(headers,complete){var xhr=s.xhr(),handle,i;if(s.username){xhr.open(s.type,s.url,s.async,s.username,s.password)}else{xhr.open(s.type,s.url,s.async)}if(s.xhrFields){for(i in s.xhrFields){xhr[i]=s.xhrFields[i]}}if(s.mimeType&&xhr.overrideMimeType){xhr.overrideMimeType(s.mimeType)}if(!s.crossDomain&&!headers["X-Requested-With"]){headers["X-Requested-With"]="XMLHttpRequest"}try{for(i in headers){xhr.setRequestHeader(i,headers[i])}}catch(_){}xhr.send(s.hasContent&&s.data||null);callback=function(_,isAbort){var status,statusText,responseHeaders,responses,xml;try{if(callback&&(isAbort||xhr.readyState===4)){callback=undefined;if(handle){xhr.onreadystatechange=jQuery.noop;if(xhrOnUnloadAbort){delete xhrCallbacks[handle]}}if(isAbort){if(xhr.readyState!==4){xhr.abort()}}else{status=xhr.status;responseHeaders=xhr.getAllResponseHeaders();responses={};xml=xhr.responseXML;if(xml&&xml.documentElement){responses.xml=xml}responses.text=xhr.responseText;try{statusText=xhr.statusText}catch(e){statusText=""}if(!status&&s.isLocal&&!s.crossDomain){status=responses.text?200:404}else if(status===1223){status=204}}}}catch(firefoxAccessException){if(!isAbort){complete(-1,firefoxAccessException)}}if(responses){complete(status,statusText,responses,responseHeaders)}};if(!s.async||xhr.readyState===4){callback()}else{handle=++xhrId;if(xhrOnUnloadAbort){if(!xhrCallbacks){xhrCallbacks={};jQuery(window).unload(xhrOnUnloadAbort)}xhrCallbacks[handle]=callback}xhr.onreadystatechange=callback}},abort:function(){if(callback){callback(0,1)}}}}})}var elemdisplay={},iframe,iframeDoc,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,timerId,fxAttrs=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],fxNow;jQuery.fn.extend({show:function(speed,easing,callback){var elem,display;if(speed||speed===0){return this.animate(genFx("show",3),speed,easing,callback)}else{for(var i=0,j=this.length;i<j;i++){elem=this[i];if(elem.style){display=elem.style.display;if(!jQuery._data(elem,"olddisplay")&&display==="none"){display=elem.style.display=""}if(display===""&&jQuery.css(elem,"display")==="none"){jQuery._data(elem,"olddisplay",defaultDisplay(elem.nodeName))}}}for(i=0;i<j;i++){elem=this[i];if(elem.style){display=elem.style.display;if(display===""||display==="none"){elem.style.display=jQuery._data(elem,"olddisplay")||""}}}return this}},hide:function(speed,easing,callback){if(speed||speed===0){return this.animate(genFx("hide",3),speed,easing,callback)}else{var elem,display,i=0,j=this.length;for(;i<j;i++){elem=this[i];if(elem.style){display=jQuery.css(elem,"display");if(display!=="none"&&!jQuery._data(elem,"olddisplay")){jQuery._data(elem,"olddisplay",display)}}}for(i=0;i<j;i++){if(this[i].style){this[i].style.display="none"}}return this}},_toggle:jQuery.fn.toggle,toggle:function(fn,fn2,callback){var bool=typeof fn==="boolean";if(jQuery.isFunction(fn)&&jQuery.isFunction(fn2)){this._toggle.apply(this,arguments)}else if(fn==null||bool){this.each(function(){var state=bool?fn:jQuery(this).is(":hidden");jQuery(this)[state?"show":"hide"]()})}else{this.animate(genFx("toggle",3),fn,fn2,callback)}return this},fadeTo:function(speed,to,easing,callback){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var optall=jQuery.speed(speed,easing,callback);if(jQuery.isEmptyObject(prop)){return this.each(optall.complete,[false])}prop=jQuery.extend({},prop);function doAnimation(){if(optall.queue===false){jQuery._mark(this)}var opt=jQuery.extend({},optall),isElement=this.nodeType===1,hidden=isElement&&jQuery(this).is(":hidden"),name,val,p,e,parts,start,end,unit,method;opt.animatedProperties={};for(p in prop){name=jQuery.camelCase(p);if(p!==name){prop[name]=prop[p];delete prop[p]}val=prop[name];if(jQuery.isArray(val)){opt.animatedProperties[name]=val[1];val=prop[name]=val[0]}else{opt.animatedProperties[name]=opt.specialEasing&&opt.specialEasing[name]||opt.easing||"swing"}if(val==="hide"&&hidden||val==="show"&&!hidden){return opt.complete.call(this)}if(isElement&&(name==="height"||name==="width")){opt.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY];if(jQuery.css(this,"display")==="inline"&&jQuery.css(this,"float")==="none"){if(!jQuery.support.inlineBlockNeedsLayout||defaultDisplay(this.nodeName)==="inline"){this.style.display="inline-block"}else{this.style.zoom=1}}}}if(opt.overflow!=null){this.style.overflow="hidden"}for(p in prop){e=new jQuery.fx(this,opt,p);val=prop[p];if(rfxtypes.test(val)){method=jQuery._data(this,"toggle"+p)||(val==="toggle"?hidden?"show":"hide":0);if(method){jQuery._data(this,"toggle"+p,method==="show"?"hide":"show");e[method]()}else{e[val]()}}else{parts=rfxnum.exec(val);start=e.cur();if(parts){end=parseFloat(parts[2]);unit=parts[3]||(jQuery.cssNumber[p]?"":"px");if(unit!=="px"){jQuery.style(this,p,(end||1)+unit);start=(end||1)/e.cur()*start;jQuery.style(this,p,start+unit)}if(parts[1]){end=(parts[1]==="-="?-1:1)*end+start}e.custom(start,end,unit)}else{e.custom(start,val,"")}}}return true}return optall.queue===false?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){if(typeof type!=="string"){gotoEnd=clearQueue;clearQueue=type;type=undefined}if(clearQueue&&type!==false){this.queue(type||"fx",[])}return this.each(function(){var index,hadTimers=false,timers=jQuery.timers,data=jQuery._data(this);if(!gotoEnd){jQuery._unmark(true,this)}function stopQueue(elem,data,index){var hooks=data[index];jQuery.removeData(elem,index,true);hooks.stop(gotoEnd)}if(type==null){for(index in data){if(data[index]&&data[index].stop&&index.indexOf(".run")===index.length-4){stopQueue(this,data,index)}}}else if(data[index=type+".run"]&&data[index].stop){stopQueue(this,data,index)}for(index=timers.length;index--;){if(timers[index].elem===this&&(type==null||timers[index].queue===type)){if(gotoEnd){timers[index](true)}else{timers[index].saveState()}hadTimers=true;timers.splice(index,1)}}if(!(gotoEnd&&hadTimers)){jQuery.dequeue(this,type)}})}});function createFxNow(){setTimeout(clearFxNow,0);return fxNow=jQuery.now()}function clearFxNow(){fxNow=undefined}function genFx(type,num){var obj={};jQuery.each(fxAttrs.concat.apply([],fxAttrs.slice(0,num)),function(){obj[this]=type});return obj}jQuery.each({slideDown:genFx("show",1),slideUp:genFx("hide",1),slideToggle:genFx("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}});jQuery.extend({speed:function(speed,easing,fn){var opt=speed&&typeof speed==="object"?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};opt.duration=jQuery.fx.off?0:typeof opt.duration==="number"?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default;if(opt.queue==null||opt.queue===true){opt.queue="fx"}opt.old=opt.complete;opt.complete=function(noUnmark){if(jQuery.isFunction(opt.old)){opt.old.call(this)}if(opt.queue){jQuery.dequeue(this,opt.queue)}else if(noUnmark!==false){jQuery._unmark(this)}};return opt},easing:{linear:function(p,n,firstNum,diff){return firstNum+diff*p},swing:function(p,n,firstNum,diff){return(-Math.cos(p*Math.PI)/2+.5)*diff+firstNum}},timers:[],fx:function(elem,options,prop){this.options=options;this.elem=elem;this.prop=prop;options.orig=options.orig||{}}});jQuery.fx.prototype={update:function(){if(this.options.step){this.options.step.call(this.elem,this.now,this)}(jQuery.fx.step[this.prop]||jQuery.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null)){return this.elem[this.prop]}var parsed,r=jQuery.css(this.elem,this.prop);return isNaN(parsed=parseFloat(r))?!r||r==="auto"?0:r:parsed},custom:function(from,to,unit){var self=this,fx=jQuery.fx;this.startTime=fxNow||createFxNow();this.end=to;this.now=this.start=from;this.pos=this.state=0;this.unit=unit||this.unit||(jQuery.cssNumber[this.prop]?"":"px");function t(gotoEnd){return self.step(gotoEnd)}t.queue=this.options.queue;t.elem=this.elem;t.saveState=function(){if(self.options.hide&&jQuery._data(self.elem,"fxshow"+self.prop)===undefined){jQuery._data(self.elem,"fxshow"+self.prop,self.start)}};if(t()&&jQuery.timers.push(t)&&!timerId){timerId=setInterval(fx.tick,fx.interval)}},show:function(){var dataShow=jQuery._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=dataShow||jQuery.style(this.elem,this.prop);this.options.show=true;if(dataShow!==undefined){this.custom(this.cur(),dataShow)}else{this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur())}jQuery(this.elem).show()},hide:function(){this.options.orig[this.prop]=jQuery._data(this.elem,"fxshow"+this.prop)||jQuery.style(this.elem,this.prop);this.options.hide=true;this.custom(this.cur(),0)},step:function(gotoEnd){var p,n,complete,t=fxNow||createFxNow(),done=true,elem=this.elem,options=this.options;if(gotoEnd||t>=options.duration+this.startTime){this.now=this.end;this.pos=this.state=1;this.update();options.animatedProperties[this.prop]=true;

for(p in options.animatedProperties){if(options.animatedProperties[p]!==true){done=false}}if(done){if(options.overflow!=null&&!jQuery.support.shrinkWrapBlocks){jQuery.each(["","X","Y"],function(index,value){elem.style["overflow"+value]=options.overflow[index]})}if(options.hide){jQuery(elem).hide()}if(options.hide||options.show){for(p in options.animatedProperties){jQuery.style(elem,p,options.orig[p]);jQuery.removeData(elem,"fxshow"+p,true);jQuery.removeData(elem,"toggle"+p,true)}}complete=options.complete;if(complete){options.complete=false;complete.call(elem)}}return false}else{if(options.duration==Infinity){this.now=t}else{n=t-this.startTime;this.state=n/options.duration;this.pos=jQuery.easing[options.animatedProperties[this.prop]](this.state,n,0,1,options.duration);this.now=this.start+(this.end-this.start)*this.pos}this.update()}return true}};jQuery.extend(jQuery.fx,{tick:function(){var timer,timers=jQuery.timers,i=0;for(;i<timers.length;i++){timer=timers[i];if(!timer()&&timers[i]===timer){timers.splice(i--,1)}}if(!timers.length){jQuery.fx.stop()}},interval:13,stop:function(){clearInterval(timerId);timerId=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(fx){jQuery.style(fx.elem,"opacity",fx.now)},_default:function(fx){if(fx.elem.style&&fx.elem.style[fx.prop]!=null){fx.elem.style[fx.prop]=fx.now+fx.unit}else{fx.elem[fx.prop]=fx.now}}}});jQuery.each(["width","height"],function(i,prop){jQuery.fx.step[prop]=function(fx){jQuery.style(fx.elem,prop,Math.max(0,fx.now)+fx.unit)}});if(jQuery.expr&&jQuery.expr.filters){jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length}}function defaultDisplay(nodeName){if(!elemdisplay[nodeName]){var body=document.body,elem=jQuery("<"+nodeName+">").appendTo(body),display=elem.css("display");elem.remove();if(display==="none"||display===""){if(!iframe){iframe=document.createElement("iframe");iframe.frameBorder=iframe.width=iframe.height=0}body.appendChild(iframe);if(!iframeDoc||!iframe.createElement){iframeDoc=(iframe.contentWindow||iframe.contentDocument).document;iframeDoc.write((document.compatMode==="CSS1Compat"?"<!doctype html>":"")+"<html><body>");iframeDoc.close()}elem=iframeDoc.createElement(nodeName);iframeDoc.body.appendChild(elem);display=jQuery.css(elem,"display");body.removeChild(iframe)}elemdisplay[nodeName]=display}return elemdisplay[nodeName]}var rtable=/^t(?:able|d|h)$/i,rroot=/^(?:body|html)$/i;if("getBoundingClientRect"in document.documentElement){jQuery.fn.offset=function(options){var elem=this[0],box;if(options){return this.each(function(i){jQuery.offset.setOffset(this,options,i)})}if(!elem||!elem.ownerDocument){return null}if(elem===elem.ownerDocument.body){return jQuery.offset.bodyOffset(elem)}try{box=elem.getBoundingClientRect()}catch(e){}var doc=elem.ownerDocument,docElem=doc.documentElement;if(!box||!jQuery.contains(docElem,elem)){return box?{top:box.top,left:box.left}:{top:0,left:0}}var body=doc.body,win=getWindow(doc),clientTop=docElem.clientTop||body.clientTop||0,clientLeft=docElem.clientLeft||body.clientLeft||0,scrollTop=win.pageYOffset||jQuery.support.boxModel&&docElem.scrollTop||body.scrollTop,scrollLeft=win.pageXOffset||jQuery.support.boxModel&&docElem.scrollLeft||body.scrollLeft,top=box.top+scrollTop-clientTop,left=box.left+scrollLeft-clientLeft;return{top:top,left:left}}}else{jQuery.fn.offset=function(options){var elem=this[0];if(options){return this.each(function(i){jQuery.offset.setOffset(this,options,i)})}if(!elem||!elem.ownerDocument){return null}if(elem===elem.ownerDocument.body){return jQuery.offset.bodyOffset(elem)}var computedStyle,offsetParent=elem.offsetParent,prevOffsetParent=elem,doc=elem.ownerDocument,docElem=doc.documentElement,body=doc.body,defaultView=doc.defaultView,prevComputedStyle=defaultView?defaultView.getComputedStyle(elem,null):elem.currentStyle,top=elem.offsetTop,left=elem.offsetLeft;while((elem=elem.parentNode)&&elem!==body&&elem!==docElem){if(jQuery.support.fixedPosition&&prevComputedStyle.position==="fixed"){break}computedStyle=defaultView?defaultView.getComputedStyle(elem,null):elem.currentStyle;top-=elem.scrollTop;left-=elem.scrollLeft;if(elem===offsetParent){top+=elem.offsetTop;left+=elem.offsetLeft;if(jQuery.support.doesNotAddBorder&&!(jQuery.support.doesAddBorderForTableAndCells&&rtable.test(elem.nodeName))){top+=parseFloat(computedStyle.borderTopWidth)||0;left+=parseFloat(computedStyle.borderLeftWidth)||0}prevOffsetParent=offsetParent;offsetParent=elem.offsetParent}if(jQuery.support.subtractsBorderForOverflowNotVisible&&computedStyle.overflow!=="visible"){top+=parseFloat(computedStyle.borderTopWidth)||0;left+=parseFloat(computedStyle.borderLeftWidth)||0}prevComputedStyle=computedStyle}if(prevComputedStyle.position==="relative"||prevComputedStyle.position==="static"){top+=body.offsetTop;left+=body.offsetLeft}if(jQuery.support.fixedPosition&&prevComputedStyle.position==="fixed"){top+=Math.max(docElem.scrollTop,body.scrollTop);left+=Math.max(docElem.scrollLeft,body.scrollLeft)}return{top:top,left:left}}}jQuery.offset={bodyOffset:function(body){var top=body.offsetTop,left=body.offsetLeft;if(jQuery.support.doesNotIncludeMarginInBodyOffset){top+=parseFloat(jQuery.css(body,"marginTop"))||0;left+=parseFloat(jQuery.css(body,"marginLeft"))||0}return{top:top,left:left}},setOffset:function(elem,options,i){var position=jQuery.css(elem,"position");if(position==="static"){elem.style.position="relative"}var curElem=jQuery(elem),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,"top"),curCSSLeft=jQuery.css(elem,"left"),calculatePosition=(position==="absolute"||position==="fixed")&&jQuery.inArray("auto",[curCSSTop,curCSSLeft])>-1,props={},curPosition={},curTop,curLeft;if(calculatePosition){curPosition=curElem.position();curTop=curPosition.top;curLeft=curPosition.left}else{curTop=parseFloat(curCSSTop)||0;curLeft=parseFloat(curCSSLeft)||0}if(jQuery.isFunction(options)){options=options.call(elem,i,curOffset)}if(options.top!=null){props.top=options.top-curOffset.top+curTop}if(options.left!=null){props.left=options.left-curOffset.left+curLeft}if("using"in options){options.using.call(elem,props)}else{curElem.css(props)}}};jQuery.fn.extend({position:function(){if(!this[0]){return null}var elem=this[0],offsetParent=this.offsetParent(),offset=this.offset(),parentOffset=rroot.test(offsetParent[0].nodeName)?{top:0,left:0}:offsetParent.offset();offset.top-=parseFloat(jQuery.css(elem,"marginTop"))||0;offset.left-=parseFloat(jQuery.css(elem,"marginLeft"))||0;parentOffset.top+=parseFloat(jQuery.css(offsetParent[0],"borderTopWidth"))||0;parentOffset.left+=parseFloat(jQuery.css(offsetParent[0],"borderLeftWidth"))||0;return{top:offset.top-parentOffset.top,left:offset.left-parentOffset.left}},offsetParent:function(){return this.map(function(){var offsetParent=this.offsetParent||document.body;while(offsetParent&&(!rroot.test(offsetParent.nodeName)&&jQuery.css(offsetParent,"position")==="static")){offsetParent=offsetParent.offsetParent}return offsetParent})}});jQuery.each(["Left","Top"],function(i,name){var method="scroll"+name;jQuery.fn[method]=function(val){var elem,win;if(val===undefined){elem=this[0];if(!elem){return null}win=getWindow(elem);return win?"pageXOffset"in win?win[i?"pageYOffset":"pageXOffset"]:jQuery.support.boxModel&&win.document.documentElement[method]||win.document.body[method]:elem[method]}return this.each(function(){win=getWindow(this);if(win){win.scrollTo(!i?val:jQuery(win).scrollLeft(),i?val:jQuery(win).scrollTop())}else{this[method]=val}})}});function getWindow(elem){return jQuery.isWindow(elem)?elem:elem.nodeType===9?elem.defaultView||elem.parentWindow:false}jQuery.each(["Height","Width"],function(i,name){var type=name.toLowerCase();jQuery.fn["inner"+name]=function(){var elem=this[0];return elem?elem.style?parseFloat(jQuery.css(elem,type,"padding")):this[type]():null};jQuery.fn["outer"+name]=function(margin){var elem=this[0];return elem?elem.style?parseFloat(jQuery.css(elem,type,margin?"margin":"border")):this[type]():null};jQuery.fn[type]=function(size){var elem=this[0];if(!elem){return size==null?null:this}if(jQuery.isFunction(size)){return this.each(function(i){var self=jQuery(this);self[type](size.call(this,i,self[type]()))})}if(jQuery.isWindow(elem)){var docElemProp=elem.document.documentElement["client"+name],body=elem.document.body;return elem.document.compatMode==="CSS1Compat"&&docElemProp||body&&body["client"+name]||docElemProp}else if(elem.nodeType===9){return Math.max(elem.documentElement["client"+name],elem.body["scroll"+name],elem.documentElement["scroll"+name],elem.body["offset"+name],elem.documentElement["offset"+name])}else if(size===undefined){var orig=jQuery.css(elem,type),ret=parseFloat(orig);return jQuery.isNumeric(ret)?ret:orig}else{return this.css(type,typeof size==="string"?size:size+"px")}}});window.jQuery=window.$=jQuery;if(typeof define==="function"&&define.amd&&define.amd.jQuery){define("jquery",[],function(){return jQuery})}})(window);(function(factory){factory(jQuery)})(function($){$.extend($.fn,{validate:function(options){if(!this.length){if(options&&options.debug&&window.console){console.warn("Nothing selected, can't validate, returning nothing.")}return}var validator=$.data(this[0],"validator");if(validator){return validator}this.attr("novalidate","novalidate");validator=new $.validator(options,this[0]);$.data(this[0],"validator",validator);if(validator.settings.onsubmit){this.validateDelegate(":submit","click",function(event){if(validator.settings.submitHandler){validator.submitButton=event.target}if($(event.target).hasClass("cancel")){validator.cancelSubmit=true}if($(event.target).attr("formnovalidate")!==undefined){validator.cancelSubmit=true}});this.submit(function(event){if(validator.settings.debug){event.preventDefault()}function handle(){var hidden,result;if(validator.settings.submitHandler){if(validator.submitButton){hidden=$("<input type='hidden'/>").attr("name",validator.submitButton.name).val($(validator.submitButton).val()).appendTo(validator.currentForm)}result=validator.settings.submitHandler.call(validator,validator.currentForm,event);if(validator.submitButton){hidden.remove()}if(result!==undefined){return result}return false}return true}if(validator.cancelSubmit){validator.cancelSubmit=false;return handle()}if(validator.form()){if(validator.pendingRequest){validator.formSubmitted=true;return false}return handle()}else{validator.focusInvalid();return false}})}return validator},valid:function(){var valid,validator;if($(this[0]).is("form")){valid=this.validate().form()}else{valid=true;validator=$(this[0].form).validate();this.each(function(){valid=validator.element(this)&&valid})}return valid},removeAttrs:function(attributes){var result={},$element=this;$.each(attributes.split(/\s/),function(index,value){result[value]=$element.attr(value);$element.removeAttr(value)});return result},rules:function(command,argument){var element=this[0],settings,staticRules,existingRules,data,param,filtered;if(command){settings=$.data(element.form,"validator").settings;staticRules=settings.rules;existingRules=$.validator.staticRules(element);switch(command){case"add":$.extend(existingRules,$.validator.normalizeRule(argument));delete existingRules.messages;staticRules[element.name]=existingRules;if(argument.messages){settings.messages[element.name]=$.extend(settings.messages[element.name],argument.messages)}break;case"remove":if(!argument){delete staticRules[element.name];return existingRules}filtered={};$.each(argument.split(/\s/),function(index,method){filtered[method]=existingRules[method];delete existingRules[method];if(method==="required"){$(element).removeAttr("aria-required")}});return filtered}}data=$.validator.normalizeRules($.extend({},$.validator.classRules(element),$.validator.attributeRules(element),$.validator.dataRules(element),$.validator.staticRules(element)),element);if(data.required){param=data.required;delete data.required;data=$.extend({required:param},data);$(element).attr("aria-required","true")}if(data.remote){param=data.remote;delete data.remote;data=$.extend(data,{remote:param})}return data}});$.extend($.expr[":"],{blank:function(a){return!$.trim(""+$(a).val())},filled:function(a){return!!$.trim(""+$(a).val())},unchecked:function(a){return!$(a).prop("checked")}});$.validator=function(options,form){this.settings=$.extend(true,{},$.validator.defaults,options);this.currentForm=form;this.init()};$.validator.format=function(source,params){if(arguments.length===1){return function(){var args=$.makeArray(arguments);args.unshift(source);return $.validator.format.apply(this,args)}}if(arguments.length>2&&params.constructor!==Array){params=$.makeArray(arguments).slice(1)}if(params.constructor!==Array){params=[params]}$.each(params,function(i,n){source=source.replace(new RegExp("\\{"+i+"\\}","g"),function(){return n})});return source};$.extend($.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusCleanup:false,focusInvalid:true,errorContainer:$([]),errorLabelContainer:$([]),onsubmit:true,ignore:":hidden",ignoreTitle:false,onfocusin:function(element){this.lastActive=element;if(this.settings.focusCleanup){if(this.settings.unhighlight){this.settings.unhighlight.call(this,element,this.settings.errorClass,this.settings.validClass)}this.hideThese(this.errorsFor(element))}},onfocusout:function(element){if(!this.checkable(element)&&(element.name in this.submitted||!this.optional(element))){this.element(element)}},onkeyup:function(element,event){if(event.which===9&&this.elementValue(element)===""){return}else if(element.name in this.submitted||element===this.lastElement){this.element(element)}},onclick:function(element){if(element.name in this.submitted){this.element(element)}else if(element.parentNode.name in this.submitted){this.element(element.parentNode)}},highlight:function(element,errorClass,validClass){if(element.type==="radio"){this.findByName(element.name).addClass(errorClass).removeClass(validClass)}else{$(element).addClass(errorClass).removeClass(validClass)}},unhighlight:function(element,errorClass,validClass){if(element.type==="radio"){this.findByName(element.name).removeClass(errorClass).addClass(validClass)}else{$(element).removeClass(errorClass).addClass(validClass)}}},setDefaults:function(settings){$.extend($.validator.defaults,settings)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date ( ISO ).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",maxlength:$.validator.format("Please enter no more than {0} characters."),minlength:$.validator.format("Please enter at least {0} characters."),rangelength:$.validator.format("Please enter a value between {0} and {1} characters long."),range:$.validator.format("Please enter a value between {0} and {1}."),max:$.validator.format("Please enter a value less than or equal to {0}."),min:$.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:false,prototype:{init:function(){this.labelContainer=$(this.settings.errorLabelContainer);this.errorContext=this.labelContainer.length&&this.labelContainer||$(this.currentForm);this.containers=$(this.settings.errorContainer).add(this.settings.errorLabelContainer);this.submitted={};this.valueCache={};this.pendingRequest=0;this.pending={};this.invalid={};this.reset();var groups=this.groups={},rules;$.each(this.settings.groups,function(key,value){if(typeof value==="string"){value=value.split(/\s/)}$.each(value,function(index,name){groups[name]=key})});rules=this.settings.rules;$.each(rules,function(key,value){rules[key]=$.validator.normalizeRule(value)});function delegate(event){var validator=$.data(this[0].form,"validator"),eventType="on"+event.type.replace(/^validate/,""),settings=validator.settings;if(settings[eventType]&&!this.is(settings.ignore)){settings[eventType].call(validator,this[0],event)}}$(this.currentForm).validateDelegate(":text, [type='password'], [type='file'], select, textarea, "+"[type='number'], [type='search'] ,[type='tel'], [type='url'], "+"[type='email'], [type='datetime'], [type='date'], [type='month'], "+"[type='week'], [type='time'], [type='datetime-local'], "+"[type='range'], [type='color'], [type='radio'], [type='checkbox']","focusin focusout keyup",delegate).validateDelegate("select, option, [type='radio'], [type='checkbox']","click",delegate);if(this.settings.invalidHandler){$(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler)}$(this.currentForm).find("[required], [data-rule-required], .required").attr("aria-required","true")},form:function(){this.checkForm();$.extend(this.submitted,this.errorMap);this.invalid=$.extend({},this.errorMap);if(!this.valid()){$(this.currentForm).triggerHandler("invalid-form",[this])}this.showErrors();return this.valid()},checkForm:function(){this.prepareForm();for(var i=0,elements=this.currentElements=this.elements();elements[i];i++){this.check(elements[i])}return this.valid()},element:function(element){var cleanElement=this.clean(element),checkElement=this.validationTargetFor(cleanElement),result=true;this.lastElement=checkElement;if(checkElement===undefined){delete this.invalid[cleanElement.name]}else{this.prepareElement(checkElement);this.currentElements=$(checkElement);result=this.check(checkElement)!==false;if(result){delete this.invalid[checkElement.name]}else{this.invalid[checkElement.name]=true}}$(element).attr("aria-invalid",!result);if(!this.numberOfInvalids()){this.toHide=this.toHide.add(this.containers)}this.showErrors();return result},showErrors:function(errors){if(errors){$.extend(this.errorMap,errors);this.errorList=[];for(var name in errors){this.errorList.push({message:errors[name],element:this.findByName(name)[0]})}this.successList=$.grep(this.successList,function(element){return!(element.name in errors)})}if(this.settings.showErrors){this.settings.showErrors.call(this,this.errorMap,this.errorList)}else{this.defaultShowErrors()}},resetForm:function(){if($.fn.resetForm){$(this.currentForm).resetForm()}this.submitted={};this.lastElement=null;this.prepareForm();this.hideErrors();this.elements().removeClass(this.settings.errorClass).removeData("previousValue").removeAttr("aria-invalid")},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(obj){var count=0,i;for(i in obj){count++}return count},hideErrors:function(){this.hideThese(this.toHide)},hideThese:function(errors){errors.not(this.containers).text("");this.addWrapper(errors).hide()},valid:function(){return this.size()===0},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid){try{$(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(e){}}},findLastActive:function(){var lastActive=this.lastActive;return lastActive&&$.grep(this.errorList,function(n){return n.element.name===lastActive.name}).length===1&&lastActive},elements:function(){var validator=this,rulesCache={};return $(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled], [readonly]").not(this.settings.ignore).filter(function(){if(!this.name&&validator.settings.debug&&window.console){console.error("%o has no name assigned",this)}if(this.name in rulesCache||!validator.objectLength($(this).rules())){return false}rulesCache[this.name]=true;return true})},clean:function(selector){return $(selector)[0]},errors:function(){var errorClass=this.settings.errorClass.split(" ").join(".");return $(this.settings.errorElement+"."+errorClass,this.errorContext)},reset:function(){this.successList=[];this.errorList=[];this.errorMap={};this.toShow=$([]);this.toHide=$([]);this.currentElements=$([])},prepareForm:function(){this.reset();this.toHide=this.errors().add(this.containers)},prepareElement:function(element){this.reset();this.toHide=this.errorsFor(element)},elementValue:function(element){var val,$element=$(element),type=element.type;if(type==="radio"||type==="checkbox"){return $("input[name='"+element.name+"']:checked").val()}else if(type==="number"&&typeof element.validity!=="undefined"){return element.validity.badInput?false:$element.val()}val=$element.val();if(typeof val==="string"){return val.replace(/\r/g,"")}return val},check:function(element){element=this.validationTargetFor(this.clean(element));var rules=$(element).rules(),rulesCount=$.map(rules,function(n,i){return i}).length,dependencyMismatch=false,val=this.elementValue(element),result,method,rule;for(method in rules){rule={method:method,parameters:rules[method]};try{result=$.validator.methods[method].call(this,val,element,rule.parameters);if(result==="dependency-mismatch"&&rulesCount===1){dependencyMismatch=true;continue}dependencyMismatch=false;if(result==="pending"){this.toHide=this.toHide.not(this.errorsFor(element));return}if(!result){this.formatAndAdd(element,rule);return false}}catch(e){if(this.settings.debug&&window.console){console.log("Exception occurred when checking element "+element.id+", check the '"+rule.method+"' method.",e)}throw e}}if(dependencyMismatch){return}if(this.objectLength(rules)){this.successList.push(element)}return true},customDataMessage:function(element,method){return $(element).data("msg"+method.charAt(0).toUpperCase()+method.substring(1).toLowerCase())||$(element).data("msg")},customMessage:function(name,method){var m=this.settings.messages[name];return m&&(m.constructor===String?m:m[method])},findDefined:function(){for(var i=0;i<arguments.length;i++){if(arguments[i]!==undefined){return arguments[i]}}return undefined},defaultMessage:function(element,method){return this.findDefined(this.customMessage(element.name,method),this.customDataMessage(element,method),!this.settings.ignoreTitle&&element.title||undefined,$.validator.messages[method],"<strong>Warning: No message defined for "+element.name+"</strong>")},formatAndAdd:function(element,rule){var message=this.defaultMessage(element,rule.method),theregex=/\$?\{(\d+)\}/g;if(typeof message==="function"){message=message.call(this,rule.parameters,element)}else if(theregex.test(message)){message=$.validator.format(message.replace(theregex,"{$1}"),rule.parameters)}this.errorList.push({message:message,element:element,method:rule.method});this.errorMap[element.name]=message;this.submitted[element.name]=message},addWrapper:function(toToggle){if(this.settings.wrapper){toToggle=toToggle.add(toToggle.parent(this.settings.wrapper))}return toToggle},defaultShowErrors:function(){var i,elements,error;for(i=0;this.errorList[i];i++){error=this.errorList[i];if(this.settings.highlight){this.settings.highlight.call(this,error.element,this.settings.errorClass,this.settings.validClass)}this.showLabel(error.element,error.message)}if(this.errorList.length){this.toShow=this.toShow.add(this.containers)}if(this.settings.success){for(i=0;this.successList[i];i++){this.showLabel(this.successList[i])}}if(this.settings.unhighlight){for(i=0,elements=this.validElements();elements[i];i++){this.settings.unhighlight.call(this,elements[i],this.settings.errorClass,this.settings.validClass)}}this.toHide=this.toHide.not(this.toShow);this.hideErrors();this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return $(this.errorList).map(function(){return this.element})},showLabel:function(element,message){var place,group,errorID,error=this.errorsFor(element),elementID=this.idOrName(element),describedBy=$(element).attr("aria-describedby");if(error.length){error.removeClass(this.settings.validClass).addClass(this.settings.errorClass);error.html(message)}else{error=$("<"+this.settings.errorElement+">").attr("id",elementID+"-error").addClass(this.settings.errorClass).html(message||"");place=error;if(this.settings.wrapper){place=error.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()}if(this.labelContainer.length){this.labelContainer.append(place)}else if(this.settings.errorPlacement){this.settings.errorPlacement(place,$(element))}else{place.insertAfter(element)}if(error.is("label")){error.attr("for",elementID)}else if(error.parents("label[for='"+elementID+"']").length===0){errorID=error.attr("id").replace(/(:|\.|\[|\])/g,"\\$1");if(!describedBy){describedBy=errorID}else if(!describedBy.match(new RegExp("\\b"+errorID+"\\b"))){describedBy+=" "+errorID}$(element).attr("aria-describedby",describedBy);group=this.groups[element.name];if(group){$.each(this.groups,function(name,testgroup){if(testgroup===group){$("[name='"+name+"']",this.currentForm).attr("aria-describedby",error.attr("id"))}})}}}if(!message&&this.settings.success){error.text("");if(typeof this.settings.success==="string"){error.addClass(this.settings.success)}else{this.settings.success(error,element)}}this.toShow=this.toShow.add(error)},errorsFor:function(element){var name=this.idOrName(element),describer=$(element).attr("aria-describedby"),selector="label[for='"+name+"'], label[for='"+name+"'] *";if(describer){selector=selector+", #"+describer.replace(/\s+/g,", #")}return this.errors().filter(selector)},idOrName:function(element){return this.groups[element.name]||(this.checkable(element)?element.name:element.id||element.name)},validationTargetFor:function(element){if(this.checkable(element)){element=this.findByName(element.name)}return $(element).not(this.settings.ignore)[0]},checkable:function(element){return/radio|checkbox/i.test(element.type)},findByName:function(name){return $(this.currentForm).find("[name='"+name+"']")},getLength:function(value,element){switch(element.nodeName.toLowerCase()){case"select":return $("option:selected",element).length;case"input":if(this.checkable(element)){return this.findByName(element.name).filter(":checked").length}}return value.length},depend:function(param,element){return this.dependTypes[typeof param]?this.dependTypes[typeof param](param,element):true},dependTypes:{"boolean":function(param){return param},string:function(param,element){return!!$(param,element.form).length},"function":function(param,element){return param(element)}},optional:function(element){var val=this.elementValue(element);return!$.validator.methods.required.call(this,val,element)&&"dependency-mismatch"},startRequest:function(element){if(!this.pending[element.name]){this.pendingRequest++;this.pending[element.name]=true}},stopRequest:function(element,valid){this.pendingRequest--;if(this.pendingRequest<0){this.pendingRequest=0}delete this.pending[element.name];if(valid&&this.pendingRequest===0&&this.formSubmitted&&this.form()){$(this.currentForm).submit();this.formSubmitted=false}else if(!valid&&this.pendingRequest===0&&this.formSubmitted){$(this.currentForm).triggerHandler("invalid-form",[this]);this.formSubmitted=false}},previousValue:function(element){return $.data(element,"previousValue")||$.data(element,"previousValue",{old:null,valid:true,message:this.defaultMessage(element,"remote")})}},classRuleSettings:{required:{required:true},email:{email:true},url:{url:true},date:{date:true},dateISO:{dateISO:true},number:{number:true},digits:{digits:true},creditcard:{creditcard:true}},addClassRules:function(className,rules){if(className.constructor===String){this.classRuleSettings[className]=rules}else{$.extend(this.classRuleSettings,className)}},classRules:function(element){var rules={},classes=$(element).attr("class");if(classes){$.each(classes.split(" "),function(){if(this in $.validator.classRuleSettings){$.extend(rules,$.validator.classRuleSettings[this])}})}return rules},attributeRules:function(element){var rules={},$element=$(element),type=element.getAttribute("type"),method,value;for(method in $.validator.methods){if(method==="required"){value=element.getAttribute(method);if(value===""){value=true}value=!!value}else{value=$element.attr(method)}if(/min|max/.test(method)&&(type===null||/number|range|text/.test(type))){value=Number(value)}if(value||value===0){rules[method]=value}else if(type===method&&type!=="range"){rules[method]=true}}if(rules.maxlength&&/-1|2147483647|524288/.test(rules.maxlength)){delete rules.maxlength}return rules},dataRules:function(element){var method,value,rules={},$element=$(element);for(method in $.validator.methods){value=$element.data("rule"+method.charAt(0).toUpperCase()+method.substring(1).toLowerCase());if(value!==undefined){rules[method]=value}}return rules},staticRules:function(element){var rules={},validator=$.data(element.form,"validator");if(validator.settings.rules){rules=$.validator.normalizeRule(validator.settings.rules[element.name])||{}}return rules},normalizeRules:function(rules,element){$.each(rules,function(prop,val){if(val===false){delete rules[prop];return}if(val.param||val.depends){var keepRule=true;switch(typeof val.depends){case"string":keepRule=!!$(val.depends,element.form).length;break;case"function":keepRule=val.depends.call(element,element);break}if(keepRule){rules[prop]=val.param!==undefined?val.param:true}else{delete rules[prop]}}});$.each(rules,function(rule,parameter){rules[rule]=$.isFunction(parameter)?parameter(element):parameter});$.each(["minlength","maxlength"],function(){if(rules[this]){rules[this]=Number(rules[this])}});$.each(["rangelength","range"],function(){var parts;if(rules[this]){if($.isArray(rules[this])){rules[this]=[Number(rules[this][0]),Number(rules[this][1])]}else if(typeof rules[this]==="string"){parts=rules[this].replace(/[\[\]]/g,"").split(/[\s,]+/);rules[this]=[Number(parts[0]),Number(parts[1])]}}});if($.validator.autoCreateRanges){if(rules.min!=null&&rules.max!=null){rules.range=[rules.min,rules.max];delete rules.min;delete rules.max}if(rules.minlength!=null&&rules.maxlength!=null){rules.rangelength=[rules.minlength,rules.maxlength];delete rules.minlength;delete rules.maxlength}}return rules},normalizeRule:function(data){if(typeof data==="string"){var transformed={};$.each(data.split(/\s/),function(){transformed[this]=true});data=transformed}return data},addMethod:function(name,method,message){$.validator.methods[name]=method;$.validator.messages[name]=message!==undefined?message:$.validator.messages[name];if(method.length<3){$.validator.addClassRules(name,$.validator.normalizeRule(name))}},methods:{required:function(value,element,param){if(!this.depend(param,element)){return"dependency-mismatch"}if(element.nodeName.toLowerCase()==="select"){var val=$(element).val();return val&&val.length>0}if(this.checkable(element)){return this.getLength(value,element)>0}return $.trim(value).length>0},email:function(value,element){return this.optional(element)||/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(value)},url:function(value,element){return this.optional(element)||/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(value);

},date:function(value,element){return this.optional(element)||!/Invalid|NaN/.test(new Date(value).toString())},dateISO:function(value,element){return this.optional(element)||/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/.test(value)},number:function(value,element){return this.optional(element)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(value)},digits:function(value,element){return this.optional(element)||/^\d+$/.test(value)},creditcard:function(value,element){if(this.optional(element)){return"dependency-mismatch"}if(/[^0-9 \-]+/.test(value)){return false}var nCheck=0,nDigit=0,bEven=false,n,cDigit;value=value.replace(/\D/g,"");if(value.length<13||value.length>19){return false}for(n=value.length-1;n>=0;n--){cDigit=value.charAt(n);nDigit=parseInt(cDigit,10);if(bEven){if((nDigit*=2)>9){nDigit-=9}}nCheck+=nDigit;bEven=!bEven}return nCheck%10===0},minlength:function(value,element,param){var length=$.isArray(value)?value.length:this.getLength(value,element);return this.optional(element)||length>=param},maxlength:function(value,element,param){var length=$.isArray(value)?value.length:this.getLength(value,element);return this.optional(element)||length<=param},rangelength:function(value,element,param){var length=$.isArray(value)?value.length:this.getLength(value,element);return this.optional(element)||length>=param[0]&&length<=param[1]},min:function(value,element,param){return this.optional(element)||value>=param},max:function(value,element,param){return this.optional(element)||value<=param},range:function(value,element,param){return this.optional(element)||value>=param[0]&&value<=param[1]},equalTo:function(value,element,param){var target=$(param);if(this.settings.onfocusout){target.unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){$(element).valid()})}return value===target.val()},remote:function(value,element,param){if(this.optional(element)){return"dependency-mismatch"}var previous=this.previousValue(element),validator,data;if(!this.settings.messages[element.name]){this.settings.messages[element.name]={}}previous.originalMessage=this.settings.messages[element.name].remote;this.settings.messages[element.name].remote=previous.message;param=typeof param==="string"&&{url:param}||param;if(previous.old===value){return previous.valid}previous.old=value;validator=this;this.startRequest(element);data={};data[element.name]=value;$.ajax($.extend(true,{url:param,mode:"abort",port:"validate"+element.name,dataType:"json",data:data,context:validator.currentForm,success:function(response){var valid=response===true||response==="true",errors,message,submitted;validator.settings.messages[element.name].remote=previous.originalMessage;if(valid){submitted=validator.formSubmitted;validator.prepareElement(element);validator.formSubmitted=submitted;validator.successList.push(element);delete validator.invalid[element.name];validator.showErrors()}else{errors={};message=response||validator.defaultMessage(element,"remote");errors[element.name]=previous.message=$.isFunction(message)?message(value):message;validator.invalid[element.name]=true;validator.showErrors(errors)}previous.valid=valid;validator.stopRequest(element,valid)}},param));return"pending"}}});$.format=function deprecated(){throw"$.format has been deprecated. Please use $.validator.format instead."};var pendingRequests={},ajax;if($.ajaxPrefilter){$.ajaxPrefilter(function(settings,_,xhr){var port=settings.port;if(settings.mode==="abort"){if(pendingRequests[port]){pendingRequests[port].abort()}pendingRequests[port]=xhr}})}else{ajax=$.ajax;$.ajax=function(settings){var mode=("mode"in settings?settings:$.ajaxSettings).mode,port=("port"in settings?settings:$.ajaxSettings).port;if(mode==="abort"){if(pendingRequests[port]){pendingRequests[port].abort()}pendingRequests[port]=ajax.apply(this,arguments);return pendingRequests[port]}return ajax.apply(this,arguments)}}$.extend($.fn,{validateDelegate:function(delegate,type,handler){return this.bind(type,function(event){var target=$(event.target);if(target.is(delegate)){return handler.apply(target,arguments)}})}})});(function(window,undefined){var Eggshell=function(Eggshell){"use strict";var Module=function(name,dependencies,constructor){this.name=name;this.dependencies=dependencies?dependencies:[];this.constructor=constructor;this.instance=null;this.getName=function(){return this.name};this.getDependencies=function(){return this.dependencies};this.getInstance=function(){return this.instance};this.instantiate=function(dependencies){this.instance=this.constructor.apply({},dependencies);this.instance=this.instance?this.instance:{};return this.instance}};var modules={};var addModule=function(module){modules[module.getName()]=module;refreshModules()};var refreshModules=function(){var anyModuleInstantiated=false;for(var name in modules){var module=modules[name];if(!module.getInstance()){var dependencies=module.getDependencies();var args=[];var dependencyReady=true;for(var x=0;x<dependencies.length;x++){var dependency=modules[dependencies[x]];if(dependency&&dependency.getInstance()){args.push(dependency.getInstance())}else{dependencyReady=false;break}}if(dependencyReady){module.instantiate(args);anyModuleInstantiated=true}}}if(anyModuleInstantiated){refreshModules()}};Eggshell.module=function(name,dependencies,constructor){if(!name||typeof name!="string"){throw"Invalid module name. Name needs to be a non empty String."}if(dependencies&&!(dependencies instanceof Array)){throw"Invalid dependencies. Dependencies can either be null or an array of module names"}if(!constructor||typeof constructor!="function"){throw"Invalid constructor function"}addModule(new Module(name,dependencies,constructor));return Eggshell};Eggshell.namespace=function(namespace,object,overwrite){if(!namespace||typeof namespace!="string"){throw"Invalid namespace. Namespace needs to be a non empty String."}if(typeof object=="undefined"||object===null){throw"Invalid object to be exported"}if(typeof overwrite!="undefined"&&typeof overwrite!="boolean"){throw"Invalid overwrite flag. It needs to be either null or boolean."}var keys=namespace.split(".");namespace=Eggshell;for(var x=0;x<keys.length-1;x++){if(!namespace[keys[x]]){namespace[keys[x]]={}}namespace=namespace[keys[x]]}if(!namespace[keys[keys.length-1]]||overwrite){namespace[keys[keys.length-1]]=object}else{throw"Namespace is already taken"}return Eggshell};return Eggshell}({});Eggshell.module("Logger",[],function(){var console=window.console=window.console||{};var methods=["log","debug","warn","error"];var noop=function(){};for(var x=0;x<methods.length;x++){if(!console[methods[x]]){console[methods[x]]=noop}}var level="warn";this.debug=function(){if(level=="debug"){console.debug(arguments)}};this.log=function(){if(level=="debug"||level=="info"){console.log(arguments)}};this.warn=function(){if(level=="debug"||level=="info"||level=="warn"){console.warn(arguments)}};this.error=function(){console.error(arguments)};this.setLogLevel=function(logLevel){level=logLevel;return Eggshell};Eggshell.namespace("setLogLevel",this.setLogLevel);return this});Eggshell.module("Api",["Logger","Eventbus","Connector","Loader","DefinitionRegistry","EggRegistry","ComponentResourceRegistry","Validator","InterfaceRegistry"],function(Logger,Eventbus,Connector,Loader,DefinitionRegistry,EggRegistry,ComponentResourceRegistry,Validator,InterfaceRegistry){var handleError=false;var strictMode=false;var resolveSelector=function(selector){if(typeof selector=="string"){return selector}else if(typeof selector=="object"&&selector.shell&&selector.shell.getId){return selector.shell.getId()}else if(typeof selector=="object"&&selector.getId){return selector.getId()}else if(typeof selector=="object"&&selector.prototype&&selector.prototype.Eggshell&&selector.prototype.Eggshell.getId){return selector.prototype.Eggshell.getId()}else if(Loader.getShellInProgress()){return Loader.getShellInProgress().getId()}return null};var getEgg=function(id){if(EggRegistry.exist(id)){return EggRegistry.get(id)}return null};var merge=function(obj1,obj2){var obj={},key,x=0;if(obj1!==null){if(obj1.length&&typeof obj1.length==="number"){obj=[];for(x=0;x<obj1.length;x++){obj.push(obj1[x])}}else{for(key in obj1){obj[key]=obj1[key]}}}if(obj2!==null){if(obj2.length&&typeof obj2.length==="number"){for(x=0;x<obj2.length;x++){obj.push(obj2[x])}}else{for(key in obj2){obj[key]=obj2[key]}}}return obj};Eggshell.namespace("enableErrorHandling",function(enable){handleError=!!enable;Eventbus.enableErrorHandling(enable);return Eggshell});Eggshell.namespace("enableStrictMode",function(enable){strictMode=!!enable;return Eggshell});Eggshell.namespace("define",function(clazz,config,constructor){var define=function(clazz,config,constructor){if(arguments.length==2){Logger.debug(clazz+" definition is depreciated. Component definition contains class, config, and implementation.");constructor=config;config=null}if(typeof config=="function"&&typeof constructor=="undefined"){Logger.debug(clazz+" definition is depreciated. Component definition contains class, config, and implementation.");constructor=config;config=null}if(typeof clazz!=="string"||!clazz){throw"Invalid class. It must be a string."}if(typeof constructor!=="function"||!constructor){throw"Invalid constructor. It must be a function."}if(config&&config["interface"]){var iface=config["interface"];config=InterfaceRegistry.get(config["interface"],config);if(!config){throw"Unrecognized interface "+iface}}if(!DefinitionRegistry.exist(clazz)){DefinitionRegistry.register(clazz,{config:config,constructor:constructor});Logger.debug("Component defined.",clazz,config,constructor)}else if(config.force_replace){DefinitionRegistry.register(clazz,{config:config,constructor:constructor},true);Logger.debug("Component defined. Forced replace",clazz,config,constructor)}return Eggshell};if(handleError){try{define(clazz,config,constructor);return Eggshell}catch(e){Logger.error('Encountered exception in "Eggshell.define".',e,clazz,config,constructor)}}else{define(clazz,config,constructor);return Eggshell}});Eggshell.namespace("definition",function(clazz){var getDefinition=function(clazz){return DefinitionRegistry.get(clazz)};if(handleError){try{return getDefinition(clazz)}catch(e){Logger.error('Encountered error in "Eggshell.getDefintion".',e,clazz,attributes);return null}}else{return getDefinition(clazz)}});Eggshell.namespace("create",function(clazz,attributes){var create=function(clazz,attributes){if(typeof clazz!=="string"||!clazz){throw"Invalid constructor id."}var config=null;var singleton=false;var constructor=null;var definition=DefinitionRegistry.get(clazz);if(definition){config=definition&&definition.config?definition.config:{};constructor=definition.constructor;singleton=config&&config.singleton?true:false}else{constructor=eval(clazz)}var id=null;if(singleton){id=Loader.load(clazz,clazz,constructor,attributes);return Eggshell.find(id)}else{id=Loader.load(null,clazz,constructor,attributes);return Eggshell.find(id)}};if(handleError){try{return create(clazz,attributes)}catch(e){Logger.error('Encountered error in "Eggshell.create".',e,clazz,attributes);return new Eggshell.Shell([],[])}}else{return create(clazz,attributes)}});Eggshell.namespace("find",function(selector){var find=function(selector){var id=resolveSelector(selector);if(typeof id!=="string"||!id){throw"Invalid id."}var ids=[];var classes=[];var eggs=EggRegistry.getAll();for(var x=0;x<eggs.length;x++){if(eggs[x].getId()===id||eggs[x].getClass()===id){var egg=eggs[x];ids.push(egg.getId());classes.push(egg.getClass())}}var hash={};var finalIds=[];for(x=0;x<ids.length;x++){if(!hash[ids[x]]){hash[ids[x]]=true;finalIds.push(ids[x])}}hash={};var finalClasses=[];for(x=0;x<classes.length;x++){if(!hash[classes[x]]){hash[classes[x]]=true;finalClasses.push(classes[x])}}var shell=new Eggshell.Shell(finalIds,finalClasses);return shell};if(handleError){try{return find(selector)}catch(e){Logger.error('Encountered error in "Eggshell.find".',e,selector);return new Eggshell.Shell([],[])}}else{return find(selector)}});Eggshell.namespace("trigger",function(selector,action,payload,options){var trigger=function(selector,action,payload){var id=resolveSelector(selector);if(typeof id!=="string"||!id){throw"Invalid id."}if(typeof action!=="string"||!action){throw"Invalid Action."}var egg=getEgg(id);if(egg){var definition=DefinitionRegistry.get(egg.getClass());if(definition&&definition.config&&definition.config.strict&&(definition.config.outputs||definition.config.inputs)){var events=merge(definition.config.inputs,definition.config.outputs);Validator.validate(events,action,payload)}egg.trigger(action,payload)}else{Eventbus.fire(id,action,payload)}};if(handleError){try{trigger(selector,action,payload,options);return Eggshell}catch(e){Logger.error('Encountered error in "Eggshell.trigger".',e,{selector:selector,action:action,payload:payload,options:options})}}else{trigger(selector,action,payload,options);return Eggshell}});Eggshell.namespace("on",function(selector,action,callback,context){var on=function(selector,action,callback,context){var id=resolveSelector(selector);if(typeof id!=="string"||!id){throw"Invalid id."}if(typeof action!=="string"||!action){throw"Invalid Action."}if(typeof callback!=="function"||!callback){throw"Invalid callback function."}if(getEgg(id)){getEgg(id).on(action,callback,context)}else{Eventbus.addListener(id,action,callback,context)}};if(handleError){try{on(selector,action,callback,context);return Eggshell}catch(e){Logger.error('Encountered error in "Eggshell.on".',e,{selector:selector,action:action,callback:callback,context:context})}}else{on(selector,action,callback,context);return Eggshell}});Eggshell.namespace("off",function(selector,action,callback,context){var off=function(selector,action,callback,context){var id=resolveSelector(selector);if(typeof id!=="string"||!id){throw"Invalid id."}if(typeof action!=="string"||!action){throw"Invalid Action."}if(getEgg(id)){getEgg(id).off(action,callback,context)}else{Eventbus.removeListener(id,action,callback,context)}};if(handleError){try{off(selector,action,callback,context);return Eggshell}catch(e){Logger.error('Encountered error in "Eggshell.off".',e,{selector:selector,action:action,callback:callback,context:context})}}else{off(selector,action,callback,context);return Eggshell}});Eggshell.namespace("connect",function(outputId,outputAction,inputId,inputAction){var connect=function(outputSelector,outputAction,inputSelector,inputAction){var outputId=resolveSelector(outputSelector);var inputId=resolveSelector(inputSelector);if(!inputAction){inputAction=outputAction}if(typeof outputId!=="string"||!outputId){throw"Invalid output id."}if(typeof outputAction!=="string"||!outputAction){throw"Invalid output action."}if(typeof inputId!=="string"||!inputId){throw"Invalid input id."}if(typeof inputAction!=="string"||!inputAction){throw"Invalid input action."}Connector.connect(outputId,outputAction,inputId,inputAction)};if(handleError){try{connect(outputId,outputAction,inputId,inputAction);return Eggshell}catch(e){Logger.error('Encountered error in "Eggshell.connect".',e,{outputId:outputId,outputAction:outputAction,inputId:inputId,inputAction:inputAction})}}else{connect(outputId,outputAction,inputId,inputAction);return Eggshell}});Eggshell.namespace("destroy",function(selector){var destroy=function(selector){var id=resolveSelector(selector);if(typeof id!=="string"||!id){throw"Invalid id."}Loader.unload(id);Eventbus.removeListener(id)};if(handleError){try{destroy(selector);return Eggshell}catch(e){Logger.error('Encountered error in "Eggshell.destroy"',e,selector)}}else{destroy(selector);return Eggshell}});Eggshell.namespace("destroyAll",function(){var destroyAll=function(){var eggs=EggRegistry.getAll();var definition=null;for(var x=0;x<eggs.length;x++){definition=DefinitionRegistry.get(eggs[x].getClass());if(definition&&definition.config&&definition.config.immuneToDestroyAll){continue}Eggshell.destroy(eggs[x].getId())}};if(handleError){try{destroyAll();return Eggshell}catch(e){Logger.error('Encountered error in "Eggshell.destroyAll"',e,selector)}}else{destroyAll();return Eggshell}});Eggshell.namespace("immuneToDestroyAll",function(selector){var immuneToDestroyAll=function(selector){var id=resolveSelector(selector);var egg=getEgg(id);if(egg){var definition=DefinitionRegistry.get(egg.getClass());definition.config.immuneToDestroyAll=true}};if(handleError){try{immuneToDestroyAll(selector);return Eggshell}catch(e){Logger.error('Encountered error in "Eggshell.immuneToDestroyAll"',e,selector)}}else{immuneToDestroyAll(selector);return Eggshell}});Eggshell.namespace("getInterface",InterfaceRegistry.get);Eggshell.namespace("defineInterface",InterfaceRegistry.set);Eggshell.namespace("createOnce",function(clazz,attributes){Logger.debug('Depreciated. Use "Eggshell.create" and "singleton" flag instead. Old API will be decommissioned in the next major release.');var create=function(clazz,attributes){if(typeof clazz!=="string"||!clazz){throw"Invalid constructor id."}var config=null;var singleton=false;var constructor=null;var definition=DefinitionRegistry.get(clazz);if(definition){config=definition&&definition.config?definition.config:{};constructor=definition.constructor;singleton=config&&config.singleton?true:false}else{constructor=eval(clazz)}var id=null;id=Loader.load(clazz,clazz,constructor,attributes);return Eggshell.find(id)};if(handleError){try{return create(clazz,attributes)}catch(e){Logger.error('Encountered error in "Eggshell.createOnce".',e,clazz,attributes);return new Eggshell.Shell([],[])}}else{return create(clazz,attributes)}});Eggshell.namespace("getDefinition",function(clazz){Logger.debug('Depreciated. Use "Eggshell.definition". Old API will be decommissioned in the next major release.');return Eggshell.definition(clazz)});Eggshell.namespace("shell",function(selector){Logger.debug('Depreciated. Use "Eggshell.find". Old API will be decommissioned in the next major release.');return Eggshell.find(selector)});Eggshell.namespace("output",function(selector,action,payload,options){Logger.debug('Depreciated. Use "Eggshell.trigger". Old API will be decommissioned in the next major release.');return Eggshell.trigger(selector,action,payload,options)});Eggshell.namespace("listen",function(selector,action,callback,context){Logger.debug('Depreciated. Use "Eggshell.on". Old API will be decommissioned in the next major release.');return Eggshell.on(selector,action,callback,context)});Eggshell.namespace("bind",Eggshell.listen);Eggshell.namespace("input",Eggshell.listen);Eggshell.namespace("stopListening",function(selector,action,callback,context){Logger.debug('Depreciated. Use "Eggshell.off". Old API will be decommissioned in the next major release.');return Eggshell.off(selector,action,callback,context)});Eggshell.namespace("unbind",Eggshell.stopListening);Eggshell.namespace("disconnect",Eggshell.stopListening)});Eggshell.module("Shell",["Logger","Api"],function(logger,api){var Shell=function(id,clazz){var ids=[];if(typeof id=="string"){ids.push(id)}else{for(var x=0;x<id.length;x++){ids.push(id[x])}}this.eggshell=true;this.getId=function(){return ids[0]};this.getClass=function(){return clazz[0]};this.trigger=function(action,payload){for(var x=0;x<ids.length;x++){Eggshell.trigger(ids[x],action,payload)}return this};this.on=function(action,callback,context,options){for(var x=0;x<ids.length;x++){var id=ids[x];Eggshell.on(id,action,callback,context,options)}return this};this.off=function(action,callback,context,options){for(var x=0;x<ids.length;x++){Eggshell.off(ids[x],action,callback,context,options)}return this};this.connect=function(action,inputs){for(var x=0;x<ids.length;x++){for(var y=0;y<inputs.length;y++){Eggshell.connect(ids[x],action,inputs[y].selector,inputs[y].action)}}return this};this.destroy=function(){for(var x=0;x<ids.length;x++){Eggshell.destroy(ids[x])}return null};this.getNs=function(){logger.debug('Depreciated function. Use "Shell.getId()". Old API will be decommissioned in the next major release.');return this.getId()};this.getNamespace=function(){logger.debug('Depreciated function. Use "Shell.getId()". Old API will be decommissioned in the next major release.');return this.getId()};this.getConstructorNamespace=function(){logger.debug('Depreciated function. Use "Shell.getClass". Old API will be decommissioned in the next major release.');return this.getClass()};this.listen=function(action,callback,context,options){logger.debug('Depreciated function. Use "Shell.on". Old API will be decommissioned in the next major release.');return this.on(action,callback,context,options)};this.input=function(action,callback,context,options){logger.debug('Depreciated function. Use "Shell.on". Old API will be decommissioned in the next major release.');return this.on(action,callback,context,options)};this.output=function(action,payload){logger.debug('Depreciated function. Use "Shell.trigger(action, payload, context)". Old API will be decommissioned in the next major release.');return this.trigger(action,payload)};this.stopListening=function(action,callback,context,options){logger.debug('Depreciated function. Use "Shell.off(action, payload, context, options)". Old API will be decommissioned in the next major release.');return this.off(action,callback,context,options)};this.disconnect=function(action,callback,context,options){logger.debug('Depreciated function. Use "Shell.off(action, payload, context, options)". Old API will be decommissioned in the next major release.');return this.off(action,callback,context,options)}};Eggshell.namespace("Shell",Shell);return Shell});Eggshell.module("Connector",["Logger","Eventbus"],function(logger,eventbus){this.connect=function(channel_out,action_out,channel_in,action_in){var listener=function(channel_out,action_out,channel_in,action_in){return{connect:function(event,payload){var nChannel_out=channel_out;var nAction_out=action_out;var nChannel_in=channel_in;var nAction_in=action_in;if(nAction_out==="*"){nAction_out=event.action}if(nAction_in==="*"){nAction_in=nAction_out}logger.debug("Routing event. ",{input:{channel:nChannel_in,action:nAction_in},output:{channel:nChannel_out,action:nAction_out}});eventbus.fire(nChannel_in,nAction_in,payload,event.chain)}}}(channel_out,action_out,channel_in,action_in);eventbus.addListener(channel_out,action_out,listener.connect,listener);logger.debug("Connector created.",listener)};return this});Eggshell.module("Egg",["Logger","Eventbus"],function(logger,eventbus){var Egg=function(id,clazz){var context=null;var initialized=false;var taskQueue=[];var addToProcessQueue=function(callback){taskQueue[taskQueue.length]=callback};var executeProcessQueue=function(){while(taskQueue.length){var callback=taskQueue[0];delete taskQueue[0];taskQueue.splice(0,1);callback.call(this)}taskQueue=[]};this.getId=function(){return id};this.getClass=function(){return clazz};this.ready=function(ctx){context=ctx;initialized=true;executeProcessQueue();delete this.ready;delete this.setContext};this.destroy=function(){context=null;initialized=null;taskQueue=null};this.trigger=function(action,payload){addToProcessQueue(function(id,action,payload){return function(){eventbus.fire(id,action,payload)}}(id,action,payload));if(initialized){executeProcessQueue()}};this.on=function(action,callback,ctx){addToProcessQueue(function(id,action,callback,ctx){return function(){if(!ctx){ctx=context}if(action==="*"){eventbus.addListener(id,"*",callback,ctx)}else{eventbus.addListener(id,action,callback,ctx)}}}(id,action,callback,ctx));if(initialized){executeProcessQueue()}};this.off=function(action,callback,ctx){if(!ctx){ctx=context}addToProcessQueue(function(id,action,ctx){if(!ctx){ctx=context}return function(){eventbus.removeListener(id,action,callback,ctx)}}(id,action,ctx));if(initialized){executeProcessQueue()}return this}};return Egg});Eggshell.module("Event",[],function(){return function(channel,action,chain){this.channel=channel;this.action=action;this.chain=chain;this.namespace=channel}});Eggshell.module("Interceptor",[],function(){return function(event,callback,context){this.Event=event;this.callback=callback;this.context=context}});Eggshell.module("Eventbus",["Logger","Event","Interceptor","Listener"],function(logger,Event,Interceptor,Listener){var handleError=true;var listenerLocker={};var interceptorsLocker={};this.enableErrorHandling=function(enable){handleError=!!enable};this.fire=function(channel,action,payload,chain){payload=typeof payload!="undefined"&&payload!==null?payload:{};chain=typeof chain!="undefined"&&chain!==null?chain:[];chain.push(new Event(channel,action));var event=new Event(channel,action,chain);logger.debug("Event fired.",event.channel,event.action,payload);if(interceptorsLocker[event.channel]&&interceptorsLocker[event.channel][event.action]){var interceptor=interceptorsLocker[event.channel][event.action];if(handleError){try{interceptor.callback.apply(interceptor.context,payload);logger.debug("Interceptor fired.",interceptor)}catch(e){logger.error("Interceptor error.",e,event.channel,event.action,interceptor)}}else{interceptor.callback.apply(interceptor.context,payload);logger.debug("Interceptor fired.",interceptor)}return}if(listenerLocker){var listeners=[];if(listenerLocker["*"]){if(listenerLocker["*"]["*"]){listeners=listeners.concat(listenerLocker["*"]["*"])}if(listenerLocker["*"][event.action]){listeners=listeners.concat(listenerLocker["*"][event.action])}}if(listenerLocker[event.channel]){if(listenerLocker[event.channel]["*"]){listeners=listeners.concat(listenerLocker[event.channel]["*"])}if(listenerLocker[event.channel][event.action]){listeners=listeners.concat(listenerLocker[event.channel][event.action])}}for(var x=0;x<listeners.length;x++){var listener=listeners[x];if(handleError){try{listener.callback.call(listener.context,event,payload);logger.debug("Listener fired.",event.channel,event.action,listener)}catch(e){logger.error("Listener error.",e,event.channel,event.action,listener)}}else{listener.callback.call(listener.context,event,payload);logger.debug("Listener fired.",event.channel,event.action,listener)}}}};this.addInterceptor=function(channel,action,callback,context){var event=new Event(channel,action);var interceptor=new Interceptor(event,callback,context);if(!interceptorsLocker[channel]){interceptorsLocker[channel]={}}interceptorsLocker[channel][action]=interceptor;logger.debug("Interceptor added.",channel,action,interceptor,context)};this.removeInterceptor=function(channel,action){if(!interceptorsLocker[channel]){interceptorsLocker[channel]={}}delete interceptorsLocker[channel][action];logger.debug("Interceptor removed",channel,action)};this.addListener=function(channel,action,callback,context){var event=new Event(channel,action);var listener=new Listener(event,callback,context);if(!listenerLocker[channel]){listenerLocker[channel]={}}if(!listenerLocker[channel][action]){listenerLocker[channel][action]=[]}listenerLocker[channel][action].push(listener);logger.debug("Listener added.",channel,action,listener,context)};this.removeListener=function(channel,action,callback,context){if(listenerLocker[channel]){if(action&&typeof action=="string"){var listeners=listenerLocker[channel][action];if(listeners){for(var x=0;x<listeners.length;x++){var listener=listeners[x];if(callback){if(!context&&listener.callback===callback){delete listener[x];listeners.splice(x,1);logger.debug("Listener removed",channel,action,callback);break}else if(listener.callback===callback&&listener.context===context){delete listener[x];listeners.splice(x,1);logger.debug("Listener removed",channel,action,callback,context);break}}else{delete listener[x];listeners.splice(x,1);logger.debug("Listeners removed",channel,action)}}}}else{delete listenerLocker[channel];listenerLocker[channel]={};logger.debug("Listeners removed",channel)}}};return this});Eggshell.module("Listener",[],function(){return function(event,callback,context){this.Event=event;this.callback=callback;this.context=context}});Eggshell.module("Loader",["Logger","Egg","ComponentRegistry","EggRegistry"],function(logger,Egg,componentRegistry,eggRegistry){var counter=0;var shellInProgress=null;var factory=null;var generateUniqueId=function(){counter++;return"eggshell."+counter};this.getShellInProgress=function(){return shellInProgress};this.load=function(id,clazz,constructor,attributes){if(id){if(componentRegistry.exist(id)){return componentRegistry.get(id)}}else{id=generateUniqueId();if(componentRegistry.exist(id)){throw"Component id is already taken"}}var egg=new Egg(id,clazz);eggRegistry.register(id,egg);var shell=new Eggshell.Shell(id,clazz);shellInProgress=shell;constructor.prototype.Eggshell=shell;constructor.prototype.shell=shell;if(typeof attributes=="object"){attributes.shell=shell}var component=null;if(factory&&factory.instantiate){component=factory.instantiate(id,clazz,constructor,attributes)}else{component=new constructor(attributes)}componentRegistry.register(id,component);component.Eggshell=shell;component.shell=shell;egg.ready(component);egg.trigger("initialize",attributes);logger.debug("Component loaded",id,component);shellInProgress=null;return id};this.unload=function(id){var egg=eggRegistry.get(id);if(!egg){return}egg.trigger("destroy");eggRegistry.unregister(id);var component=componentRegistry.get(id);if(factory&&factory.destroy){factory.destroy(id,component)}componentRegistry.unregister(id)};Eggshell.namespace("loader.setFactory",function(factoryImpl){factory=factoryImpl});return this});Eggshell.module("ComponentRegistry",["Registry"],function(Registry){return new Registry("ComponentRegistry")});Eggshell.module("DefinitionRegistry",["Registry"],function(Registry){return new Registry("DefinitionRegistry")});Eggshell.module("EggRegistry",["Registry"],function(Registry){return new Registry("EggRegistry ")});Eggshell.module("InterfaceRegistry",[],function(){var registry={};function deepMerge(target,obj){for(var key in obj){if(!obj.hasOwnProperty(key))continue;if(!target[key]){target[key]=obj[key]}else if(obj[key]instanceof Array&&target[key]instanceof Array){target[key]=target[key].concat(obj[key])}else if(typeof obj[key]=="object"){deepMerge(target[key],obj[key])}else{target[key]=obj[key]}}return target}var defineInterface=function(name,config){registry[name]=config;return Eggshell};var getInterface=function(name,config){var conf=registry[name];if(!conf){return null}if(!config){return conf}return deepMerge(config,conf)};return{set:defineInterface,get:getInterface}});Eggshell.module("Registry",["Logger"],function(logger){var Registry=function(name){var objectLocker={};this.exist=function(key){if(objectLocker[key]){return true}return false};this.getAll=function(){var objects=[];for(var key in objectLocker){objects.push(objectLocker[key])}return objects};this.get=function(key){if(this.exist(key)){return objectLocker[key]}return null};this.register=function(key,object,force){if(!force&&this.exist(key)){throw'Key "'+key+'" already taken'}objectLocker[key]=object;logger.debug("Object registered in registry "+name,key,object)};this.unregister=function(key){delete objectLocker[key];logger.debug("Object unregistered in registry "+name,key)}};return Registry});Eggshell.module("ComponentResourceRegistry",["Registry"],function(Registry){return new Registry("EggRegistry ")});Eggshell.module("Validator",["Logger"],function(logger){this.validate=function(events,action,payload){if(this.detectMethod(payload)){throw"Payload cannot contain functions"}if(events===null){return}else if(typeof events=="object"){var acceptedAction;if(typeof events.length=="number"){for(var x=0;x<events.length;x++){acceptedAction=events[x];if(acceptedAction===action){return}}throw"Action not found in component configuration."}else{for(acceptedAction in events){if(acceptedAction===action){var actionConfig=events[acceptedAction];if(actionConfig===null||typeof actionConfig.payload=="undefined"||actionConfig.payload===null){return}else if(actionConfig.payload!==null){if(this.validateStructure(actionConfig.payload,payload)){
return}else{throw"Payload does not confirm to data structure."}}else{return}}}throw"Action not found in component configuration."}}else{throw"Invalid input / output configuration"}};this.validateStructure=function(structure,payload){if(typeof structure==="string"){if(typeof payload===structure){return true}else{return false}}else if(typeof structure==="object"){for(var key in structure){var subStructure=structure[key];if(!this.validateStructure(subStructure,payload[key])){return false}}return true}else{throw"Structure type is not supported. It can either be a native type as a string value or an object of native types."}};this.detectMethod=function(payload){if(typeof payload==="function"){return true}else if(typeof payload==="object"){for(var key in payload){if(this.detectMethod(payload[key])===true){return true}}return false}else{return false}};return this});window.Eggshell=Eggshell})(window);Eggshell.module("Marker",["Api","DefinitionRegistry","ComponentRegistry"],function(api,definitionRegistry,componentRegistry){Eggshell.on("*","initialize",function(event){var id=event.channel;shell=Eggshell.find(id);var clazz=shell.getClass();var definition=definitionRegistry.get(clazz);if(!definition||!definition.config||!definition.config.markers){return}if(definition.config.strict===true&&definition.config.outputs){if($.isArray(definition.config.outputs)){definition.config.outputs=$.merge(definition.config.outputs,["place markers"])}else{definition.config.outputs["place markers"]=null}}var component=componentRegistry.get(id);shell.on("place markers",function(){var id=this.id;var clazz=this.clazz;var component=this.component;var markers=this.markers;for(var css in markers){var automationId=markers[css].automation;$el=component.$(css);if($el.length<=0){throw'Marker "'+css+'" not found in component "'+id+'".'}else{escapeCss=function(name){name=name.replace(/[!\"#$%&'\(\)\*\+,\.\/:;<=>\?\@\[\\\]\^`\{\|\}~]/g,"-").replace(/\s/g,"-");return name};$el.addClass("chg-test-"+escapeCss(clazz)+"-"+escapeCss(automationId))}}},{component:component,markers:definition.config.markers,id:id,clazz:clazz})},this)});(function(window,undefined){var document=window.document,location=window.location;var C=function(){var C=function(name,value){name=name.split(".");var ns=window.C,parentNs,parentNm;for(var i=0;i<name.length;i++){var nm=name[i];parentNs=ns;parentNm=nm;ns=ns[nm]||(ns[nm]={})}if(value!==undefined){parentNs[parentNm]=value}return ns};return C}();C.utility=function(){return self};C.utility.exists=function(root,name){name=name.split(".");var ns=root;for(var i=0;i<name.length;i++){var nm=name[i];if(ns[nm]===undefined){return false}ns=ns[nm]}return true};C.utility.access=function(name,root){var ns=root||window,nm;name=name.split(".");for(var i=0;i<name.length;i++){nm=name[i];if(ns[nm]===undefined){return undefined}ns=ns[nm]}return ns};C.utility.getMaxIndex=function(){var children=$("body").children();var zIndex=[1e3];for(var i=0;i<children.length;i++){zIndex.push(+$(children[i]).css("z-index")||0)}var highestZ=C.utility.max(zIndex);return highestZ};C.utility.updateCsrfToken=function(callback,urlPrefix,setFBId){var urlPrefix=typeof urlPrefix!=="undefined"?urlPrefix:"/";var setFBId=typeof setFBId!=="undefined"?setFBId:false;$.ajax({url:urlPrefix+"_ajax/global/init",type:"post",dataType:"json",xhrFields:{withCredentials:true},success:function(callback){return function(data){if(data.token!==C.global.csrfToken){C.global.csrfToken=data.token}if(data.facebookId&&setFBId){C("global.facebookAppId",data.facebookId)}if(callback){callback()}}}(callback)})};C.utility.loadScript=function(url,callback,remove_on_page_unload){var script=document.createElement("script");script.setAttribute("type","text/javascript");script.setAttribute("charset","utf-8");if(script.readyState){script.onreadystatechange=function(){if(script.readyState=="loaded"||script.readyState=="complete"){script.onreadystatechange=null;callback()}}}else{script.onload=function(){callback()}}script.src=url;document.getElementsByTagName("head")[0].appendChild(script);if(remove_on_page_unload){C.dom.$window.one("pageunload",function(){script.parentNode.removeChild(script)})}return script};C.utility.max=function(array){return Math.max.apply(Math,array)};C.utility.min=function(array){return Math.min.apply(Math,array)};C.utility.addCommasToInt=function(num){var numStr=num.toString();if(numStr.match(/\D/)){return null}numStr=numStr.replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,");return numStr};C.utility.processPlaceholders=function(){var $inputs=$("[placeholder]");$inputs.each(function(){var $input=$(this);var text=$input.attr("placeholder");$input.placeholder(text)})};C.utility.json2UriParams=function(o){var result=[];for(var key in o){if(o[key]){result.push(key+"="+encodeURIComponent(o[key]))}}return result.join("&")};C.utility.getParams=function(){return C.utility.getParamsByUrl(window.location.href)};C.utility.getParamsByUrl=function(url){var params={};var index=url.indexOf("?");if(index==-1){return params}var hashIndex=url.indexOf("#");if(hashIndex>0){url=url.slice(0,hashIndex)}url=url.substr(index+1,url.length);url=url.split("&");var component;for(var i=0;i<url.length;i++){component=url[i].split("=");component[0]=decodeURIComponent(component[0]);component[1]=component[1]==undefined?1:decodeURIComponent(component[1]);if(params[component[0]]){if(Object.prototype.toString.call(params[component[0]])!="[object Array]"){params[component[0]]=[params[component[0]]]}params[component[0]].push(component[1])}else{params[component[0]]=component[1]}}return params};C.dump=function(){if(top.location.href.indexOf("www.chegg.com")>-1){return}for(var i=0,max=arguments.length;i<max;i++){C.log("Variable type: "+Object.prototype.toString.call(arguments[i]));C.log("Variable value: ",arguments[i])}C.log(C.log.divider(10)+" Stacktrace "+C.log.divider(10));console.trace()};C.log=function(){if(C.utility.getCookie("logging")==null){return}if(Function.prototype.bind&&console&&console.log){Function.prototype.bind.call(console.log,console).apply(console,arguments)}};C.log.divider=function(n){var result="";for(var i=0;i<n;i++){result+="="}return result};C.utility.clone=function(obj,skip){if(obj==null||typeof obj!="object")return obj;var temp=new obj.constructor;for(var key in obj){if(skip&&key.indexOf(skip)!=-1)continue;temp[key]=this.clone(obj[key])}return temp};C.utility.bookCover=function(book,size,opts){opts=$.extend({cart:false},opts);book=$.extend({},book);var coverImg="",overlayImg="",rwywCover="",readNowStrip="",coverHTML="",showRwywCover="",sizeClass="";switch(size){case 1:case 2:coverImg=book.imgThumb;overlayImg="book-overlay-60.png";sizeClass="tiny";break;case 3:coverImg=book.imgSmall;overlayImg="book-overlay-100.png";sizeClass="small";break;case 4:coverImg=book.imgMedium;overlayImg="book-overlay-140.png";sizeClass="medium";break;case 5:coverImg=book.imgLarge;overlayImg="book-overlay-180.png";sizeClass="large";break}if(coverImg&&coverImg.indexOf("http")!==0&&coverImg.indexOf(C.global.coversBaseUrl)===-1){coverImg=C.global.coversBaseUrl+coverImg.replace(/^\//,"")}if(opts.hasOwnProperty("type")&&opts.type==C.utility.bookCover.tbsType){coverHTML='<div class="tbs-book-cover '+sizeClass+'"> ';var contentHTML;switch(true){case coverImg!=null:contentHTML='<img class="tbs-book-cover-img" src="'+coverImg+'" onerror="this.src=\''+C.global.errorImage+"'\" />";break;default:contentHTML='<span class="tbs-title">Solutions</span>'}coverHTML+=contentHTML;coverHTML+="</div>"}else{if(!!opts.isReadNow){readNowStrip='<div class="read-now-strip"><span class="read-now-icon"></span> Read Now</div>'}else if(!!opts.isRwyw){rwywCover=!!opts.stripVersion?'<div class="img-courtesy-etextbook-overlay"></div>':'<div class="instant-access">Includes free <span>Instant Access</span></div>'}else if(!!opts.showRwywOverlay){showRwywCover='<div id="rwyw-book-overlay-100" class="icn icon-chegg-etb-courtesy"/>'}var bookId="";if(opts.cart){bookId="id=book-in-review"}coverHTML="<div "+bookId+' class="book-img-'+size;if(opts&&opts.noBoxShadow){coverHTML+=" noBoxShadow"}coverHTML+='">'+'<img class="book-cover" src="'+coverImg+'" onerror="this.src=\''+C.global.errorImage+"'\" />";if(opts&&!opts.noOverlay){var overlayId="";if(opts.cart){overlayId="id=overlay-in-review"}overlayImg=C.global.staticBaseUrl+"s/_global/images/"+overlayImg;coverHTML+="<img "+overlayId+' class="book-overlay" src="'+overlayImg+'" />'}coverHTML+=showRwywCover+rwywCover+readNowStrip+"</div>"}return coverHTML};C.utility.bookCover.dropdown=1;C.utility.bookCover.thumb=2;C.utility.bookCover.small=3;C.utility.bookCover.medium=4;C.utility.bookCover.large=5;C.utility.bookCover.bookType="book";C.utility.bookCover.tbsType="tbs";C.utility.openGlobalNav=function(animate){Eggshell.find("C.global.nav").trigger("expand navigation bar")};C.utility.closeGlobalNav=function(animate){Eggshell.find("C.global.nav").trigger("collapse navigation bar")};C.utility.reflowSubNav=function(){$(".chg-nav").css({width:C.dom.$content.width()})};C.utility.showTower=function(){$(".chg-container").addClass("has-tower");C.utility.reflowSubNav()};C.utility.hideTower=function(){$(".chg-container").removeClass("has-tower");C.utility.reflowSubNav()};(function(){var result={},exception=["$","_","Backbone","C","Class","console","History","jQuery","swfobject","matchMedia","CRITEO","_FirebugCommandLine","FxFrames","Fx","MathJax","SelectParser","AbstractChosen","get_side_border_padding","SkypeClick2Call","tinyMCE","tinymce","cheggmathjax","WebFont","WebFontConfig","insertSteps","allocatedAxes","ctx","startAngle","FB","fbAsyncInit","fb_xdm_frame_http","fb_xdm_frame_https","BrightTag","btServe","bt_parameter","bt_meta","bt_data","bt_data_escaped","bt_log","bt_handle_exception","_bt_url_prefix","_bt_referrer","_bt_site","_bt_mode"];for(var x in window){result[x]=1}for(var j=0;j<exception.length;j++){result[exception[j]]=1}C.utility.checkPollution=function(){for(var x in window){if(!result[x]&&x.indexOf("jQuery")!==0){C.log("pollution of window."+x)}}}})();C.utility.navigate=function(url,replace){C.global.adTargeting={};if(typeof C.dom!=="undefined"&&typeof C.dom.$window!=="undefined"){var unloadText=C.dom.$window.triggerHandler("beforeunload")}if(unloadText!==undefined){var response=confirm(""+unloadText+"\n\nAre you sure you want to leave this page?");if(!response){return}else{if(typeof C.dom!=="undefined"&&typeof C.dom.$window!=="undefined"){C.dom.$window.unobserve("beforeunload",this)}}}if(C.global.navigationOptimization&&!C.utility.isAjaxLoadable(url)){replace?location.replace(url):location.href=url;return false}if(History.enabled&&C.global.ajaxPageLoading){try{if(url!=location.href){if(replace){History.replaceState(null,null,url)}else{History.pushState(null,null,url)}}else{C.utility._handleRequest(url)}}catch(err){replace?location.replace(url):location.href=url}}else{replace?location.replace(url):location.href=url}};C.utility.isAjaxLoadable=function(url){var isAjaxLoadable=true;var urlParts=C.utility.parseUrl(url);var host=urlParts.host;var path=urlParts.path;if(host){var hostParts=host.split(".");var subDomainName=hostParts[0];if(host.indexOf("chegg.com")>-1&&subDomainName!=="www"){isAjaxLoadable=false}}if(path&&(path.indexOf("/tutors")>-1||path.indexOf("/jobs")>-1)){isAjaxLoadable=false}return isAjaxLoadable};C.utility.parseUrl=function(url){var key=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"];var parser=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\?([^#]*))?(?:#(.*))?)/;var m=parser.exec(url),uri={},i=14,isAjax=false;while(i--){if(m[i]){uri[key[i]]=m[i]}}if(uri.path){var split=uri.path.split("/");uri.splits=split;if(split[1]==="_ajax"){isAjax=true}}uri.isAjax=isAjax;return uri};C.utility.refresh=function(){C.utility.navigate(location.href)};C.utility.replace=function(url){C.utility.navigate(url,true)};C.utility.escapeRegEx=function(expr){return expr.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")};C.utility.escapeHtml=function(html){return $("<div/>").text(html).html()};C.utility.serializeFormToJson=function(formSelector){var $form=formSelector.jQuery?formSelector:$(formSelector),formArray=$form.serializeArray(),obj={};$.each(formArray,function(i,o){var n=o.name,v=o.value;obj[n]=obj[n]===undefined?v:$.isArray(obj[n])?obj[n].concat(v):[obj[n],v]});return obj};C.utility.appendCSRFToken=function($formEl){if($formEl.length&&$formEl.find('input[name="token"]').length===0){var tokenInput=$('<input name="token" type="hidden" />').val(C.global.csrfToken);$formEl.append(tokenInput)}return $formEl};C.utility.attrSupportedByEl=function(elm,attr){var test=C.utility.attrSupportedByEl.cache[elm]||document.createElement(elm);if(!C.utility.attrSupportedByEl.cache[elm]){C.utility.attrSupportedByEl.cache[elm]=test}return attr in test};C.utility.attrSupportedByEl.cache={};C.utility.rgba2rgb=function(rgba){var res=rgba.match(/rgba\((.+)\)/);if(!res){return rgba}res=res[1].split(",");res.pop();return"rgb("+res.join(",")+")"};C.utility.unique=function(array){var ret=[];o:for(var i=0,n=array.length;i<n;i++){for(var x=i+1;x<n;x++){if(array[x]===array[i])continue o}ret.push(array[i])}return ret};C.utility.setCookie=function(c_name,value,exdays){var exdate=new Date;exdate.setDate(exdate.getDate()+exdays);var c_value=escape(value)+(exdays==null?"":";expires="+exdate.toUTCString())+";path=/";document.cookie=c_name+"="+c_value+";domain="+(C.global.cookieDomain||COOKIE_DOMAIN)};C.utility.getCookie=function(c_name){var i,x,y,ARRcookies=document.cookie.split(";");for(i=0;i<ARRcookies.length;i++){x=ARRcookies[i].substr(0,ARRcookies[i].indexOf("="));y=ARRcookies[i].substr(ARRcookies[i].indexOf("=")+1);x=x.replace(/^\s+|\s+$/g,"");if(x==c_name){return unescape(y)}}};C.utility.setLocal=function(key,value,ttl){if(!ttl){ttl=864e5}return $.jStorage.set(key,value,{TTL:ttl})};C.utility.getLocal=function(key,defaultValue){return $.jStorage.get(key,defaultValue)};C.utility.deleteLocal=function(key){return $.jStorage.deleteKey(key)};C.utility.listLocal=function(){return $.jStorage.index()};C.utility.getActiveExperiments=function(){var exp=C.utility.getCookie("exp");return exp&&exp.length?exp.toUpperCase().split("|"):[]};C.utility.dataLogger=function(){var uvn=C.utility.getCookie("V");var exp=C.utility.getCookie("exp");exp.toUpperCase();var tracking={uvn:uvn,pageTrackId:C.logger.pageTrackId,experiments:exp,userUuid:C.global.userUuid};return $.extend({},tracking)};C.utility.updateCart=function(cb){$.ajax({url:"/_ajax/cart/count",complete:function(jqXHR){var response={};try{response=$.parseJSON(jqXHR.responseText)}catch(e){response={items:0}}if(response.items==0||response.items==null){$(".chg-cart-area").css({display:"none"});$(".hide-with-cart").css({display:"none"})}else{$(".chg-cart-count").text(response.items);if(response.items==null){$(".chg-cart-count").text(0)}$(".chg-cart-area").css({display:"inline-block"});$(".hide-with-cart").css({display:"inline-block"})}if(typeof cb==="function"){cb(response)}}})};C.utility.zeroPad=function(num,base){base=base||10;var len=String(base).length-String(num).length+1;return len>0?new Array(len).join("0")+num:num};C.utility.getMessage=function(className,html,header,close){header=header?'<div class="msg-header">'+header+"</div>":"";close=close?'<span class="msg-close"></span>':"";return'<div class="'+className+'">'+'<div class="msg-icon">'+header+'<div class="msg-text">'+html+close+"</div>"+"</div>"+"</div>"};C.utility.showCsrfMessage=function(){if(!C.utility.csrfMessageDialog){C.utility.csrfMessageDialog=Eggshell.create("C.Eggshell.dialog",{el:$("body")});Eggshell.immuneToDestroyAll(C.utility.csrfMessageDialog)}var dialogNS=C.utility.csrfMessageDialog;Eggshell.trigger(dialogNS,"set headline","Action could not be completed");Eggshell.trigger(dialogNS,"hide sub headline");Eggshell.trigger(dialogNS,"hide icon");Eggshell.trigger(dialogNS,"set content html","Your session has expired due to inactivity. Please refresh the page.");Eggshell.trigger(dialogNS,"show")};C.utility.isISBN10=function(isbn){isbn=isbn.replace(/[^\dxX]/g,"");if(isbn.length!=10){return false}var chars=isbn.split("");if(chars[9].toUpperCase()=="X"){chars[9]=10}var sum=0;for(var i=0;i<chars.length;i++){sum+=(10-i)*parseInt(chars[i])}return sum%11==0};C.utility.isISBN13=function(isbn){isbn=isbn.replace(/[^\d]/g,"");if(isbn.length!=13){return false}var chars=isbn.split("");var check=0;for(var i=0;i<13;i+=2){check+=parseInt(chars[i])}for(var j=1;j<12;j+=2){check+=3*parseInt(chars[j])}return 0==check%10};C.utility.ordinal=function(cdnl){var test_c=Math.abs(cdnl)%10;var ext=Math.abs(cdnl)%100<21&&Math.abs(cdnl)%100>4?"th":test_c<4?test_c<3?test_c<2?test_c<1?"th":"st":"nd":"rd":"th";return cdnl+ext};C.utility.highlightText=function(text,textToBeHighlighted){var replacement='<span class="chg-suggest-term"> $1</span>';var regExpQuote=(textToBeHighlighted+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1");var regex=new RegExp("("+regExpQuote+")","gi");return text.replace(regex,replacement)};C.utility.loadCss=function(src){var l=document.createElement("link");l.setAttribute("rel","stylesheet");l.setAttribute("type","text/css");l.setAttribute("href",src);document.getElementsByTagName("head")[0].appendChild(l)};C.utility.isAdBlock=function isAdBlock(callback,src){var src="undefined"!==typeof src?src:"/s/_global/adframe.js";C.utility.loadScript(src,onload,true).onerror=onerror;function onload(e){setAdBlocker(false)}function onerror(e){setAdBlocker(true)}function setAdBlocker(bool){C.global.isAdBlock=bool;if(callback){callback(bool)}}};C.utility.cleanInput=function(query){return query.replace(/<(?:.|\n)*?>/gm,"")};C.utility.isMobile=function isMobile(){if(isMobile.val===undefined){isMobile.val=$("body").hasClass("mobile")}return isMobile.val};C.utility.isIOS=function isIOS(){if(isIOS.val===undefined){var userAgent=navigator.userAgent.toLowerCase();isIOS.val=userAgent.match(/iPad/i)||userAgent.match(/iPhone/i)||userAgent.match(/iPod/i)}return isIOS.val};C.utility.isAndroid=function isAndroid(){if(isAndroid.val===undefined){var userAgent=navigator.userAgent.toLowerCase();isAndroid.val=userAgent.indexOf("android")>-1}return isAndroid.val};C.utility.isIE=function isIE(){if(isIE.val===undefined){isIE.val=document.documentMode||/Edge/.test(navigator.userAgent)}return isIE.val};C.utility.isEdge=function isEdge(){if(isEdge.val===undefined){isEdge.val=navigator.userAgent.indexOf("Edge")!==-1}return isEdge.val};C.utility.lazyLoadImages=function lazyLoadImages(){$("document").ready($.proxy(function(){$.each($("[data-img-src]"),function(index,item){var item=$(item);var src=item.attr("data-img-src");item.attr("src",src);item.removeAttr("data-img-src")})},this))};C.utility.setSessionVariable=function(key,value,callback){$.ajax({url:"/_ajax/common/session/set",type:"get",dataType:"json",data:{key:key,value:value,token:C.global.csrfToken},success:callback,error:function(e){console.log("Error setting session variable. "+JSON.stringify(e))}})};C.utility.getSessionVariable=function(key,callback){$.ajax({url:"/_ajax/common/session/get",type:"get",dataType:"json",data:{key:key,token:C.global.csrfToken},success:callback,error:function(e){C.log("Error retrieving session variable. "+JSON.stringify(e))}})};C.utility.setAdobeExperimentVariable=function(key,value){if(undefined===C.global.adobeExperiments){C.global.adobeExperiments={}}C.global.adobeExperiments[key]=value};C.utility.getAdobeExperimentVariable=function(key){if(undefined===C.global.adobeExperiments||undefined===C.global.adobeExperiments[key]){return null}return C.global.adobeExperiments[key]};window.C=C})(window);C.utility.bookCover=function(book,size,opts){opts=$.extend({cart:false,readNowCornerVersion:false,isOverdue:false,overdueCornerVersion:false},opts);book=$.extend({},book);var coverImg="",overlay="",coverHTML="",cornerSize="",sizeClass="";switch(size){case 1:case 2:coverImg=book.imgThumb;cornerSize="small";sizeClass="tiny";break;case 3:coverImg=book.imgSmall;cornerSize="small";sizeClass="small";break;case 4:coverImg=book.imgMedium;cornerSize="small";sizeClass="medium";break;case 5:coverImg=book.imgLarge;cornerSize="large";sizeClass="large";break}if(coverImg&&coverImg.indexOf("http")!==0&&coverImg.indexOf(C.global.coversBaseUrl)===-1){coverImg=C.global.coversBaseUrl+coverImg.replace(/^\//,"")}if(opts.hasOwnProperty("type")&&opts.type==C.utility.bookCover.tbsType){coverHTML='<div class="tbs-book-cover '+sizeClass+'"> ';var contentHTML;switch(true){case coverImg!=null:contentHTML='<img class="tbs-book-cover-img" src="'+coverImg+'" onerror="this.src=\''+C.global.errorImage+"'\" />";break;default:contentHTML='<span class="tbs-title">Solutions</span>'}coverHTML+=contentHTML;coverHTML+='<div class="tbs-bottom-line">by </div></div>'}else{var bookId="";if(opts.cart){bookId="id=book-in-review"}if(!C.utility.isMobile()){var showRwywCover="";if("undefined"!==typeof opts&&null!==opts){if("undefined"!==typeof opts.isReadNow&&opts.isReadNow){overlay='<div class="read-now-strip"></div>';if("undefined"!==typeof opts.readNowCornerVersion&&opts.readNowCornerVersion){overlay='<div class="read-now-corner '+cornerSize+'"></div>'}}else if("undefined"!==typeof opts.isOverdue&&opts.isOverdue){overlay='<div class="overdue-strip"></div>';if("undefined"!==typeof opts.overdueCornerVersion&&opts.overdueCornerVersion){overlay='<div class="overdue-corner '+cornerSize+'"></div>'}}else if("undefined"!==typeof opts.isRwyw&&opts.isRwyw){if("undefined"!==typeof opts.stripVersion&&opts.stripVersion){overlay='<div class="img-courtesy-etextbook-overlay"></div>'}else{overlay='<div class="instant-access">Includes free <span>Instant Access</span></div>'}}else if("undefined"!==typeof opts.showRwywOverlay&&opts.showRwywOverlay){showRwywCover='<div id="rwyw-book-overlay-100" class="icn icon-chegg-etb-courtesy"/>'}}coverHTML="<div "+bookId+' class="book-img-'+size;if(opts&&opts.noBoxShadow){coverHTML+=" noBoxShadow"}coverHTML+='">'+'<img class="book-cover" src="'+coverImg+'" onerror="this.src=\''+C.global.errorImage+"'\" />";coverHTML+=showRwywCover+overlay+"</div>"}else{var settings="";if(_.isObject(opts)){if(opts.isSample===true){settings="sample "}switch(true){case opts.isOverdue===true:settings+="overdue";break;case opts.isRwyw===true:settings+="rwyw";break;case opts.isETextbook===true:settings+="etextbook";break}if(cornerSize=="small"){settings+=cornerSize}}coverHTML='<div class="book-cover '+settings+'">'+'<img src="'+coverImg+'" onerror="this.src="'+C.global.errorImage+'">'+"</div>"}}return coverHTML};C.utility.bookCover.dropdown=1;C.utility.bookCover.thumb=2;C.utility.bookCover.small=3;C.utility.bookCover.medium=4;C.utility.bookCover.large=5;C.utility.bookCover.bookType="book";C.utility.bookCover.tbsType="tbs";var JSON;if(!JSON){JSON={}}(function(){"use strict";function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else if(typeof space==="string"){indent=space}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}})();(function(){var JSTORAGE_VERSION="0.3.2",$=window.jQuery||window.$||(window.$={}),JSON={parse:window.JSON&&(window.JSON.parse||window.JSON.decode)||String.prototype.evalJSON&&function(str){return String(str).evalJSON()}||$.parseJSON||$.evalJSON,stringify:Object.toJSON||window.JSON&&(window.JSON.stringify||window.JSON.encode)||$.toJSON};if(!JSON.parse||!JSON.stringify){throw new Error("No JSON support found, include //cdnjs.cloudflare.com/ajax/libs/json2/20110223/json2.js to page")}var _storage={__jstorage_meta:{CRC32:{}}},_storage_service={jStorage:"{}"},_storage_elm=null,_storage_size=0,_backend=false,_observers={},_observer_timeout=false,_observer_update=0,_pubsub_observers={},_pubsub_last=+new Date,_ttl_timeout,_XMLService={isXML:function(elm){var documentElement=(elm?elm.ownerDocument||elm:0).documentElement;return documentElement?documentElement.nodeName!=="HTML":false},encode:function(xmlNode){if(!this.isXML(xmlNode)){return false}try{return(new XMLSerializer).serializeToString(xmlNode)}catch(E1){try{return xmlNode.xml}catch(E2){}}return false},decode:function(xmlString){var dom_parser="DOMParser"in window&&(new DOMParser).parseFromString||window.ActiveXObject&&function(_xmlString){var xml_doc=new ActiveXObject("Microsoft.XMLDOM");xml_doc.async="false";xml_doc.loadXML(_xmlString);return xml_doc},resultXML;if(!dom_parser){return false}resultXML=dom_parser.call("DOMParser"in window&&new DOMParser||window,xmlString,"text/xml");return this.isXML(resultXML)?resultXML:false}},_localStoragePolyfillSetKey=function(){};function _init(){var localStorageReallyWorks=false;if("localStorage"in window){try{window.localStorage.setItem("_tmptest","tmpval");localStorageReallyWorks=true;window.localStorage.removeItem("_tmptest")}catch(BogusQuotaExceededErrorOnIos5){}}if(localStorageReallyWorks){try{if(window.localStorage){_storage_service=window.localStorage;_backend="localStorage";_observer_update=_storage_service.jStorage_update}}catch(E3){}}else if("globalStorage"in window){try{if(window.globalStorage){_storage_service=window.globalStorage[window.location.hostname];_backend="globalStorage";_observer_update=_storage_service.jStorage_update}}catch(E4){}}else{_storage_elm=document.createElement("link");if(_storage_elm.addBehavior){_storage_elm.style.behavior="url(#default#userData)";document.getElementsByTagName("head")[0].appendChild(_storage_elm);try{_storage_elm.load("jStorage")}catch(E){_storage_elm.setAttribute("jStorage","{}");_storage_elm.save("jStorage");_storage_elm.load("jStorage")}var data="{}";try{data=_storage_elm.getAttribute("jStorage")}catch(E5){}try{_observer_update=_storage_elm.getAttribute("jStorage_update")}catch(E6){}_storage_service.jStorage=data;_backend="userDataBehavior"}else{_storage_elm=null;return}}_load_storage();_handleTTL();_createPolyfillStorage("local");_createPolyfillStorage("session");_setupObserver();_handlePubSub();if("addEventListener"in window){window.addEventListener("pageshow",function(event){if(event.persisted){_storageObserver()}},false)}}function _createPolyfillStorage(type,forceCreate){var _skipSave=false,_length=0,i,storage,storage_source={};var rand=Math.random();if(!forceCreate&&typeof window[type+"Storage"]!="undefined"){return}if(type=="local"&&window.globalStorage){localStorage=window.globalStorage[window.location.hostname];return}if(_backend!="userDataBehavior"){return}if(forceCreate&&window[type+"Storage"]&&window[type+"Storage"].parentNode){window[type+"Storage"].parentNode.removeChild(window[type+"Storage"])}storage=document.createElement("button");document.getElementsByTagName("head")[0].appendChild(storage);if(type=="local"){storage_source=_storage}else if(type=="session"){_sessionStoragePolyfillUpdate()}for(i in storage_source){if(storage_source.hasOwnProperty(i)&&i!="__jstorage_meta"&&i!="length"&&typeof storage_source[i]!="undefined"){if(!(i in storage)){_length++}storage[i]=storage_source[i]}}storage.length=_length;storage.key=function(n){var count=0,i;_sessionStoragePolyfillUpdate();for(i in storage_source){if(storage_source.hasOwnProperty(i)&&i!="__jstorage_meta"&&i!="length"&&typeof storage_source[i]!="undefined"){if(count==n){return i}count++}}};storage.getItem=function(key){_sessionStoragePolyfillUpdate();if(type=="session"){return storage_source[key]}return $.jStorage.get(key)};storage.setItem=function(key,value){if(typeof value=="undefined"){return}storage[key]=(value||"").toString()};storage.removeItem=function(key){if(type=="local"){return $.jStorage.deleteKey(key)}storage[key]=undefined;_skipSave=true;if(key in storage){storage.removeAttribute(key)}_skipSave=false};storage.clear=function(){if(type=="session"){window.name="";_createPolyfillStorage("session",true);return}$.jStorage.flush()};if(type=="local"){_localStoragePolyfillSetKey=function(key,value){if(key=="length"){return}_skipSave=true;if(typeof value=="undefined"){if(key in storage){_length--;storage.removeAttribute(key)}}else{if(!(key in storage)){_length++}storage[key]=(value||"").toString()}storage.length=_length;_skipSave=false}}function _sessionStoragePolyfillUpdate(){if(type!="session"){return}try{storage_source=JSON.parse(window.name||"{}")}catch(E){storage_source={}}}function _sessionStoragePolyfillSave(){if(type!="session"){return}window.name=JSON.stringify(storage_source)}storage.attachEvent("onpropertychange",function(e){if(e.propertyName=="length"){return}if(_skipSave||e.propertyName=="length"){return}if(type=="local"){if(!(e.propertyName in storage_source)&&typeof storage[e.propertyName]!="undefined"){_length++}}else if(type=="session"){_sessionStoragePolyfillUpdate();if(typeof storage[e.propertyName]!="undefined"&&!(e.propertyName in storage_source)){storage_source[e.propertyName]=storage[e.propertyName];_length++}else if(typeof storage[e.propertyName]=="undefined"&&e.propertyName in storage_source){
delete storage_source[e.propertyName];_length--}else{storage_source[e.propertyName]=storage[e.propertyName]}_sessionStoragePolyfillSave();storage.length=_length;return}$.jStorage.set(e.propertyName,storage[e.propertyName]);storage.length=_length});window[type+"Storage"]=storage}function _reloadData(){var data="{}";if(_backend=="userDataBehavior"){_storage_elm.load("jStorage");try{data=_storage_elm.getAttribute("jStorage")}catch(E5){}try{_observer_update=_storage_elm.getAttribute("jStorage_update")}catch(E6){}_storage_service.jStorage=data}_load_storage();_handleTTL();_handlePubSub()}function _setupObserver(){if(_backend=="localStorage"||_backend=="globalStorage"){if("addEventListener"in window){window.addEventListener("storage",_storageObserver,false)}else{document.attachEvent("onstorage",_storageObserver)}}else if(_backend=="userDataBehavior"){setInterval(_storageObserver,1e3)}}function _storageObserver(){var updateTime;clearTimeout(_observer_timeout);_observer_timeout=setTimeout(function(){if(_backend=="localStorage"||_backend=="globalStorage"){updateTime=_storage_service.jStorage_update}else if(_backend=="userDataBehavior"){_storage_elm.load("jStorage");try{updateTime=_storage_elm.getAttribute("jStorage_update")}catch(E5){}}if(updateTime&&updateTime!=_observer_update){_observer_update=updateTime;_checkUpdatedKeys()}},25)}function _checkUpdatedKeys(){var oldCrc32List=JSON.parse(JSON.stringify(_storage.__jstorage_meta.CRC32)),newCrc32List;_reloadData();newCrc32List=JSON.parse(JSON.stringify(_storage.__jstorage_meta.CRC32));var key,updated=[],removed=[];for(key in oldCrc32List){if(oldCrc32List.hasOwnProperty(key)){if(!newCrc32List[key]){removed.push(key);continue}if(oldCrc32List[key]!=newCrc32List[key]&&String(oldCrc32List[key]).substr(0,2)=="2."){updated.push(key)}}}for(key in newCrc32List){if(newCrc32List.hasOwnProperty(key)){if(!oldCrc32List[key]){updated.push(key)}}}_fireObservers(updated,"updated");_fireObservers(removed,"deleted")}function _fireObservers(keys,action){keys=[].concat(keys||[]);if(action=="flushed"){keys=[];for(var key in _observers){if(_observers.hasOwnProperty(key)){keys.push(key)}}action="deleted"}for(var i=0,len=keys.length;i<len;i++){if(_observers[keys[i]]){for(var j=0,jlen=_observers[keys[i]].length;j<jlen;j++){_observers[keys[i]][j](keys[i],action)}}}}function _publishChange(){var updateTime=(+new Date).toString();if(_backend=="localStorage"||_backend=="globalStorage"){_storage_service.jStorage_update=updateTime}else if(_backend=="userDataBehavior"){_storage_elm.setAttribute("jStorage_update",updateTime);_storage_elm.save("jStorage")}_storageObserver()}function _load_storage(){if(_storage_service.jStorage){try{_storage=JSON.parse(String(_storage_service.jStorage))}catch(E6){_storage_service.jStorage="{}"}}else{_storage_service.jStorage="{}"}_storage_size=_storage_service.jStorage?String(_storage_service.jStorage).length:0;if(!_storage.__jstorage_meta){_storage.__jstorage_meta={}}if(!_storage.__jstorage_meta.CRC32){_storage.__jstorage_meta.CRC32={}}}function _save(){_dropOldEvents();try{_storage_service.jStorage=JSON.stringify(_storage);if(_storage_elm){_storage_elm.setAttribute("jStorage",_storage_service.jStorage);_storage_elm.save("jStorage")}_storage_size=_storage_service.jStorage?String(_storage_service.jStorage).length:0}catch(E7){}}function _checkKey(key){if(!key||typeof key!="string"&&typeof key!="number"){throw new TypeError("Key name must be string or numeric")}if(key=="__jstorage_meta"){throw new TypeError("Reserved key name")}return true}function _handleTTL(){var curtime,i,TTL,CRC32,nextExpire=Infinity,changed=false,deleted=[];clearTimeout(_ttl_timeout);if(!_storage.__jstorage_meta||typeof _storage.__jstorage_meta.TTL!="object"){return}curtime=+new Date;TTL=_storage.__jstorage_meta.TTL;CRC32=_storage.__jstorage_meta.CRC32;for(i in TTL){if(TTL.hasOwnProperty(i)){if(TTL[i]<=curtime){delete TTL[i];delete CRC32[i];delete _storage[i];changed=true;deleted.push(i)}else if(TTL[i]<nextExpire){nextExpire=TTL[i]}}}if(nextExpire!=Infinity){_ttl_timeout=setTimeout(_handleTTL,nextExpire-curtime)}if(changed){_save();_publishChange();_fireObservers(deleted,"deleted")}}function _handlePubSub(){if(!_storage.__jstorage_meta.PubSub){return}var pubelm,_pubsubCurrent=_pubsub_last;for(var i=len=_storage.__jstorage_meta.PubSub.length-1;i>=0;i--){pubelm=_storage.__jstorage_meta.PubSub[i];if(pubelm[0]>_pubsub_last){_pubsubCurrent=pubelm[0];_fireSubscribers(pubelm[1],pubelm[2])}}_pubsub_last=_pubsubCurrent}function _fireSubscribers(channel,payload){if(_pubsub_observers[channel]){for(var i=0,len=_pubsub_observers[channel].length;i<len;i++){_pubsub_observers[channel][i](channel,JSON.parse(JSON.stringify(payload)))}}}function _dropOldEvents(){if(!_storage.__jstorage_meta.PubSub){return}var retire=+new Date-2e3;for(var i=0,len=_storage.__jstorage_meta.PubSub.length;i<len;i++){if(_storage.__jstorage_meta.PubSub[i][0]<=retire){_storage.__jstorage_meta.PubSub.splice(i,_storage.__jstorage_meta.PubSub.length-i);break}}if(!_storage.__jstorage_meta.PubSub.length){delete _storage.__jstorage_meta.PubSub}}function _publish(channel,payload){if(!_storage.__jstorage_meta){_storage.__jstorage_meta={}}if(!_storage.__jstorage_meta.PubSub){_storage.__jstorage_meta.PubSub=[]}_storage.__jstorage_meta.PubSub.unshift([+new Date,channel,payload]);_save();_publishChange()}function murmurhash2_32_gc(str,seed){var l=str.length,h=seed^l,i=0,k;while(l>=4){k=str.charCodeAt(i)&255|(str.charCodeAt(++i)&255)<<8|(str.charCodeAt(++i)&255)<<16|(str.charCodeAt(++i)&255)<<24;k=(k&65535)*1540483477+(((k>>>16)*1540483477&65535)<<16);k^=k>>>24;k=(k&65535)*1540483477+(((k>>>16)*1540483477&65535)<<16);h=(h&65535)*1540483477+(((h>>>16)*1540483477&65535)<<16)^k;l-=4;++i}switch(l){case 3:h^=(str.charCodeAt(i+2)&255)<<16;case 2:h^=(str.charCodeAt(i+1)&255)<<8;case 1:h^=str.charCodeAt(i)&255;h=(h&65535)*1540483477+(((h>>>16)*1540483477&65535)<<16)}h^=h>>>13;h=(h&65535)*1540483477+(((h>>>16)*1540483477&65535)<<16);h^=h>>>15;return h>>>0}$.jStorage={version:JSTORAGE_VERSION,set:function(key,value,options){_checkKey(key);options=options||{};if(typeof value=="undefined"){this.deleteKey(key);return value}if(_XMLService.isXML(value)){value={_is_xml:true,xml:_XMLService.encode(value)}}else if(typeof value=="function"){return undefined}else if(value&&typeof value=="object"){value=JSON.parse(JSON.stringify(value))}_storage[key]=value;_storage.__jstorage_meta.CRC32[key]="2."+murmurhash2_32_gc(JSON.stringify(value));this.setTTL(key,options.TTL||0);_localStoragePolyfillSetKey(key,value);_fireObservers(key,"updated");return value},get:function(key,def){_checkKey(key);if(key in _storage){if(_storage[key]&&typeof _storage[key]=="object"&&_storage[key]._is_xml){return _XMLService.decode(_storage[key].xml)}else{return _storage[key]}}return typeof def=="undefined"?null:def},deleteKey:function(key){_checkKey(key);if(key in _storage){delete _storage[key];if(typeof _storage.__jstorage_meta.TTL=="object"&&key in _storage.__jstorage_meta.TTL){delete _storage.__jstorage_meta.TTL[key]}delete _storage.__jstorage_meta.CRC32[key];_localStoragePolyfillSetKey(key,undefined);_save();_publishChange();_fireObservers(key,"deleted");return true}return false},setTTL:function(key,ttl){var curtime=+new Date;_checkKey(key);ttl=Number(ttl)||0;if(key in _storage){if(!_storage.__jstorage_meta.TTL){_storage.__jstorage_meta.TTL={}}if(ttl>0){_storage.__jstorage_meta.TTL[key]=curtime+ttl}else{delete _storage.__jstorage_meta.TTL[key]}_save();_handleTTL();_publishChange();return true}return false},getTTL:function(key){var curtime=+new Date,ttl;_checkKey(key);if(key in _storage&&_storage.__jstorage_meta.TTL&&_storage.__jstorage_meta.TTL[key]){ttl=_storage.__jstorage_meta.TTL[key]-curtime;return ttl||0}return 0},flush:function(){_storage={__jstorage_meta:{CRC32:{}}};_createPolyfillStorage("local",true);_save();_publishChange();_fireObservers(null,"flushed");return true},storageObj:function(){function F(){}F.prototype=_storage;return new F},index:function(){var index=[],i;for(i in _storage){if(_storage.hasOwnProperty(i)&&i!="__jstorage_meta"){index.push(i)}}return index},storageSize:function(){return _storage_size},currentBackend:function(){return _backend},storageAvailable:function(){return!!_backend},listenKeyChange:function(key,callback){_checkKey(key);if(!_observers[key]){_observers[key]=[]}_observers[key].push(callback)},stopListening:function(key,callback){_checkKey(key);if(!_observers[key]){return}if(!callback){delete _observers[key];return}for(var i=_observers[key].length-1;i>=0;i--){if(_observers[key][i]==callback){_observers[key].splice(i,1)}}},subscribe:function(channel,callback){channel=(channel||"").toString();if(!channel){throw new TypeError("Channel not defined")}if(!_pubsub_observers[channel]){_pubsub_observers[channel]=[]}_pubsub_observers[channel].push(callback)},publish:function(channel,payload){channel=(channel||"").toString();if(!channel){throw new TypeError("Channel not defined")}_publish(channel,payload)},reInit:function(){_reloadData()}};_init()})();(function(){var root=this;var previousUnderscore=root._;var breaker={};var ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype;var push=ArrayProto.push,slice=ArrayProto.slice,concat=ArrayProto.concat,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty;var nativeForEach=ArrayProto.forEach,nativeMap=ArrayProto.map,nativeReduce=ArrayProto.reduce,nativeReduceRight=ArrayProto.reduceRight,nativeFilter=ArrayProto.filter,nativeEvery=ArrayProto.every,nativeSome=ArrayProto.some,nativeIndexOf=ArrayProto.indexOf,nativeLastIndexOf=ArrayProto.lastIndexOf,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind;var _=function(obj){if(obj instanceof _)return obj;if(!(this instanceof _))return new _(obj);this._wrapped=obj};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=_}exports._=_}else{root._=_}_.VERSION="1.4.3";var each=_.each=_.forEach=function(obj,iterator,context){if(obj==null)return;if(nativeForEach&&obj.forEach===nativeForEach){obj.forEach(iterator,context)}else if(obj.length===+obj.length){for(var i=0,l=obj.length;i<l;i++){if(iterator.call(context,obj[i],i,obj)===breaker)return}}else{for(var key in obj){if(_.has(obj,key)){if(iterator.call(context,obj[key],key,obj)===breaker)return}}}};_.map=_.collect=function(obj,iterator,context){var results=[];if(obj==null)return results;if(nativeMap&&obj.map===nativeMap)return obj.map(iterator,context);each(obj,function(value,index,list){results[results.length]=iterator.call(context,value,index,list)});return results};var reduceError="Reduce of empty array with no initial value";_.reduce=_.foldl=_.inject=function(obj,iterator,memo,context){var initial=arguments.length>2;if(obj==null)obj=[];if(nativeReduce&&obj.reduce===nativeReduce){if(context)iterator=_.bind(iterator,context);return initial?obj.reduce(iterator,memo):obj.reduce(iterator)}each(obj,function(value,index,list){if(!initial){memo=value;initial=true}else{memo=iterator.call(context,memo,value,index,list)}});if(!initial)throw new TypeError(reduceError);return memo};_.reduceRight=_.foldr=function(obj,iterator,memo,context){var initial=arguments.length>2;if(obj==null)obj=[];if(nativeReduceRight&&obj.reduceRight===nativeReduceRight){if(context)iterator=_.bind(iterator,context);return initial?obj.reduceRight(iterator,memo):obj.reduceRight(iterator)}var length=obj.length;if(length!==+length){var keys=_.keys(obj);length=keys.length}each(obj,function(value,index,list){index=keys?keys[--length]:--length;if(!initial){memo=obj[index];initial=true}else{memo=iterator.call(context,memo,obj[index],index,list)}});if(!initial)throw new TypeError(reduceError);return memo};_.find=_.detect=function(obj,iterator,context){var result;any(obj,function(value,index,list){if(iterator.call(context,value,index,list)){result=value;return true}});return result};_.filter=_.select=function(obj,iterator,context){var results=[];if(obj==null)return results;if(nativeFilter&&obj.filter===nativeFilter)return obj.filter(iterator,context);each(obj,function(value,index,list){if(iterator.call(context,value,index,list))results[results.length]=value});return results};_.reject=function(obj,iterator,context){return _.filter(obj,function(value,index,list){return!iterator.call(context,value,index,list)},context)};_.every=_.all=function(obj,iterator,context){iterator||(iterator=_.identity);var result=true;if(obj==null)return result;if(nativeEvery&&obj.every===nativeEvery)return obj.every(iterator,context);each(obj,function(value,index,list){if(!(result=result&&iterator.call(context,value,index,list)))return breaker});return!!result};var any=_.some=_.any=function(obj,iterator,context){iterator||(iterator=_.identity);var result=false;if(obj==null)return result;if(nativeSome&&obj.some===nativeSome)return obj.some(iterator,context);each(obj,function(value,index,list){if(result||(result=iterator.call(context,value,index,list)))return breaker});return!!result};_.contains=_.include=function(obj,target){if(obj==null)return false;if(nativeIndexOf&&obj.indexOf===nativeIndexOf)return obj.indexOf(target)!=-1;return any(obj,function(value){return value===target})};_.invoke=function(obj,method){var args=slice.call(arguments,2);var isFunc=_.isFunction(method);return _.map(obj,function(value){return(isFunc?method:value[method]).apply(value,args)})};_.pluck=function(obj,key){return _.map(obj,function(value){return value[key]})};_.where=function(obj,attrs){if(_.isEmpty(attrs))return[];return _.filter(obj,function(value){for(var key in attrs){if(attrs[key]!==value[key])return false}return true})};_.max=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535){return Math.max.apply(Math,obj)}if(!iterator&&_.isEmpty(obj))return-Infinity;var result={computed:-Infinity,value:-Infinity};each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed>=result.computed&&(result={value:value,computed:computed})});return result.value};_.min=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535){return Math.min.apply(Math,obj)}if(!iterator&&_.isEmpty(obj))return Infinity;var result={computed:Infinity,value:Infinity};each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed<result.computed&&(result={value:value,computed:computed})});return result.value};_.shuffle=function(obj){var rand;var index=0;var shuffled=[];each(obj,function(value){rand=_.random(index++);shuffled[index-1]=shuffled[rand];shuffled[rand]=value});return shuffled};var lookupIterator=function(value){return _.isFunction(value)?value:function(obj){return obj[value]}};_.sortBy=function(obj,value,context){var iterator=lookupIterator(value);return _.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iterator.call(context,value,index,list)}}).sort(function(left,right){var a=left.criteria;var b=right.criteria;if(a!==b){if(a>b||a===void 0)return 1;if(a<b||b===void 0)return-1}return left.index<right.index?-1:1}),"value")};var group=function(obj,value,context,behavior){var result={};var iterator=lookupIterator(value||_.identity);each(obj,function(value,index){var key=iterator.call(context,value,index,obj);behavior(result,key,value)});return result};_.groupBy=function(obj,value,context){return group(obj,value,context,function(result,key,value){(_.has(result,key)?result[key]:result[key]=[]).push(value)})};_.countBy=function(obj,value,context){return group(obj,value,context,function(result,key){if(!_.has(result,key))result[key]=0;result[key]++})};_.sortedIndex=function(array,obj,iterator,context){iterator=iterator==null?_.identity:lookupIterator(iterator);var value=iterator.call(context,obj);var low=0,high=array.length;while(low<high){var mid=low+high>>>1;iterator.call(context,array[mid])<value?low=mid+1:high=mid}return low};_.toArray=function(obj){if(!obj)return[];if(_.isArray(obj))return slice.call(obj);if(obj.length===+obj.length)return _.map(obj,_.identity);return _.values(obj)};_.size=function(obj){if(obj==null)return 0;return obj.length===+obj.length?obj.length:_.keys(obj).length};_.first=_.head=_.take=function(array,n,guard){if(array==null)return void 0;return n!=null&&!guard?slice.call(array,0,n):array[0]};_.initial=function(array,n,guard){return slice.call(array,0,array.length-(n==null||guard?1:n))};_.last=function(array,n,guard){if(array==null)return void 0;if(n!=null&&!guard){return slice.call(array,Math.max(array.length-n,0))}else{return array[array.length-1]}};_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,n==null||guard?1:n)};_.compact=function(array){return _.filter(array,_.identity)};var flatten=function(input,shallow,output){each(input,function(value){if(_.isArray(value)){shallow?push.apply(output,value):flatten(value,shallow,output)}else{output.push(value)}});return output};_.flatten=function(array,shallow){return flatten(array,shallow,[])};_.without=function(array){return _.difference(array,slice.call(arguments,1))};_.uniq=_.unique=function(array,isSorted,iterator,context){if(_.isFunction(isSorted)){context=iterator;iterator=isSorted;isSorted=false}var initial=iterator?_.map(array,iterator,context):array;var results=[];var seen=[];each(initial,function(value,index){if(isSorted?!index||seen[seen.length-1]!==value:!_.contains(seen,value)){seen.push(value);results.push(array[index])}});return results};_.union=function(){return _.uniq(concat.apply(ArrayProto,arguments))};_.intersection=function(array){var rest=slice.call(arguments,1);return _.filter(_.uniq(array),function(item){return _.every(rest,function(other){return _.indexOf(other,item)>=0})})};_.difference=function(array){var rest=concat.apply(ArrayProto,slice.call(arguments,1));return _.filter(array,function(value){return!_.contains(rest,value)})};_.zip=function(){var args=slice.call(arguments);var length=_.max(_.pluck(args,"length"));var results=new Array(length);for(var i=0;i<length;i++){results[i]=_.pluck(args,""+i)}return results};_.object=function(list,values){if(list==null)return{};var result={};for(var i=0,l=list.length;i<l;i++){if(values){result[list[i]]=values[i]}else{result[list[i][0]]=list[i][1]}}return result};_.indexOf=function(array,item,isSorted){if(array==null)return-1;var i=0,l=array.length;if(isSorted){if(typeof isSorted=="number"){i=isSorted<0?Math.max(0,l+isSorted):isSorted}else{i=_.sortedIndex(array,item);return array[i]===item?i:-1}}if(nativeIndexOf&&array.indexOf===nativeIndexOf)return array.indexOf(item,isSorted);for(;i<l;i++)if(array[i]===item)return i;return-1};_.lastIndexOf=function(array,item,from){if(array==null)return-1;var hasIndex=from!=null;if(nativeLastIndexOf&&array.lastIndexOf===nativeLastIndexOf){return hasIndex?array.lastIndexOf(item,from):array.lastIndexOf(item)}var i=hasIndex?from:array.length;while(i--)if(array[i]===item)return i;return-1};_.range=function(start,stop,step){if(arguments.length<=1){stop=start||0;start=0}step=arguments[2]||1;var len=Math.max(Math.ceil((stop-start)/step),0);var idx=0;var range=new Array(len);while(idx<len){range[idx++]=start;start+=step}return range};var ctor=function(){};_.bind=function(func,context){var args,bound;if(func.bind===nativeBind&&nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError;args=slice.call(arguments,2);return bound=function(){if(!(this instanceof bound))return func.apply(context,args.concat(slice.call(arguments)));ctor.prototype=func.prototype;var self=new ctor;ctor.prototype=null;var result=func.apply(self,args.concat(slice.call(arguments)));if(Object(result)===result)return result;return self}};_.bindAll=function(obj){var funcs=slice.call(arguments,1);if(funcs.length===0)funcs=_.functions(obj);each(funcs,function(f){obj[f]=_.bind(obj[f],obj)});return obj};_.memoize=function(func,hasher){var memo={};hasher||(hasher=_.identity);return function(){var key=hasher.apply(this,arguments);return _.has(memo,key)?memo[key]:memo[key]=func.apply(this,arguments)}};_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)};_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)))};_.throttle=function(func,wait){var context,args,timeout,result;var previous=0;var later=function(){previous=new Date;timeout=null;result=func.apply(context,args)};return function(){var now=new Date;var remaining=wait-(now-previous);context=this;args=arguments;if(remaining<=0){clearTimeout(timeout);timeout=null;previous=now;result=func.apply(context,args)}else if(!timeout){timeout=setTimeout(later,remaining)}return result}};_.debounce=function(func,wait,immediate){var timeout,result;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate)result=func.apply(context,args)};var callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow)result=func.apply(context,args);return result}};_.once=function(func){var ran=false,memo;return function(){if(ran)return memo;ran=true;memo=func.apply(this,arguments);func=null;return memo}};_.wrap=function(func,wrapper){return function(){var args=[func];push.apply(args,arguments);return wrapper.apply(this,args)}};_.compose=function(){var funcs=arguments;return function(){var args=arguments;for(var i=funcs.length-1;i>=0;i--){args=[funcs[i].apply(this,args)]}return args[0]}};_.after=function(times,func){if(times<=0)return func();return function(){if(--times<1){return func.apply(this,arguments)}}};_.keys=nativeKeys||function(obj){if(obj!==Object(obj))throw new TypeError("Invalid object");var keys=[];for(var key in obj)if(_.has(obj,key))keys[keys.length]=key;return keys};_.values=function(obj){var values=[];for(var key in obj)if(_.has(obj,key))values.push(obj[key]);return values};_.pairs=function(obj){var pairs=[];for(var key in obj)if(_.has(obj,key))pairs.push([key,obj[key]]);return pairs};_.invert=function(obj){var result={};for(var key in obj)if(_.has(obj,key))result[obj[key]]=key;return result};_.functions=_.methods=function(obj){var names=[];for(var key in obj){if(_.isFunction(obj[key]))names.push(key)}return names.sort()};_.extend=function(obj){each(slice.call(arguments,1),function(source){if(source){for(var prop in source){obj[prop]=source[prop]}}});return obj};_.pick=function(obj){var copy={};var keys=concat.apply(ArrayProto,slice.call(arguments,1));each(keys,function(key){if(key in obj)copy[key]=obj[key]});return copy};_.omit=function(obj){var copy={};var keys=concat.apply(ArrayProto,slice.call(arguments,1));for(var key in obj){if(!_.contains(keys,key))copy[key]=obj[key]}return copy};_.defaults=function(obj){each(slice.call(arguments,1),function(source){if(source){for(var prop in source){if(obj[prop]==null)obj[prop]=source[prop]}}});return obj};_.clone=function(obj){if(!_.isObject(obj))return obj;return _.isArray(obj)?obj.slice():_.extend({},obj)};_.tap=function(obj,interceptor){interceptor(obj);return obj};var eq=function(a,b,aStack,bStack){if(a===b)return a!==0||1/a==1/b;if(a==null||b==null)return a===b;if(a instanceof _)a=a._wrapped;if(b instanceof _)b=b._wrapped;var className=toString.call(a);if(className!=toString.call(b))return false;switch(className){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeof a!="object"||typeof b!="object")return false;var length=aStack.length;while(length--){if(aStack[length]==a)return bStack[length]==b}aStack.push(a);bStack.push(b);var size=0,result=true;if(className=="[object Array]"){size=a.length;result=size==b.length;if(result){while(size--){if(!(result=eq(a[size],b[size],aStack,bStack)))break}}}else{var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor)){return false}for(var key in a){if(_.has(a,key)){size++;if(!(result=_.has(b,key)&&eq(a[key],b[key],aStack,bStack)))break}}if(result){for(key in b){if(_.has(b,key)&&!size--)break}result=!size}}aStack.pop();bStack.pop();return result};_.isEqual=function(a,b){return eq(a,b,[],[])};_.isEmpty=function(obj){if(obj==null)return true;if(_.isArray(obj)||_.isString(obj))return obj.length===0;for(var key in obj)if(_.has(obj,key))return false;return true};_.isElement=function(obj){return!!(obj&&obj.nodeType===1)};_.isArray=nativeIsArray||function(obj){return toString.call(obj)=="[object Array]"};_.isObject=function(obj){return obj===Object(obj)};each(["Arguments","Function","String","Number","Date","RegExp"],function(name){_["is"+name]=function(obj){return toString.call(obj)=="[object "+name+"]"}});if(!_.isArguments(arguments)){_.isArguments=function(obj){return!!(obj&&_.has(obj,"callee"))}}if(typeof/./!=="function"){_.isFunction=function(obj){return typeof obj==="function"}}_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))};_.isNaN=function(obj){return _.isNumber(obj)&&obj!=+obj};_.isBoolean=function(obj){return obj===true||obj===false||toString.call(obj)=="[object Boolean]"};_.isNull=function(obj){return obj===null};_.isUndefined=function(obj){return obj===void 0};_.has=function(obj,key){return hasOwnProperty.call(obj,key)};_.noConflict=function(){root._=previousUnderscore;return this};_.identity=function(value){return value};_.times=function(n,iterator,context){var accum=Array(n);for(var i=0;i<n;i++)accum[i]=iterator.call(context,i);return accum};_.random=function(min,max){if(max==null){max=min;min=0}return min+Math.floor(Math.random()*(max-min+1))};var entityMap={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};entityMap.unescape=_.invert(entityMap.escape);var entityRegexes={escape:new RegExp("["+_.keys(entityMap.escape).join("")+"]","g"),unescape:new RegExp("("+_.keys(entityMap.unescape).join("|")+")","g")};_.each(["escape","unescape"],function(method){_[method]=function(string){if(string==null)return"";return(""+string).replace(entityRegexes[method],function(match){return entityMap[method][match]})}});_.result=function(object,property){if(object==null)return null;var value=object[property];return _.isFunction(value)?value.call(object):value};_.mixin=function(obj){each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];push.apply(args,arguments);return result.call(this,func.apply(_,args))}})};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id};_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/;var escapes={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"};var escaper=/\\|'|\r|\n|\t|\u2028|\u2029/g;_.template=function(text,data,settings){var render;settings=_.defaults({},settings,_.templateSettings);var matcher=new RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g");var index=0;var source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){source+=text.slice(index,offset).replace(escaper,function(match){return"\\"+escapes[match]});if(escape){source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'"}if(interpolate){source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'"}if(evaluate){source+="';\n"+evaluate+"\n__p+='"}index=offset+match.length;return match});source+="';\n";if(!settings.variable)source="with(obj||{}){\n"+source+"}\n";source="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";try{render=new Function(settings.variable||"obj","_",source)}catch(e){e.source=source;throw e}if(data)return render(data,_);var template=function(data){return render.call(this,data,_)};template.source="function("+(settings.variable||"obj")+"){\n"+source+"}";return template};_.chain=function(obj){return _(obj).chain()};var result=function(obj){return this._chain?_(obj).chain():obj};_.mixin(_);each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;method.apply(obj,arguments);if((name=="shift"||name=="splice")&&obj.length===0)delete obj[0];return result.call(this,obj)}});each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result.call(this,method.apply(this._wrapped,arguments))}});_.extend(_.prototype,{chain:function(){this._chain=true;return this},value:function(){return this._wrapped}})}).call(this);(function(){var root=this;var previousBackbone=root.Backbone;var array=[];var push=array.push;var slice=array.slice;var splice=array.splice;var Backbone;if(typeof exports!=="undefined"){Backbone=exports}else{Backbone=root.Backbone={}}Backbone.VERSION="1.0.0";var _=root._;if(!_&&typeof require!=="undefined")_=require("underscore");Backbone.$=root.jQuery||root.Zepto||root.ender||root.$;Backbone.noConflict=function(){root.Backbone=previousBackbone;return this};Backbone.emulateHTTP=false;Backbone.emulateJSON=false;var Events=Backbone.Events={on:function(name,callback,context){if(!eventsApi(this,"on",name,[callback,context])||!callback)return this;this._events||(this._events={});var events=this._events[name]||(this._events[name]=[]);events.push({callback:callback,context:context,ctx:context||this});return this},once:function(name,callback,context){if(!eventsApi(this,"once",name,[callback,context])||!callback)return this;var self=this;var once=_.once(function(){self.off(name,once);callback.apply(this,arguments)});once._callback=callback;return this.on(name,once,context)},off:function(name,callback,context){var retain,ev,events,names,i,l,j,k;if(!this._events||!eventsApi(this,"off",name,[callback,context]))return this;if(!name&&!callback&&!context){this._events={};return this}names=name?[name]:_.keys(this._events);for(i=0,l=names.length;i<l;i++){name=names[i];if(events=this._events[name]){this._events[name]=retain=[];if(callback||context){for(j=0,k=events.length;j<k;j++){ev=events[j];if(callback&&callback!==ev.callback&&callback!==ev.callback._callback||context&&context!==ev.context){retain.push(ev)}}}if(!retain.length)delete this._events[name]}}return this},trigger:function(name){if(!this._events)return this;var args=slice.call(arguments,1);if(!eventsApi(this,"trigger",name,args))return this;var events=this._events[name];var allEvents=this._events.all;if(events)triggerEvents(events,args);if(allEvents)triggerEvents(allEvents,arguments);return this},stopListening:function(obj,name,callback){var listeners=this._listeners;if(!listeners)return this;var deleteListener=!name&&!callback;if(typeof name==="object")callback=this;if(obj)(listeners={})[obj._listenerId]=obj;for(var id in listeners){listeners[id].off(name,callback,this);if(deleteListener)delete this._listeners[id]}return this}};var eventSplitter=/\s+/;var eventsApi=function(obj,action,name,rest){if(!name)return true;if(typeof name==="object"){for(var key in name){obj[action].apply(obj,[key,name[key]].concat(rest))}return false}if(eventSplitter.test(name)){var names=name.split(eventSplitter);for(var i=0,l=names.length;i<l;i++){obj[action].apply(obj,[names[i]].concat(rest))}return false}return true};var triggerEvents=function(events,args){var ev,i=-1,l=events.length,a1=args[0],a2=args[1],a3=args[2];switch(args.length){case 0:while(++i<l)(ev=events[i]).callback.call(ev.ctx);return;case 1:while(++i<l)(ev=events[i]).callback.call(ev.ctx,a1);return;case 2:while(++i<l)(ev=events[i]).callback.call(ev.ctx,a1,a2);return;case 3:while(++i<l)(ev=events[i]).callback.call(ev.ctx,a1,a2,a3);

return;default:while(++i<l)(ev=events[i]).callback.apply(ev.ctx,args)}};var listenMethods={listenTo:"on",listenToOnce:"once"};_.each(listenMethods,function(implementation,method){Events[method]=function(obj,name,callback){var listeners=this._listeners||(this._listeners={});var id=obj._listenerId||(obj._listenerId=_.uniqueId("l"));listeners[id]=obj;if(typeof name==="object")callback=this;obj[implementation](name,callback,this);return this}});Events.bind=Events.on;Events.unbind=Events.off;_.extend(Backbone,Events);var Model=Backbone.Model=function(attributes,options){var defaults;var attrs=attributes||{};options||(options={});this.cid=_.uniqueId("c");this.attributes={};_.extend(this,_.pick(options,modelOptions));if(options.parse)attrs=this.parse(attrs,options)||{};if(defaults=_.result(this,"defaults")){attrs=_.defaults({},attrs,defaults)}this.set(attrs,options);this.changed={};this.initialize.apply(this,arguments)};var modelOptions=["url","urlRoot","collection"];_.extend(Model.prototype,Events,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(options){return _.clone(this.attributes)},sync:function(){return Backbone.sync.apply(this,arguments)},get:function(attr){return this.attributes[attr]},escape:function(attr){return _.escape(this.get(attr))},has:function(attr){return this.get(attr)!=null},set:function(key,val,options){var attr,attrs,unset,changes,silent,changing,prev,current;if(key==null)return this;if(typeof key==="object"){attrs=key;options=val}else{(attrs={})[key]=val}options||(options={});if(!this._validate(attrs,options))return false;unset=options.unset;silent=options.silent;changes=[];changing=this._changing;this._changing=true;if(!changing){this._previousAttributes=_.clone(this.attributes);this.changed={}}current=this.attributes,prev=this._previousAttributes;if(this.idAttribute in attrs)this.id=attrs[this.idAttribute];for(attr in attrs){val=attrs[attr];if(!_.isEqual(current[attr],val))changes.push(attr);if(!_.isEqual(prev[attr],val)){this.changed[attr]=val}else{delete this.changed[attr]}unset?delete current[attr]:current[attr]=val}if(!silent){if(changes.length)this._pending=true;for(var i=0,l=changes.length;i<l;i++){this.trigger("change:"+changes[i],this,current[changes[i]],options)}}if(changing)return this;if(!silent){while(this._pending){this._pending=false;this.trigger("change",this,options)}}this._pending=false;this._changing=false;return this},unset:function(attr,options){return this.set(attr,void 0,_.extend({},options,{unset:true}))},clear:function(options){var attrs={};for(var key in this.attributes)attrs[key]=void 0;return this.set(attrs,_.extend({},options,{unset:true}))},hasChanged:function(attr){if(attr==null)return!_.isEmpty(this.changed);return _.has(this.changed,attr)},changedAttributes:function(diff){if(!diff)return this.hasChanged()?_.clone(this.changed):false;var val,changed=false;var old=this._changing?this._previousAttributes:this.attributes;for(var attr in diff){if(_.isEqual(old[attr],val=diff[attr]))continue;(changed||(changed={}))[attr]=val}return changed},previous:function(attr){if(attr==null||!this._previousAttributes)return null;return this._previousAttributes[attr]},previousAttributes:function(){return _.clone(this._previousAttributes)},fetch:function(options){options=options?_.clone(options):{};if(options.parse===void 0)options.parse=true;var model=this;var success=options.success;options.success=function(resp){if(!model.set(model.parse(resp,options),options))return false;if(success)success(model,resp,options);model.trigger("sync",model,resp,options)};wrapError(this,options);return this.sync("read",this,options)},save:function(key,val,options){var attrs,method,xhr,attributes=this.attributes;if(key==null||typeof key==="object"){attrs=key;options=val}else{(attrs={})[key]=val}if(attrs&&(!options||!options.wait)&&!this.set(attrs,options))return false;options=_.extend({validate:true},options);if(!this._validate(attrs,options))return false;if(attrs&&options.wait){this.attributes=_.extend({},attributes,attrs)}if(options.parse===void 0)options.parse=true;var model=this;var success=options.success;options.success=function(resp){model.attributes=attributes;var serverAttrs=model.parse(resp,options);if(options.wait)serverAttrs=_.extend(attrs||{},serverAttrs);if(_.isObject(serverAttrs)&&!model.set(serverAttrs,options)){return false}if(success)success(model,resp,options);model.trigger("sync",model,resp,options)};wrapError(this,options);method=this.isNew()?"create":options.patch?"patch":"update";if(method==="patch")options.attrs=attrs;xhr=this.sync(method,this,options);if(attrs&&options.wait)this.attributes=attributes;return xhr},destroy:function(options){options=options?_.clone(options):{};var model=this;var success=options.success;var destroy=function(){model.trigger("destroy",model,model.collection,options)};options.success=function(resp){if(options.wait||model.isNew())destroy();if(success)success(model,resp,options);if(!model.isNew())model.trigger("sync",model,resp,options)};if(this.isNew()){options.success();return false}wrapError(this,options);var xhr=this.sync("delete",this,options);if(!options.wait)destroy();return xhr},url:function(){var base=_.result(this,"urlRoot")||_.result(this.collection,"url")||urlError();if(this.isNew())return base;return base+(base.charAt(base.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(resp,options){return resp},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(options){return this._validate({},_.extend(options||{},{validate:true}))},_validate:function(attrs,options){if(!options.validate||!this.validate)return true;attrs=_.extend({},this.attributes,attrs);var error=this.validationError=this.validate(attrs,options)||null;if(!error)return true;this.trigger("invalid",this,error,_.extend(options||{},{validationError:error}));return false}});var modelMethods=["keys","values","pairs","invert","pick","omit"];_.each(modelMethods,function(method){Model.prototype[method]=function(){var args=slice.call(arguments);args.unshift(this.attributes);return _[method].apply(_,args)}});var Collection=Backbone.Collection=function(models,options){options||(options={});if(options.url)this.url=options.url;if(options.model)this.model=options.model;if(options.comparator!==void 0)this.comparator=options.comparator;this._reset();this.initialize.apply(this,arguments);if(models)this.reset(models,_.extend({silent:true},options))};var setOptions={add:true,remove:true,merge:true};var addOptions={add:true,merge:false,remove:false};_.extend(Collection.prototype,Events,{model:Model,initialize:function(){},toJSON:function(options){return this.map(function(model){return model.toJSON(options)})},sync:function(){return Backbone.sync.apply(this,arguments)},add:function(models,options){return this.set(models,_.defaults(options||{},addOptions))},remove:function(models,options){models=_.isArray(models)?models.slice():[models];options||(options={});var i,l,index,model;for(i=0,l=models.length;i<l;i++){model=this.get(models[i]);if(!model)continue;delete this._byId[model.id];delete this._byId[model.cid];index=this.indexOf(model);this.models.splice(index,1);this.length--;if(!options.silent){options.index=index;model.trigger("remove",model,this,options)}this._removeReference(model)}return this},set:function(models,options){options=_.defaults(options||{},setOptions);if(options.parse)models=this.parse(models,options);if(!_.isArray(models))models=models?[models]:[];var i,l,model,attrs,existing,sort;var at=options.at;var sortable=this.comparator&&at==null&&options.sort!==false;var sortAttr=_.isString(this.comparator)?this.comparator:null;var toAdd=[],toRemove=[],modelMap={};for(i=0,l=models.length;i<l;i++){if(!(model=this._prepareModel(models[i],options)))continue;if(existing=this.get(model)){if(options.remove)modelMap[existing.cid]=true;if(options.merge){existing.set(model.attributes,options);if(sortable&&!sort&&existing.hasChanged(sortAttr))sort=true}}else if(options.add){toAdd.push(model);model.on("all",this._onModelEvent,this);this._byId[model.cid]=model;if(model.id!=null)this._byId[model.id]=model}}if(options.remove){for(i=0,l=this.length;i<l;++i){if(!modelMap[(model=this.models[i]).cid])toRemove.push(model)}if(toRemove.length)this.remove(toRemove,options)}if(toAdd.length){if(sortable)sort=true;this.length+=toAdd.length;if(at!=null){splice.apply(this.models,[at,0].concat(toAdd))}else{push.apply(this.models,toAdd)}}if(sort)this.sort({silent:true});if(options.silent)return this;for(i=0,l=toAdd.length;i<l;i++){(model=toAdd[i]).trigger("add",model,this,options)}if(sort)this.trigger("sort",this,options);return this},reset:function(models,options){options||(options={});for(var i=0,l=this.models.length;i<l;i++){this._removeReference(this.models[i])}options.previousModels=this.models;this._reset();this.add(models,_.extend({silent:true},options));if(!options.silent)this.trigger("reset",this,options);return this},push:function(model,options){model=this._prepareModel(model,options);this.add(model,_.extend({at:this.length},options));return model},pop:function(options){var model=this.at(this.length-1);this.remove(model,options);return model},unshift:function(model,options){model=this._prepareModel(model,options);this.add(model,_.extend({at:0},options));return model},shift:function(options){var model=this.at(0);this.remove(model,options);return model},slice:function(begin,end){return this.models.slice(begin,end)},get:function(obj){if(obj==null)return void 0;return this._byId[obj.id!=null?obj.id:obj.cid||obj]},at:function(index){return this.models[index]},where:function(attrs,first){if(_.isEmpty(attrs))return first?void 0:[];return this[first?"find":"filter"](function(model){for(var key in attrs){if(attrs[key]!==model.get(key))return false}return true})},findWhere:function(attrs){return this.where(attrs,true)},sort:function(options){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");options||(options={});if(_.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this)}else{this.models.sort(_.bind(this.comparator,this))}if(!options.silent)this.trigger("sort",this,options);return this},sortedIndex:function(model,value,context){value||(value=this.comparator);var iterator=_.isFunction(value)?value:function(model){return model.get(value)};return _.sortedIndex(this.models,model,iterator,context)},pluck:function(attr){return _.invoke(this.models,"get",attr)},fetch:function(options){options=options?_.clone(options):{};if(options.parse===void 0)options.parse=true;var success=options.success;var collection=this;options.success=function(resp){var method=options.reset?"reset":"set";collection[method](resp,options);if(success)success(collection,resp,options);collection.trigger("sync",collection,resp,options)};wrapError(this,options);return this.sync("read",this,options)},create:function(model,options){options=options?_.clone(options):{};if(!(model=this._prepareModel(model,options)))return false;if(!options.wait)this.add(model,options);var collection=this;var success=options.success;options.success=function(resp){if(options.wait)collection.add(model,options);if(success)success(model,resp,options)};model.save(null,options);return model},parse:function(resp,options){return resp},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(attrs,options){if(attrs instanceof Model){if(!attrs.collection)attrs.collection=this;return attrs}options||(options={});options.collection=this;var model=new this.model(attrs,options);if(!model._validate(attrs,options)){this.trigger("invalid",this,attrs,options);return false}return model},_removeReference:function(model){if(this===model.collection)delete model.collection;model.off("all",this._onModelEvent,this)},_onModelEvent:function(event,model,collection,options){if((event==="add"||event==="remove")&&collection!==this)return;if(event==="destroy")this.remove(model,options);if(model&&event==="change:"+model.idAttribute){delete this._byId[model.previous(model.idAttribute)];if(model.id!=null)this._byId[model.id]=model}this.trigger.apply(this,arguments)}});var methods=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];_.each(methods,function(method){Collection.prototype[method]=function(){var args=slice.call(arguments);args.unshift(this.models);return _[method].apply(_,args)}});var attributeMethods=["groupBy","countBy","sortBy"];_.each(attributeMethods,function(method){Collection.prototype[method]=function(value,context){var iterator=_.isFunction(value)?value:function(model){return model.get(value)};return _[method](this.models,iterator,context)}});var View=Backbone.View=function(options){this.cid=_.uniqueId("view");this._configure(options||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var delegateEventSplitter=/^(\S+)\s*(.*)$/;var viewOptions=["model","collection","el","id","attributes","className","tagName","events"];_.extend(View.prototype,Events,{tagName:"div",$:function(selector){return this.$el.find(selector)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();this.stopListening();return this},setElement:function(element,delegate){if(this.$el)this.undelegateEvents();this.$el=element instanceof Backbone.$?element:Backbone.$(element);this.el=this.$el[0];if(delegate!==false)this.delegateEvents();return this},delegateEvents:function(events){if(!(events||(events=_.result(this,"events"))))return this;this.undelegateEvents();for(var key in events){var method=events[key];if(!_.isFunction(method))method=this[events[key]];if(!method)continue;var match=key.match(delegateEventSplitter);var eventName=match[1],selector=match[2];method=_.bind(method,this);eventName+=".delegateEvents"+this.cid;if(selector===""){this.$el.on(eventName,method)}else{this.$el.on(eventName,selector,method)}}return this},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid);return this},_configure:function(options){if(this.options)options=_.extend({},_.result(this,"options"),options);_.extend(this,_.pick(options,viewOptions));this.options=options},_ensureElement:function(){if(!this.el){var attrs=_.extend({},_.result(this,"attributes"));if(this.id)attrs.id=_.result(this,"id");if(this.className)attrs["class"]=_.result(this,"className");var $el=Backbone.$("<"+_.result(this,"tagName")+">").attr(attrs);this.setElement($el,false)}else{this.setElement(_.result(this,"el"),false)}}});Backbone.sync=function(method,model,options){var type=methodMap[method];_.defaults(options||(options={}),{emulateHTTP:Backbone.emulateHTTP,emulateJSON:Backbone.emulateJSON});var params={type:type,dataType:"json"};if(!options.url){params.url=_.result(model,"url")||urlError()}if(options.data==null&&model&&(method==="create"||method==="update"||method==="patch")){params.contentType="application/json";params.data=JSON.stringify(options.attrs||model.toJSON(options))}if(options.emulateJSON){params.contentType="application/x-www-form-urlencoded";params.data=params.data?{model:params.data}:{}}if(options.emulateHTTP&&(type==="PUT"||type==="DELETE"||type==="PATCH")){params.type="POST";if(options.emulateJSON)params.data._method=type;var beforeSend=options.beforeSend;options.beforeSend=function(xhr){xhr.setRequestHeader("X-HTTP-Method-Override",type);if(beforeSend)return beforeSend.apply(this,arguments)}}if(params.type!=="GET"&&!options.emulateJSON){params.processData=false}if(params.type==="PATCH"&&window.ActiveXObject&&!(window.external&&window.external.msActiveXFilteringEnabled)){params.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")}}var xhr=options.xhr=Backbone.ajax(_.extend(params,options));model.trigger("request",model,xhr,options);return xhr};var methodMap={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};Backbone.ajax=function(){return Backbone.$.ajax.apply(Backbone.$,arguments)};var Router=Backbone.Router=function(options){options||(options={});if(options.routes)this.routes=options.routes;this._bindRoutes();this.initialize.apply(this,arguments)};var optionalParam=/\((.*?)\)/g;var namedParam=/(\(\?)?:\w+/g;var splatParam=/\*\w+/g;var escapeRegExp=/[\-{}\[\]+?.,\\\^$|#\s]/g;_.extend(Router.prototype,Events,{initialize:function(){},route:function(route,name,callback){if(!_.isRegExp(route))route=this._routeToRegExp(route);if(_.isFunction(name)){callback=name;name=""}if(!callback)callback=this[name];var router=this;Backbone.history.route(route,function(fragment){var args=router._extractParameters(route,fragment);callback&&callback.apply(router,args);router.trigger.apply(router,["route:"+name].concat(args));router.trigger("route",name,args);Backbone.history.trigger("route",router,name,args)});return this},navigate:function(fragment,options){Backbone.history.navigate(fragment,options);return this},_bindRoutes:function(){if(!this.routes)return;this.routes=_.result(this,"routes");var route,routes=_.keys(this.routes);while((route=routes.pop())!=null){this.route(route,this.routes[route])}},_routeToRegExp:function(route){route=route.replace(escapeRegExp,"\\$&").replace(optionalParam,"(?:$1)?").replace(namedParam,function(match,optional){return optional?match:"([^/]+)"}).replace(splatParam,"(.*?)");return new RegExp("^"+route+"$")},_extractParameters:function(route,fragment){var params=route.exec(fragment).slice(1);return _.map(params,function(param){return param?decodeURIComponent(param):null})}});var History=Backbone.History=function(){this.handlers=[];_.bindAll(this,"checkUrl");if(typeof window!=="undefined"){this.location=window.location;this.history=window.history}};var routeStripper=/^[#\/]|\s+$/g;var rootStripper=/^\/+|\/+$/g;var isExplorer=/msie [\w.]+/;var trailingSlash=/\/$/;History.started=false;_.extend(History.prototype,Events,{interval:50,getHash:function(window){var match=(window||this).location.href.match(/#(.*)$/);return match?match[1]:""},getFragment:function(fragment,forcePushState){if(fragment==null){if(this._hasPushState||!this._wantsHashChange||forcePushState){fragment=this.location.pathname;var root=this.root.replace(trailingSlash,"");if(!fragment.indexOf(root))fragment=fragment.substr(root.length)}else{fragment=this.getHash()}}return fragment.replace(routeStripper,"")},start:function(options){if(History.started)throw new Error("Backbone.history has already been started");History.started=true;this.options=_.extend({},{root:"/"},this.options,options);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var fragment=this.getFragment();var docMode=document.documentMode;var oldIE=isExplorer.exec(navigator.userAgent.toLowerCase())&&(!docMode||docMode<=7);this.root=("/"+this.root+"/").replace(rootStripper,"/");if(oldIE&&this._wantsHashChange){this.iframe=Backbone.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(fragment)}if(this._hasPushState){Backbone.$(window).on("popstate",this.checkUrl)}else if(this._wantsHashChange&&"onhashchange"in window&&!oldIE){Backbone.$(window).on("hashchange",this.checkUrl)}else if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval)}this.fragment=fragment;var loc=this.location;var atRoot=loc.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!atRoot){this.fragment=this.getFragment(null,true);this.location.replace(this.root+this.location.search+"#"+this.fragment);return true}else if(this._wantsPushState&&this._hasPushState&&atRoot&&loc.hash){this.fragment=this.getHash().replace(routeStripper,"");this.history.replaceState({},document.title,this.root+this.fragment+loc.search)}if(!this.options.silent)return this.loadUrl()},stop:function(){Backbone.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);History.started=false},route:function(route,callback){this.handlers.unshift({route:route,callback:callback})},checkUrl:function(e){var current=this.getFragment();if(current===this.fragment&&this.iframe){current=this.getFragment(this.getHash(this.iframe))}if(current===this.fragment)return false;if(this.iframe)this.navigate(current);this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(fragmentOverride){var fragment=this.fragment=this.getFragment(fragmentOverride);var matched=_.any(this.handlers,function(handler){if(handler.route.test(fragment)){handler.callback(fragment);return true}});return matched},navigate:function(fragment,options){if(!History.started)return false;if(!options||options===true)options={trigger:options};fragment=this.getFragment(fragment||"");if(this.fragment===fragment)return;this.fragment=fragment;var url=this.root+fragment;if(this._hasPushState){this.history[options.replace?"replaceState":"pushState"]({},document.title,url)}else if(this._wantsHashChange){this._updateHash(this.location,fragment,options.replace);if(this.iframe&&fragment!==this.getFragment(this.getHash(this.iframe))){if(!options.replace)this.iframe.document.open().close();this._updateHash(this.iframe.location,fragment,options.replace)}}else{return this.location.assign(url)}if(options.trigger)this.loadUrl(fragment)},_updateHash:function(location,fragment,replace){if(replace){var href=location.href.replace(/(javascript:|#).*$/,"");location.replace(href+"#"+fragment)}else{location.hash="#"+fragment}}});Backbone.history=new History;var extend=function(protoProps,staticProps){var parent=this;var child;if(protoProps&&_.has(protoProps,"constructor")){child=protoProps.constructor}else{child=function(){return parent.apply(this,arguments)}}_.extend(child,parent,staticProps);var Surrogate=function(){this.constructor=child};Surrogate.prototype=parent.prototype;child.prototype=new Surrogate;if(protoProps)_.extend(child.prototype,protoProps);child.__super__=parent.prototype;return child};Model.extend=Collection.extend=Router.extend=View.extend=History.extend=extend;var urlError=function(){throw new Error('A "url" property or function must be specified')};var wrapError=function(model,options){var error=options.error;options.error=function(resp){if(error)error(model,resp,options);model.trigger("error",model,resp,options)}}}).call(this);(function(root,factory){root=root||global;if(root.EVENTS_NO_REQUIRE){root.Events=factory();return}if(typeof exports==="object"){module.exports.Events=factory()}else if(typeof define==="function"&&define.amd){define(function(){return{Events:factory()}})}else{root.Events=factory()}})(this,function(){var use_dom=false,pseudo_regex=/([^:]+)(?:\:([^(]*)(?:\((.*)\))?)?/,addEvent,addEvents,fireEvent,removeEvent,addEventOnce,Events,fireLatchedEvent;try{use_dom=document&&"addEventListener"in document}catch(e){}function indexOf(arr,prop){if(arr.indexOf)return arr.indexOf(prop);else return String.prototype.indexOf(arr,prop)}function warn(error){if(Events.strict){throw new Error(error)}else if("console"in window){if(console.error)console.error(error);else if(console.warn)console.warn(error);else console.log(error)}}function removeOn(string){return string.replace(/^on([A-Z])/,function(full,first){return first.toLowerCase()})}function getPseudo(string){var match=string.match(pseudo_regex);if(string.split(":").length>2)warn("Library does not support multiple pseudo events");return{name:match[1],pseudo:match[2],args:match[3]}}function processType(type){return getPseudo(removeOn(type))}function createEvent(type,dis,args,bubbles){var ev;if(use_dom){ev=document.createEvent("UIEvents");ev.initUIEvent(type,bubbles,true,window,1)}else{ev={}}ev.dispatcher=dis;ev.args=args;ev.object_event=true;return ev}Events=function Events(el,no_destroy){var $this=this,alias,destroy_names="$event_element $latched $events $once addEvent addEvents fireEvent removeEvent addEventOnce fireLatchedEvent".split(" ");if(!use_dom){this.$events={}}else{this.$event_element=el||document.createElement("events")}this.$has_events=true;this.$latched={};this.$once={};this.addEvent=addEvent;this.addEvents=addEvents;this.fireEvent=fireEvent;this.removeEvent=removeEvent;this.addEventOnce=addEventOnce;this.fireLatchedEvent=fireLatchedEvent;for(alias in Events.aliases){this[alias]=this[Events.aliases[alias]];destroy_names.push(alias)}if(!no_destroy)this.addEvent("destroy:delay(0)",function(){var i,name;if($this.$no_ev_destroy)return;for(i=0;name=destroy_names[i];i++)$this[name]=null;$this.$events_destroyed=true})};Events.removeOn=removeOn;Events.getPseudos=getPseudo;Events.processType=processType;Events.createEvent=createEvent;Events.strict=false;Events.aliases={on:"addEvent",addListener:"addEvent",once:"addEventOnce",removeListener:"removeEvent",off:"removeEvent",emit:"fireEvent"};Events.Pseudoes={once:{addEvent:function(type,fn){return this.addEventOnce(type,fn)}},latched:{fireEvent:function(type,args){return this.fireLatchedEvent(type,args)}},times:{addEvent:function(type,fn,ammount){var count=0,$this=this;this.addEvent(type,function times(){fn.apply(null,arguments);count+=1;if(count==ammount)$this.removeEvent(type,times)})}},delay:{addEvent:function(type,fn,delay){this.addEvent(type,function(){setTimeout(fn,delay)})},fireEvent:function(type,args,delay){var $this=this;setTimeout(function(){$this.fireEvent(type,args)},delay)}}};function register(obj,type,fn){if(use_dom){obj.$event_element.addEventListener(type,fn,false)}else{if(!obj.$events[type])obj.$events[type]=[fn];else if(indexOf(obj.$events[type],fn)==-1){obj.$events[type].push(fn)}}}function dispatch(obj,type,ev){var i,fn;if(use_dom){obj.$event_element.dispatchEvent(ev)}else{if(!obj.$events[type])return;for(i=0;fn=obj.$events[type][i];i++){fn.apply(null,[ev])}}}function remove(obj,type,fn){var index;if(use_dom){obj.$event_element.removeEventListener(type,fn,false)}else{if(!obj.$events[type])return;index=indexOf(obj.$events[type],fn);if(index<0)return;obj.$events[type].splice(index,1)}}addEvent=function addEvent(type,fn){if(this.$events_destroyed)return this;var data=processType(type),pseudo_fn=Events.Pseudoes[data.pseudo]&&Events.Pseudoes[data.pseudo].addEvent,args=this.$latched[data.name]&&this.$latched[data.name].args,ev;if(pseudo_fn){return pseudo_fn.apply(this,[data.name,fn,data.args])}register(this,data.name,fn);if(this.$latched&&this.$latched[data.name]){ev=createEvent(data.name,this,args);fn.apply(null,[ev])}return this};addEvents=function addEvents(events){if(this.$events_destroyed)return this;var type;for(type in events)if(events.hasOwnProperty(type)){this.addEvent(type,events[type])}return this};fireEvent=function fireEvent(type,args,bubbles){if(this.$events_destroyed)return this;var data=processType(type),pseudo_fn=Events.Pseudoes[data.pseudo]&&Events.Pseudoes[data.pseudo].fireEvent,ev,fn,once_arr,temp_arr;if(bubbles==null)bubbles=true;if(pseudo_fn){return pseudo_fn.call(this,data.name,args)}once_arr=this.$once[data.name];this.$once[data.name]=null;ev=createEvent(data.name,this,args,bubbles);dispatch(this,data.name,ev);if(!once_arr)return this;while(fn=once_arr.pop()){this.removeEvent(data.name,fn,true)}return this};removeEvent=function removeEvent(type,fn,no_once){if(this.$events_destroyed)return this;var data=processType(type),index;remove(this,data.name,fn);if(!no_once&&this.$once[data.name]&&(index=indexOf(this.$once[data.name],fn))>-1){this.$once[data.name].splice(index,1)}return this};addEventOnce=function addEventOnce(type,fn){if(this.$events_destroyed)return this;var $this=this,data=processType(type);if(!this.$once[data.name])this.$once[data.name]=[];if(indexOf(this.$once[data.name],fn)==-1){this.$once[data.name].push(fn)}return this.addEvent(data.name,fn)};fireLatchedEvent=function fireLatchedEvent(type,args){if(this.$events_destroyed)return this;if(!this.$latched)this.$latched={};this.$latched[type]={args:args};this.fireEvent(type,args);return this};Events.addEvent=addEvent;Events.addEvents=addEvents;Events.addEventOnce=addEventOnce;Events.fireEvent=fireEvent;Events.fireLatchedEvent=fireLatchedEvent;Events.removeEvent=removeEvent;Events.processType=processType;return Events});(function($){var mixins={};function $parent(name,args){if(!this.$parent_stack){this.$parent_stack={}}var old=this.$parent_stack[name];if(!old){this.$parent_stack[name]=this.constructor.__super__}else{this.$parent_stack[name]=old.constructor?old.constructor.__super__:null}var result=this.$parent_stack[name][name].apply(this,args||[]);this.$parent_stack[name]=old;return result}var View=Backbone.View.extend({mixins:null,do_render:true,_namespace:"",initialize:function(){if(this.mixins){this._applyMixins()}if(this._namespace){this._attachNamespace()}if(!this.$generated&&this.do_render)this.render();if(this.init)this.init();if(!this.$attached)this.addListeners()},$parent:$parent,render:function(){this.$generated=true},addListeners:function(){this.$attached=true;if(this.Eggshell){this.Eggshell.on("destroy",this.destroy.bind(this))}return this},_applyMixins:function(){var i,name;for(i=0;name=this.mixins[i];i++){if(mixins[name])mixins[name].call(this);else if(name.call)name.call(this);else console.warn("Trying to apply undefined mixin: "+name)}},_attachNamespace:function(){var definition=Eggshell.getDefinition(this._namespace),actions={},shell=this.Eggshell,$this=this;function empty(){}function bind(key){if(actions[key])return;var name=$.camelCase(key.replace(/ /g,"-")),method=$this[name]?$this[name].bind($this):empty;shell.on(key,method);actions[key]=true}function add(list){var key,i;if(list instanceof Array){for(i=0;key=list[i];i++){bind(key)}}else{for(key in list){bind(key)}}}if(definition&&definition.config.inputs)add(definition.config.inputs)},destroy:function(){}});View.registerMixin=function(name,mixin){mixins[name]=mixin};C.define=function(ns,config,props){props._namespace=ns;Eggshell.define(ns,config,View.extend(props));return ns};View.$parent=$parent;View.mixins=mixins;C.CheggView=View})(window.Zepto||window.jQuery);(function(){C.CheggView.registerMixin("Attacher",function(){var events=[];this.attach=function attach(target,name,ns,fn){if(!target.on)target=$(target);if(!fn){target.on(name,ns)}else{target.on(name,ns,fn)}events.push({target:target,name:name,ns:ns,fn:fn});return this};function dettach(){var i,def;for(i=0;def=events[i];i++){if(!def.fn){def.target.off(def.name,def.ns)}else{def.target.off(def.name,def.ns,def.fn)}}events=null}if(this.Eggshell)this.Eggshell.on("destroy",dettach);this.dettach=dettach})})(window.Zepto||window.jQuery);(function(){C.CheggView.registerMixin("$parent",function(){this.$parent=C.CheggView.$parent})})();C.CheggView.registerMixin("Options",function(){this.setOptions=function(opts){function clone(target,opts){var key;for(key in target){if(!opts.hasOwnProperty(key)||!target.hasOwnProperty(key))continue;if(typeof opts[key]=="object"){clone(target[key],opts[key])}else{target[key]=opts[key]}}}clone(this.options,opts);return this}});C.CheggView.registerMixin("Generator",function(){var elements=this["generator:elements"],data=_.result(this,"generator:getData"),template=this["generator:template"],html=typeof template=="function"?template.call(this,data):template,name;if(html)this.element=$(html);if(elements&&this.element){this.elements={};for(name in elements){this.elements[name]=$(elements[name],this.element)}}if(!this.Eggshell)return;this.Eggshell.on("destroy",function once(){this.Eggshell.off("destroy",once);if(this.element)this.element.remove();this.elements={}}.bind(this))});C.CheggView.registerMixin("Bind",function(){var i,fn;this.bound=function(name){
if(!this.bound[name]){try{this.bound[name]=this[name].bind(this)}catch(e){utils.warn("Trying to bind undefined method "+name);return}}return this.bound[name]};if(!this.bind)return;for(i=0;fn=this.bind[i];i++){this.bound(fn)}});C.CheggView.registerMixin("Validator",function(){this.defaultOptions={onkeyup:false,onfocusout:false,onclick:false,onsubmit:false};var element=_.result(this,"validator:element")||this.element;this.opt=this["validator:options"];this.opt=$.extend(this.defaultOptions,this.opt);this.validator=element.validate(this.opt);this.setElementRules=function(elm,rules){elm.rules("add",rules)};this.showErrors=function(error){this.validator.showErrors(error)};this.runValidator=function(){return element.valid()};if(!this.Eggshell)return;this.Eggshell.on("destroy",function once(){this.Eggshell.off("destroy",once)}.bind(this))});Eggshell.define("C.report.GA",{inputs:["submit custom command","report custom event","report","register"],outputs:["custom command sent","custom report sent"],singleton:true,immueToDestroyAll:true},function(events){var eventMapping=!!events?events:[];var shell=Eggshell.find(this);var gaqEnabled=false;var commandsQueue=[];var interval=setInterval($.proxy(function(){if(typeof ga=="undefined"){gaqEnabled=false}else{gaqEnabled=true;clearInterval(interval);for(var i=0,len=commandsQueue.length;i<len;i++){processCommand(commandsQueue[i][0],commandsQueue[i][1])}commandsQueue=[]}},this),1e3);var processCommand=function(type,payload){if(!gaqEnabled){commandsQueue.push([null,payload]);return""}var commandArgs=_.isArray(payload)?payload:[payload];ga.apply(null,commandArgs);var action="event"==type?"custom report sent":"custom command sent";var callback=$.proxy(function(){this.trigger(action,payload)},shell);ga(callback)};var submitCustomCommand=function(event,payload){processCommand(null,payload)};var reportCustomEvent=function(event,payload){processCommand("event",["send","event",payload.page,payload.section,payload.link])};var report=function(event){if(event.action==="register"){return}var channel=event.channel;var action=event.action;var reportData=null;if(!!eventMapping&&!!eventMapping[channel]&&!!eventMapping[channel][action]){reportData=eventMapping[channel][action];processCommand("event",["send","event",reportData.page,reportData.section,reportData.link]);return}var shell=Eggshell.find(channel);if(shell&&shell.getClass()){channel=shell.getClass();if(!!eventMapping&&!!eventMapping[channel]&&!!eventMapping[channel][action]){reportData=eventMapping[channel][action];processCommand("event",["send","event",reportData.page,reportData.section,reportData.link]);return}}};var registerMapping=function(event,payload){var events=payload;if(!!events){for(var namespace in events){var nsEvents=events[namespace];for(var action in nsEvents){var mapping=nsEvents[action];if(!eventMapping[namespace]){eventMapping[namespace]={}}eventMapping[namespace][action]=mapping}}}};Eggshell.on("*","*",report,this);Eggshell.find(this).on("submit custom command",submitCustomCommand).on("report",report).on("report custom event",reportCustomEvent).on("register",registerMapping);return{}});Eggshell.module("Factory",["Logger","DefinitionRegistry","Api"],function(Logger,DefinitionRegistry,Api){Eggshell.loader.setFactory({escapeCss:function(name){name=name.replace(/[!\"#$%&'\(\)\*\+,\.\/:;<=>\?\@\[\\\]\^`\{\|\}~]/g,"-");return name},instantiate:function(id,clazz,constructor,attributes){if(typeof attributes!="object")attributes={};var definition=DefinitionRegistry.get(clazz);if(attributes.createSafeDomContainer!==false&&attributes.newNode!==false&&(definition===null||definition&&definition.config===null||definition&&definition.config&&definition.config.newNode!==false)){if(!attributes.el){attributes.el=$("body")}if(!attributes.el.jquery){attributes.el=$(attributes.el)}if(attributes.el.jquery){attributes.el=$.extend({},attributes.el)}if(attributes.el.attr("id")!=this.escapeCss(id)){attributes.el=$("<div/>").appendTo(attributes.el)}attributes.el.attr("id",this.escapeCss(id));attributes.el.addClass(this.escapeCss(clazz));if(attributes.className){attributes.el.addClass(attributes.className)}}else{if(attributes.el){if(!attributes.el.jquery){attributes.el=$(attributes.el)}attributes.el.attr("id",this.escapeCss(id));attributes.el.addClass(this.escapeCss(clazz));if(attributes.className){attributes.el.addClass(attributes.className)}}}if(attributes.shell){attributes.shell}var component=new constructor(attributes);if(component&&component.Eggshell){component.Eggshell.listen("show",function(){if(this.$el)this.$el.show()});component.Eggshell.listen("hide",function(){if(this.$el)this.$el.hide()});component.Eggshell.on("track impression",function(){this.component.activityTracking={};this.component.activityTracking.$el=this.el;this.component.activityTracking.isSeen=false;this.component.activityTracking.scrollDetector=Eggshell.create("C.Eggshell.window.scroll.tracker");this.component.activityTracking.scrollDetected=$.proxy(function(){if(this.el.height()>0){if(this.el.offset().top+Math.floor(this.el.height()/2)>=window.pageYOffset&&this.el.offset().top+Math.floor(this.el.height()/2)<window.pageYOffset+$(window).height()){this.component.activityTracking.scrollDetector.off("scrolled",this.component.activityTracking.scrollDetected,this);Eggshell.find(this.component).trigger("impression fired")}}},this);this.component.activityTracking.scrollDetector.on("scrolled",this.component.activityTracking.scrollDetected,this);setTimeout(this.component.activityTracking.scrollDetected,1)},{component:component,el:attributes.el})}return component},destroy:function(id,component){if(component.unbind){component.unbind()}if(component.model&&component.model.unbind){component.model.unbind();delete this.model}if(component.collection&&component.collection.unbind){component.collection.unbind();delete this.collection}if(component.remove){component.remove()}if(this.$el){delete this.$el}if(this.el){delete this.el}$("#"+this.escapeCss(id)).remove()}})});Eggshell.define("C.eggshell.component.ajax.client",{inputs:["push","flush all"],outputs:[],singleton:true},function(){var context=this;var ajaxQueue={};var ajaxCache={};var flushAjaxQueue=function(key){for(var x=0;x<ajaxQueue[key].length;x++){delete ajaxQueue[key][x]}ajaxQueue[key]=[]};var validate=function(settings){if(!settings){throw"Empty payload."}if(typeof settings.url!="string"||!settings.url){throw"Invalid URL."}};var generateKey=function(settings){var key="";if(settings.type){key=settings.type}key+=settings.url;if(key[key.length-1]!="?"){key+="?"}if(settings.data){for(var param in settings.data){key+=param+"="+encodeURIComponent(settings.data[param])+"&"}}return key};var generateOutputPayload=function(settings,response,args){var payload={request:settings,response:response,arguments:args};return payload};var outputResponse=function(key,action,response,args){for(var x=0;x<ajaxQueue[key].length;x++){var settings=ajaxQueue[key][x];var payload=generateOutputPayload(settings,response,args);context.Eggshell.trigger(action,payload)}};var ajax=function(event,payload){var settings=payload;validate(settings);if(typeof settings.cache=="undefined"){settings.cache=true}var key=generateKey(settings);if(!ajaxQueue[key]){ajaxQueue[key]=[]}ajaxQueue[key].push(settings);if(settings.cache&&ajaxQueue[key].length>1){return}if(!!settings.cache&&!!ajaxCache[key]){outputResponse.call(context,key,"success",ajaxCache[key].response,[ajaxCache[key].response]);outputResponse.call(context,key,"ready",ajaxCache[key].response,[ajaxCache[key].response]);flushAjaxQueue(key);return}var noop=function(){};var ajaxSettings=$.extend({},settings,{done:noop,success:noop,fail:noop,error:noop,always:noop,complete:noop});var ajaxRequest=$.ajax($.extend({},ajaxSettings,{context:this}));ajaxRequest.done(function(){outputResponse.call(context,key,"success",arguments[0],arguments);outputResponse.call(context,key,"ready",arguments[0],arguments);flushAjaxQueue(key);if(settings.cache){ajaxCache[key]=generateOutputPayload(settings,arguments[0],arguments)}});ajaxRequest.fail(function(jqXHR,textStatus,errorThrown){outputResponse.call(context,key,"error",null,arguments);outputResponse.call(context,key,"ready",null,arguments);flushAjaxQueue(key)})};context.Eggshell.listen("ajax",ajax);context.Eggshell.listen("push",function(event,payload){if(!payload){throw"Invalid payload"}if(!payload.settings){throw"Invalid ajax settings"}if(!payload.response){throw"Invalid ajax response"}var settings=payload.settings;var response=payload.response;validate(settings);var key=generateKey(settings);ajaxCache[key]=generateOutputPayload(settings,response,null)});context.Eggshell.listen("flush all",function(event,payload){ajaxCache={}})});$.cjax=function(){var ajaxClientNS=Eggshell.create("C.eggshell.component.ajax.client");Eggshell.immuneToDestroyAll(ajaxClientNS);Eggshell.input(ajaxClientNS,"success",function(event,payload){var request=payload.request;var context=request.context;if(request.done){request.done.apply(context,payload.arguments)}else if(request.success){request.success.apply(context,payload.arguments)}});Eggshell.input(ajaxClientNS,"error",function(event,payload){var request=payload.request;var context=request.context;if(request.fail){request.fail.apply(context,payload.arguments)}else if(request.error){request.error.apply(context,payload.arguments)}});Eggshell.input(ajaxClientNS,"ready",function(event,payload){var request=payload.request;var context=request.context;if(request.always){request.always.apply(context,payload.arguments)}else if(request.complete){request.complete.apply(context,payload.arguments)}});return function(){var settings={};if(arguments.length==1){if(typeof arguments[0]=="string"){settings.url=arguments[0]}else{settings=arguments[0]}}else if(arguments.length==2){settings=arguments[1];settings.url=arguments[0]}if(!settings.context){settings.context=this}Eggshell.trigger(ajaxClientNS,"ajax",settings)}}();Eggshell.define("C.Eggshell.window.scroll.tracker",{outputs:["scrolled"],singleton:true},function(){$(window).scroll($.proxy(function(){this.Eggshell.trigger("scrolled")},this))});Eggshell.define("C.common.tracking",{inputs:{"enable automatic tracking":{},"disable automatic tracking":{},"push class matcher":{payload:"string"},"set page information":{payload:{page:{name:"string",namespace:"string"}}}},singleton:true,immueToDestroyAll:true},Backbone.Model.extend({initialize:function(){this.reset();Eggshell.find(this).on("reset",this.reset).on("push class matcher",this.pushClassMatcher,this).on("set page information",this.setPageInfo).on("enable automatic tracking",this.enable).on("disable automatic tracking",this.disable);Eggshell.on("*","*",this.track,this)},reset:function(){this.clear();this.set({enabled:true,"class":[]})},pushClassMatcher:function(event,payload){var matchers=this.get("class");matchers.push(payload);this.set("class",matchers)},setPageInfo:function(event,payload){this.set("page",payload)},enable:function(){this.set("enabled",true)},disable:function(){this.set("enabled",false)},track:function(event,payload){if(!this.get("enabled")){return}var action=event.action;if(action.indexOf("clicked")>=0||action.indexOf("focused")>=0||action.indexOf("blurred")>=0){var module=event.namespace;if(module){var id=event.namespace;var shell=Eggshell.shell(id);var clazz=shell.getConstructorNamespace();var matchers=this.get("class");for(var x=0;x<matchers.length;x++){if(clazz.indexOf(matchers[x])>=0){if(clazz===matchers[x]){clazz=clazz.substr(clazz.lastIndexOf(".")+1)}else{clazz=clazz.replace(matchers[x]+".","")}clazz=clazz.replace(/\./g," ");clazz=clazz.charAt(0).toUpperCase()+clazz.slice(1);var page=this.get("page")&&this.get("page").name?this.get("page").name:$("title").html();var section=clazz;var link=action;Eggshell.create("C.report.GA").trigger("report custom event",{page:page,section:section,link:link});break}}}}}}));(function(window,C){var adobeAnalytics=function(){this.init=function(){if(typeof window.digitalData==="undefined"){window.digitalData={}}};this.setData=function(key,value){function defineProperty(key,value){var i,keys=key.split("."),obj=window.digitalData,last,last_key;for(i=0;i<keys.length;i++){var _key=keys[i];last=obj;last_key=_key;if(!obj[_key]){obj=obj[_key]={}}else if(typeof obj[_key]==="object"){obj=obj[_key]}}if(value!==undefined){last[last_key]=value}else{delete last[last_key]}return window.digitalData}function parsePolite(obj){try{obj=JSON.parse(obj)}catch(e){}return obj}if(!key){return}if(arguments.length>1){defineProperty(key,parsePolite(value))}else{window.digitalData=parsePolite(key)}};this.removeKey=function(key){this.setData(key,undefined)};this.track=function(name,pageBottom){if(name){try{name=JSON.parse(name)}catch(e){if(typeof name==="string"){name=[name]}}if(typeof _satellite!=="undefined"){for(i=0;i<name.length;i++){_satellite.track(name[i])}}}};this.log=function(msg,logLevel){if(typeof _satellite!=="undefined"){_satellite.notify(msg,logLevel)}};this.init()};C.adobeAnalytics=new adobeAnalytics})(window,C);if(!C.resource){C.resource=function(){var Locale=function(language,country,variant){if(!language||typeof language!=="string"){throw"Invalid language"}if(!country||typeof country!=="string"){throw"Invalid country"}if(!variant){variant=""}this.toString=function(){var localeStr=language.toLowerCase()+"-"+country.toUpperCase();if(variant){localeStr+="-"+variant}return localeStr}};var Messages=function(){var messages={};this.add=function(key,message){if(!key||typeof key!=="string"){throw"Invalid key"}if(!message||typeof message!=="string"){throw"Invalid message"}messages[key]=message};this.remove=function(key){if(!key||typeof key!=="string"){throw"Invalid key"}delete messages[key]};this.fetch=function(key){if(!key||typeof key!=="string"){throw"Invalid key"}return messages[key]};this.fetchAll=function(){return messages}};var debug=false;var defaultLocale=new Locale("en","US");var messageBundles={};var setDebug=function(enable){debug=!!enable};var setDefaultLocale=function(locale){if(!locale instanceof Locale){throw"Invalid locale"}defaultLocale=locale;if(debug){console.log("default locale registered",locale)}};var getDefaultLocale=function(){return defaultLocale};var addMessage=function(){var locale,key,message,messages=null;if(arguments.length==1&&typeof arguments[0]==="object"){for(var key in arguments[0]){var message=arguments[0][key];addMessage(key,message)}return}else if(arguments.length==2&&typeof arguments[1]==="object"){locale=arguments[0];if(!locale){throw"Invalid locale"}for(var key in arguments[1]){var message=arguments[1][key];addMessage(locale,key,message)}return}else if(arguments.length==2){locale=getDefaultLocale();key=arguments[0];message=arguments[1]}else if(arguments.length==3){locale=arguments[0];key=arguments[1];message=arguments[2]}else{throw"Invalid arguments"}if(!locale){throw"Invalid locale"}if(!key||typeof key!=="string"){throw"Invalid key"}if(!message||typeof message!=="string"){throw"Invalid message"}if(!messageBundles[locale.toString()]){messageBundles[locale.toString()]=new Messages}messageBundles[locale.toString()].add(key,message);if(debug){console.log("message added",locale.toString(),key,message)}};var fetchMessage=function(){var locale,key,message=null,placeholders=[];if(arguments.length==1){locale=getDefaultLocale();key=arguments[0]}else if(arguments.length==2){if(arguments[0]instanceof Locale){locale=arguments[0];key=arguments[1]}else{locale=getDefaultLocale();key=arguments[0];placeholders=arguments[1]}}else if(arguments.length==3){locale=arguments[0];key=arguments[1];placeholders=arguments[2]}else{throw"Invalid arguments"}if(!locale){throw"Invalid locale"}if(!key||typeof key!=="string"){throw"Invalid key"}if(messageBundles[locale.toString()]){message=messageBundles[locale.toString()].fetch(key)}if(placeholders){_.each(placeholders,function(placeholder,index){message=message.replace("{"+index+"}",placeholder)},this)}if(debug){console.log("message fetched",locale.toString(),key,message)}return message};var toJSON=function(){var locale=getDefaultLocale();if(arguments.length==1){locale=arguments[0]}if(messageBundles[locale.toString()]){return messageBundles[locale.toString()].fetchAll()}else{return{}}};return{Locale:Locale,setDebug:setDebug,setDefaultLocale:setDefaultLocale,getDefaultLocale:getDefaultLocale,add:addMessage,fetch:fetchMessage,toJSON:toJSON}}()}(function(c){c=c||{};var valid=["debug","info","warn","error","assert","clear","dir","dirxml","trace","group","groupCollapsed","groupEnd","time","timeEnd","profile","profileEnd","count","exception","table"];for(var i=0;i<valid.length;i++){c[valid[i]]=c[valid[i]]||function(){}}var params=C.utility.getParams();for(var prop in params){if(prop=="profile")C("global").profile=1}if(C("global").profile){console.profile("Global package profiler")}})(window.console);C("support");C.support.touch="ontouchstart"in document.documentElement;C.support.placeholder=C.utility.attrSupportedByEl("input","placeholder");(function(){var value="rgba(1,1,1,0.5)",pel=document.createElement("p"),result;try{pel.style.color=value}catch(e){}C.support.rgba=/^rgba/.test(pel.style.color);pel=null;C.support.util={moved:false,slideRight:false,slideLeft:false,resetTouch:function(){C.support.util.moved=false;C.support.util.slideRight=false;C.support.util.slideLeft=false;C.support.util.startX=0;C.support.util.startY=0;C.support.util.diffX=0;C.support.util.diffY=0;C.support.util.changeX=0;C.support.util.changeY=0},onTouchMove:function(e){var touch=e.originalEvent.touches[0];C.support.util.diffX=touch.clientX-C.support.util.startX;C.support.util.diffY=touch.clientY-C.support.util.startY;C.support.util.changeX=Math.abs(C.support.util.diffX);C.support.util.changeY=Math.abs(C.support.util.diffY);if(C.support.util.changeX>15||C.support.util.changeY>15){C.support.util.moved=true}if(C.support.util.diffX>60&&C.support.util.changeY<50){C.support.util.slideRight=true}else if(C.support.util.diffX<-60&&C.support.util.changeY<50){C.support.util.slideLeft=true}else{C.support.util.slideRight=false;C.support.util.slideLeft=false}},onTouchStart:function(e){var touch=e.originalEvent.touches[0];C.support.util.resetTouch();C.support.util.startX=touch.clientX;C.support.util.startY=touch.clientY}};C.support.util.resetTouch();$("body").on("touchstart",C.support.util.onTouchStart).on("touchmove",C.support.util.onTouchMove)})();(function(){var map={},jsProp,cssProp,prop,prefix,isVendor,cssRegex;for(var supported in document.body.style){isVendor=supported.match(/^(webkit|Moz|O|ms)/);jsProp=supported;if(isVendor){if(!prefix){prefix=isVendor[0]?isVendor[0].toLowerCase():null;cssRegex=new RegExp("/-"+prefix+"-/","g")}cssProp=("-"+supported.replace(/([A-Z])/g,function($1){return"-"+$1}).toLowerCase()).replace("--","-");prop=cssProp.replace("-"+prefix+"-","")}else{jsProp=supported;cssProp=supported.replace(/([A-Z])/g,function($1){return"-"+$1}).toLowerCase();prop=cssProp}if(!map[prop]){if(prop in document.body.style&&(jsProp!=prop||cssProp!=prop)){continue}map[prop]={css:cssProp,js:jsProp}}}$.fn._css=$.fn.css;$.fn.css=function(){if(arguments.length){if(Object.prototype.toString.call(arguments[0])=="[object Object]"){for(var prop in arguments[0]){if(Object.prototype.toString.call(arguments[0][prop])=="[object String]"){arguments[0][prop]=arguments[0][prop].replace(cssRegex,"")}if(map[prop]){if(map[prop].js!=prop){arguments[0][map[prop].js]=arguments[0][prop];delete arguments[0][prop]}}}}}return this._css.apply(this,arguments)}})();C("dom");C.dom.$window=$(window);C.dom.$html=$(document.documentElement);C.dom.$header=$(".chgg-hdr").length>0?$(".chgg-hdr"):$(".chg-header");C.dom.$headerRoot=$(".chg-hdr-root");C.dom.$content=$(".chg-content");C.dom.$nav=$(".chg-nav");C.dom.$body=$(document.body);C.dom.$root=$(".chg-root");C.dom.$container=$(".chg-container");C.dom.$navToggle=$(".icn-menu-toggle");(function(window,undefined){"use strict";var History=window.History=window.History||{},jQuery=window.jQuery;if(typeof History.Adapter!=="undefined"){throw new Error("History.js Adapter has already been loaded...")}History.Adapter={bind:function(el,event,callback){jQuery(el).bind(event,callback)},trigger:function(el,event,extra){jQuery(el).trigger(event,extra)},extractEventData:function(key,event,extra){var result=event&&event.originalEvent&&event.originalEvent[key]||extra&&extra[key]||undefined;return result},onDomLoad:function(callback){jQuery(callback)}};if(typeof History.init!=="undefined"){History.init()}})(window);(function(window,undefined){"use strict";var console=window.console||undefined,document=window.document,navigator=window.navigator,sessionStorage=false,setTimeout=window.setTimeout,clearTimeout=window.clearTimeout,setInterval=window.setInterval,clearInterval=window.clearInterval,JSON=window.JSON,alert=window.alert,History=window.History=window.History||{},history=window.history;JSON.stringify=JSON.stringify||JSON.encode;JSON.parse=JSON.parse||JSON.decode;if(typeof History.init!=="undefined"){throw new Error("History.js Core has already been loaded...")}History.init=function(){if(typeof History.Adapter==="undefined"){return false}if(typeof History.initCore!=="undefined"){History.initCore()}if(typeof History.initHtml4!=="undefined"){History.initHtml4()}return true};History.initCore=function(){if(typeof History.initCore.initialized!=="undefined"){return false}else{History.initCore.initialized=true}History.options=History.options||{};History.options.hashChangeInterval=History.options.hashChangeInterval||100;History.options.safariPollInterval=History.options.safariPollInterval||500;History.options.doubleCheckInterval=History.options.doubleCheckInterval||500;History.options.storeInterval=History.options.storeInterval||1e3;History.options.busyDelay=History.options.busyDelay||250;History.options.debug=History.options.debug||false;History.options.initialTitle=History.options.initialTitle||document.title;History.intervalList=[];History.clearAllIntervals=function(){var i,il=History.intervalList;if(typeof il!=="undefined"&&il!==null){for(i=0;i<il.length;i++){clearInterval(il[i])}History.intervalList=null}};History.debug=function(){if(History.options.debug||false){History.log.apply(History,arguments)}};History.log=function(){var consoleExists=!(typeof console==="undefined"||typeof console.log==="undefined"||typeof console.log.apply==="undefined"),textarea=document.getElementById("log"),message,i,n,args,arg;if(consoleExists){args=Array.prototype.slice.call(arguments);message=args.shift();if(typeof console.debug!=="undefined"){console.debug.apply(console,[message,args])}else{console.log.apply(console,[message,args])}}else{message="\n"+arguments[0]+"\n"}for(i=1,n=arguments.length;i<n;++i){arg=arguments[i];if(typeof arg==="object"&&typeof JSON!=="undefined"){try{arg=JSON.stringify(arg)}catch(Exception){}}message+="\n"+arg+"\n"}if(textarea){textarea.value+=message+"\n-----\n";textarea.scrollTop=textarea.scrollHeight-textarea.clientHeight}else if(!consoleExists){alert(message)}return true};History.getInternetExplorerMajorVersion=function(){var result=History.getInternetExplorerMajorVersion.cached=typeof History.getInternetExplorerMajorVersion.cached!=="undefined"?History.getInternetExplorerMajorVersion.cached:function(){var v=3,div=document.createElement("div"),all=div.getElementsByTagName("i");while((div.innerHTML="<!--[if gt IE "+ ++v+"]><i></i><![endif]-->")&&all[0]){}return v>4?v:false}();return result};History.isInternetExplorer=function(){var result=History.isInternetExplorer.cached=typeof History.isInternetExplorer.cached!=="undefined"?History.isInternetExplorer.cached:Boolean(History.getInternetExplorerMajorVersion());return result};History.emulated={pushState:!Boolean(window.history&&window.history.pushState&&window.history.replaceState&&!(/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(navigator.userAgent)||/AppleWebKit\/5([0-2]|3[0-2])/i.test(navigator.userAgent))),hashChange:Boolean(!("onhashchange"in window||"onhashchange"in document)||History.isInternetExplorer()&&History.getInternetExplorerMajorVersion()<8)};History.enabled=!History.emulated.pushState;History.bugs={setHash:Boolean(!History.emulated.pushState&&navigator.vendor==="Apple Computer, Inc."&&/AppleWebKit\/5([0-2]|3[0-3])/.test(navigator.userAgent)),safariPoll:Boolean(!History.emulated.pushState&&navigator.vendor==="Apple Computer, Inc."&&/AppleWebKit\/5([0-2]|3[0-3])/.test(navigator.userAgent)),ieDoubleCheck:Boolean(History.isInternetExplorer()&&History.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(History.isInternetExplorer()&&History.getInternetExplorerMajorVersion()<7)};History.isEmptyObject=function(obj){for(var name in obj){return false}return true};History.cloneObject=function(obj){var hash,newObj;if(obj){hash=JSON.stringify(obj);newObj=JSON.parse(hash)}else{newObj={}}return newObj};History.getRootUrl=function(){var rootUrl=document.location.protocol+"//"+(document.location.hostname||document.location.host);if(document.location.port||false){rootUrl+=":"+document.location.port}rootUrl+="/";return rootUrl};History.getBaseHref=function(){var baseElements=document.getElementsByTagName("base"),baseElement=null,baseHref="";if(baseElements.length===1){baseElement=baseElements[0];baseHref=baseElement.href.replace(/[^\/]+$/,"")}baseHref=baseHref.replace(/\/+$/,"");if(baseHref)baseHref+="/";return baseHref};History.getBaseUrl=function(){var baseUrl=History.getBaseHref()||History.getBasePageUrl()||History.getRootUrl();return baseUrl};History.getPageUrl=function(){var State=History.getState(false,false),stateUrl=(State||{}).url||document.location.href.replace(/#.*/,""),pageUrl;pageUrl=stateUrl.replace(/\/+$/,"").replace(/[^\/]+$/,function(part,index,string){return/\./.test(part)?part:part+"/"});return pageUrl};History.getBasePageUrl=function(){var basePageUrl=document.location.href.replace(/[#\?].*/,"").replace(/[^\/]+$/,function(part,index,string){return/[^\/]$/.test(part)?"":part}).replace(/\/+$/,"")+"/";return basePageUrl};History.getFullUrl=function(url,allowBaseHref){var fullUrl=url,firstChar=url.substring(0,1);allowBaseHref=typeof allowBaseHref==="undefined"?true:allowBaseHref;if(/[a-z]+\:\/\//.test(url)){}else if(firstChar==="/"){fullUrl=History.getRootUrl()+url.replace(/^\/+/,"")}else if(firstChar==="#"){fullUrl=History.getPageUrl().replace(/#.*/,"")+url}else if(firstChar==="?"){fullUrl=History.getPageUrl().replace(/[\?#].*/,"")+url}else{if(allowBaseHref){fullUrl=History.getBaseUrl()+url.replace(/^(\.\/)+/,"")}else{fullUrl=History.getBasePageUrl()+url.replace(/^(\.\/)+/,"")}}return fullUrl.replace(/\#$/,"")};History.getShortUrl=function(url){var shortUrl=url,baseUrl=History.getBaseUrl(),rootUrl=History.getRootUrl();if(History.emulated.pushState){shortUrl=shortUrl.replace(baseUrl,"")}shortUrl=shortUrl.replace(rootUrl,"/");if(History.isTraditionalAnchor(shortUrl)){shortUrl="./"+shortUrl}shortUrl=shortUrl.replace(/^(\.\/)+/g,"./").replace(/\#$/,"");return shortUrl};History.store={};History.idToState=History.idToState||{};History.stateToId=History.stateToId||{};History.urlToId=History.urlToId||{};History.storedStates=History.storedStates||[];History.savedStates=History.savedStates||[];History.normalizeStore=function(){History.store.idToState=History.store.idToState||{};History.store.urlToId=History.store.urlToId||{};History.store.stateToId=History.store.stateToId||{}};History.getState=function(friendly,create){if(typeof friendly==="undefined"){friendly=true}if(typeof create==="undefined"){create=true}var State=History.getLastSavedState();if(!State&&create){State=History.createStateObject()}if(friendly){State=History.cloneObject(State);State.url=State.cleanUrl||State.url}return State};History.getIdByState=function(newState){var id=History.extractId(newState.url),str;if(!id){str=History.getStateString(newState);if(typeof History.stateToId[str]!=="undefined"){id=History.stateToId[str]}else if(typeof History.store.stateToId[str]!=="undefined"){id=History.store.stateToId[str]}else{while(true){id=(new Date).getTime()+String(Math.random()).replace(/\D/g,"");if(typeof History.idToState[id]==="undefined"&&typeof History.store.idToState[id]==="undefined"){break}}History.stateToId[str]=id;History.idToState[id]=newState}}return id};History.normalizeState=function(oldState){var newState,dataNotEmpty;if(!oldState||typeof oldState!=="object"){oldState={}}if(typeof oldState.normalized!=="undefined"){return oldState}if(!oldState.data||typeof oldState.data!=="object"){oldState.data={}}newState={};newState.normalized=true;newState.title=oldState.title||"";newState.url=History.getFullUrl(History.unescapeString(oldState.url||document.location.href.replace(/#.*/,"")));newState.hash=History.getShortUrl(newState.url);newState.data=History.cloneObject(oldState.data);newState.id=History.getIdByState(newState);newState.cleanUrl=newState.url.replace(/\??\&_suid.*/,"");newState.url=newState.cleanUrl;dataNotEmpty=!History.isEmptyObject(newState.data);if(newState.title||dataNotEmpty){newState.hash=History.getShortUrl(newState.url).replace(/\??\&_suid.*/,"");if(!/\?/.test(newState.hash)){newState.hash+="?"}newState.hash+="&_suid="+newState.id}newState.hashedUrl=History.getFullUrl(newState.hash);if((History.emulated.pushState||History.bugs.safariPoll)&&History.hasUrlDuplicate(newState)){newState.url=newState.hashedUrl}return newState};History.createStateObject=function(data,title,url){var State={data:data,title:title,url:url};State=History.normalizeState(State);return State};History.getStateById=function(id){id=String(id);var State=History.idToState[id]||History.store.idToState[id]||undefined;return State};History.getStateString=function(passedState){var State,cleanedState,str;State=History.normalizeState(passedState);cleanedState={data:State.data,title:passedState.title,url:passedState.url};str=JSON.stringify(cleanedState);return str};History.getStateId=function(passedState){var State,id;State=History.normalizeState(passedState);id=State.id;return id};History.getHashByState=function(passedState){var State,hash;State=History.normalizeState(passedState);hash=State.hash;return hash};History.extractId=function(url_or_hash){var id,parts,url;parts=/(.*)\&_suid=([0-9]+)$/.exec(url_or_hash);url=parts?parts[1]||url_or_hash:url_or_hash;id=parts?String(parts[2]||""):"";return id||false};History.isTraditionalAnchor=function(url_or_hash){var isTraditional=!/[\/\?\.]/.test(url_or_hash);return isTraditional};History.extractState=function(url_or_hash,create){var State=null,id,url;create=create||false;id=History.extractId(url_or_hash);if(id){State=History.getStateById(id)}if(!State){url=History.getFullUrl(url_or_hash);id=History.getIdByUrl(url)||false;if(id){State=History.getStateById(id)}if(!State&&create&&!History.isTraditionalAnchor(url_or_hash)){State=History.createStateObject(null,null,url)}}return State};History.getIdByUrl=function(url){var id=History.urlToId[url]||History.store.urlToId[url]||undefined;return id};History.getLastSavedState=function(){return History.savedStates[History.savedStates.length-1]||undefined};History.getLastStoredState=function(){return History.storedStates[History.storedStates.length-1]||undefined};History.hasUrlDuplicate=function(newState){var hasDuplicate=false,oldState;oldState=History.extractState(newState.url);hasDuplicate=oldState&&oldState.id!==newState.id;return hasDuplicate};History.storeState=function(newState){History.urlToId[newState.url]=newState.id;History.storedStates.push(History.cloneObject(newState));return newState};History.isLastSavedState=function(newState){var isLast=false,newId,oldState,oldId;if(History.savedStates.length){newId=newState.id;oldState=History.getLastSavedState();oldId=oldState.id;isLast=newId===oldId}return isLast};History.saveState=function(newState){if(History.isLastSavedState(newState)){return false}History.savedStates.push(History.cloneObject(newState));return true};History.getStateByIndex=function(index){var State=null;if(typeof index==="undefined"){State=History.savedStates[History.savedStates.length-1];

}else if(index<0){State=History.savedStates[History.savedStates.length+index]}else{State=History.savedStates[index]}return State};History.getHash=function(){var hash=History.unescapeHash(document.location.hash);return hash};History.unescapeString=function(str){var result=str,tmp;return result};History.unescapeHash=function(hash){var result=History.normalizeHash(hash);result=History.unescapeString(result);return result};History.normalizeHash=function(hash){var result=hash.replace(/[^#]*#/,"").replace(/#.*/,"");return result};History.setHash=function(hash,queue){var adjustedHash,State,pageUrl;if(queue!==false&&History.busy()){History.pushQueue({scope:History,callback:History.setHash,args:arguments,queue:queue});return false}adjustedHash=History.escapeHash(hash);History.busy(true);State=History.extractState(hash,true);if(State&&!History.emulated.pushState){History.pushState(State.data,State.title,State.url,false)}else if(document.location.hash!==adjustedHash){if(History.bugs.setHash){pageUrl=History.getPageUrl();History.pushState(null,null,pageUrl+"#"+adjustedHash,false)}else{document.location.hash=adjustedHash}}return History};History.escapeHash=function(hash){var result=History.normalizeHash(hash);result=window.escape(result);if(!History.bugs.hashEscape){result=result.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")}return result};History.getHashByUrl=function(url){var hash=String(url).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");hash=History.unescapeHash(hash);return hash};History.setTitle=function(newState){var title=newState.title,firstState;if(!title){firstState=History.getStateByIndex(0);if(firstState&&firstState.url===newState.url){title=firstState.title||History.options.initialTitle}}try{document.getElementsByTagName("title")[0].innerHTML=title.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(Exception){}document.title=title;return History};History.queues=[];History.busy=function(value){if(typeof value!=="undefined"){History.busy.flag=value}else if(typeof History.busy.flag==="undefined"){History.busy.flag=false}if(!History.busy.flag){clearTimeout(History.busy.timeout);var fireNext=function(){var i,queue,item;if(History.busy.flag)return;for(i=History.queues.length-1;i>=0;--i){queue=History.queues[i];if(queue.length===0)continue;item=queue.shift();History.fireQueueItem(item);History.busy.timeout=setTimeout(fireNext,History.options.busyDelay)}};History.busy.timeout=setTimeout(fireNext,History.options.busyDelay)}return History.busy.flag};History.busy.flag=false;History.fireQueueItem=function(item){return item.callback.apply(item.scope||History,item.args||[])};History.pushQueue=function(item){History.queues[item.queue||0]=History.queues[item.queue||0]||[];History.queues[item.queue||0].push(item);return History};History.queue=function(item,queue){if(typeof item==="function"){item={callback:item}}if(typeof queue!=="undefined"){item.queue=queue}if(History.busy()){History.pushQueue(item)}else{History.fireQueueItem(item)}return History};History.clearQueue=function(){History.busy.flag=false;History.queues=[];return History};History.stateChanged=false;History.doubleChecker=false;History.doubleCheckComplete=function(){History.stateChanged=true;History.doubleCheckClear();return History};History.doubleCheckClear=function(){if(History.doubleChecker){clearTimeout(History.doubleChecker);History.doubleChecker=false}return History};History.doubleCheck=function(tryAgain){History.stateChanged=false;History.doubleCheckClear();if(History.bugs.ieDoubleCheck){History.doubleChecker=setTimeout(function(){History.doubleCheckClear();if(!History.stateChanged){tryAgain()}return true},History.options.doubleCheckInterval)}return History};History.safariStatePoll=function(){var urlState=History.extractState(document.location.href.replace(/#.*/,"")),newState;if(!History.isLastSavedState(urlState)){newState=urlState}else{return}if(!newState){newState=History.createStateObject()}History.Adapter.trigger(window,"popstate");return History};History.back=function(queue){if(queue!==false&&History.busy()){History.pushQueue({scope:History,callback:History.back,args:arguments,queue:queue});return false}History.busy(true);History.doubleCheck(function(){History.back(false)});history.go(-1);return true};History.forward=function(queue){if(queue!==false&&History.busy()){History.pushQueue({scope:History,callback:History.forward,args:arguments,queue:queue});return false}History.busy(true);History.doubleCheck(function(){History.forward(false)});history.go(1);return true};History.go=function(index,queue){var i;if(index>0){for(i=1;i<=index;++i){History.forward(queue)}}else if(index<0){for(i=-1;i>=index;--i){History.back(queue)}}else{throw new Error("History.go: History.go requires a positive or negative integer passed.")}return History};if(History.emulated.pushState){var emptyFunction=function(){};History.pushState=History.pushState||emptyFunction;History.replaceState=History.replaceState||emptyFunction}else{History.onPopState=function(event,extra){var stateId=false,newState=false,currentHash,currentState;History.doubleCheckComplete();stateId=History.Adapter.extractEventData("state",event,extra)||false;if(stateId){newState=History.getStateById(stateId)}else if(History.expectedStateId){newState=History.getStateById(History.expectedStateId)}else{newState=History.extractState(document.location.href.replace(/#.*/,""))}if(!newState){newState=History.createStateObject(null,null,document.location.href.replace(/#.*/,""))}History.expectedStateId=false;if(History.isLastSavedState(newState)){History.busy(false);return false}History.storeState(newState);History.saveState(newState);History.setTitle(newState);History.Adapter.trigger(window,"statechange");History.busy(false);return true};History.Adapter.bind(window,"popstate",History.onPopState);History.pushState=function(data,title,url,queue){if(History.getHashByUrl(url)&&History.emulated.pushState){throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).")}if(queue!==false&&History.busy()){History.pushQueue({scope:History,callback:History.pushState,args:arguments,queue:queue});return false}History.busy(true);var newState=History.createStateObject(data,title,url);if(History.isLastSavedState(newState)){History.busy(false)}else{History.storeState(newState);History.expectedStateId=newState.id;history.pushState(newState.id,newState.title,newState.url);History.Adapter.trigger(window,"popstate")}return true};History.replaceState=function(data,title,url,queue){if(History.getHashByUrl(url)&&History.emulated.pushState){throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).")}if(queue!==false&&History.busy()){History.pushQueue({scope:History,callback:History.replaceState,args:arguments,queue:queue});return false}History.busy(true);var newState=History.createStateObject(data,title,url);if(History.isLastSavedState(newState)){History.busy(false)}else{History.storeState(newState);History.expectedStateId=newState.id;history.replaceState(newState.id,newState.title,newState.url);History.Adapter.trigger(window,"popstate")}return true}}if(sessionStorage){try{History.store=JSON.parse(sessionStorage.getItem("History.store"))||{}}catch(err){History.store={}}History.normalizeStore()}else{History.store={};History.normalizeStore()}History.Adapter.bind(window,"beforeunload",History.clearAllIntervals);History.Adapter.bind(window,"unload",History.clearAllIntervals);History.saveState(History.storeState(History.extractState(document.location.href.replace(/#.*/,""),true)));if(sessionStorage){History.onUnload=function(){var currentStore,item;try{currentStore=JSON.parse(sessionStorage.getItem("History.store"))||{}}catch(err){currentStore={}}currentStore.idToState=currentStore.idToState||{};currentStore.urlToId=currentStore.urlToId||{};currentStore.stateToId=currentStore.stateToId||{};for(item in History.idToState){if(!History.idToState.hasOwnProperty(item)){continue}currentStore.idToState[item]=History.idToState[item]}for(item in History.urlToId){if(!History.urlToId.hasOwnProperty(item)){continue}currentStore.urlToId[item]=History.urlToId[item]}for(item in History.stateToId){if(!History.stateToId.hasOwnProperty(item)){continue}currentStore.stateToId[item]=History.stateToId[item]}History.store=currentStore;History.normalizeStore();sessionStorage.setItem("History.store",JSON.stringify(currentStore))};History.intervalList.push(setInterval(History.onUnload,History.options.storeInterval));History.Adapter.bind(window,"beforeunload",History.onUnload);History.Adapter.bind(window,"unload",History.onUnload)}if(!History.emulated.pushState){if(History.bugs.safariPoll){History.intervalList.push(setInterval(History.safariStatePoll,History.options.safariPollInterval))}if(navigator.vendor==="Apple Computer, Inc."||(navigator.appCodeName||"")==="Mozilla"){History.Adapter.bind(window,"hashchange",function(){History.Adapter.trigger(window,"popstate")});if(History.getHash()){History.Adapter.onDomLoad(function(){History.Adapter.trigger(window,"hashchange")})}}}};History.init()})(window);window.matchMedia=window.matchMedia||function(doc,undefined){var bool,docElem=doc.documentElement,refNode=docElem.firstElementChild||docElem.firstChild,fakeBody=doc.createElement("body"),div=doc.createElement("div");div.id="mq-test-1";div.style.cssText="position:absolute;top:-100em";fakeBody.style.background="none";fakeBody.appendChild(div);return function(q){div.innerHTML='&shy;<style media="'+q+'"> #mq-test-1 { width: 42px; }</style>';docElem.insertBefore(fakeBody,refNode);bool=div.offsetWidth==42;docElem.removeChild(fakeBody);return{matches:bool,media:q}}}(document);(function($){$.fn.placeholder=function(text){return this.each(function(){var context=$(this),placeholderText,nativePlaceholderSupport="placeholder"in document.createElement("input");function onBlur(event){checkIfEmpty($(event.target))}function checkIfEmpty(){if(context.val()===""){if(context.attr("type")==="password"){try{context.attr("type","text")}catch(e){return false}}context.val(placeholderText);context.addClass("ui-placeholder")}}function onFocus(event){context.removeClass("ui-placeholder");if(context.val()===placeholderText){context.val("")}}if(text===undefined){placeholderText=$(this).attr("placeholder")}else{placeholderText=text}if(!nativePlaceholderSupport){checkIfEmpty(context.blur(onBlur).focus(onFocus).addClass("ui-placeholder"));context.parents("form").submit(function(event){if(context.val()===placeholderText){context.val("")}})}else{context.attr("placeholder",placeholderText)}})}})(jQuery);(function(ns){var initializing=false,fnTest=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;var Class=ns.Class=function(){};if(typeof this!=="undefined"){this.Class=Class}Class.extend=function(prop){var _super=this.prototype;initializing=true;var prototype=new this;initializing=false;for(var name in prop){prototype[name]=typeof prop[name]=="function"&&typeof _super[name]=="function"&&fnTest.test(prop[name])?function(name,fn){return function(){var tmp=this._super;this._super=_super[name];var ret=fn.apply(this,arguments);this._super=tmp;return ret}}(name,prop[name]):prop[name]}var _Class=function(){if(!initializing&&this.init)this.init.apply(this,arguments)};_Class.prototype=prototype;_Class.prototype.constructor=_Class;_Class.extend=Class.extend;return _Class}})(typeof global!="undefined"?global:window);C("widget");C.widget.__base={init:function(){this.instanceNumber=++C.global.instanceCounter,C("widget."+this.instanceNumber);C.widget[this.instanceNumber]._widget=[];this.eventNamespace="widget"+this.instanceNumber;this.construct.apply(this,arguments)},destroy:function(){this.destruct();if(this.eventNamespace){var unbindNamespace="."+this.eventNamespace;$(window).off(unbindNamespace);$("*").off(unbindNamespace)}for(var i=0;i<C.widget[this.instanceNumber]._widget.length;i++){if(C.widget[this.instanceNumber]._widget[i].destroy){C.widget[this.instanceNumber]._widget[i].destroy()}else{C.log("Widget "+i+" does not have a destroy method")}}while(C.widget[this.instanceNumber]._widget.length){C.widget[this.instanceNumber]._widget.pop()}},addWidget:function(o){C.widget[this.instanceNumber]._widget.push(o);return o},construct:function(opts){C.log("Missing widget construct(opts) function!")},destruct:function(){C.log("Missing widget destruct() function!")}};C.widget._base=Class.extend(C.widget.__base);C("widget.backbone");C.widget.backbone.view=Backbone.View.extend(_.extend(C.widget.__base,{initialize:function(opts){this.init(opts)}}));C("page");C.page._base=Class.extend({init:function(){this.arguments=arguments;C.page._widget=C.page._widget||[];this.instanceNumber=++C.global.pageCounter,this.eventNamespace="page"+this.instanceNumber;this.construct.apply(this,arguments)},getData:function(){return this.arguments},destroy:function(){this.destruct();if(this.eventNamespace){var unbindNamespace="."+this.eventNamespace;$(window).off(unbindNamespace);$("*").off(unbindNamespace)}for(var i=0;i<C.page._widget.length;i++){if(C.page._widget[i].destroy){C.page._widget[i].destroy()}else{C.log("Widget "+C.page._widget[i].toString()+" does not have a destroy method")}}while(C.page._widget.length){C.page._widget.pop()}},addWidget:function(o){C.page._widget.push(o);return o},construct:function(opts){C.log("Missing page construct(opts) function!")},destruct:function(){C.log("Missing page destruct() function!")}});C.Events=_.extend({},Backbone.Events);C.Collection=Backbone.Collection.extend({objName:"C.Collection",destroy:function(){this.log("destroy");while(this.length>0){this.at(0).destroy();this.remove(this.at(0))}this.trigger("destroy")}});C.Model=Backbone.Model.extend({objName:"C.Model",destroy:function(){this.trigger("destroy")}});C.View=Backbone.View.extend({objName:"C.View"});C.Collection.prototype.log=C.Model.prototype.log=C.View.prototype.log=function(){var args=Array.prototype.slice.call(arguments);args.unshift(this.objName);C.log.apply(this,args)};jQuery.extend(jQuery,{escapeSelector:function(){var specials=["#","&","~","=",">","'",":",'"',"!",";",","];var regexSpecials=[".","*","+","|","[","]","(",")","/","^","$"];var sRE=new RegExp("("+specials.join("|")+"|\\"+regexSpecials.join("|\\")+")","g");return function(selector){return selector.replace(sRE,"\\$1")}}()});$.fn.serializeObject=function(){var o={};var a=this.serializeArray();$.each(a,function(){if(o[this.name]){if(!o[this.name].push){o[this.name]=[o[this.name]]}o[this.name].push(this.value||"")}else{o[this.name]=this.value||""}});return o};$.safeAjax=function(options){var entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function escapeHtml(string){return String(string).replace(/[&<>"'\/]/g,function(s){return entityMap[s]})}function htmlEscapeData(data){if(typeof data==="string"){return escapeHtml(data)}else if(typeof data==="object"){for(var i in data){var val=data[i];data[i]=htmlEscapeData(val)}return data}return data}var success=options.success;options.success=function(data,textStatus,jqXHR){data=htmlEscapeData(data);if(success){success(data,textStatus,jqXHR)}};return $.ajax(options)};$.fn.observe=function(){var arg=arguments,context,callback,delegator,events=arg[0],ns,that=this;var addNs=function(e,curNs){e=e.split(/\s+/);var result=[];for(var i=0;i<e.length;i++){result.push(e[i]+curNs)}return result.join(" ")};if(arg.length==2){context=arg[1];ns=typeof context.eventNamespace=="string"?"."+context.eventNamespace:"";for(var event in events){(function(event){that.on(addNs(event,ns),function(e){return events[event].call(context,e)})})(event)}}else if(arg.length==3){if(typeof events=="object"){delegator=arg[1];context=arg[2];ns=typeof context.eventNamespace=="string"?"."+context.eventNamespace:"";for(var event in events){(function(event){that.on(addNs(event,ns),delegator,function(e){return events[event].call(context,e)})})(event)}}else{callback=arg[1];context=arg[2];ns=typeof context.eventNamespace=="string"?"."+context.eventNamespace:"";this.on(addNs(events,ns),function(e){return callback.call(context,e)})}}else if(arg.length==4){delegator=arg[1];callback=arg[2];context=arg[3];ns=typeof context.eventNamespace=="string"?"."+context.eventNamespace:"";this.on(addNs(events,ns),delegator,function(e){return callback.call(context,e)})}return this};$.fn.unobserve=function(){var arg=arguments,context,delegator,events=arg[0],ns,that=this;var addNs=function(e,curNs){e=e.split(/\s+/);var result=[];for(var i=0;i<e.length;i++){result.push(e[i]+curNs)}return result.join(" ")};if(arg.length==2){context=arg[1];ns=typeof context.eventNamespace=="string"?"."+context.eventNamespace:"";if(typeof events=="object"){for(var event in events){(function(event){that.off(addNs(event,ns))})(event)}}else{this.off(addNs(events,ns))}}else if(arg.length==3){delegator=arg[1];context=arg[2];ns=typeof context.eventNamespace=="string"?"."+context.eventNamespace:"";if(typeof events=="object"){for(var event in events){(function(event){that.off(addNs(event,ns),delegator)})(event)}}else{this.off(addNs(events,ns),delegator)}}return this};(function($){C("widget");C.widget.spinner=C.widget._base.extend({construct:function(opts){var self=this;this.options=$.extend({spokes:16,animTime:75,color:"#666666",type:"round"},opts);this.$set=this.options.canvas.jquery?this.options.canvas:$(this.options.canvas);this.canvases=this.getAndValidateCanvases(this.$set);if(!this.canvases.length)return;this.rotation=Math.PI*2/this.options.spokes;this.rgbColor=this.getRGBColor(this.options.color);this.contexts=this.setupContexts(this.canvases);this.draw()},draw:function(){var self=this;this.translateContexts(this.contexts);this.drawIntervalID=setInterval(function(){self.paintFrame()},this.options.animTime)},clearFrame:function(cx){cx.ctx.clearRect(cx.negHalf,cx.negHalf,cx.size,cx.size)},paintFrame:function(){for(var i=0;i<this.contexts.length;i++){var cx=this.contexts[i];if(!this.isPresent(cx.ctx.canvas)){this.contexts.splice(i,1);i--;continue}this.clearFrame(cx);cx.ctx.rotate(this.rotation);for(var j=0;j<this.options.spokes;j++){cx.ctx.rotate(this.rotation);cx.ctx.strokeStyle=this.rgbColor+j/this.options.spokes+")";cx.ctx.beginPath();cx.ctx.moveTo(0,cx.startPos);cx.ctx.lineTo(0,cx.endPos);cx.ctx.stroke()}}if(!this.contexts.length){clearInterval(this.drawIntervalID);for(var cx in this.contexts){if(!this.contexts.hasOwnProperty(cx))continue;cx=this.contexts[cx];this.clearFrame(cx);this.translateContext(cx,true)}}},isPresent:function(cv){return!!$(cv).closest("body").length},getAndValidateCanvases:function($set){var canvases=[];$set.each(function(i,el){if(el.nodeName==="CANVAS"){canvases.push(el)}});return canvases},setupContexts:function(canvases){var contexts=[];for(var cv in canvases){if(!canvases.hasOwnProperty(cv))continue;cv=canvases[cv];var $cv=$(cv);if(!$cv.is(":visible"))continue;var size=$cv.height(),halfSize=.5*size,negHalf=-1*halfSize,startPos=Math.floor(1/3*size),thickness=size*(size<30?.08:.0625),endPos=Math.floor(.5*size)-thickness,ctx=cv.getContext("2d");ctx.lineWidth=thickness;ctx.lineCap=this.options.type;contexts.push({ctx:ctx,size:size,halfSize:halfSize,negHalf:negHalf,startPos:startPos,endPos:endPos,thickness:thickness})}return contexts},translateContext:function(cx,reverse){if(reverse)cx.ctx.translate(cx.negHalf,cx.negHalf);else cx.ctx.translate(cx.halfSize,cx.halfSize)},translateContexts:function(contexts,reverse){for(var cx in contexts){if(!contexts.hasOwnProperty(cx))continue;cx=contexts[cx];this.translateContext(cx,reverse)}},getRGBColor:function(hex){function hexToN(h,a,b){return parseInt(cutHex(h).substring(a,b),16)}function cutHex(h){return h.charAt(0)=="#"?h.substring(1,7):h}return["rgba(",hexToN(hex,0,2),",",hexToN(hex,2,4),",",hexToN(hex,4,6),","].join("")},clearAllCanvases:function(){if(this.contexts){for(var i=0;i<this.contexts.length;i++){var cx=this.contexts[i];if(!this.isPresent(cx.ctx.canvas)){this.contexts.splice(i,1);i--;continue}this.clearFrame(cx)}}},destruct:function(){clearInterval(this.drawIntervalID);this.clearAllCanvases();return}})})(jQuery);(function($){C("widget");C.widget.autoComplete=C.widget._base.extend({construct:function(opts){C.log("autocomplete:construct");this.opts=$.extend({minChar:1,delay:200,paramName:"search_by",ajaxParamName:"search_by",button:".search-submit",dropdownOverride:null,overrideActiveClass:null,topOffset:0,showTypeIcons:false,showCommentCounts:false,limitParamsString:"",additionalGetParamsString:"",cssPositioning:"absolute",combineResultSets:false,callback:null,lastItem:null,lastItemCallback:null,track:null,refreshAfterSchoolChange:false,urlToNavigateToAfterSchoolChange:null,schoolChangeCallback:null,useSpinner:false,onTextboxBlur:null,attachToParent:null,overrideSolutionsImage:false},opts);if(this.opts.type=="answers"){this.opts.subType="answers";this.opts.type="instantAnswers"}this.mouseInDropdown=false;this.$initializationElement=this.opts.el.jquery?this.opts.el:$(this.opts.el);this.$lastItem=this.opts.lastItem?this.opts.lastItem.jquery?this.opts.lastItem:$(this.opts.lastItem):null;if(!this.$initializationElement.length){return}if(this.$initializationElement.is("input")||this.$initializationElement.is("textarea")){this.$input=this.$initializationElement;this.$el=this.$input.offsetParent();this.inputInitialized=true}else{this.$el=this.$initializationElement;this.favorWrapElem=true;this.$input=this.$el.find("input[name="+this.opts.paramName+"]");this.inputInitialized=false}this.activeQuestionsListWidget=null;this.needsQuestionsLists=false;if(!this.type){this.type=this.opts.type||"combined"}this.determineQuestionsListNeeded();this.$parentHeaderSelector=this.$input.closest(".chg-header, .chg-hdr-root");this.isHeaderChild=this.$parentHeaderSelector&&this.$parentHeaderSelector.length;this.$dialogParentSelector=this.$input.closest(".dialog-widget");this.isDialogChild=this.$dialogParentSelector&&this.$dialogParentSelector.length;if(this.opts.attachToParent)this.$appendTarget=this.opts.attachToParent;else this.$appendTarget=this.isHeaderChild?C.dom.$headerRoot:C.dom.$root;this.isFixedCss=this.opts.cssPositioning.toLowerCase()==="fixed";this.$input.attr("autocomplete","off");this.$form=this.$input.parents("form");this.$button=this.$form.parent().find(this.opts.button);this.buttonRestoreHtml=this.$button.html();this.liRestoreHtml=null;this.submitButtonSpinner=null;this.url="/_ajax/autocomplete";this.trackId=this.generateTrackId();this.xhrCounter=0;this.xhr=[];this.canShow=0;this.suggestVal="";this.lastQuery="";this.userForcedSubmission=false;this.saveClickedHeader=null;this.changeSchoolUrl="/_ajax/user/changeschool";this.createDropdownContainer();this.doBind();this.hasRoundedCorners=parseInt(this.$input.css("border-bottom-right-radius"),10)},generateTrackId:function(){var trackid=Math.abs(Math.random()*4294967295<<0).toString(16);return("000000000"+trackid).slice(-8)},destruct:function(){C.log("autocomplete:destruct");if(this.$dropdown&&this.opts.dropdownOverride&&this.opts.overrideActiveClass){if(!this.$dropdown.hasClass(this.opts.overrideActiveClass)){this.$dropdown.addClass(this.opts.overrideActiveClass)}this.$dropdown.remove();return}if(this.activeQuestionsListWidget){this.activeQuestionsListWidget.destroy()}if(this.submitButtonSpinner){this.submitButtonSpinner.destroy()}if(this.$dropdown&&this.$dropdown.length){this.$dropdown.remove()}},determineQuestionsListNeeded:function(){var questionPattern=new RegExp("question","i"),instantAnswersPattern=new RegExp("instantanswers","i"),homeworkhelpPattern=new RegExp("homeworkhelp","i"),currentType=this.type;if(questionPattern.test(currentType)||instantAnswersPattern.test(currentType)||homeworkhelpPattern.test(currentType)){this.needsQuestionsLists=true}if(this.opts.subType=="answers"){this.needsQuestionsLists=false}},createDropdownContainer:function(){if(this.opts.dropdownOverride&&this.opts.overrideActiveClass){if(typeof this.opts.dropdownOverride==="string"){this.opts.dropdownOverride=$(this.opts.dropdownOverride)}this.$dropdown=this.opts.dropdownOverride;this.$dropdown.addClass("chg-autocomplete-container");return}this.$dropdown=$('<div class="chg-autocomplete-container" id="autocomplete-'+this.instanceNumber+'"></div>').appendTo(this.$appendTarget).hide().css({position:this.opts.cssPositioning,zIndex:-1,width:this.opts.width})},doBind:function(){var that=this;this.$input.observe({"focus.autocomplete":this.onTextboxFocus,"blur.autocomplete":this.opts.onTextboxBlur||this.onTextboxBlur,"keydown.autocomplete":this.onKeyDown,"keyup.autocomplete":this.onKeyUp},this);this.$input.observe("paste",function(){var arg=arguments;setTimeout(function(){that.onKeyUp.apply(that,arg)},0)},this);this.$dropdown.observe({mouseover:this.onMouseOverSelection,mousedown:this.onSelectionClick,mouseenter:this.onMouseEnter,mouseleave:this.onMouseLeave},this);this.$button.observe("click",this.onButtonClick,this);$(window).observe("resize",this.hideDropdown,this)},getParsedUrl:function(){var getParamString="",limitParamsString="",combineResultsString="",paramDelimiter="";if(this.opts.additionalGetParamsString.length){paramDelimiter=this.opts.additionalGetParamsString.substring(1)=="&"?"":"&";getParamString=paramDelimiter+this.opts.additionalGetParamsString}if(this.opts.limitParamsString.length){paramDelimiter=this.opts.limitParamsString.substring(1)=="&"?"":"&";limitParamsString=paramDelimiter+this.opts.limitParamsString}if(this.opts.combineResultSets){combineResultsString="&combine_results="+this.opts.combineResultsString}return this.url+"?"+this.opts.ajaxParamName+"="+encodeURIComponent(this.$input.val())+"&type="+this.type+getParamString+limitParamsString+combineResultsString+"&trackid="+this.trackId},fireAjax:function(){clearTimeout(this.ajaxTimeout);var that=this;this.ajaxTimeout=setTimeout(function(){that.callAjax()},this.opts.delay)},callAjax:function(){if(!this.canShow){return}if(this.opts.useSpinner&&this.$button.length&&this.buttonRestoreHtml){if(!this.submitButtonSpinner){this.$button.html('<canvas class="loading" width="15" height="15"><img src="/s/_global/images/ajax-loader.gif"></canvas>');var cv=this.$button.find("canvas.loading");this.submitButtonSpinner=new C.widget.spinner({canvas:cv,color:"#000000"})}}this.xhr.push($.ajax({url:this.getParsedUrl(),dataType:"json",context:this,success:this.onAjaxSuccess,error:this.onAjaxError}))},onAjaxSuccess:function(data,status,xhr){if(this.canShow&&this.isResponseInOrder(xhr)){this.onAjaxResponse(data)}},onAjaxError:function(xhr,status,error){},isResponseInOrder:function(xhr){var i;for(i=0;i<this.xhr.length;i++){if(this.xhr[i]===xhr){break}}if(i>=this.xhrCounter){this.xhrCounter=i;return true}return false},onAjaxResponse:function(data){var builtResults=this.buildAutocompleteDropdown(data);if(builtResults){if(this.$button.length&&this.submitButtonSpinner){this.$button.html(this.buttonRestoreHtml);this.submitButtonSpinner=null}this.showDropdown();$("body").trigger("autocomplete:success",{data:data})}else{$("body").trigger("autocomplete:noResults")}},showDropdown:function(){if(!this.canShow){return}if(this.userForcedSubmission){return}if(this.opts.dropdownOverride&&this.opts.overrideActiveClass){if(this.$dropdown&&!this.$dropdown.hasClass(this.opts.overrideActiveClass)){this.$dropdown.addClass(this.opts.overrideActiveClass)}this.$dropdown.find("p").css({visibility:"hidden"}).each(function(){var that=this,$this=$(this),text=$this.text(),$highlightEl=$this.find("span").text(),tokens,html="",i,timer;if(that.scrollHeight<=that.offsetHeight){$this.css({visibility:"visible"});return}tokens=text.split(/\s+/);i=0;timer=setInterval(function(){if(!tokens[i]){clearInterval(timer);$this.css({visibility:"visible"});return}html+=tokens[i]+" ";$this.text(html);if(that.scrollHeight>that.offsetHeight){tokens=tokens.slice(0,i-1);tokens=tokens.join(" ")+"...";if($highlightEl.length){$regex=new RegExp("("+$highlightEl+")");tokens=tokens.replace($regex,'<span class="chg-suggest-term">$1</span>')}$this.html(tokens);clearInterval(timer);$this.css({visibility:"visible"});return}i++},0)});return}var width=this.opts.width||this.$input.outerWidth()-2,inputOffset=this.$input.offset(),inputOffsetLeft=inputOffset.left,$staticPositionGetterElement=this.favorWrapElem?this.$initializationElement:this.$input,inputOffsetTop=this.isFixedCss?$staticPositionGetterElement.position().top:$staticPositionGetterElement.offset().top,height=$staticPositionGetterElement.outerHeight(true),autocompleteLeftOffset=inputOffset.left,autocompleteTopOffset=height+this.opts.topOffset;var zIndex=[0];this.$input.parents().each(function(i,el){zIndex.push(+$(el).css("zIndex")||0)});zIndex=C.utility.max(zIndex)+1;if(this.opts.cssPositioning!=="fixed"&&!this.isHeaderChild){var scrollTop=this.$input.scrollTop();autocompleteTopOffset+=scrollTop+inputOffset.top}else if(this.isDialogChild){autocompleteTopOffset+=$staticPositionGetterElement.position().top+parseInt(this.$dialogParentSelector.css("top"),10)}this.$dropdown.css({position:this.opts.cssPositioning,zIndex:zIndex,width:width+"px",left:autocompleteLeftOffset+"px",top:autocompleteTopOffset+"px"}).show();if(this.opts.attachToParent){this.$dropdown.css({position:"relative",left:"0px",top:"0px"})}if(this.hasRoundedCorners){this.$input.css({"border-radius":"5px 5px 0 0"})}this.userForcedSubmission=false},hideDropdown:function(){var o=this;if(this.opts.dropdownOverride&&this.opts.overrideActiveClass){if(this.$dropdown.hasClass(this.opts.overrideActiveClass)){this.$dropdown.removeClass(this.opts.overrideActiveClass)}return}setTimeout(function(){if(o.hasRoundedCorners){o.$input.css({"border-radius":"5px"})}o.$dropdown.hide()},300)},onTextboxFocus:function(e){if(this.$input.val().length&&this.$dropdown.html().length){this.canShow=1;this.showDropdown()}},onTextboxBlur:function(e){if(!this.mouseInDropdown){if(!this.$input.is(":focus")){this.canShow=0;this.hideDropdown()}}},onMouseEnter:function(){if(this.mouseInDropdown){return}this.mouseInDropdown=true},onMouseLeave:function(){if(this.mouseInDropdown){this.mouseInDropdown=false;this.onTextboxBlur()}return},onKeyUp:function(e){if(e.keyCode==13){this.userForcedSubmission=true;this.hideDropdown();return}var val=$.trim(this.$input.val());if(this.lastQuery==val){return}this.lastQuery=val;var defaultVal=String(this.$input.attr("textvalue"));if(val==defaultVal||val===""||val.length<this.opts.minChar){if(this.$button.length&&this.submitButtonSpinner){this.$button.html(this.buttonRestoreHtml);this.submitButtonSpinner=null}this.canShow=0;this.hideDropdown();return}this.canShow=1;this.suggestVal="";this.fireAjax();this.userForcedSubmission=false},onKeyDown:function(e){if(e.keyCode==40){this.doNextSelection(e);e.preventDefault()}else if(e.keyCode==38){this.doPrevSelection(e);e.preventDefault()}else if(e.keyCode==27){this.$input.blur()}else if(e.keyCode==13){this.onSubmit(e)}},onMouseOverSelection:function(e){var $cur=this.getTargetedLi(e),container=e.currentTarget;if($cur.hasClass("disabled")){return}if($cur.length){$(container).find("li").removeClass("suggest-selected");$cur.addClass("suggest-selected")}this.changeSelection($cur)},getTargetedLi:function(e){return $(e.target).closest("li")},doNextSelection:function(e){var $lis=this.$dropdown.find("li"),index=$lis.index(this.$dropdown.find("li.suggest-selected")),$cur;$lis.removeClass("suggest-selected");if(index==-1||index>=$lis.length-1){$cur=$lis.eq(0).addClass("suggest-selected")}else{$cur=$lis.eq(index+1).addClass("suggest-selected")}if($cur.hasClass("disabled")){this.doNextSelection(e);return false}this.changeSelection($cur)},doPrevSelection:function(e){var $lis=this.$dropdown.find("li"),index=$lis.index(this.$dropdown.find("li.suggest-selected")),$cur;$lis.removeClass("suggest-selected");if(index==-1||index===0){$cur=$lis.eq($lis.length-1).addClass("suggest-selected")}else{$cur=$lis.eq(index-1).addClass("suggest-selected")}if($cur.hasClass("disabled")){this.doPrevSelection(e);return false}this.changeSelection($cur)},onButtonClick:function(){var val=$.trim(this.$input.val());

if(!(val==this.$input.attr("textvalue")||val==="")){this.$form.submit()}return false},changeSelection:function($el){this.$curLi=$el;var $clickedHeader=this.$curLi.find(".autocomplete-hdr");if($clickedHeader.length){this.saveClickedHeader=$clickedHeader.text()}else{this.saveClickedHeader=null}this.suggestVal=this.saveClickedHeader},onSubmit:function(e){if(!this.$curLi){if(this.opts.track){var trk=this.opts.track.split("=");this.$form.append('<input type="hidden" name="'+trk[0]+'" value="'+trk[1]+'" />')}if(this.opts.callback){this.opts.callback(e)}return true}if(this.$curLi.hasClass("disabled")){e.preventDefault();return false}if(this.suggestVal.length){e.preventDefault();this.hideDropdown();var $clickedHeader=this.$curLi.find(".autocomplete-hdr");if($clickedHeader.length){this.saveClickedHeader=$clickedHeader.text()}if(this.opts.callback&&this.$curLi){this.opts.callback(e,this.$curLi,this.$initializationElement);return false}if(this.$curLi.hasClass("school-change")){this.changeUserSchool(e,this.$curLi);return false}var url=this.$curLi.attr("data-url"),ii=this.$curLi.attr("data-ii");if(ii!=undefined){url=url.indexOf("?")==-1?url+"?ii="+ii:url+"&ii="+ii;if(this.opts.track){url+="&"+this.opts.track}}top.location.href=url;return false}return true},getDisabledItems:function(attr){if(!this.opts)this.opts={};if(!this.opts.disabledItems||typeof this.opts.disabledItems!=="object")this.opts.disabledItems={};var disabledItems=[];if(this.opts.disabledItems[attr]&&typeof this.opts.disabledItems[attr]==="object"){_.each(this.opts.disabledItems[attr],function(item){disabledItems.push($.trim(item))})}return disabledItems},convertItemsToArray:function(items){if(!items)return[];if(typeof items!=="object")return[items];return items},setDisabledItems:function(attr,items){var prev=this.getDisabledItems(attr);if(attr&&typeof attr==="string"){this.opts.disabledItems[attr]=this.convertItemsToArray(items)}if(prev.toString()!=this.getDisabledItems(attr).toString()){this.hideDropdown();this.$dropdown.html("")}return this},addDisabledItems:function(attr,items){var newItems=_.union(this.getDisabledItems(attr),this.convertItemsToArray(items));return this.setDisabledItems(attr,newItems)},removeDisabledItems:function(attr,items){var newItems=_.difference(this.getDisabledItems(attr),this.convertItemsToArray(items));return this.setDisabledItems(attr,newItems)},checkItemIsDisabled:function(itemAttributes){if(!itemAttributes||typeof itemAttributes!=="object"||!_.size(itemAttributes))return false;if(itemAttributes.hasOwnProperty("disabled")&&itemAttributes["disabled"]==true)return true;var disabled=false,that=this;_.each(itemAttributes,function(itemValue,itemAttr){if(_.indexOf(that.getDisabledItems(itemAttr),itemValue)>-1){disabled=true;return false}});return disabled},buildAutocompleteSectionItem:function(autoCompleteItem,iiIndex){var html=[],iiCount=iiIndex,replacement='<span class="chg-suggest-term">$1</span>',isQuestion=autoCompleteItem.title?autoCompleteItem.title.toLowerCase().indexOf("question")>=0:false,shouldHighlightTerm=isQuestion?autoCompleteItem.replaceIsSafe:true,replaceTerm=isQuestion&&shouldHighlightTerm?$.trim(autoCompleteItem.replaceTerm):$.trim(this.$input.val()),regex=new RegExp("("+this.RegExpQuote(replaceTerm)+")","i"),safeReplaceTitle=$("<div/>").html(autoCompleteItem.title).text(),hasTBS=typeof autoCompleteItem.hasTBS!=="undefined"&&autoCompleteItem.hasTBS?autoCompleteItem.hasTBS:false,liString='<li data-ii="'+iiCount+'" ',liClass=this.checkItemIsDisabled(autoCompleteItem.attributes)?"disabled ":"";if(autoCompleteItem.listClass){liClass+=" "+autoCompleteItem.listClass+" "}if(liClass){liString+='class="'+$.trim(liClass)+'" '}html.push(liString);if(autoCompleteItem.attributes){for(var attribute in autoCompleteItem.attributes){html.push(attribute+'="'+autoCompleteItem.attributes[attribute]+'" ')}}html.push(">");if(autoCompleteItem.img){if(autoCompleteItem.img.url){html.push('<img src="'+autoCompleteItem.img.url+'"');var imgAlt=autoCompleteItem.img.alt?autoCompleteItem.img.alt:"chegg image";html.push(' alt="'+imgAlt+'"');if(autoCompleteItem.img.width){html.push(' width="'+autoCompleteItem.img.width+'"')}if(autoCompleteItem.img.height){html.push(' height="'+autoCompleteItem.img.height+'"')}if(autoCompleteItem.img.onError){html.push('this.onerror=null; onError="'+autoCompleteItem.img.onError+'"')}html.push(" />")}html.push("<div>")}if(autoCompleteItem.typeicon&&this.opts.showTypeIcons){if(autoCompleteItem.typeicon.type==="count"&&autoCompleteItem.countDisplay){html.push('<span class="icn-count-22 '+autoCompleteItem.typeicon.iconclass+'">'+autoCompleteItem.countDisplay+"</span>")}else{html.push('<span class="autocomplete-type-icon '+autoCompleteItem.typeicon.iconclass+'">'+autoCompleteItem.typeicon.type+"</span>")}}if(typeof autoCompleteItem.starRating!=="undefined"&&autoCompleteItem.starRating){html.push('<div class="autocomplete-star-rating"><span class="star-'+autoCompleteItem.starRating+'-sm">'+autoCompleteItem.starRating+" Stars</span></div>")}if(hasTBS&&autoCompleteItem.solutionsUrl&&!this.opts.overrideSolutionsImage){html.push('<a class = "autocomplete-hasTBS" href ='+autoCompleteItem.solutionsUrl+"></a>")}if(autoCompleteItem.title){var printTitle=shouldHighlightTerm?safeReplaceTitle.replace(regex,replacement):autoCompleteItem.title;html.push('<p class="autocomplete-hdr">'+printTitle+"</p>")}if(autoCompleteItem.subtitle){var printSubTitle=shouldHighlightTerm?autoCompleteItem.subtitle.replace(regex,replacement):autoCompleteItem.subtitle;html.push('<p class="autocomplete-subtitle">'+printSubTitle+"</p>")}if(autoCompleteItem.author){var printAuthor=autoCompleteItem.author.replace(regex,replacement);html.push('<p class="autocomplete-author">'+printAuthor+"</p>")}if(autoCompleteItem.isbnText){var printIsbn=autoCompleteItem.isbnText.replace(regex,replacement);printIsbn=printIsbn.replace("&amp;nbsp;"," &nbsp; ");if(autoCompleteItem.editionNo&&autoCompleteItem.editionNo!=0){printIsbn="Edition: "+autoCompleteItem.editionNo+" "+printIsbn}html.push('<p class="autocomplete-isbn">'+printIsbn+"</p>")}if(autoCompleteItem.coursename){var printCourseName=autoCompleteItem.coursename.replace(regex,replacement);html.push('<p class="autocomplete-course">'+printCourseName+"</p>")}if(this.showCommentCounts&&autoCompleteItem.commentCount>0){html.push('<span class="comment-count">'+autoCompleteItem.commentCount+"</span>")}if(autoCompleteItem.button){var btnid=autoCompleteItem.button.id?' id="'+autoCompleteItem.button.id+'"':"",btnclass=autoCompleteItem.button.btnclass?' class="'+autoCompleteItem.button.btnclass+'"':"btn-primary-mini",btntext=autoCompleteItem.button.text?autoCompleteItem.button.text:"go";html.push("<button"+btnid+btnclass+">"+btntext+"</button>")}if(autoCompleteItem.img){html.push("</div>")}html.push("</li>");return html.join("")},buildAutocompleteDropdown:function(data){var responseData=typeof data=="object"?data:jQuery.parseJSON(data);if(!responseData){return}var idSafeType=this.opts.type.replace("|","_"),markupDiv='<div id="'+idSafeType+'_autocomplete"></div>',$markup=$(markupDiv),iiIndex=1;if(responseData){for(var responseSection in responseData){if(responseData[responseSection].title){var sectionHdr='<p class="automplete-sec-hdr">'+responseData[responseSection].title+"</p>";$markup.append($(sectionHdr));var $autoItemsList=$("<ul></ul>");if(this.needsQuestionsLists){$autoItemsList.addClass("questions-list")}for(var item in responseData[responseSection].items){var Li=this.buildAutocompleteSectionItem(responseData[responseSection].items[item],iiIndex),$Li=$(Li);$Li.data("itemDetail",responseData[responseSection].items[item]);$autoItemsList.append($Li);iiIndex++}if(this.$lastItem){this.$lastItem.addClass("last-item");$autoItemsList.append(this.$lastItem)}$markup.append($autoItemsList)}}if(this.$lastItem&&$markup.find("ul").length==0){this.$lastItem.addClass("last-item");var $itemsList=$("<ul></ul>");$itemsList.append(this.$lastItem);$markup.append($itemsList)}this.$dropdown.html($markup).find("li:last-child").css({borderBottom:0});if($markup.html()==""){return false}return true}},wireQuestionsList:function(qid){if(this.activeQuestionsListWidget){this.activeQuestionsListWidget.destroy()}var $questionsList=this.$dropdown.find(".questions-list");if($questionsList.length){this.activeQuestionsListWidget=new C.widget.questionsList({el:$questionsList,removeCourseButton:true,disableAnswering:true})}var questionId=qid||null;if(questionId&&this.activeQuestionsListWidget){this.activeQuestionsListWidget.getAjaxQuestion(questionId)}},RegExpQuote:function(str){return(str+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},onSelectionClick:function(e){if($(e.target).hasClass("autocomplete-hasTBS")){this.hideDropdown();return}if($(e.target).hasClass("automplete-sec-hdr")){return}if(e.which!==1){return}var $curLi=this.getTargetedLi(e);if($curLi.hasClass("disabled")){return}this.$curLi=$curLi;this.hideDropdown();if(this.$curLi.hasClass("last-item")){if(this.opts.lastItemCallback){this.opts.lastItemCallback(e,this.$curLi,this.$initializationElement)}return false}if(this.opts.callback){this.opts.callback(e,this.$curLi,this.$initializationElement);return}var $clickedHeader=this.$curLi.find(".autocomplete-hdr");if($clickedHeader.length){this.saveClickedHeader=$clickedHeader.text();this.updateInputVal()}this.liRestoreHtml=this.$curLi.html();this.$curLi.html('<canvas class="loading" width="20" height="20"><img src="/s/_global/images/ajax-loader.gif"></canvas>');var cv=this.$curLi.find("canvas.loading");new C.widget.spinner({canvas:cv,color:"#000000"});if(this.$curLi.hasClass("school-change")){this.changeUserSchool(e,this.$curLi);return false}var url=this.$curLi.attr("data-url"),ii=this.$curLi.attr("data-ii");if(ii!=undefined){url=url.indexOf("?")==-1?url+"?ii="+ii:url+"&ii="+ii;if(this.opts.track){url+="&"+this.opts.track}}if(this.liRestoreHtml){this.$curLi.html(this.liRestoreHtml);this.liRestoreHtml=null}top.location.href=url;return false},changeType:function(newType,opts){var options=opts||{},oldOptions=this.opts;if(typeof newType!=="string"){JSON.stringify(newType)}this.type=newType;this.opts=$.extend({type:newType},oldOptions,options);if(this.$dropdown){this.hideDropdown();this.$dropdown.html("")}this.determineQuestionsListNeeded()},setPlaceholder:function(text){this.$input.attr("placeholder",text)},changeUserSchool:function(e,li){var $li=li.jQuery?li:$(li),gid=$li.attr("data-schoolid");this.updateInputVal();if(this.liRestoreHtml){this.$curLi.html(this.liRestoreHtml);this.liRestoreHtml=null}if(this.opts.schoolChangeCallback){this.opts.schoolChangeCallback(e,$li);return false}this.submitUserSchool(gid)},submitUserSchool:function(gid){var postData={gid:gid},that=this;this.addAPITokenTo(postData);var doRefresh=this.opts.refreshAfterSchoolChange,urlNavigate=this.opts.urlToNavigateToAfterSchoolChange;$.ajax({type:"POST",dataType:"json",url:this.changeSchoolUrl,data:postData,success:function(response){if(urlNavigate){C.utility.navigate(urlNavigate);return}if(doRefresh){$(".chg-content > div").css({opacity:.5});top.location.reload()}if(that.opts.schoolChangeSuccessCallback){that.opts.schoolChangeSuccessCallback(response);return}return},error:function(){return false}})},updateInputVal:function(){if(this.saveClickedHeader){this.$input.off(".autocomplete");this.$input.val(this.saveClickedHeader);this.$input.blur();this.$input.observe({"focus.autocomplete":this.onTextboxFocus,"blur.autocomplete":this.onTextboxBlur,"keydown.autocomplete":this.onKeyDown,"keyup.autocomplete":this.onKeyUp},this);this.saveClickedHeader=null}},addAPITokenTo:function(postData){postData.token=C.global.csrfToken}})})(jQuery);(function($){C.widget.autoCompleteHeader=C.widget.autoComplete.extend({construct:function(opts){C.log("autocomplete:construct");this.GAclient=Eggshell.create("C.report.GA");this.opts=$.extend({minChar:1,delay:200,paramName:"search_by",ajaxParamName:"search_by",button:".search-magnify-btn",dropdownOverride:null,overrideActiveClass:null,topOffset:0,showTypeIcons:false,showCommentCounts:false,limitParamsString:"",additionalGetParamsString:"",cssPositioning:"absolute",combineResultSets:false,callback:null,lastItem:null,lastItemCallback:null,track:null,refreshAfterSchoolChange:false,urlToNavigateToAfterSchoolChange:null,schoolChangeCallback:null,useSpinner:false,inHeader:false,psycicResults:"#autosuggest-psycic",autoSuggestResults:"#autosuggest-results",container:"#autosuggest-results-container",thumbWidth:70,thumbHeight:85,thumbLetterBox:true,showResultsFlag:false,slideDown:true},opts);this.mouseInDropdown=false;this.$initializationElement=this.opts.el.jquery?this.opts.el:$(this.opts.el);this.$lastItem=this.opts.lastItem?this.opts.lastItem.jquery?this.opts.lastItem:$(this.opts.lastItem):null;if(!this.$initializationElement.length){return}this.$el=this.$initializationElement;this.favorWrapElem=true;this.$input=this.$el.find("input[name="+this.opts.paramName+"]");this.inputInitialized=false;if(!this.type){this.type=this.opts.type||"combined"}this.$parentHeaderSelector=this.$input.closest(".chg-header, .chg-hdr-root");this.isHeaderChild=this.$parentHeaderSelector&&this.$parentHeaderSelector.length;this.$dialogParentSelector=this.$input.closest(".dialog-widget");this.isDialogChild=this.$dialogParentSelector&&this.$dialogParentSelector.length;this.$appendTarget=this.isHeaderChild?C.dom.$headerRoot:C.dom.$root;this.isFixedCss=this.opts.cssPositioning.toLowerCase()==="fixed";this.$input.attr("autocomplete","off");this.$form=this.$input.parents("form");this.$button=this.$form.parent().find(this.opts.button);this.buttonRestoreHtml=this.$button.html();this.liRestoreHtml=null;this.submitButtonSpinner=null;this.url="/_ajax/autocomplete";this.trackId=this.generateTrackId();this.xhrCounter=0;this.xhr=[];this.canShow=0;this.suggestVal="";this.lastQuery="";this.userForcedSubmission=false;this.saveClickedHeader=null;this.changeSchoolUrl="/_ajax/user/changeschool";this.getSchoolUrl="/_ajax/school/info";this.gid=C.utility.getCookie("gid");this.schoolInfo={};this.evaluateSchoolData(this.gid);this.createDropdownContainer();this.doBind();$("#header_autocomplete").removeAttr("disabled").blur();$("#header_autocomplete_close").removeClass("icn-disabled");$(".chg-header input#header_autocomplete").keyup(function(e){if(e.keyCode==13){if($("li.suggest-selected").length>0){C.logger.doSessionLog({src:"header"})}else{C.logger.doSessionLog({src:"header",action:"enter"})}}});$(".chg-header #header_autocomplete_submit").click(function(e){C.logger.doSessionLog({src:"header",action:"button"})})},createDropdownContainer:function(){if(this.opts.dropdownOverride&&this.opts.overrideActiveClass){if(typeof this.opts.dropdownOverride==="string"){this.opts.dropdownOverride=$(this.opts.dropdownOverride)}this.$dropdown=this.opts.dropdownOverride;this.$psycic=this.opts.psycicResults;return}this.$dropdown=$('<div class="chg-autocomplete-container" id="autocomplete-'+this.instanceNumber+'"></div>').appendTo(this.$appendTarget).hide().css({position:this.opts.cssPositioning,zIndex:-1,width:this.opts.width})},doBind:function(){this.$input.observe({"focus.autocomplete":this.onTextboxFocus,"blur.autocomplete":this.onTextboxBlur,"keydown.autocomplete":this.onKeyDown,"keyup.autocomplete":this.onKeyUp},this);this.$dropdown.observe({mouseover:this.onMouseOverSelection,mousedown:this.onSelectionClick,mouseenter:this.onMouseEnter,mouseleave:this.onMouseLeave},this);$(this.opts.psycicResults).observe({mousedown:this.onSelectionClick,mouseover:this.onMouseOverSelection},this);this.$button.observe("click",this.onButtonClick,this);$(".chg-container").observe({mousedown:this.hideAS},this);$(".chg-header").observe({mousedown:this.hideAS},this);$("#header_autocomplete_close").observe({click:this.hideAS},this);$(window).observe("resize",this.hideDropdown,this)},getParsedUrl:function(){var getParamString="",limitParamsString="",combineResultsString="",paramDelimiter="";if(this.opts.additionalGetParamsString.length){paramDelimiter=this.opts.additionalGetParamsString.substring(1)=="&"?"":"&";getParamString=paramDelimiter+this.opts.additionalGetParamsString}if(this.opts.limitParamsString.length){paramDelimiter=this.opts.limitParamsString.substring(1)=="&"?"":"&";limitParamsString=paramDelimiter+this.opts.limitParamsString}if(this.opts.combineResultSets){combineResultsString="&combine_results="+this.opts.combineResultsString}return this.url+"?"+this.opts.ajaxParamName+"="+encodeURIComponent(this.$input.val())+"&type="+this.type+getParamString+limitParamsString+combineResultsString+"&trackid="+this.trackId},onTextboxFocus:function(e){if(this.$input.val().length&&this.$dropdown.html().length){this.canShow=1}this.animateContainerOpen()},onTextboxBlur:function(e){if(!this.mouseInDropdown){if(!this.$input.is(":focus")){this.canShow=0;this.hideDropdown();if(!this.$input.val()){this.clearSearchInput()}}this.opts.showResultsFlag=false}},onButtonClick:function(){var val=$.trim(this.$input.val());if(!(val==this.$input.attr("textvalue")||val==="")){this.$form.submit()}return false},callAjax:function(){if(!this.canShow){return}if(this.opts.useSpinner&&this.$button.length&&this.buttonRestoreHtml){if(!this.submitButtonSpinner){this.$button.html('<canvas class="loading" width="15" height="15"><img src="/s/_global/images/ajax-loader.gif"></canvas>');var cv=this.$button.find("canvas.loading");this.submitButtonSpinner=new C.widget.spinner({canvas:cv,color:"#FFFFFF"})}}this.xhr.push($.ajax({url:this.getParsedUrl(),dataType:"json",context:this,success:this.onAjaxSuccess,error:this.onAjaxError}))},onAjaxResponse:function(data){var builtResults=this.buildAutocompleteDropdown(data);if(builtResults){if(this.$button.length&&this.submitButtonSpinner){this.$button.html(this.buttonRestoreHtml);this.submitButtonSpinner=null}}else{$("body").trigger("autocomplete:noResults")}},onKeyUp:function(e){if(e.keyCode==13){var psycicResult=$("#autosuggest-psycic li.autosuggest-result-psycic.suggest-selected a");if(psycicResult.length>0){psycicResult.removeClass("suggest-selected");this.GAclient.trigger("report custom event",{page:"Header",section:"Psycic search",link:psycicResult.attr("data-reportlink")})}this.userForcedSubmission=true;this.hideDropdown();return}var val=$.trim(this.$input.val());if(this.lastQuery==val){return}this.lastQuery=val;var defaultVal=String(this.$input.attr("textvalue"));if(val==defaultVal||val===""||val.length<this.opts.minChar){if(this.$button.length&&this.submitButtonSpinner){this.$button.html(this.buttonRestoreHtml);this.submitButtonSpinner=null}this.canShow=0;$("#autosuggest-results").hide().removeClass("active");$(this.opts.psycicResults).show().css("height","auto").addClass("active");$(this.opts.psycicResults).find("li").removeClass("suggest-selected");return}this.canShow=1;this.suggestVal="";this.fireAjax();this.userForcedSubmission=false;$(this.opts.psycicResults).hide();$(this.opts.psycicResults).find("li").removeClass("suggest-selected");this.onTextboxFocus()},animateContainerOpen:function(){if(C.global.pageObject.schoolId){this.responseId=C.global.pageObject.schoolId}if(!this.canShow){this.GAclient.trigger("report custom event",{page:"Header",section:"Psycic search",link:"Show"});this.updatePsycicMarkup();$(this.opts.psycicResults).removeAttr("style").addClass("active");$(this.opts.psycicResults).show();$(".icn-x").show();this.opts.showResultsFlag=true}else{$(this.opts.autoSuggestResults).removeAttr("style").addClass("active");$(this.opts.autoSuggestResults).show();this.showDropdown()}if(this.opts.slideDown==true)$(this.opts.container).slideDown(300);else $(this.opts.container).css("display","block");this.resizeTitleContainer()},clearSearchInput:function(){$("#header_autocomplete").val("");$(".icn-x").hide();$("#header_autocomplete").focusout()},onMouseEnter:function(){if(this.mouseInDropdown){return}this.mouseInDropdown=true},onMouseOverSelection:function(e){var $cur=this.getTargetedLi(e),container=e.currentTarget;if($cur.length){$(container).find("li").removeClass("suggest-selected");$cur.addClass("suggest-selected")}this.changeSelection($cur)},showDropdown:function(){if(!this.canShow){return}if(this.userForcedSubmission){return}if(this.opts.dropdownOverride&&this.opts.overrideActiveClass){if(this.$dropdown&&!this.$dropdown.hasClass(this.opts.overrideActiveClass)){this.$dropdown.addClass(this.opts.overrideActiveClass)}return}var width=this.opts.width||this.$input.outerWidth(),inputOffset=this.$input.offset(),inputOffsetLeft=inputOffset.left,$staticPositionGetterElement=this.favorWrapElem?this.$initializationElement:this.$input,inputOffsetTop=this.isFixedCss?$staticPositionGetterElement.position().top:$staticPositionGetterElement.offset().top,height=$staticPositionGetterElement.outerHeight(true),autocompleteLeftOffset=inputOffset.left,autocompleteTopOffset=height+this.opts.topOffset;var zIndex=[0];this.$input.parents().each(function(i,el){zIndex.push(+$(el).css("zIndex")||0)});zIndex=C.utility.max(zIndex)+1;if(this.opts.cssPositioning!=="fixed"&&!this.isHeaderChild){var scrollTop=this.$input.scrollTop();autocompleteTopOffset+=scrollTop+inputOffset.top}else if(this.isDialogChild){autocompleteTopOffset+=$staticPositionGetterElement.position().top+parseInt(this.$dialogParentSelector.css("top"),10)}this.$dropdown.css({position:this.opts.cssPositioning,zIndex:zIndex,width:width+"px",left:autocompleteLeftOffset+"px",top:autocompleteTopOffset+"px"}).show();this.userForcedSubmission=false},hideDropdown:function(){var o=this;$("#autosuggest-results-container").hide();o.$dropdown.hide();$("#header_autocomplete").focusout()},hideAS:function(event){var clickTarget=event.target;var resultsContainer=document.getElementById("autosuggest-results-container");var inParentContainer=$.contains(resultsContainer,clickTarget);var isInput=clickTarget==document.getElementById("header_autocomplete");var obj=this;$(resultsContainer).find("li").removeClass("suggest-selected");if($(clickTarget).hasClass("icn-magnify")==false){if(!inParentContainer&&!isInput){$(resultsContainer).hide();$(this.opts.autoSuggestResults).hide();$("#header_autocomplete").blur().val("")}this.canShow=0;this.opts.showResultsFlag=false}},toOrdinal:function(i){var j=i%10;if(j==1&&i!=11){return i+"st"}if(j==2&&i!=12){return i+"nd"}if(j==3&&i!=13){return i+"rd"}return i+"th"},buildAutocompleteSectionItem:function(autoCompleteItem,iiIndex){var html=[],iiCount=iiIndex,replacement='<span class="chg-suggest-term">$1</span>',isQuestion=autoCompleteItem.title?autoCompleteItem.title.toLowerCase().indexOf("question")>=0:false,shouldHighlightTerm=isQuestion?autoCompleteItem.replaceIsSafe:true,replaceTerm=isQuestion&&shouldHighlightTerm?$.trim(autoCompleteItem.replaceTerm):$.trim(this.$input.val()),regex=new RegExp("("+this.RegExpQuote(replaceTerm)+")","i"),safeReplaceTitle=$("<div/>").html(autoCompleteItem.title).text(),hasTBS=typeof autoCompleteItem.hasTBS!=="undefined"&&autoCompleteItem.hasTBS?autoCompleteItem.hasTBS:false,isCourse=autoCompleteItem.typeicon&&autoCompleteItem.typeicon.type=="course";var itemType=autoCompleteItem.itemType?autoCompleteItem.itemType:"book";if(autoCompleteItem.title){var printTitle=shouldHighlightTerm?safeReplaceTitle.replace(regex,replacement):autoCompleteItem.title;autoCompleteItem.title=printTitle}if(autoCompleteItem.isbnText){var printIsbn=autoCompleteItem.isbnText.replace(regex,replacement);printIsbn=printIsbn.replace("&amp;nbsp;"," &nbsp; ");if(autoCompleteItem.editionNo&&autoCompleteItem.editionNo!=0){printIsbn=this.toOrdinal(autoCompleteItem.editionNo)+" Edition - "+printIsbn}if(itemType=="ebook"){printIsbn=printIsbn.replace("ISBN","eISBN");printIsbn=printIsbn.replace("ISBN13","eISBN13")}autoCompleteItem.isbnText=printIsbn}if(autoCompleteItem.img){if(autoCompleteItem.img.url){var imgAlt=autoCompleteItem.img.alt?autoCompleteItem.img.alt:"chegg image";autoCompleteItem.img.alt=imgAlt}}if(typeof autoCompleteItem.itemPromo=="object"&&(autoCompleteItem.itemPromo.hasTBS||autoCompleteItem.itemPromo.hasInstantAccess||autoCompleteItem.itemPromo.hasEbook)){var item=autoCompleteItem.itemPromo;autoCompleteItem.hasItemPromo=true;autoCompleteItem.hasTBS=item.hasTBS?item.hasTBS:false;autoCompleteItem.hasInstantAccess=item.hasInstantAccess?item.hasInstantAccess:false;autoCompleteItem.hasEbook=item.hasEbook?item.hasEbook:false;if(autoCompleteItem.hasEbook&&autoCompleteItem.hasTBS){autoCompleteItem.availableEbookText='<span class="skip-available">eTextbook</span>'}else{autoCompleteItem.availableEbookText='<span class="emphasis">Available:</span> eTextbook'}}else{autoCompleteItem.hasItemPromo=false}autoCompleteItem.courseClassName=courseClassName=isCourse?" autosuggest-result-course":" ";autoCompleteItem.iiCount=iiCount;switch(itemType){case"ebook":var item=template.ebook({item:autoCompleteItem});break;case"course":var item=template.course({item:autoCompleteItem});break;case"dac":var item=template.dac({item:autoCompleteItem});break;case"book":default:var item=template.book({item:autoCompleteItem})}html.push(item);return html.join("")},onKeyDown:function(e){if(e.keyCode==40){this.doNextSelection(e);e.preventDefault()}else if(e.keyCode==38){this.doPrevSelection(e);e.preventDefault()}else if(e.keyCode==27){this.$input.val("");this.$input.blur();this.hideDropdown()}else if(e.keyCode==13){this.onSubmit(e)}},doNextSelection:function(e){var activeDropdown=this.$dropdown.hasClass("active")?this.$dropdown:this.$psycic;var $lis=$(activeDropdown).find("li.autosuggest-result"),index=$lis.index($(activeDropdown).find("li.suggest-selected")),$cur;$lis.removeClass("suggest-selected");if(index==-1||index>=$lis.length-1){$cur=$lis.eq(0).addClass("suggest-selected")}else{$cur=$lis.eq(index+1).addClass("suggest-selected")}this.changeSelection($cur)},doPrevSelection:function(e){var activeDropdown=this.$dropdown.hasClass("active")?this.$dropdown:this.$psycic;var $lis=$(activeDropdown).find("li.autosuggest-result"),index=$lis.index($(activeDropdown).find("li.suggest-selected")),$cur;$lis.removeClass("suggest-selected");if(index==-1||index===0){$cur=$lis.eq($lis.length-1).addClass("suggest-selected")}else{$cur=$lis.eq(index-1).addClass("suggest-selected")}this.changeSelection($cur)},evaluateSchoolData:function(gid){savedId=C.utility.getLocal("schoolId");savedName=C.utility.getLocal("schoolName");if(!gid){return false}if(gid&&savedId&&savedName&&gid==savedId){this.schoolInfo={schoolName:savedName,schoolId:savedId};return true}else{this.getSchool(gid)}},updatePsycicMarkup:function(){$("#autosuggest-psycic").html(template.psycic({schoolInfo:this.schoolInfo}))},getSchool:function(id){var postData={school:id};var o=this;$.ajax({type:"GET",dataType:"json",url:this.getSchoolUrl,data:postData,success:function(response){var school=response.schoolInfo;C.utility.setLocal("schoolId",school.schoolId);C.utility.setLocal("schoolName",school.nickname?school.nickname:school.longName);o.schoolInfo={schoolName:school.nickname?school.nickname:school.longName,schoolId:school.schoolId};o.updatePsycicMarkup();return true},error:function(){return false}})},onSelectionClick:function(e){if($(e.target).hasClass("autocomplete-show-more")){this.hideAS(e.target);C.utility.navigate(e.target.href);return}if($(e.target).parents().hasClass("autosuggest-result-psycic")){var url=$(e.target).parents("a").attr("href")!=undefined?$(e.target).parents("a").attr("href"):$(e.target).attr("href");this.GAclient.trigger("report custom event",{page:"Header",section:"Psycic search",link:$(e.target).parents("a").attr("data-reportlink")});C.utility.navigate(url);return}if($(e.target).parents().hasClass("autosuggest-no-results")){return}if($(e.target).hasClass("autocomplete-hasTBS")){return}if(e.which!==1){return}this.$curLi=this.getTargetedLi(e);this.hideDropdown();if(this.$curLi.hasClass("last-item")){if(this.opts.lastItemCallback){this.opts.lastItemCallback(e,this.$curLi,this.$initializationElement)}return false}if(this.$curLi.hasClass("question-get")&&!this.$curLi.hasClass("no-modal")&&this.opts.subType!="answers"){var qid=this.$curLi.attr("data-qid");this.wireQuestionsList(qid);return false}if(this.opts.callback){this.opts.callback(e,this.$curLi,this.$initializationElement);return}var $clickedHeader=this.$curLi.find(".autocomplete-hdr");if($clickedHeader.length){this.saveClickedHeader=$clickedHeader.text();this.updateInputVal()}this.liRestoreHtml=this.$curLi.html();this.$curLi.html('<canvas class="loading" width="20" height="20"><img src="/s/_global/images/ajax-loader-white.gif"></canvas>');var cv=this.$curLi.find("canvas.loading");new C.widget.spinner({canvas:cv,color:"#000000"});if(this.$curLi.hasClass("school-change")){this.changeUserSchool(e,this.$curLi);return false}var url=this.$curLi.attr("data-url"),ii=this.$curLi.attr("data-ii");if(ii!=undefined){url=url.indexOf("?")==-1?url+"?ii="+ii:url+"&ii="+ii;if(this.opts.track){url+="&"+this.opts.track}}if(this.liRestoreHtml){this.$curLi.html(this.liRestoreHtml);this.liRestoreHtml=null}C.logger.doSessionLog({src:"header"});C.utility.navigate(url);return false},resizeTitleContainer:function(){var ASWidth=$(".autosuggest-result-data").width();ASWidth=parseInt(ASWidth)-30;$(".autosuggest-result-title").css("width",ASWidth)},onSubmit:function(e){if(!this.$curLi){if(this.opts.track){var trk=this.opts.track.split("=");this.$form.append('<input type="hidden" name="'+trk[0]+'" value="'+trk[1]+'" />')}return true}var $clickedHeader=this.$curLi.find(".autocomplete-hdr");var inputVal=this.$input.val();if(this.suggestVal&&this.suggestVal.length||inputVal!=""){e.preventDefault();this.hideDropdown();if($clickedHeader.length){this.saveClickedHeader=$clickedHeader.text()}if(this.opts.callback&&this.$curLi){this.opts.callback(e,this.$curLi,this.$initializationElement);return false}if(this.$curLi.hasClass("school-change")){this.changeUserSchool(e,this.$curLi);return false}var url=this.$curLi.attr("data-url"),ii=this.$curLi.attr("data-ii");if(ii!=undefined){var results=$(".autosuggest-result");var selectedResult=false;$.each(results,function(){if($(this).hasClass("suggest-selected")){selectedResult=true}});if(selectedResult){url=url.indexOf("?")==-1?url+"?ii="+ii:url+"&ii="+ii;if(this.opts.track){url+="&"+this.opts.track}}else{url="/search/"+inputVal+"/books";C.utility.navigate(url);return false}}else{url="/search/"+inputVal+"/books"}C.utility.navigate(url);return false}else{var url=this.$curLi.find("a").attr("href");C.utility.navigate(url);return false}return true},buildAutocompleteDropdown:function(data){var responseData=typeof data=="object"?data:jQuery.parseJSON(data);if(!responseData){return}var idSafeType=this.opts.type.replace("|","_"),markupDiv='<div id="'+idSafeType+'_autocomplete"></div>',$markup=$(markupDiv),iiIndex=1;if(responseData[0].items[0]==undefined){this.$dropdown.html($markup);$(this.opts.psycicResults).hide().removeClass("active");$(this.opts.autoSuggestResults).show().addClass("active");$markup.append(template.noresults());return true}if(responseData){for(var responseSection in responseData){if(responseData[responseSection].title){var $autoItemsList=$("<ul></ul>");if(this.needsQuestionsLists){$autoItemsList.addClass("questions-list")}for(var item in responseData[responseSection].items){var Li=this.buildAutocompleteSectionItem(responseData[responseSection].items[item],iiIndex),$Li=$(Li);$autoItemsList.append($Li);iiIndex++}$markup.append($autoItemsList)}}this.$dropdown.html($markup);$(this.opts.psycicResults).hide().removeClass("active");$(this.opts.autoSuggestResults).show().addClass("active");if($markup.html()==""){return false}this.schoolInfo["query"]=this.$input.val();$markup.append(template.showall({schoolInfo:this.schoolInfo}));this.resizeTitleContainer();return true}}})})(jQuery);var template={};template.book=_.template('<li class="autosuggest-result" data-ii="<%= item.iiCount %>" data-url="<%= item.attributes["data-url"] %>">'+'<a href="<%= item.attributes["data-url"] %>">'+'<span class="autosuggest-width"><span class="autosuggest-row row"><span class="col-12 col-first col-last">'+'<div class="autosuggest-result-meta">'+"<% if(_.isEqual(item.hasItemPromo,true)){ %>"+'<span class="autosuggest-icon-meta"></span>'+'<div class="autosuggest-results-meta-info">'+"<% if(_.isEqual(item.hasTBS,true)){ %>"+'<span class="autosuggest-results-meta-info-item">'+'<span class="emphasis">Available:</span> Step-by-step Solutions</span>'+"<% } %>"+"<% if(_.isEqual(item.hasEbook,true)){ %>"+'<span class="autosuggest-results-meta-info-item">'+"<%= item.availableEbookText %>"+"<% } %>"+"<% if(_.isEqual(item.hasInstantAccess,true)){ %>"+'<span class="autosuggest-results-meta-info-item">'+'<span class="emphasis">Includes:</span> Free 7-day eTextbook Access</span>'+"<% } %>"+"</div>"+"<% } %>"+"</div>"+'<div class="autosuggest-result-data">'+'<span class="img-wrapper"><img src="<%= item.img.url %>" alt="<%= item.imgAlt %>"></span>'+'<div class="autosuggest-result-bookinfo-sizer"><div class="autosuggest-result-bookinfo">'+'<span class="autosuggest-result-title autocomplete-hdr"><%= item.title %></span>'+'<span class="autosuggest-result-author"><%= item.author %></span>'+'<span class="autosuggest-result-info"><%= item.isbnText %></span>'+"</div></div>"+"</div>"+"</span></span></span>"+"</a>"+"</li>");

template.ebook=_.template('<li class="autosuggest-result" data-ii="<%= item.iiCount %>" data-url="<%= item.attributes["data-url"] %>">'+'<a href="<%= item.attributes["data-url"] %>">'+'<span class="autosuggest-width"><span class="autosuggest-row row"><span class="col-12 col-first col-last">'+'<div class="autosuggest-result-meta">'+"<% if(_.isEqual(item.hasItemPromo,true)){ %>"+'<span class="autosuggest-icon-meta"></span>'+'<div class="autosuggest-results-meta-info">'+"<% if(_.isEqual(item.hasTBS,true)){ %>"+'<span class="autosuggest-results-meta-info-item">'+'<span class="emphasis">Available:</span> Step-by-step Solutions</span>'+"<% } %>"+"<% if(_.isEqual(item.hasInstantAccess,true)){ %>"+'<span class="autosuggest-results-meta-info-item">'+'<span class="emphasis">Includes:</span> Free 7-day eTextbook Access</span>'+"<% } %>"+"</div>"+"<% } %>"+"</div>"+'<div class="autosuggest-result-data">'+'<span class="autosuggest-icon autosuggest-icon-etextbook-sml"></span>'+'<span class="img-wrapper"><img src="<%= item.img.url %>" alt="<%= item.imgAlt %>"></span>'+'<div class="autosuggest-result-bookinfo-sizer"><div class="autosuggest-result-bookinfo">'+'<span class="autosuggest-result-title autocomplete-hdr"><%= item.title %></span>'+'<span class="autosuggest-result-author"><%= item.author %></span>'+'<span class="autosuggest-result-info"><%= item.isbnText %></span>'+"</div></div>"+"</div>"+"</span></span></span>"+"</a>"+"</li>");template.dac=_.template('<li class="autosuggest-result" data-ii="<%= item.iiCount %>" data-url="<%= item.attributes["data-url"] %>">'+'<a href="<%= item.attributes["data-url"] %>">'+'<span class="autosuggest-width"><span class="autosuggest-row row"><span class="col-12 col-first col-last">'+'<div class="autosuggest-result-meta">'+"<% if(_.isEqual(item.hasItemPromo,true)){ %>"+'<span class="autosuggest-icon-meta"></span>'+'<div class="autosuggest-results-meta-info">'+"<% if(_.isEqual(item.hasTBS,true)){ %>"+'<span class="autosuggest-results-meta-info-item">'+'<span class="emphasis">Available:</span> Step-by-step Solutions</span>'+"<% } %>"+"<% if(_.isEqual(item.hasEbook,true)){ %>"+'<span class="autosuggest-results-meta-info-item">'+"<%= item.availableEbookText %>"+"<% } %>"+"<% if(_.isEqual(item.hasInstantAccess,true)){ %>"+'<span class="autosuggest-results-meta-info-item">'+'<span class="emphasis">Includes:</span> Free 7-day eTextbook Access</span>'+"<% } %>"+"</div>"+"<% } %>"+"</div>"+'<div class="autosuggest-result-data">'+'<span class="autosuggest-icon autosuggest-icon-etextbook-sml"></span>'+'<span class="img-wrapper icon-dac"></span>'+'<div class="autosuggest-result-bookinfo-sizer"><div class="autosuggest-result-bookinfo">'+'<span class="autosuggest-result-title autocomplete-hdr"><%= item.title %></span>'+'<span class="autosuggest-result-author"><%= item.author %></span>'+'<span class="autosuggest-result-info"><%= item.isbnText %></span>'+"</div></div>"+"</div>"+"</span></span></span>"+"</a>"+"</li>");template.course=_.template('<li class="autosuggest-result autosuggest-result-course" data-ii="<%= item.iiCount %>" data-url="<%= item.attributes["data-url"] %>">'+'<a href="<%= item.attributes["data-url"] %>">'+'<span class="autosuggest-width"><span class="autosuggest-row row"><span class="col-12 col-first col-last">'+'<div class="autosuggest-result-data">'+'<span class="autosuggest-icon autosuggest-icon-course"></span>'+'<div class="autosuggest-result-courseinfo">'+'<span class="autosuggest-result-title autocomplete-hdr"><%= item.title %><span class="small"> at <%= item.attributes["data-schoolName"] %></span></span>'+'<span class="autosuggest-result-info"><%= item.subtitle %></span>'+"</div>"+"</div>"+"</span></span></span>"+"</a>"+"</li>");template.psycic=_.template("<ul>"+'<li class="autosuggest-result autosuggest-result-psycic" data-url="topbooks"><a data-reportLink="Top textbooks" href="/psearch/top-textbooks<% if(_.isNumber(schoolInfo.schoolId)){ %>?schoolId=<%= schoolInfo.schoolId %><% } %>"><span class="autosuggest-width"><span class="autosuggest-row row"><span class="col-12 col-first col-last"><span class="autosuggest-icon autosuggest-icon-textbook"></span>Top Textbooks<% if(!_.isEmpty(schoolInfo.schoolName)){ %> at <%= schoolInfo.schoolName %><% } %></span></span></span></a></li>'+'<li class="autosuggest-result autosuggest-result-psycic" data-url="topebooks"><a data-reportLink="Top eTextbooks" href="/psearch/top-etextbooks<% if(_.isNumber(schoolInfo.schoolId)){ %>?schoolId=<%= schoolInfo.schoolId %><% } %>"><span class="autosuggest-width"><span class="autosuggest-row row"><span class="col-12 col-first col-last"><span class="autosuggest-icon autosuggest-icon-etextbook"></span>Top eTextbooks<% if(!_.isEmpty(schoolInfo.schoolName)){ %> at <%= schoolInfo.schoolName %><% } %></span></span></span></a></li>'+'<li class="autosuggest-result autosuggest-result-psycic" data-url="topsolutions"><a data-reportLink="Top textbook solutions" href="/psearch/top-textbooksolutions<% if(_.isNumber(schoolInfo.schoolId)){ %>?schoolId=<%= schoolInfo.schoolId %><% } %>"><span class="autosuggest-width"><span class="autosuggest-row row"><span class="col-12 col-first col-last"><span class="autosuggest-icon autosuggest-icon-solution"></span>Top Textbook Solutions<% if(!_.isEmpty(schoolInfo.schoolName)){ %> at <%= schoolInfo.schoolName %><% } %></span></span></span></a></li>'+'<li class="autosuggest-result autosuggest-result-psycic" data-url="sell-textbooks"><a data-reportLink="Sell textbooks" href="/sell-textbooks" class="psychic-sell-textbooks"><span class="autosuggest-width"><span class="autosuggest-row row"><span class="col-12 col-first col-last"><span class="autosuggest-icon autosuggest-icon-selltextbooks"></span>Sell your books</span></span></span></a></li>'+"</ul>");template.noresults=_.template('<ul class="autosuggest-no-results"><li class="autosuggest-result autosuggest-result-psycic">'+'<span class="autosuggest-width"><span class="autosuggest-row row"><span class="col-12 col-first col-last">'+'<div class="autosuggest-result-data">'+'<span class="img-wrapper"></span>'+'<div class="autosuggest-result-bookinfo-sizer"><div class="autosuggest-result-bookinfo">'+"No Search Results Were Found."+"</div></div>"+"</div>"+"</span></span></span>"+"</li></ul>");template.showall=_.template('<div class="autosuggest-morelinks"><ul>'+'<li><a href="/search/<% if(!_.isEmpty(schoolInfo.query)){ %><%= schoolInfo.query %><% } %>/books" class="autocomplete-show-more">Search For Books <span>&raquo;</span></a></li>'+'<li><a href="/search/<% if(!_.isEmpty(schoolInfo.query)){ %><%= schoolInfo.query %><% } %>/books#p=1&eBook=1" class="autocomplete-show-more">Search For eBooks <span>&raquo;</span></a></li><% if(!_.isEmpty(schoolInfo.schoolName) && _.isNumber(schoolInfo.schoolId)){ %>'+'<li><a href="/search/<% if(!_.isEmpty(schoolInfo.query)){ %><%= schoolInfo.query %><% } %>/courses/<%= schoolInfo.schoolName %>#p=1" class="autocomplete-show-more">Search For Courses <span>&raquo;</span></a></li><% } %>'+"</ul></div>");(function($){C("widget");C.widget.floatingMenu=C.widget._base.extend({construct:function(opts){this.opts=$.extend({contentArea:C.dom.$content,fixedClass:null,lastFixTopOffset:0},opts);this.elem=opts.el.jquery?opts.el:$(opts.el);this.marginTop=opts.marginTop;this.cssPosition=this.elem.css("position");this.cssTop=this.elem.css("top");this.cssWidth=this.elem.width();this.setDiv=$("<div></div>");this.elem.before(this.setDiv);C.dom.$window.observe("scroll",this.doScroll,this);C.dom.$window.observe("resize",this.doScroll,this);this.doScroll()},doScroll:function(event){var trackTop=this.setDiv.offset().top-this.marginTop;var scrollTop=$(window).scrollTop();if(scrollTop>=trackTop){this.elem.css({visibility:"hidden",position:"fixed",top:this.marginTop,"min-width":this.cssWidth});if(this.opts.fixedClass){this.elem.addClass(this.opts.fixedClass)}var contentBottom=this.getContentBottom();var elemBottom=this.getElemBottom();if(this.opts.lastFixTopOffset&&elemBottom>=this.opts.lastFixTopOffset){this.elem.css({position:this.cssPosition,top:this.cssTop,"min-width":this.cssWidth})}else if(elemBottom>=contentBottom){this.elem.css("top",this.marginTop-(elemBottom-contentBottom))}this.elem.css("visibility","visible")}else{if(this.opts.fixedClass){this.elem.removeClass(this.opts.fixedClass)}this.elem.css({position:this.cssPosition,top:this.cssTop,"min-width":this.cssWidth})}},getContentBottom:function(){var content=this.opts.contentArea;if(content.length===0){return 0}return content.offset().top+content.outerHeight()},getElemBottom:function(){if(this.elem.length===0){return 0}return this.elem.offset().top+this.elem.outerHeight()+parseFloat(this.elem.css("margin-bottom").replace("px",""))},destruct:function(){this.setDiv.remove()}})})(jQuery);C("widget");C.widget.dialog=C.widget._base.extend({construct:function(opts){this.opts=$.extend({top:"50",type:"string",content:"",overlay:true,background:"#000",opacity:.4,overlayClose:true,resizeClose:false,successCallback:null,errorCallback:null,showPaging:false,pageRightCallback:null,pageLeftCallback:null,contentChangeCallback:null,fixed:true,afterHideCallback:null,afterHideCallbackContext:null,destroyOnClose:false,noAutoScroll:false},opts);this.$root=C.dom.$root;this.$window=C.dom.$window;if(!this.$root.length||!this.$window.length){return}this.closeDialog=".chg-dialog-close";this.isHidden=true;this.$body=C.dom.$body||null;this.isResizing=false;this.overlayZIndex=0;this.createOverlay();this.createDialog();this.createPagingButtons();this.doBind();this.handlingScroll=false;this.lastScrollTop=null;if(this.opts.content.length){if(this.opts.type=="ajax"){this.doAjax()}else if(this.opts.type=="string"){this.doString()}}},createOverlay:function(){this.overlayZIndex=C.utility.getMaxIndex()+1;if(this.opts.overlay){this.$overlay=$('<div style="position:fixed;top:0;left:0;z-index:-1;" id="overlay-'+this.eventNamespace+'"></div>').appendTo(this.$root).css({background:this.opts.background,opacity:this.opts.opacity}).hide()}},createDialog:function(){var positionType=this.opts.fixed?"fixed":"absolute";this.$dialog=$('<div id="dialog-'+this.eventNamespace+'" class="dialog-widget"></div>').appendTo(this.$root).css({position:positionType,zIndex:-1,top:"-9999px",left:"-9999px"})},styleDropdown:function(selector){selector=selector||"select";this.$dialog.find(selector).chosen({disable_search_threshold:8})},createPagingButtons:function(){if(!this.opts.showPaging){return}this.$pageLeft=this.$pageLeft||$('<div class="dialog-pg-lt-wrap"><button class="dialog-pg-lt" type="button"> </button></div>');this.$pageRight=this.$pageRight||$('<div class="dialog-pg-rt-wrap"><button class="dialog-pg-rt" type="button"> </button></div>')},positionPagingButtons:function(){if(!this.$dialog||!this.opts.showPaging){return}var existingPager=this.$dialog.find(".dialog-pg-lt-wrap");if(!existingPager.length){this.$dialog.append(this.$pageLeft);this.$dialog.append(this.$pageRight)}if(!this.$pageLeft||!this.$pageRight){return}if(!this.opts.fixed){var $lwrap=$(".dialog-pg-lt-wrap"),$rwrap=$(".dialog-pg-rt-wrap");$lwrap.css({position:"absolute",top:"100px"});$rwrap.css({position:"absolute",top:"100px"});this.$pageLeft.css({left:"-50px"});this.$pageRight.css({right:"-50px"})}else{var $doc=$(document),width=$doc.width(),dialogLeft=(width-this.$dialog.width())/2,dialogWidth=+this.$dialog.outerWidth(),leftPagerLeftPos=dialogLeft-50,rightPagerLeftPos=dialogLeft+dialogWidth;this.$pageLeft.css({left:leftPagerLeftPos+"px"});this.$pageRight.css({left:rightPagerLeftPos+"px"})}},showOverLay:function(useIndex){if(this.$overlay){var $doc=$(document),width=$doc.width(),height=$doc.height();this.$overlay.css({width:width+"px",height:height+"px"}).show();this.isHidden=false;if(useIndex){this.$overlay.css({zIndex:this.overlayZIndex})}}},showDialog:function(){var width=$(document).width(),zIndex=this.overlayZIndex+1,top=this.getDialogTopPositionVal();var o=this;this.$dialog.css({top:top+"px",left:(width-o.$dialog.width())/2+"px",zIndex:zIndex});if(this.opts.fixed){this.setMaxDialogContentHeight()}this.$dialog.show();this.showOverLay(1);this.isHidden=false},applySizeChangeAfterHide:function(){var $doc=$(document),width=$doc.width(),height=$doc.height(),zIndex;this.$overlay.css({width:width+"px",height:height+"px"});var zIndex=this.overlayZIndex+1,top=this.getDialogTopPositionVal();this.$dialog.css({zIndex:zIndex});var o=this;this.$dialog.css({top:top+"px",left:(width-o.$dialog.width())/2+"px"});if(this.opts.fixed){this.setMaxDialogContentHeight()}this.positionPagingButtons()},getDialogTopPositionVal:function(){var top=parseInt(this.opts.top,10);if(!this.opts.fixed){top+=parseInt(C.dom.$window.scrollTop(),10)}return top},handleResize:function(){if(!this.$dialog||this.isResizing){return}this.isResizing=true;if(this.opts.resizeClose){this.hideDialog();this.hideOverlay();this.applySizeChangeAfterHide();return}if(!this.$overlay&&this.opts.overlay){this.createOverlay()}if(!this.$dialog){this.createDialog()}if(this.isHidden){this.applySizeChangeAfterHide()}else{this.showDialog()}this.positionPagingButtons();this.isResizing=false},setMaxDialogContentHeight:function(){if(!this.$dialog){return}var $dialogHead=this.$dialog.find(".dialog-hdr"),$dialogFoot=this.$dialog.find(".dialog-ftr"),$dialogBody=this.$dialog.find(".dialog-content"),headHeight=+$dialogHead.outerHeight(),footHeight=+$dialogFoot.outerHeight(),fixedHeight=$(window).height()-2*+this.opts.top-headHeight-footHeight,overflow=this.opts.noAutoScroll?"":"auto";$dialogBody.css({"max-height":fixedHeight+"px","overflow-y":overflow})},doBind:function(){this.$dialog.observe("click",this.closeDialog,this.fireClose,this);if(this.opts.overlayClose){this.$overlay.observe("click",this.hide,this)}this.$window.observe("resize",this.handleResize,this);this.$window.observe("scroll",this.pagerButtonsHandleScroll,this);if(this.opts.showPaging){this.$pageLeft.observe("click",this.handlePageLeft,this);this.$pageRight.observe("click",this.handlePageRight,this);if(this.$body){this.$body.observe("keyup",this.pagingKeyUp,this)}if(C.support.touch){this.$dialog.observe("touchend",function(e){if(!this.isHidden){if(C.support.util.slideLeft){this.handlePageRight();e.preventDefault();e.stopPropagation()}else if(C.support.util.slideRight){this.handlePageLeft();e.preventDefault();e.stopPropagation()}}},this)}}},pagerButtonsHandleScroll:function(){if(!this.opts.showPaging||this.handlingScroll||this.opts.fixed){return}this.handlingScroll=true;setTimeout($.proxy(function(){var $lwrap=$(".dialog-pg-lt-wrap"),$rwrap=$(".dialog-pg-rt-wrap"),currentPagingTop=parseInt($lwrap.css("top")),dialogTop=parseInt(this.$dialog.css("top"),10),scrollValue=C.dom.$body.scrollTop()-dialogTop,dialogHeight=this.$dialog.outerHeight(),maxPosition=dialogHeight-dialogTop-100,newTop;if(dialogHeight<200){this.handlingScroll=false;return}if(this.lastScrollTop&&scrollValue<this.lastScrollTop){newTop=currentPagingTop-scrollValue}else{newTop=currentPagingTop+scrollValue}if(newTop>maxPosition){newTop=maxPosition}if(newTop<100||C.dom.$body.scrollTop()<dialogTop){newTop=100}this.lastScrollTop=newTop;$lwrap.animate({top:newTop+"px"},250);$rwrap.animate({top:newTop+"px"},250);var self=this;setTimeout(function(){self.handlingScroll=false},300)},this),1e3)},pagingKeyUp:function(e){if(this.isHidden||!this.$dialog){return}var $focus=$(":focus"),$engagedMceEditor=this.$dialog.find(".mceIframeContainer");if($engagedMceEditor.length){return}if($focus.is("textarea, input")){return}var key=e.which;if(key===39){this.handlePageRight()}if(key===37){this.handlePageLeft()}return false},handlePageRight:function(){this.opts.pageRightCallback()},handlePageLeft:function(){this.opts.pageLeftCallback()},disablePaging:function(){this.disablePageLeft();this.disablePageRight()},disablePageLeft:function(){if(!this.$pageLeft){return}this.$pageLeft.find(".dialog-pg-lt").attr("disabled","disabled");this.$pageLeft.off("click")},disablePageRight:function(){if(!this.$pageRight){return}this.$pageLeft.find(".dialog-pg-rt").attr("disabled","disabled");this.$pageRight.off("click")},show:function(){if(this.opts.overlay){if(!this.$overlay){this.createOverlay()}this.$overlay.show()}if(!this.$dialog){this.createDialog()}if(!this.opts.fixed){var top=this.getDialogTopPositionVal();var o=this;this.$dialog.css({top:top+"px"})}this.$dialog.show();this.isHidden=false},fireClose:function(e){if(e){e.preventDefault()}if(this.opts.destroyOnClose){this.destroy()}else{this.hide();C.dom.$body.trigger("hideModerator")}},hide:function(){this.hideOverlay();this.hideDialog();if(this.opts.afterHideCallback){if(this.opts.afterHideCallbackContext){this.opts.afterHideCallback.call(this.opts.afterHideCallbackContext)}else{this.opts.afterHideCallback()}}},hideOverlay:function(){this.$overlay.hide()},getHiddenValue:function(){return this.isHidden},hideDialog:function(){this.$dialog.hide();this.isHidden=true},remove:function(){if(this.$dialog){this.$dialog.remove()}if(this.$overlay){this.$overlay.remove()}},doAjax:function(){this.$dialog.css({"min-width":600+"px"});this.showLoader();$.ajax({url:this.opts.content,context:this,success:this.onAjaxSuccess,error:this.onAjaxError})},showLoader:function(){this.populateDialog('<canvas class="chg-dialog-spinner" width="40" height="40"><div class="chg-dialog-spinner-fallback"></div></canvas>');this.showDialog();new C.widget.spinner({canvas:".chg-dialog-spinner",color:"#ffffff",spokes:15,thickness:3})},onAjaxSuccess:function(data){this.showLoader();this.populateDialog(data);if(this.opts.successCallback)this.opts.successCallback()},populateDialog:function(data){if(!this.$dialog){return}if(typeof data=="string"){this.$dialog.html(data)}else{this.$dialog.empty();this.$dialog.append(data)}if(this.opts.showPaging){this.positionPagingButtons()}this.setMaxDialogContentHeight();this.onDialogContentChange()},doString:function(){this.populateDialog(this.opts.content);this.showDialog()},onAjaxError:function(){if(this.opts.errorCallback)this.opts.errorCallback()},onDialogContentChange:function(){if(typeof this.opts.onContentChange=="function"){this.opts.contentChangeCallback()}},destruct:function(){C.log("dialog:destruct");this.$overlay.remove();this.$dialog.remove()}});C("widget");C.widget.popup=C.widget._base.extend({construct:function(opts){var style={color:"#fff",borderRadius:"5px",background:"rgba(0,0,0,0.8)",shadow:"rgba(0,0,0,0.25)",borderColor:"transparent"};if(opts&&opts.opacity&&typeof opts.opacity=="number"&&opts.opacity<=1){style.background="rgba(0,0,0,"+opts.opacity+")"}if(opts&&opts.template){if(opts.template=="gray"){style={color:"#333",borderRadius:"5px",background:"rgba(230,230,230,1)",shadow:"rgba(0,0,0,0.25)",borderColor:"transparent"}}else if(opts.template=="white"){style={color:"#000",borderRadius:"5px",background:"#fff",shadow:"rgba(0,0,0,0.25)",borderColor:"transparent"}}else if(opts.template=="header"){style={color:"#666",borderRadius:"0",background:"white",shadow:"rgba(0,0,0,0.25)",borderColor:"#f07d00"}}else if(opts.template=="headerGray"){style={color:"#666",borderRadius:"0",background:"#f5f5f5",shadow:"rgba(0,0,0,0.25)",borderColor:"#f07d00"}}}this.opts=$.extend({className:"popup-widget",padding:"15px",side:"right",width:"auto",height:"auto",margin:5,overhang:15,pointerEdgePadding:15,pointerSize:10,content:"attr",attr:"title",trigger:"hover",template:null,url:"",method:"get",autoCenter:false,showDelay:0,hideTimeout:500,resizeClose:false,needFlush:true,centerContent:false,animation:false},style,opts);if(!C.support.rgba){this.opts.color=C.utility.rgba2rgb(this.opts.color);this.opts.background=C.utility.rgba2rgb(this.opts.background);this.opts.shadow=C.utility.rgba2rgb(this.opts.shadow)}this.delayTimer=null;this.hideTimer=null;this.isShowed=false;this.$el=opts.el.jquery?opts.el:$(opts.el);this.$parentHeaderSelector=this.$el.closest(".chg-header, .chg-hdr-root");this.isHeaderChild=this.$parentHeaderSelector&&this.$parentHeaderSelector.length;this.$appendTarget=this.isHeaderChild?C.dom.$headerRoot:C.dom.$root;this.createPopup();this.doBind();if(!this.opts.needFlush){this.$container.html(this.opts.content)}if(this.opts.centerContent){this.$container.css("text-align","center")}},setContent:function(html){this.$container.html(html)},destruct:function(){clearTimeout(this.delayTimer);clearTimeout(this.hideTimer);if(this.$container.length){this.$container.remove()}},createPopup:function(){this.$container=this.$container||$('<div id="popup-'+this.instanceNumber+'"><div></div></div>').appendTo(this.$appendTarget).children().css({position:"absolute","border-radius":this.opts.borderRadius,"background-color":this.opts.background,padding:this.opts.padding,color:this.opts.color,width:this.opts.width,"z-index":-1,visibility:"hidden",border:"1px solid "+this.opts.borderColor});var arrowMap={top:0,right:1,bottom:2,left:3};if(this.opts.borderColor=="transparent"){var borderMap=["transparent","transparent","transparent","transparent"];borderMap[arrowMap[this.opts.side]]=this.opts.background;var borderWidthMap=[this.opts.pointerSize-1,this.opts.pointerSize-1,this.opts.pointerSize-1,this.opts.pointerSize-1];borderWidthMap[arrowMap[this.opts.side]]=this.opts.pointerSize;var cssProp={width:0,height:0,position:"absolute",borderColor:borderMap.join(" "),borderStyle:"solid",borderWidth:borderWidthMap.join("px ")+"px"};this.$pointer=$("<div></div>").css(cssProp);this.$innerPointer=$("<div></div>")}else{var borderMap=["transparent","transparent","transparent","transparent"];borderMap[arrowMap[this.opts.side]]=this.opts.borderColor;var cssProp={width:0,height:0,position:"absolute",borderColor:borderMap.join(" "),borderStyle:"solid",borderWidth:this.opts.pointerSize};this.$pointer=$("<div></div>").css(cssProp);borderMap=["transparent","transparent","transparent","transparent"];borderMap[arrowMap[this.opts.side]]=this.opts.background;cssProp={width:0,height:0,position:"absolute",top:-this.opts.pointerSize+2,left:-this.opts.pointerSize+1,borderColor:borderMap.join(" "),borderStyle:"solid",borderWidth:this.opts.pointerSize-1};this.$innerPointer=$("<div></div>").css(cssProp)}},doBind:function(){if(this.opts.trigger=="hover"){this.$el.observe({mouseover:this.toggleContainer,mouseout:this.hidePopup},this);this.$container.observe({mouseover:this.holdContainer,mouseout:this.hidePopup},this)}else if(this.opts.trigger=="click"){C.dom.$body.observe({click:this.toggleContainer},this.opts.el,this);if(!this.outsideClickEventHandler){this.outsideClickEventHandler=$("a,div,span,html").on("click",$.proxy(function(){if(($(".popup-widget:hover").length==0||$(".popup-widget").find("a:hover").length>0)&&this.isShowed){this.hidePopup()}},this))}}if(this.opts.resizeClose){C.dom.$window.observe("resize",this.hidePopup,this)}},holdContainer:function(){clearTimeout(this.hideTimer)},toggleContainer:function(e){clearTimeout(this.hideTimer);if(!this.isShowed){var $target=this.opts.el.jquery?this.opts.el:$(this.opts.el),data=this.opts.getData?this.opts.getData.call(this,$target):this.getData($target),that=this;if(data&&data.length){this.delayTimer=setTimeout(function(){that.showPopup($target,data)},this.opts.showDelay)}}else{this.hidePopup()}},hidePopup:function(){clearTimeout(this.delayTimer);clearTimeout(this.hideTimer);var that=this;this.hideTimer=setTimeout(function(){if(that.opts.animation){that.$container.show().fadeOut(function(){that.$container.css({zIndex:-1,visibility:"hidden"})})}else{that.$container.css({zIndex:-1,visibility:"hidden"})}},this.opts.hideTimeout);this.isShowed=false;$(this.opts.el).removeClass("pop-active")},getData:function($target){var that=this;if(this.opts.content=="attr"){if(this.opts.attr=="title"){if(!this.title){this.title=$target.attr(this.opts.attr);$target.removeAttr(this.opts.attr)}return this.title}return $target.attr(this.opts.attr)}else if(this.opts.content=="ajax"){$.ajax({url:this.opts.url,method:this.opts.method,success:function(h){that.showPopup($target,h)}})}else{return this.opts.content}},positionPopup:function($target){var offset=$target.offset(),width,height,containerCss,pointerCss,cWidth,cHeight;if(this.isHeaderChild){offset=$target.position()}if(this.opts.side=="top"){if(this.opts.autoCenter){width=$target.outerWidth();height=$target.outerHeight();cWidth=this.$container.outerWidth();cHeight=this.$container.outerHeight();containerCss={top:offset.top-cHeight-this.opts.pointerSize-this.opts.margin,left:offset.left+width/2-cWidth/2,"box-shadow":"2px -2px 2px "+this.opts.shadow};pointerCss={bottom:this.opts.pointerSize*-2,left:cWidth/2-this.opts.pointerSize}}else{containerCss={top:offset.top-this.$container.outerHeight()-this.opts.pointerSize-this.opts.margin,left:offset.left-this.opts.overhang,"box-shadow":"2px -2px 2px "+this.opts.shadow};pointerCss={bottom:this.opts.pointerSize*-2,left:this.opts.pointerEdgePadding}}}else if(this.opts.side=="left"){if(this.opts.autoCenter){width=$target.outerWidth();height=$target.outerHeight();cWidth=this.$container.outerWidth();cHeight=this.$container.outerHeight();containerCss={top:offset.top+height/2-cHeight/2,left:offset.left-cWidth-this.opts.pointerSize-this.opts.margin};pointerCss={right:this.opts.pointerSize*-2,top:cHeight/2-this.opts.pointerSize}}else{containerCss={top:offset.top-this.opts.overhang,left:offset.left-this.$container.outerWidth()-this.opts.pointerSize-this.opts.margin};pointerCss={right:this.opts.pointerSize*-2,top:this.opts.pointerEdgePadding}}}else if(this.opts.side=="right"){if(this.opts.autoCenter){width=$target.outerWidth();height=$target.outerHeight();cWidth=this.$container.outerWidth();cHeight=this.$container.outerHeight();containerCss={top:offset.top+height/2-cHeight/2,left:offset.left+width+this.opts.pointerSize+this.opts.margin};pointerCss={left:this.opts.pointerSize*-2,top:cHeight/2-this.opts.pointerSize}}else{containerCss={top:offset.top-this.opts.overhang,left:offset.left+$target.outerWidth()+this.opts.pointerSize+this.opts.margin};pointerCss={left:this.opts.pointerSize*-2,top:this.opts.pointerEdgePadding}}}else if(this.opts.side=="bottom"){if(this.opts.autoCenter){width=$target.outerWidth();height=$target.outerHeight();cWidth=this.$container.outerWidth();cHeight=this.$container.outerHeight();containerCss={top:offset.top+height+this.opts.pointerSize+this.opts.margin,left:offset.left+width/2-cWidth/2,"box-shadow":"2px 2px 2px "+this.opts.shadow};pointerCss={top:this.opts.pointerSize*-2,left:cWidth/2-this.opts.pointerSize}}else{containerCss={top:offset.top+$target.outerHeight()+this.opts.pointerSize+this.opts.margin,left:offset.left-this.opts.overhang,"box-shadow":"0 2px 2px "+this.opts.shadow};pointerCss={top:this.opts.pointerSize*-2,left:this.opts.pointerEdgePadding}}}this.$container.css(containerCss);this.$pointer.css(pointerCss);this.$container.addClass(this.opts.className)},showPopup:function($target,text){if(!text||!text.length){return}if(this.opts.needFlush){this.$container.html(text)}this.opts.positionCallback?this.opts.positionCallback.call(this,$target):this.positionPopup($target);if(this.opts.afterInsertCallback){this.opts.afterInsertCallback.call(this,$target,this.$container)}this.$container.append(this.$pointer.append(this.$innerPointer)).css({zIndex:C.utility.getMaxIndex()+1,visibility:"visible"});if(this.opts.animation){this.$container.hide().fadeIn()}this.isShowed=true;$(this.opts.el).addClass("pop-active")},fadeIn:function(){}});C("ever");C.ever.kv={};C.ever.set=function(k,v){if(v===undefined||v==="undefined")return;v=$.trim(v);C.ever.setWindow(k,v);C.ever.setLocal(k,v);C.ever.setCookie(k,v);C.ever.kv[k]=v};C.ever.get=function(k){var v;v=v||C.ever.getWindow(k);v=v||C.ever.getLocal(k);v=v||C.ever.getCookie(k);v=v||C.ever.kv[k];C.ever.set(k,v);return $.trim(v)};C.ever.setCookie=function(k,v){var domain=C.global&&C.global.cookieDomain?";domain="+C.global.cookieDomain:"";document.cookie=k+"=; expires=Mon, 20 Sep 2010 00:00:00 UTC; path=/"+domain;document.cookie=k+"="+v+"; expires=Tue, 31 Dec 2050 00:00:00 UTC; path=/"+domain};C.ever.getCookie=function(k){return C.ever.getFromSerializedString(document.cookie,";",k,1)};C.ever.setWindow=function(k,v){window.name=C.ever.getSetIntoSerializedStringResult(window.name,"&",k,v,1)};C.ever.getWindow=function(k){if(window.name){return C.ever.getFromSerializedString(window.name,"&",k,1)}};C.ever.setLocal=function(k,v){if(window.localStorage&&window.localStorage.setItem){localStorage.setItem(k,v)}};C.ever.getLocal=function(k){if(window.localStorage&&window.localStorage.getItem){return localStorage.getItem(k)}};C.ever.getSetIntoSerializedStringResult=function(s,d,k,v,esc){k=k+"=";if(!s.length){return k+(esc?escape(v):v)}var exist=0;s=s.split(d);for(var i=0;i<s.length;i++){if(s[i].indexOf(k)===0){s[i]=k+(esc?escape(v):v);exist=1}}if(!exist)s.push(k+(esc?escape(v):v));return s.join(d)};C.ever.getFromSerializedString=function(s,d,k,esc){s=s.split(d);k=k+"=";for(var i=0;i<s.length;i++){if($.trim(s[i]).indexOf(k)===0){return $.trim(esc?unescape(s[i].replace(k,"")):s[i].replace(k,""))}}};C.dom.$window.bind("beforeunload",function(){for(var k in C.ever.kv){C.ever.set(k,C.ever.kv[k])}});C("widget");C.widget.dropmenu=C.widget._base.extend({construct:function(opts){this.opts=$.extend({trigger:".drop-menu-trigger",header:""},opts);this.setupDropdownMenu();this.doBaseBind()},destruct:function(){C.dom.$body.unobserve("mousedown."+this.instanceNumber,this);C.dom.$window.unobserve("resize."+this.instanceNumber,this);this.$widget.remove()},setupDropdownMenu:function(){this.$widget=$('<div class="drop-menu-widget">'+'<div class="drop-menu-close"></div>'+'<div class="drop-menu-tab"><span>'+this.opts.header+"</span> <b></b></div>"+'<div class="drop-menu-content"></div>'+"</div>").hide().appendTo(document.body);this.$close=this.$widget.find(".drop-menu-close");this.$tabText=this.$widget.find(".drop-menu-tab span");this.$content=this.$widget.find(".drop-menu-content");if(this.setContentAndBind){this.setContentAndBind()}},show:function(left,top){this.$widget.css({top:top,left:left-10}).show()},hide:function(){this.$widget.hide()},doBaseBind:function(){C.dom.$body.observe("mousedown."+this.instanceNumber,this.opts.trigger,this.onClickTrigger,this);C.dom.$window.observe("resize."+this.instanceNumber,this.onScrollOrResize,this);this.$close.observe("click",this.hide,this)},onScrollOrResize:function(){var that=this;clearTimeout(this.hideTimer);this.hideTimer=setTimeout(function(){that.hide()},0)},onClickTrigger:function(e){var $el=$(e.currentTarget),offset=$el.offset();this.$curTrigger=$el;this.show(offset.left,offset.top,$el);e.preventDefault();e.stopPropagation();if(this.reset){this.reset($el)}}});C("widget");C.widget.moderator=C.widget.dropmenu.extend({construct:function(opts){this.opts=$.extend({trigger:".abuse-flag",header:"Report abuse",maxDescLength:300},opts);this.isMod=$(".content-moderation-view").length;this.setupDropdownMenu();this.doBaseBind();this.doBind();this.reset()},reset:function($el){this.$textarea.val("");this.$content.find("input:selected").removeAttr("checked").prop("checked",0);this.onTextboxKeyup();this.$button.removeAttr("disabled","disabled");this.$reportForm.show();this.$reportNotice.hide();this.qid="";this.aid="";this.cid="";this.rid="";this.arid="";if($el&&$el.length){this.aid=$el.attr("data-answerid")||"";this.qid=$el.attr("data-questionid")||"";this.cid=$el.attr("data-commentid")||"";this.rid=$el.attr("data-ratingid")||"";this.arid=$el.attr("data-appratingid")||""}},setContentAndBind:function(){this.$content.html(this.getContent());this.$textarea=this.$content.find("textarea");this.$button=this.$content.find("button");this.$wordsLeft=this.$content.find(".words-left");this.$form=this.$content.find("form");this.$reportForm=this.$content.find(".report-form");this.$reportNotice=this.$content.find(".report-notice")},getContent:function(){var label=this.isMod?"Remove content":"Report Abuse";return'<form onsubmit="return false">'+'<div class="report-reason">'+'<div class="report-form">'+this.getReasons()+'<div class="words-left"></div>'+'<textarea name="description" placeholder="Leave a comment (optional)" maxlength="'+this.opts.maxDescLength+'"></textarea>'+'<div class="moderator-button"><button class="btn-secondary-dk-mini">'+label+"</button></div>"+"</div>"+'<div class="report-notice"></div>'+"</div>"+"</form>";

},getReasons:function(){var defaultOptions={Adult_Or_Inappropriate:"Adult/Inappropriate",Harassment:"Harassment",Spam:"Spam",Solicitation:"Solicitation",Threats_Or_Violence:"Threats/Violence",Other:"Other"};var processReasons=function(o){var lis="",selected="checked",i=0;for(var x in o){if(x=="All"){continue}lis+='<li><input type="radio" '+selected+' name="reason" id="reason-'+i+'" value="'+x+'" /><label class="form-radio" for="reason-'+i+'"></label> <label for="reason-'+i+'">'+o[x]+"</label></li>";i++;selected=""}return"<ul>"+lis+"</ul>"};return processReasons(defaultOptions)},wordsLeft:function(){return this.opts.maxDescLength-this.$textarea.val().length},doBind:function(){this.$button.observe("click",this.onClickSubmit,this);this.$textarea.observe("keyup",this.onTextboxKeyup,this)},onScrollOrResize:function(){var that=this;clearTimeout(this.hideTimer);this.hideTimer=setTimeout(function(){that.hide()},100)},onClickSubmit:function(){var $checked=this.$widget.find(":checked"),$contentMod;if(!$checked.length){alert("Please select a reason");return}this.$button.attr("disabled","disabled");$.ajax({url:"/_ajax/hwh/moderate/?token="+C.global.csrfToken+"&aid="+this.aid+"&qid="+this.qid+"&cid="+this.cid+"&rid="+this.rid+"&arid="+this.arid+"&reason="+$checked.val()+"&comment="+encodeURIComponent($.trim(this.$textarea.val())),success:$.proxy(function(){this.$reportForm.hide();this.$reportNotice.html('<div class="msg-info-dk-sm">'+'<div class="msg-icon">'+'<div class="msg-text">Success</div>'+"</div>"+"</div>").show()},this),error:$.proxy(function(){this.$reportForm.hide();this.$reportNotice.html('<div class="msg-info-dk-sm">'+'<div class="msg-icon">'+'<div class="msg-text">We encountered an error. Please try again</div>'+"</div>"+"</div>").show()},this)});if(this.isMod){$contentMod=this.$curTrigger.parents(".question, li").find(".content-moderation").first();var type=$contentMod.attr("data-type"),id=$contentMod.attr("data-id"),idExtra=$contentMod.attr("data-extra-id"),postData={id:id,type:type,token:C.global.csrfToken};if(idExtra){postData.id_extra=idExtra}$.ajax({type:"post",dataType:"json",url:"/_ajax/hwh/delete",data:postData,context:this,success:function(){}})}},onTextboxKeyup:function(){this.$wordsLeft.html(this.wordsLeft()+" left")}});C("utility");C.utility.profiler=function(){var canShow=document.location.hostname.indexOf("cheggnet")>0||C.utility.getCookie("logging")!=null;var completeTimeout;return{show:function(){if(!canShow){return}$(".api-profiler").remove();var dialog='<div class="api-profiler">'+'<div class="api-profiler-hotspots" onclick="C.utility.profiler.toggleHotspots()">hotspots<br/>OFF</div>'+'<div class="api-profiler-timings">'+'<span title="DOM Loading">'+((C.global.domLoading-C.global.navigationStart)/1e3).toFixed(2)+"s</span><br/>"+'<span title="DOM Interactive">'+((C.global.domInteractive-C.global.navigationStart)/1e3).toFixed(2)+"s</span><br/>"+"</div>"+'<div class="api-profiler-more" style="display: none; background-color: white;" onclick="C.utility.profiler.showStack()">'+"</div>"+"</div>";$(dialog).prependTo(".chgg-hdr");var checkLoaded=function(){if(C.global.domComplete===null){completeTimeout=setTimeout(checkLoaded,300);return}var totalLoadTime=C.global.domComplete-C.global.navigationStart;var timings='<span title="Total Load Time">'+(totalLoadTime/1e3).toFixed(2)+"s</span><br/>";$(timings).appendTo(".api-profiler-timings");if(totalLoadTime>0&&totalLoadTime<2e3){$(".api-profiler-timings").css("background-color","#ddffdd")}else if(totalLoadTime==0||totalLoadTime>4500){$(".api-profiler-timings").css("background-color","#ffdddd")}else{$(".api-profiler-timings").css("background-color","#ffffdd")}};checkLoaded();var loadProfileCount=function(){$.ajax({url:"/_ajax/ajaxApiStack?countOnly=1",type:"post",success:function(data){var image="";if(data){var automationTxt=data["experiment"]["automation"]?"Automation":"Normal";$(".api-profiler-more").show().html(data["fail"]+"/"+(data["fail"]+data["success"])+image+"<br/>"+automationTxt).css("color",data["fail"]>0?"#cc0000":"")}}})};loadProfileCount();setInterval(loadProfileCount,6e4)},reset:function(){if(!canShow){return}clearTimeout(completeTimeout);C.global.navigationStart=null;C.global.domLoading=null;C.global.domInteractive=null;C.global.domComplete=null;$(".api-profiler").html('<div class="api-profiler-timings">loading...</div>')},showStack:function(){if(!canShow){return}console.log("Fetching API calls caused by this page load in the last 10 minutes...");$.ajax({url:"/_ajax/ajaxApiStack",type:"post",success:function(data){console.log(data);C.dom.$window.trigger("apiStackShown",[data])}})},toggleHotspots:function(){if(!canShow){return}if($('.api-profiler-hotspots:contains("ON")').length){$(".api-profiler-hotspots").html("hotspots<br/>OFF");$(".chg-tracking-label").remove();$(".chg-tracking-section").removeClass("chg-tracking-section");$(".chg-tracking-entity").removeClass("chg-tracking-entity");return}else{$(".api-profiler-hotspots").html("hotspots<br/>ON")}}}}();C("logger");C.logger=function(){var doLog=function(data,callback){if(null!==data){var prefixUrl=window.location.protocol==="http:"?C.global.cheggSiteUrl:C.global.cheggSiteSecureUrl;$.ajax({url:prefixUrl+"_ajax/log",type:"GET",data:{type:data.type,value:JSON.stringify(data)},success:function(){if(typeof callback==="function"){callback()}},error:function(e){C.log(data.type+" log failed with error: "+JSON.stringify(e))}})}};return{doEventLog:function(data,callback){data.parent_page_url=window.location.href;data.parent_page_timestamp=C.logger.loadTime;data.page_track_id=C.logger.pageTrackId;data.referrer_url=window.location.href;data.destination_url=window.location.href;data.type="event";doLog(data,callback)},doSessionLog:function(data,callback){data.page_track_id=C.logger.pageTrackId;data.destination_url=window.location.href;data.referrer_url=C.logger.referrer_url;data.type="session";doLog(data,callback)}}}();Eggshell.define("C.common.log",{inputs:["event log","session log"],outputs:["log success","log error"]},Backbone.View.extend({initialize:function(){Eggshell.find(this).on("event log",this.doEventLog);Eggshell.find(this).on("session log",this.doSessionLog)},doEventLog:function(e,data){var pageTrackId,referrer,loadTime;if(C&&C.logger){pageTrackId=C.logger.pageTrackId;loadTime=C.logger.loadTime}else{pageTrackId=mChegg.global.pageTrackId;loadTime=null}if(loadTime!==null){data.parent_page_timestamp=loadTime}data.event_uuid="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c=="x"?r:r&3|8;return v.toString(16)});data.parent_page_url=window.location.href;data.page_track_id=pageTrackId;data.destination_url=window.location.href;data.referrer_url=window.location.href;data.type="event";this.doLog(data)},doSessionLog:function(e,data){var pageTrackId,referrer;if(C&&C.logger){pageTrackId=C.logger.pageTrackId;referrer=C.logger.referrer_url}else{pageTrackId=mChegg.global.pageTrackId;referrer=document.referrer}data.page_track_id=pageTrackId;data.destination_url=window.location.href;data.referrer_url=referrer;data.type="session";this.doLog(data)},doLog:function(data){$.ajax({url:"/_ajax/log",type:"GET",context:this,data:{type:data.type,value:JSON.stringify(data)},success:function(){Eggshell.find(this).trigger("log success")},error:function(e){Eggshell.find(this).trigger("log error",e)}})}}));C("logs.events");C.logs.events.common={getOnlyEventName:function(event_name){return{event_name:event_name}}};Eggshell.define("C.common.navigation",{inputs:["expand navigation bar","collapse navigation bar","render","refresh left nav","hide group","set left nav type"],outputs:[],singleton:true,newNode:false},function(){var Model=Backbone.Model.extend({load:function(){$.ajax({url:"/_ajax/navigation",type:"post",dataType:"json",data:{},context:this,success:$.proxy(function(r){this.polishResults(r);this.set("originalResult",r);this.trigger("loaded")},this),error:function(){this.trigger("error")}})},polishResults:function(r){var groups=[];var subGroups={};$.each(r,function(key,val){if(typeof val.group!="undefined"&&val.subGroup==null){groups.push(val);if(!(val.group in subGroups)){subGroups[val.group]=[]}}});$.each(r,function(key,val){if(typeof val.group!="undefined"&&val.subGroup!=null){subGroups[val.group].push(val)}});this.set("groups",groups);this.set("subGroups",subGroups)},getSubgroup:function(subName){var subGroups=this.get("subGroups");if(subName in subGroups){return subGroups[subName]}return{}}});var View=Backbone.View.extend({navigationBarCollapsedWidth:50,navigationBarExpandedWidth:210,mainTemplate:_.template('<div class="leftnav"></div>'),linkTemplate:_.template("<%if(link) {%>"+'<a href ="<%- link %>" class="<%-classes%>">'+"<% if(newIndicator) { %>"+'	<span class="global-nav-list-new">NEW</span>'+"<% } %>"+"<%=text%>"+"</a>"+"<%} else {%>"+'<div class="<%-classes%>"><%=text%></div>'+"<%}%>"),initialize:function(){this.model=new Model;this.setListeners();this.load()},setListeners:function(){this.model.on("loaded",this.render,this);this.model.on("errored",this.renderError,this);Eggshell.find(this).on("render",this.load,this).on("expand navigation bar",this.expandNavigationBar,this).on("collapse navigation bar",this.collapseNavigationBar,this).on("refresh left nav",this.load,this)},openOverlayLeftNav:function(){var zIndex=C.utility.getMaxIndex()+1;$(".chg-global-nav").css({width:this.navigationBarExpandedWidth+"px","z-index":zIndex+1,"box-shadow":"1px 0px 2px #999",overflow:"hidden"});$(".chg-global-nav-home").css({opacity:0,visibility:"hidden"});$(".chg-global-nav-list").css({visibility:"visible",opacity:1});$(".chg-global-screen-blocker").css({"z-index":zIndex,opacity:.6})},closeOverlayLeftNav:function(){$(".chg-global-nav").css({width:this.navigationBarCollapsedWidth+"px","box-shadow":"none"});$(".chg-global-nav-home").css({opacity:1,visibility:"visible"});$(".chg-global-nav-list").css({visibility:"hidden",opacity:0});$(".chg-global-screen-blocker").css({"z-index":-1,opacity:0})},expandNavigationBar:function(){this.closeOverlayLeftNav();$(".chg-body").removeClass("chegg-content-nav-collapsed").addClass("chegg-content-nav-expanded");$(".chg-global-nav").css({width:this.navigationBarExpandedWidth+"px"});this.$el.find(".chg-global-nav-home").css({opacity:0,visibility:"hidden"});this.$el.find(".chg-global-nav-list").css({visibility:"visible",opacity:1});$(".chg-global-content").css("margin-left","210px");$(".chg-global-nav").off("mouseover").off("mouseleave")},collapseNavigationBar:function(){$(".chg-global-content").css("margin-left","50px");if($(".chg-body").hasClass("chegg-content-nav-collapsed")){this.closeOverlayLeftNav()}else{$(".chg-body").removeClass("chegg-content-nav-expanded").addClass("chegg-content-nav-collapsed");$(".chg-global-nav").css({width:this.navigationBarCollapsedWidth+"px"});this.$el.find(".chg-global-nav-home").css({opacity:1,visibility:"visible"});this.$el.find(".chg-global-nav-list").css({visibility:"hidden",opacity:0})}if($(".chg-global-nav").hasClass("chg-global-nav-autosliding")){$(".chg-global-nav").on("mouseover",$.proxy(function(){if($(".chg-body").hasClass("chegg-content-nav-collapsed")){this.openOverlayLeftNav()}},this));$(".chg-global-nav").on("mouseleave",$.proxy(function(){if($(".chg-body").hasClass("chegg-content-nav-collapsed")){this.closeOverlayLeftNav()}},this))}},load:function(){this.model.load()},render:function(){$(".chg-global-nav").append(this.$el);this.$el.html(this.mainTemplate());this.renderLeftNav()},renderLeftNav:function(){var groups=this.model.get("groups");this.$el.find(".leftnav").append('<a class="chg-global-nav-home" href="/">Home</a>');this.$el.find(".leftnav").append('<div class="chg-global-nav-list"></div>');this.$el.find(".chg-global-nav-home").css({opacity:0,visibility:"hidden"});$.each(groups,$.proxy(function(k,v){this.renderGroup(v)},this))},renderGroup:function(item){var groupEl=$('<div class="'+item.group.replace(" ","-")+'-item"></div>');var subGroup=this.model.getSubgroup(item.group);var backwardsCompatibleClass=" chg-global-nav-list-item";var link=item.link?item.link:false;var classes=item.classes?item.classes:"";groupEl.append(this.linkTemplate({link:link,classes:classes+" chg-global-nav-list-section",text:item.group,newIndicator:item.newIndicator}));if(subGroup.length>0){groupEl.append('<div class="'+item.group.replace(" ","-")+'-subgroup-items"></div>');$.each(subGroup,$.proxy(function(key,val){var link=val.link?val.link:"#";var classes=val.classes?val.classes+backwardsCompatibleClass:backwardsCompatibleClass;groupEl.find("."+item.group.replace(" ","-")+"-subgroup-items").append(this.linkTemplate({link:link,classes:classes,text:val.subGroup,newIndicator:val.newIndicator}))},this))}this.$el.find(".chg-global-nav-list").append(groupEl)}});return View}());Eggshell.define("C.global.nav",{inputs:["expand navigation bar","collapse navigation bar","enable fixed header","disable fixed header"],outputs:["returned fixed header content node"],singleton:true,newNode:false},function(){var NavigationBar=C.View.extend({navigationBarCollapsedWidth:50,navigationBarExpandedWidth:210,initialize:function(){this.setNavigationBarTopOffset(0);this.fixPosition(true);this.collapseNavigationBar();$(".chg-global-nav a").on("click",function(e){$(".chg-global-nav").off("mouseover");$(".chg-global-nav").off("mouseleave")});$(".chg-global-nav a").on("touchstart",function(e){$(".chg-global-nav").off("mouseover");$(".chg-global-nav").off("mouseleave")});$(".chg-global-nav a.track-nav-solutions").click(function(e){e.preventDefault();e.stopPropagation();var $glassTBSComponent=$(".glass-container .tbs-tab");if($glassTBSComponent.length!==0){$glassTBSComponent.trigger("click")}else{Eggshell.create("C.common.tbspopup").trigger("show tbs popup")}}).attr("data-noajax","data-noajax").attr("data-noredirect","data-noredirect");$(".chg-global-nav a.track-nav-qna").click(function(e){e.preventDefault();e.stopPropagation();var $glassQNAComponent=$(".glass-container .qna-tab");if($glassQNAComponent.length!==0){$glassQNAComponent.trigger("click")}else{C.utility.navigate($(e.target).attr("href"))}}).attr("data-noajax","data-noajax").attr("data-noredirect","data-noredirect");$(".chg-global-nav a.track-nav-live-tutors").click(function(e){e.preventDefault();e.stopPropagation();var $glassTutorsComponent=$(".glass-container .tutors-tab");if($glassTutorsComponent.length!==0){$glassTutorsComponent.trigger("click")}else{if(C.global.instaEdu){C.utility.navigate("/tutors/online-now/Chegg-GPA")}}}).attr("data-noajax","data-noajax").attr("data-noredirect","data-noredirect")},isNavigationBar:function(){if($(".chg-body").hasClass("no-nav")||$(".chg-global-nav-list").length===0){return false}else{return true}},slideOutNavigationBar:function(){var zIndex=C.utility.getMaxIndex()+1;$(".chg-global-nav").css({width:this.navigationBarExpandedWidth+"px","z-index":zIndex+1,"box-shadow":"1px 0px 2px #999",overflow:"hidden"});$(".chg-global-nav-home").css({opacity:0,visibility:"hidden"});$(".chg-global-nav-list").css({visibility:"visible",opacity:1});$(".chg-global-screen-blocker").css({"z-index":zIndex,opacity:.6})},slideBackNavigationBar:function(){$(".chg-global-nav").css({width:this.navigationBarCollapsedWidth+"px","box-shadow":"none"});$(".chg-global-nav-home").css({opacity:1,visibility:"visible"});$(".chg-global-nav-list").css({visibility:"hidden",opacity:0});$(".chg-global-screen-blocker").css({"z-index":-1,opacity:0})},expandNavigationBar:function(){if(!this.isNavigationBar()){return}this.slideBackNavigationBar();$(".chg-body").removeClass("chegg-content-nav-collapsed").addClass("chegg-content-nav-expanded");$(".chg-global-nav").css({width:this.navigationBarExpandedWidth+"px"});$(".chg-global-nav-home").css({opacity:0,visibility:"hidden"});$(".chg-global-nav-list").css({visibility:"visible",opacity:1});$(".chg-global-content").css("margin-left","210px");$(".chg-global-nav").off("mouseover").off("mouseleave")},collapseNavigationBar:function(){if(!this.isNavigationBar()){return}if($(".center-content").length==0){$(".chg-global-content").css("margin-left","50px")}if($(".chg-body").hasClass("chegg-content-nav-collapsed")){this.slideBackNavigationBar()}else{$(".chg-body").removeClass("chegg-content-nav-expanded").addClass("chegg-content-nav-collapsed");$(".chg-global-nav").css({width:this.navigationBarCollapsedWidth+"px"});$(".chg-global-nav-home").css({opacity:1,visibility:"visible"});$(".chg-global-nav-list").css({visibility:"hidden",opacity:0})}if($(".chg-global-nav").hasClass("chg-global-nav-autosliding")){$(".chg-global-nav").on("mouseover",$.proxy(function(){if($(".chg-body").hasClass("chegg-content-nav-collapsed")){this.slideOutNavigationBar()}},this));$(".chg-global-nav").on("mouseleave",$.proxy(function(){if($(".chg-body").hasClass("chegg-content-nav-collapsed")){this.slideBackNavigationBar()}},this))}},setNavigationBarTopOffset:function(offset){$(".chg-global-nav-home").css({top:87+offset+"px"});$(".chg-global-nav-list").css({top:90+offset+"px"})},fixPosition:function(enable){if(enable){$(".chg-global-nav, .chg-global-nav-home, .chg-global-nav-list").css({position:"fixed"})}else{$(".chg-global-nav, .chg-global-nav-home, .chg-global-nav-list").css({position:"absolute"})}}});var Header=C.View.extend({height:100,initialize:function(){this.$globalHeader=$(".chg-header");this.$fixedHeader=$("<div></div>");this.scrollDetector=Eggshell.create("C.Eggshell.window.scroll.tracker");this.fixedHeaderVisibleCallback=this.options.fixedHeaderVisibleCallback;this.render();Eggshell.immuneToDestroyAll(this.scrollDetector)},render:function(){this.$fixedHeader.addClass("chg-fixed-header").css({height:"0px","z-index":C.utility.getMaxIndex()}).insertAfter($(".chg-header"))},fadeInFixedHeader:function(){this.$fixedHeader.css({height:this.height+"px",position:"fixed",top:"0px"});if(this.fixedHeaderVisibleCallback&&typeof this.fixedHeaderVisibleCallback=="function"){this.fixedHeaderVisibleCallback(this.height)}},fadeOutFixedHeader:function(){this.$fixedHeader.css({height:"0px",position:"absolute",top:"50px"});if(this.fixedHeaderVisibleCallback&&typeof this.fixedHeaderVisibleCallback=="function"){this.fixedHeaderVisibleCallback(0)}},handleFixedHeaderScrolledEvent:function(){if($("body").scrollTop()>=50){this.fadeInFixedHeader()}else{this.fadeOutFixedHeader()}},enableFixedHeader:function(enable){if(enable){this.$globalHeader.css({position:"absolute"});this.scrollDetector.on("scrolled",this.handleFixedHeaderScrolledEvent,this);if($("body").scrollTop()>=50){this.fadeInFixedHeader()}}else{this.$globalHeader.css({position:"fixed"});this.fadeOutFixedHeader();this.scrollDetector.off("scrolled",this.handleFixedHeaderScrolledEvent,this)}}});if($(".chg-nav-v2").length>0){this.navigationBar=Eggshell.create("C.common.navigation");Eggshell.immuneToDestroyAll(this.navigationBar);var parent=Eggshell.find(this);Eggshell.connect(parent,"expand navigation bar",this.navigationBar,"expand navigation bar").connect(parent,"collapse navigation bar",this.navigationBar,"collapse navigation bar")}else{this.navigationBar=new NavigationBar;this.header=new Header({fixedHeaderVisibleCallback:$.proxy(function(height){if(height==0){this.navigationBar.setNavigationBarTopOffset(0);this.navigationBar.fixPosition(false)}else{this.navigationBar.setNavigationBarTopOffset(height-50);this.navigationBar.fixPosition(true)}},this)});Eggshell.find(this).on("expand navigation bar",this.navigationBar.expandNavigationBar,this.navigationBar).on("collapse navigation bar",this.navigationBar.collapseNavigationBar,this.navigationBar).on("enable fixed header",function(){this.header.enableFixedHeader(true);this.navigationBar.fixPosition(false)}).on("disable fixed header",function(){this.header.enableFixedHeader(false);this.navigationBar.fixPosition(true)})}});Eggshell.immuneToDestroyAll(Eggshell.create("C.global.nav"));C("logs.events");C.logs.events.my=function(){return{onLoad:function(options){return{event_name:"on_load_person_overview",school_id:options.schoolId,question_for_me_ids:options.questions_for_me_ids.join("+"),qa_ids:options.qa_ids.join("+"),notes_ids:options.notes_ids.join("+")}}}}();try{var CRITEO=function(){var f="0.5.2";var t,x;var r=false;var b=false;var s={home:{eventType:"sendEvent",params:"v=2&pt1=0&pt2=1"},product:{eventType:"sendEvent",params:"v=2&pt1=2"},list:{eventType:"sendEvent",params:"v=2&pt1=3"},basket:{eventType:"transaction",params:"v=2&s=0"},confirmation:{eventType:"transaction",params:"v=2&s=1"},search:{eventType:"sendEvent",params:"v=2&pt1=4"}};function m(){return t[0]}function y(){return t[1]}function l(){var B="";if(typeof t[2]!="undefined"&&t[2]!=""){B=t[2];if(B.charAt(B.length-1)!="."){B+="."}}return B}function c(){var B=t[3].charAt(0);return typeof B!="undefined"&&B==1}function i(){var B=t[3].charAt(1);return typeof B!="undefined"&&B==1}function w(){var B=t[3].charAt(2);return!b&&typeof B!="undefined"&&B==1}function j(){return t[4]}function z(){return t[5]}function h(){return(document.location.protocol=="https:"&&"https:"||"http:")+"//dis."+l()+"criteo.com/dis/dis.aspx"}function A(B){return(document.location.protocol=="https:"?"https://sslwidget.":"http://widget.")+"criteo.com/"+y()+"/display.js?resptype="+B+"&"+e()}function u(C,B){switch(C){case"sendEvent":return B[0];case"transaction":return B[1];default:break}}function e(){var E="";var D=x&&x.length||0;var B=j();var F=1;for(var C=0;C<D;C++){for(var G=0;G<B.length;G++){if(F>1){E+="&"}E+=v(x[C],F,B[G]);F++}}return E}function v(O,L,K){var I=s[O.pageType];if(!I){return}var H=z();var G="";var D="";for(name in H){if(!O.hasOwnProperty(name)){continue}var F=H[name][0];var C=H[name][1];var N=H[name][2];var E="";if(typeof O[name]=="function"){E=O[name]()}else{E=O[name]}if(!E){continue}switch(C){case 0:D+="&"+F+"="+E;break;case 1:var B;if(typeof E==="string"){B=E.split(O.delimiter)}else{if(Object.prototype.toString.apply(E)==="[object Array]"){B=E}}var M=B.length;if(typeof N!="undefined"&&M>N){M=N}for(var J=1;J<=M;J++){D+="&"+F+J+"="+B[J-1]}break;case 2:G+="&"+F+"="+encodeURIComponent(E);break;default:break}}return"t"+L+"="+I.eventType+"&p"+L+"="+encodeURIComponent(I.params+"&wi="+u(I.eventType,K)+D)+G}function d(){var C=h()+"?p="+m()+"&cb="+Math.floor(Math.random()*99999999999);try{C+="&ref="+encodeURIComponent(document.referrer)}catch(B){}try{C+="&sc_r="+encodeURIComponent(screen.width+"x"+screen.height)}catch(B){}try{C+="&sc_d="+encodeURIComponent(screen.colorDepth)}catch(B){}return C.substring(0,2e3)}function a(){var C=h()+"?p="+m();C+="&"+e();C+="&cb="+Math.floor(Math.random()*99999999999);try{C+="&ref="+encodeURIComponent(document.referrer)}catch(B){}try{C+="&sc_r="+encodeURIComponent(screen.width+"x"+screen.height)}catch(B){}try{C+="&sc_d="+encodeURIComponent(screen.colorDepth)}catch(B){}return C.substring(0,2e3)}function n(B){if(window.addEventListener){window.addEventListener("load",B,false)}else{if(window.attachEvent){window.attachEvent("onload",B)}else{var C=window.onload;window.onload=function(){if(C&&typeof C.fired=="undefined"){C.fired=true;C()}B()}}}}function g(){var D=[];if(c()){if(document.createElement){var B=document.createElement("iframe");if(B){B.width="1px";B.height="1px";B.style.display="none";B.src=a()}D.push(B)}}else{var C=document.createElement("img");if(C){C.width="1px";C.height="1px";C.style.display="none";C.src=A("gif")}var E=document.createElement("iframe");if(E){E.width="1px";E.height="1px";E.style.display="none";E.src=d();C.onload=function(){p(E)}}D.push(C)}return D}function k(){var C=g();for(var B=0;B<C.length;B++){p(C[B])}}function p(B){var C;if(!w()){C=document.getElementsByTagName("body");if(!C||C.length==0){return}C=C[0]}else{C=document.getElementById("cto_mg_div")}if(C!=null&&C.appendChild){C.appendChild(B)}}function o(){if(w()){document.write("<div id='cto_mg_div' style='display:none;'></div>")}}function q(){if(i()){n(function(){k()})}else{k()}}return{Load:function(B){if(typeof CRITEO_CONF=="undefined"||r){return}r=true;b=B;t=CRITEO_CONF[1];x=CRITEO_CONF[0];o();q()}}}()}catch(err){}CRITEO.Load(true);C("logs.events");C.logs.events.qa=function(){return{onLoadMyQuestions:function(opts){var ids=[],questions_for_me=opts.questions_for_me;for(var i in questions_for_me){ids.push(questions_for_me[i].id)}return{event_name:"on_load_my_questions",questions_for_me_ids:ids.join("+")}},onLoadTextbooksQA:function(options){var ids=[];for(var i in options.questions){ids.push(options.questions[i].id)}return{event_name:"on_load_textbooks_questions",question_ids:ids.join("+"),book_id:options.book_id}},onQuestionClick:function(qid,type,crumb){return{event_name:"on_click_question",pcscrumb:crumb,qid:qid}},onClickAnswer:function(qid,type){return{event_name:"on_submit_answer",qid:qid}},onSubmitQuestion:function(response,type){var questionData=response.response;return{event_name:"on_submit_ask_question",question_id:questionData.id,is_anonymous:questionData.anonymous,course_id:null!==questionData.questionCourse?questionData.questionCourse.id:null}},onClickSeeAllQA:function(){return C.logs.events.common.getOnlyEventName("on_click_see_all_qa")},onClickQuestionsTab:function(questions,type,hwh_type){var ids=[],event="";if(type=="asked"){event="on_click_asked_questions"}else if(type=="answered"){event="on_click_answered_questions"}for(var i in questions){if(null!==questions[i]){ids.push(questions[i].id)}}return{event_name:event,ids:ids.join("+")}},onClickHWHSubscribe:function(data,qid){var type=data.subscription_type,id=typeof qid==="undefined"?null:qid;return{event_name:"on_click_hwh_subscribe",id:id}},onClickInstantQuestion:function(qid){return{event_name:"on_click_instant_question",question_id:qid}}}}();C("logs.events");C.logs.events.books=function(){return{onClickSeeAllBooks:function(){return C.logs.events.common.getOnlyEventName("on_click_see_all_books")},onClickAddBooks:function(){return C.logs.events.common.getOnlyEventName("on_click_add_books")},onLoadCoursesBooks:function(d){return{event_name:"on_load_courses_books",required_isbns:d.required.join("+"),recommended_isbns:d.recommended.join("+")}},onToggleCheckBoxForCart:function(el){var checked=$(el).is(":checked"),isbn=$(el).attr("id").split("include")[1];if(checked){return{event_name:"on_check_book_for_add_to_cart",isbn:isbn}}else{return{event_name:"on_uncheck_book_for_add_to_cart",isbn:isbn}}},onClickAddToCart:function(data){return{event_name:"on_add_to_cart",isbns:data.isbns.join("+"),list_price:data.list_price,total_price:data.total_price}},onLoadPersonBooks:function(data){var userBooks=data.userBooks,orderedBooks=data.orderedBooks,books_for_me_ids=[],books_i_have_ids=[];if(null!=userBooks){for(var i in userBooks){if(userBooks[i].no){for(var j in userBooks[i].no){books_for_me_ids.push(userBooks[i].no[j])}}}}if(null!=orderedBooks){for(var i in orderedBooks){if(orderedBooks[i]){books_i_have_ids.push(orderedBooks[i].ean)}}}return{event_name:"on_load_person_books",books_for_me_ids:books_for_me_ids.join("+"),books_i_have_ids:books_i_have_ids.join("+")}}}}();C("logs.events");C.logs.events.notes=function(){return{onClickSeeAllNotes:function(){return C.logs.events.common.getOnlyEventName("on_click_see_all_notes")}}}();C("logs.events");C.logs.events.course=function(){var getStatusLoggingObjectByEventName=function(event_name){return{event_name:event_name,schPrefix:this.schPrefix,schoolId:this.schoolId,subjCode:this.subjCode,subject:this.subject,term:this.term,year:this.year}};return{onLoadCoursesCourse:function(options){return{event_name:"on_load_courses_course",question_ids:options.questionIds.join("+"),review_ids:options.reviewIds.join("+"),is_planned:options.statusInfo.is_planned?1:0,is_rated:options.statusInfo.is_rated?1:0,current_term:options.studentInfo.term,student_count:options.studentInfo.count}},onClickIAmInThisCourse:function(schedInfo){return getStatusLoggingObjectByEventName.call(schedInfo,"on_click_i_am_in_this_course")},onClickRateThisCourse:function(schedInfo){return getStatusLoggingObjectByEventName.call(schedInfo,"on_click_rate_this_course")},onClickSeeAllInfoReviews:function(){return C.logs.events.common.getOnlyEventName("on_click_see_all_info_reviews")},onClickSeeAllStudents:function(){return C.logs.events.common.getOnlyEventName("on_click_see_all_students")},onClickWriteReview:function(){return C.logs.events.common.getOnlyEventName("on_click_write_a_review")},onSubmitRateCourse:function(data){return{event_name:"on_submit_rate_course",school:data.school,subject:data.subject,code:data.code,rating:data.currentRating,grade:data.currentGrade,year:data.currentYear,term:data.currentTerm}},onLoadCoursesQuestions:function(options){return{event_name:"on_load_courses_questions",school_id:options.course.schoolId,course_number:options.course.catalogNumber,subject_code:options.course.subjectCode,year:options.course.academicYear}}}}();C("logs.events");C.logs.events.schedule=function(){return{onLoadSuccess:function(options){var data=[];for(var i in options.courses){var tmp={term:options.courses[i].academicTerm,year:options.courses[i].academicYear,catalogNumber:options.courses[i].catalogNumber,subjectCode:options.courses[i].subjectCode,schoolId:options.courses[i].schoolId};data.push(tmp)}return{event_name:"on_load_person_schedule",course_info:JSON.stringify(data)}},onClickAddCourse:function(data){return{event_name:"on_click_add_course",catalog_number:data.code,school_id:data.school,subject:data.subject,term:data.term,year:data.year}}}}();C("logs.events");C.logs.events.home=function(){var _getCoursesInfo=function(courses){var data=[];if(null!==courses){for(var key in courses){var course_info=key;var isbns=[];for(var i in courses[key].books){isbns.push(courses[key].books[i].isbn)}data.push({info:course_info,isbns:isbns.join("+")})}}return data};return{onLoad:function(options){return{event_name:"on_load_home",courses_info:JSON.stringify(_getCoursesInfo(options.courses)),school_name:options.user_info.school,school_id:options.user_info.schoolId,term:options.user_info.term,year:options.user_info.year}},onSubmitAddRemoveCourse:function(data,action){return{event_name:action=="add"?"on_submit_add_course":"on_submit_remove_course",subject:data.subject,code:data.code,term:data.term,year:data.year,school:data.school}},OnHoverCourseItem:function(d,type){var common={event_name:type=="info"?"on_hover_course_info":"on_hover_course_book",year:d.year,term:d.term,code:d.code,subject:d.subject};return type=="book"?$.extend(common,{isbn:d.isbn}):common},onClickInfoLink:function(id,event){return{event_name:event,id:id}},onClickSeeMoreCourses:function(d){return{event_name:"on_click_see_course_info",school:d.school,subject:d.subject,code:d.code}}}}();C("logs.events");C.logs.events.solution=function(){return{onLoadBookSolutions:function(data){return{event_name:"on_load_books_solution",isbn:data.isbn,problem_id:data.vmJson.problemId,solution_id:data.vmJson.solutionId}},onClickHWHSubscribe:function(isbn,solutionId){return{event_name:"on_click_HWH_subscribe",isbn:isbn,solution_id:solutionId}}}}();C("tou");C.tou.model=C.Model.extend({objName:"C.tou.model",initialize:function(){},fetch:function(){var url="/_ajax/tou";$.ajax({context:this,type:"post",dataType:"json",url:url,success:function(response){this.set({version:response.version});this.trigger("fetch:success")}})},submit:function(){var url="/_ajax/tou/accept",data={token:C.global.csrfToken};$.ajax({context:this,type:"post",dataType:"json",url:url,data:data,success:function(response){this.trigger("submit:success")}})}});C.tou.view=C.View.extend({objName:"C.tou.view",events:{},initialize:function(){this.model.on("destroy",this.destroy,this);this.model.on("submit:success",this.destroy,this);this.model.on("fetch:success",this.render,this)},render:function(){if($("div.dialog-widget").length>0&&$("div.tou").length>0){C.log("tou found");return true}var termsCopy=this.model.toJSON()["version"];this.termsDialog=Eggshell.create("C.common.dialog");this.termsDialog.trigger("set headline","Terms of Use and Privacy Policy").trigger("hide sub headline").trigger("hide icon").trigger("hide close button",true).trigger("disable screen blocker click").trigger("enable default control").trigger("set primary button","I accept").trigger("set secondary button","I do not accept").trigger("set content html",'<div class="placeholder-content">'+termsCopy+"</div>").on("primary button clicked",$.proxy(function(){
this.model.submit()},this)).on("secondary button clicked",$.proxy(function(){this.termsDialog.trigger("hide");this.destroy();this.onClickLogout()},this));this.showDialog();return this},destroy:function(){this.remove();this.termsDialog.trigger("hide")},showDialog:function(){this.termsDialog.trigger("show")},onClickLogout:function(e){if(e){e.preventDefault()}var signOutUrl="/signout?token="+C.global.csrfToken;window.location.href=signOutUrl}});Eggshell.define("C.common.beacon",{inputs:["enable","disable","send beacon request"],outputs:[],singleton:true},C.Model.extend({enabled:true,queue:[],locked:false,initialize:function(){Eggshell.find(this).on("send beacon request",this.add,this).on("enabled",this.enable).on("disable",this.disable)},enable:function(){this.enabled=true},disable:function(){this.enabled=false},fire:function(){if(this.locked===true||this.queue.length===0){return}this.locked=true;var beaconReq=this.queue.shift();if(C.global.beacon!=true){this.locked=false;this.fire();return}$.cjax({context:this,url:"/_ajax/odin",dataType:"json",type:"POST",cache:false,data:{url:"/v1/stream-event",method:"POST",token:C.global.csrfToken,payload:JSON.stringify({impressionId:beaconReq.impressionId,eventTargetId:beaconReq.eventTargetId,eventType:beaconReq.eventType,tracker:C.utility.dataLogger()})},always:function(){this.locked=false;this.fire()}})},add:function(event,payload){if(typeof payload=="undefined"||payload===null){throw"Empty payload"}if(!payload.impressionId){throw"Empty impression id"}if(!payload.eventTargetId){throw"Empty event target id"}if(!payload.eventType){throw"Empty event type"}this.queue.push($.extend({},payload));this.fire()}}));Eggshell.define("C.Eggshell.tabs",{inputs:["build tabs"],outputs:["tab switch"],newNode:false},Backbone.View.extend({counter:0,firstel:0,loadFlag:false,initialize:function(options){this.loadFlag=true;this.options=$.extend({activeTabIsLink:false,useAlwaysHash:false,needHashTag:true},options);Eggshell.find(this).on("build tabs",this.buildTabs).on("view tab",this.activateTab)},events:{"click .tab-nav":"switchTab"},generateUniqueId:function(){var id=this.$el.attr("id");return id+"-"+this.counter++},activateTab:function(e,anchor){this.$(".tab-nav[data-anchor="+anchor+"]").click()},switchTab:function(e){var obj=$(e.target);if($(e.target).attr("data-anchor")===undefined){if($(e.target).parents(".tab-nav").attr("data-anchor")!==undefined){obj=$(e.target).parents(".tab-nav")}}if(obj.hasClass("selected")&&!this.options.activeTabIsLink){return false}else{this.loadFlag=false;this.$(".tab-nav").removeClass("selected");this.$(".tab-content").removeClass("selected");var id=obj.attr("id");obj.addClass("selected");this.$("#"+id+"-content").addClass("selected");if(this.options.needHashTag){if(id!=this.firstel||this.options.useAlwaysHash){window.location.hash=obj.attr("data-anchor")}else{window.location.hash=""}}this.Eggshell.trigger("tab switch",{type:obj.attr("data-anchor"),id:id});return true}},buildTabs:function(){var hash="";var navs=this.$(".tab-nav");var contents=this.$(".tab-content");for(var x=0;x<navs.length;x++){var nav=$(navs.get(x));var content=$(contents.get(x));var id=this.generateUniqueId();nav.attr("id",id);content.attr("id",id+"-content");var attr=nav.attr("data-anchor");if(typeof attr==="undefined"||attr===false){nav.attr("data-anchor",id+"-anchor")}if(window.location.hash=="#"+nav.attr("data-anchor")){hash=nav}}this.firstel=$(navs.get(0)).attr("id");if(hash==""){if(!this.loadFlag){$(navs.get(0)).click()}}else{$(hash).click()}}}));Eggshell.define("C.Eggshell.window.resize.tracker",{inputs:{"trigger resize":{payload:null}},outputs:["resize"],singleton:true},function(){this.resize=function(){var viewportWidth=$(window).width();var viewportHeight=$(window).height();if(this.viewportWidth&&this.viewportHeight){if(this.viewportWidth==viewportWidth&&this.viewportHeight==viewportHeight){return}}this.viewportWidth=viewportWidth;this.viewportHeight=viewportHeight;this.Eggshell.trigger("resize",{width:viewportWidth,height:viewportHeight})};$(window).on("resize",$.proxy(function(e){this.resize()},this));Eggshell.find(this).on("trigger resize",function(){this.resize()},this)});C.resource.add("C.Eggshell.dialog.close.title","Close");Eggshell.define("C.Eggshell.dialog",{inputs:["set id","set headline","allow child overflow","set sub headline","set icon","set icon size","set content html","set content component","get content area","destroy content","set control","get control area","show","hide","show headline","hide headline","show sub headline","hide sub headline","show icon","hide icon","enable default control","show control","set primary button","set secondary button","set link","show primary button","hide primary button","disable primary button","enable primary button","show secondary button","hide secondary button","disable secondary button","enable secondary button","show link","hide link","hide control","enable screen blocker click","disable screen blocker click","disable default padding"],outputs:["content component created","content area","control component created","control area","shown","hidden","headline clicked","sub headline clicked","icon clicked","close button clicked","screen blocker clicked","primary button clicked","secondary button clicked","link clicked","content clicked"]},C.View.extend({componentNS:null,controlNS:null,template:_.template('<div class="dialog">'+'<div class="header">'+'<div class="close" title="<%- closeTitle %>"></div>'+'<div class="icon"></div>'+'<h3 class="headline"></h3>'+'<p class="subHeadline"></p>'+"</div>"+'<div class="content"></div>'+'<div class="control disabled"></div>'+"</div>"+'<div class="screenBlocker"></div>'),initialize:function(options){console.log("This component will be deprecated.  Instead use C.commom.dialog");this.render();this.setuplistens();this.Eggshell.on("destroy",this.destroy)},destroy:function(){this.hide();this.destroyContent();this.destroyControl()},render:function(){this.$el.empty();this.$el.html(this.template({closeTitle:C.resource.fetch("C.Eggshell.dialog.close.title")}));this.$el.hide();this.$(".screenBlocker").css("z-index",C.utility.getMaxIndex());this.$(".dialog").css("z-index",C.utility.getMaxIndex()+1)},events:{"click .close":"closeOnClick","click .screenBlocker":"screenBlockerOnClick","click .headline":"headlineOnClick","click .subHeadline":"subHeadlineOnClick","click .icon":"iconOnClick","click .content":"contentOnClick"},setuplistens:function(){this.Eggshell.on("set id",function(event,payload){if(!payload&&typeof payload!=="id"){throw"Invalid id"}this.$(".dialog").attr("id",payload)}).on("set headline",function(event,payload){if(!payload&&typeof payload!=="string"){throw"Invalid headline"}this.$(".headline").html(payload)}).on("allow child overflow",function(){this.$(".dialog").addClass("overflowed")}).on("set sub headline",function(event,payload){if(!payload&&typeof payload!=="string"){throw"Invalid sub headline"}this.$(".subHeadline").html(payload)}).on("set icon",function(event,payload){if(!payload&&typeof payload!=="string"){throw"Invalid icon class name"}this.$(".icon").addClass(payload)}).on("set icon size",function(event,payload){if(!payload||typeof payload!=="string"||payload!=="small"&&payload!=="large"){throw"Invalid icon size"}this.$(".icon").removeClass("small").removeClass("large");this.$(".icon").addClass(payload)}).on("set content html",function(event,payload){if(!payload&&typeof payload!=="string"){throw"Invalid content html"}this.destroyContent();this.$(".content").html(payload)}).on("set content component",function(event,payload){if(!payload&&typeof payload!=="string"){throw"Invalid content component constructor"}this.destroyContent();this.componentNS=Eggshell.create(payload,$.extend({},this.$(".content")));this.Eggshell.trigger("content component created",this.componentNS)}).on("get content area",function(event,payload){this.Eggshell.trigger("content area",$.extend({},this.$(".content")))}).on("destroy content",function(event,payload){this.destroyContent()}).on("set control",function(event,payload){if(!payload&&typeof payload!=="string"){throw"Invalid control constructor"}this.destroyControl();this.controlNS=Eggshell.create(payload,{el:$.extend({},this.$(".control"))});this.$(".control").show().removeClass("disabled");this.Eggshell.trigger("control component created",this.controlNS)}).on("get control area",function(event,payload){this.Eggshell.trigger("control area",$.extend({},this.$(".control")))}).on("show",function(){this.show()}).on("hide",function(){this.hide()}).on("show headline",function(event,payload){this.$(".headline").show()}).on("hide headline",function(event,payload){this.$(".headline").hide()}).on("show sub headline",function(event,payload){this.$(".subHeadline").show()}).on("hide sub headline",function(event,payload){this.$(".subHeadline").hide()}).on("show icon",function(event,payload){this.$(".icon").show()}).on("hide icon",function(event,payload){this.$(".icon").hide()}).on("show control",function(event,payload){this.$(".control").show().removeClass("disabled")}).on("hide control",function(event,payload){this.$(".control").hide().addClass("disabled")}).on("disable screen blocker click",function(event,payload){this.screenBlockerClickEnabled=false}).on("enable screen blocker click",function(event,payload){this.screenBlockerClickEnabled=true}).on("disable default padding",function(event,payload){this.$(".dialog").addClass("no-padding")}).on("enable default control",function(event,payload){if(!payload&&typeof payload!=="boolean"){throw"Invalid control enable flag"}this.$(".control").show().removeClass("disabled");this.destroyControl();this.controlNS=Eggshell.create("C.Eggshell.dialog.control.standard",{el:$.extend({},this.$(".control"))});Eggshell.connect(this.Eggshell.getNamespace(),"set primary button",this.controlNS);Eggshell.connect(this.Eggshell.getNamespace(),"set secondary button",this.controlNS);Eggshell.connect(this.Eggshell.getNamespace(),"set link",this.controlNS);Eggshell.connect(this.Eggshell.getNamespace(),"show primary button",this.controlNS);Eggshell.connect(this.Eggshell.getNamespace(),"hide primary button",this.controlNS);Eggshell.connect(this.Eggshell.getNamespace(),"disable primary button",this.controlNS);Eggshell.connect(this.Eggshell.getNamespace(),"enable primary button",this.controlNS);Eggshell.connect(this.Eggshell.getNamespace(),"show secondary button",this.controlNS);Eggshell.connect(this.Eggshell.getNamespace(),"hide secondary button",this.controlNS);Eggshell.connect(this.Eggshell.getNamespace(),"disable secondary button",this.controlNS);Eggshell.connect(this.Eggshell.getNamespace(),"enable secondary button",this.controlNS);Eggshell.connect(this.Eggshell.getNamespace(),"set text below button",this.controlNS);Eggshell.connect(this.Eggshell.getNamespace(),"show text below button",this.controlNS);Eggshell.connect(this.Eggshell.getNamespace(),"hide text below button",this.controlNS);Eggshell.connect(this.Eggshell.getNamespace(),"show link",this.controlNS);Eggshell.connect(this.Eggshell.getNamespace(),"hide link",this.controlNS);Eggshell.connect(this.Eggshell.getNamespace(),"enable screen blocker",this.controlNS);Eggshell.connect(this.controlNS,"primary button clicked",this.Eggshell.getNamespace());Eggshell.connect(this.controlNS,"secondary button clicked",this.Eggshell.getNamespace());Eggshell.connect(this.controlNS,"link clicked",this.Eggshell.getNamespace());this.controlNS.trigger("show")});var resizeTrackerNS=Eggshell.create("C.Eggshell.window.resize.tracker");Eggshell.on(resizeTrackerNS,"resize",$.proxy(this.resize,this))},resize:function(){var height=this.$(".dialog").height();var viewportHeight=$(window).height();var contentHeight=parseInt(viewportHeight-2*this.$(".dialog").css("top").replace("px",""));var headerHeight=this.$(".header").height();var controlHeight=this.$(".control").height();if(headerHeight){contentHeight-=headerHeight}if(controlHeight){contentHeight-=controlHeight;var controlMargin=parseInt(this.$(".control").css("margin-top").replace("px"));contentHeight-=controlMargin}if(this.$(".control").css("margin-top")){contentHeight-=parseInt(this.$(".control").css("margin-top").replace("px"))}var padding=this.$(".dialog").css("padding");if(!padding){padding=this.$(".dialog").css("padding-top")}if(padding){contentHeight-=2*parseInt(padding.replace("px"))}if(contentHeight<=0){contentHeight=0}this.$(".content").css("max-height",contentHeight)},show:function(){this.resizable=true;this.lockViewport();this.$el.show();this.$(".dialog").show();this.resize();this.Eggshell.trigger("shown");this.resize()},hide:function(e){this.resizable=false;this.$(".dialog").hide();this.unlockViewport();this.$el.hide();this.Eggshell.trigger("hidden")},lockViewport:function(){$("html, body").css({overflow:"hidden"})},unlockViewport:function(){$("html, body").css({overflow:"visible"})},destroyContent:function(){if(this.componentNS){Eggshell.destroy(this.componentNS)}this.$(".content").html("")},destroyControl:function(){if(this.controlNS){Eggshell.destroy(this.controlNS)}this.$(".control").html("")},closeOnClick:function(e){e.preventDefault();e.stopPropagation();this.Eggshell.trigger("close button clicked");this.hide()},screenBlockerOnClick:function(){if(this.screenBlockerClickEnabled===false){return}this.Eggshell.trigger("screen blocker clicked");this.hide()},headlineOnClick:function(){this.Eggshell.trigger("headline clicked")},subHeadlineOnClick:function(){this.Eggshell.trigger("sub headline clicked")},iconOnClick:function(){this.Eggshell.trigger("icon clicked")},contentOnClick:function(e){this.Eggshell.trigger("content clicked",e)}}));Eggshell.define("C.Eggshell.dialog.control.standard",{inputs:["set primary button","set secondary button","set link","set link url","set hint","set text below button","show primary button","hide primary button","enable primary button","disable primary button","focus on primary button","show secondary button","hide secondary button","enable secondary button","disable secondary button","show link","hide link","show hint","hide hint","show text below button","hide text below button"],outputs:["primary button clicked","secondary button clicked","link clicked"]},Backbone.View.extend({template:_.template('<span class="control-standard-hint"></span>'+'<button class="secondary btn-lg btn-primary-outline"></button>'+'<div class="main-button">'+'   <button class="primary btn-lg btn-primary"></button>'+'   <div class="text-below-button"></div>'+"</div>"+"<a></a>"),initialize:function(){this.bindEvents();this.render()},render:function(){this.$el.empty();this.$el.html(this.template());Eggshell.find(this).trigger("hide secondary button");Eggshell.find(this).trigger("hide hint");Eggshell.find(this).trigger("hide text below button")},events:{"click .primary":"clickPrimary","click .secondary":"clickSecondary","click a":"linkOnClick"},bindEvents:function(){var shell=Eggshell.find(this).on("set primary button",function(event,payload){if(typeof payload!="string"||!$.trim(payload)){throw"Invalid primary button text"}this.$(".primary").html(payload).attr("title",payload);shell.trigger("show primary button")}).on("set secondary button",function(event,payload){if(typeof payload!="string"||!$.trim(payload)){throw"Invalid secondary button text"}this.$(".secondary").html(payload).attr("title",payload);shell.trigger("show secondary button")}).on("set link",function(event,payload){if(typeof payload!="string"||!$.trim(payload)){throw"Invalid link text"}this.$("a").html(payload).attr("title",payload)}).on("set link url",function(event,payload){if(typeof payload!="string"||!$.trim(payload)){throw"Invalid link url"}this.$("a").attr("href",payload);shell.trigger("show link")}).on("set text below button",function(event,payload){if(!payload&&typeof payload!=="string"){throw"Invalid text type"}this.$(".text-below-button").html(payload);shell.trigger("show text below button")}).on("set hint",function(event,payload){if(!payload&&typeof payload!=="string"){throw"Invalid text type"}this.$(".control-standard-hint").html(payload);shell.trigger("show hint")}).on("show primary button",function(){this.$(".primary").show()}).on("hide primary button",function(){this.$(".primary").hide()}).on("enable primary button",function(){this.$(".primary").removeAttr("disabled")}).on("disable primary button",function(){this.$(".primary").attr("disabled","disabled")}).on("focus on primary button",function(){this.$(".primary").focus()}).on("show secondary button",function(){this.$(".secondary").show()}).on("hide secondary button",function(){this.$(".secondary").hide()}).on("enable secondary button",function(){this.$(".secondary").removeAttr("disabled")}).on("disable secondary button",function(){this.$(".secondary").attr("disabled","disabled")}).on("show link",function(){this.$("a").show()}).on("hide link",function(){this.$("a").hide()}).on("show text below button",function(event,payload){this.$(".text-below-button").show()}).on("hide text below button",function(event,payload){this.$(".text-below-button").hide()}).on("show hint",function(event,payload){this.$(".control-standard-hint").show()}).on("hide hint",function(event,payload){this.$(".control-standard-hint").hide()})},clickPrimary:function(e){this.Eggshell.trigger("primary button clicked")},clickSecondary:function(e){this.Eggshell.trigger("secondary button clicked")},linkOnClick:function(){this.Eggshell.trigger("link clicked")}}));C.resource.add("C.Eggshell.viewfullsite.button.text","View mobile site &raquo;");Eggshell.define("C.eggshell.viewfullsite.button",{inputs:["show","hide","view mobile site button clicked"],outputs:[]},C.View.extend({events:{"click .view-full-site-button":"viewMobileSiteButtonClicked"},initialize:function(){this.Eggshell.listen("show",function(event,payload){this.$el.show()},this);this.Eggshell.listen("hide",function(event,payload){this.$el.hide()},this);this.Eggshell.listen("view mobile site button clicked",function(event,payload){var url=""+window.location;C.utility.setCookie("NO_MDT",0,-1e3);if(url.indexOf("no_mobile=1")>-1){window.location=url.replace(/(\?|&)no_mobile=1&?/,function(match,start){if(start=="?")return"?";return""})}else{C.utility.refresh()}},this);this.render()},viewMobileSiteButtonTemplate:_.template('<div class="view-full-site-button">'+"<span><%= text %></span>"+"</div>"),render:function(){this.$el.html(this.viewMobileSiteButtonTemplate({text:C.resource.fetch("C.Eggshell.viewfullsite.button.text")}))},viewMobileSiteButtonClicked:function(){this.Eggshell.trigger("view mobile site button clicked")}}));Eggshell.define("C.common.marker",{inputs:["show marker"],outputs:[],newNode:false},function(attributes){var id=attributes.id;var $el=attributes.component;var component=attributes.component;if(component!=null&&typeof component=="string"){$el=$("#"+C.factory.createSafeCssName(component))}else if(component!=null&&typeof component=="object"&&typeof component.getNamespace=="function"){$el=$("#"+C.factory.createSafeCssName(component.getNamespace()))}if(!id){throw"Invalid automation marker ID"}if(!$el||!$el.jquery){throw'Automation marker "'+id+'" error: invalid node'}if($el.length==0){throw'Automation marker "'+id+'" error: node is no longer available'}if($el.length>1){throw'Automation marker "'+id+'" error: cannot mark more than one node'}this.showMarker=function(){$el.addClass("C-test-"+C.factory.createSafeCssName(id))};Eggshell.find(this).on("show marker",this.showMarker);this.showMarker()});if(C("global").profile){console.profileEnd()}(function($){Eggshell.define("C.common.avatar",{inputs:["set avatar id","update avatar image url","update avatar image url with matching id","set size","set shape","set border","set avatar link url"],outputs:["rendered"]},function(attributes){this.id=null;this.$el=attributes.el;this.$el.addClass("medium");this.$el.append($("<img>"));this.$el.hide();this.setSize=function(event,payload){this.$el.removeClass("xsmall small medium large xlarge").addClass(payload);this.resizeImage()};this.setShape=function(event,payload){this.$el.removeClass("circle square").addClass(payload)};this.enableBorder=function(event,payload){if(payload){this.$el.addClass("border")}else{this.$el.removeClass("border")}};this.setUserId=function(event,payload){this.id=payload};this.resizeImage=function(){var img=$("img",this.$el);if(img.naturalWidth()>0&&img.naturalHeight()>0){this.onLoadImage()}else{img.on("load",$.proxy(this.onLoadImage,this))}};this.onLoadImage=function(){var img=$("img",this.$el);var imgWidth=img.naturalWidth();var imgHeight=img.naturalHeight();var width=this.$el.width();var height=this.$el.height();if(imgWidth>imgHeight){var newWidth=height*imgWidth/imgHeight;var newWidthPercent=newWidth/height*100;var left=(newWidth-height)/2;img.css({position:"relative","max-width":"none",width:newWidthPercent.toFixed(0)+"%",left:"-"+left.toFixed(1)+"px"})}else if(imgWidth<imgHeight){var newHeight=width*imgHeight/imgWidth;var newHeightPercent=newHeight/width*100;var top=(newHeight-width)/2;img.css({position:"relative","max-height":"none",height:newHeightPercent.toFixed(0)+"%",top:"-"+top.toFixed(1)+"px"})}};this.updateImageUrl=function(event,payload){var url=payload;this.resizeImage();$("img",this.$el).attr("src",url);this.$el.show()};this.updateImageUrlWithMatchingId=function(event,payload){var id=payload.id;var imageUrl=payload.image;if(id){if(id==this.id){this.updateImageUrl(null,imageUrl)}}else{this.updateImageUrl(null,imageUrl)}};this.setLinkUrl=function(event,payload){var $img=$("img",this.$el);$img.remove();$("<a></a>").attr("href",payload).append($img).appendTo(this.$el)};Eggshell.find(this).on("set avatar id",this.setUserId).on("set size",this.setSize).on("set shape",this.setShape).on("set border",this.enableBorder).on("set avatar link url",this.setLinkUrl).on("update avatar image url",this.updateImageUrl).on("update avatar image url with matching id",this.updateImageUrlWithMatchingId)})})(window.Zepto||window.jQuery);(function($){function img(url){var i=new Image;i.src=url;return i}function noImage(){console.warn("naturalWidth: no image have been passed");return 0}if("naturalWidth"in new Image){$.fn.naturalWidth=function(){return!this.length?noImage():this[0].naturalWidth};$.fn.naturalHeight=function(){return!this.length?noImage():this[0].naturalHeight};return}$.fn.naturalWidth=function(){return!this.length?noImage():img(this[0].src).width};$.fn.naturalHeight=function(){return!this.length?noImage():img(this[0].src).height}})(window.Zepto||window.jQuery);C.resource.add("C.common.autosuggest.placeholder","Begin your search");C.resource.add("C.common.autosuggest.close","Close");C.resource.add("C.common.autosuggest.submit","Submit");C.resource.add("C.common.autosuggest.sellyourbooks","Sell your books");C.resource.add("C.common.autosuggest.at","at ");C.resource.add("C.common.autosuggest.toptextbooks","Top Textbooks ");C.resource.add("C.common.autosuggest.topetextbooks","Top eTextbooks ");C.resource.add("C.common.autosuggest.topsolutions","Top Textbook Solutions ");C.resource.add("C.common.autosuggest.searchtextbooks","Search For Books");C.resource.add("C.common.autosuggest.searchebooks","Search For eBooks");C.resource.add("C.common.autosuggest.noresultsfound","No results found for");C.resource.add("C.common.autosuggest.didyoumean","Did you mean");C.resource.add("C.common.autosuggest.globalsearchheader","Search for a book or course");Eggshell.define("C.common.autosuggestContextualContent",{inputs:["set contextual content","get contextual content"],outputs:["return contextual content"]},function(){var Model=C.Model.extend({initialize:function(){this.set("searchTerm",null)}});var View=C.View.extend({model:new Model,template:_.template('<ul class="contextualContent">'+"<li>"+'<a href="/search/<%- search %>/books" class="autocomplete-show-more"><%- text.searchtextbooks %><span></span></a>'+"</li>"+"<li>"+'<a href="/search/<%- search %>/books#p=1&amp;eBook=1" class="autocomplete-show-more"><%- text.searchebooks %><span></span></a>'+"</li>"+"</ul>"),initialize:function(){this.registerListeners();this.on("render",this.render())},events:{"click a":"getLink",keypress:"onKeyDown"},render:function(){var text={searchtextbooks:C.resource.fetch("C.common.autosuggest.searchtextbooks"),searchebooks:C.resource.fetch("C.common.autosuggest.searchebooks")};this.$el.html(this.template({text:text,search:this.model.get("searchTerm")}))},registerListeners:function(){this.Eggshell.listen("get contextual content",function(event,payload){this.render()});this.Eggshell.listen("set contextual content",function(event,payload){this.model.set("searchTerm",payload)})},getLink:function(e){e.preventDefault();e.stopPropagation();C.utility.navigate(e.currentTarget.href)},onKeyDown:function(){}});return View}());Eggshell.defineInterface("C.common.autosuggest.interface",{inputs:["render","set sohp autosuggest","set full width","set result type","force prefetch pre-results data","set min chars","set first result","set last result","set no results override","set contextual content","set callback","set placeholder text","set value","set render as form","set input field class","set submit button class","set submit button text","set tracking","enable global session tracking","suppress result meta","suppress icons","set max majors","set max schools","delegate mouse over selection event","set disabled items","add disabled items","remove disabled items","disable ajax loader","focus on search input","hide results","inline submit button","disable input field","enable input field"],outputs:["rendered","rendered results","rendered contextual content","rendered no results","search input focused","search input blurred","clicked result","autosuggest clicked","callback fired","autosuggest form submitted"]});Eggshell.define("C.common.autosuggest",{"interface":"C.common.autosuggest.interface"},function(){var Model=Backbone.Model.extend({initialize:function(){this.set("minChars",3);this.set("placeholderText",C.resource.fetch("C.common.autosuggest.placeholder"));this.set("submitButtonText",C.resource.fetch("C.common.autosuggest.submit"));this.set("firstResult",null);this.set("lastResult",null);this.set("contextualContent",null);this.set("fullWidth",false);this.set("lastQuery",null);this.set("renderAsForm",false);this.set("submitButtonClass","btn-flat-sm");this.set("inputFieldClass","form-input-sm");this.set("delay",200);this.set("results",null);this.set("globalSessionTracking",false);this.set("track",null);this.set("selectedResult",null);this.set("callback",null);this.set("resultContainerHeight",0);this.set("loadingIndicatorVisible",false);this.set("suppressMeta",false);this.set("maxMajors",null);this.set("maxSchools",null);this.set("suppressIcons",false);this.set("disableAjaxLoader",false);this.set("sohpAutosuggest",false);this.set("hideResultsOnReload",false);this.set("disabledItems",[]);this.set("maxResultsBlockHeight",false)},preGetResults:function(params){clearTimeout(this.ajaxTimeout);var that=this;this.ajaxTimeout=setTimeout(function(){that.getResults(params)},this.delay)},getResults:function(params){this.trigger("showLoadingIndicator");$.ajax({url:C.global.cheggSiteSecureUrl+"_ajax/autocomplete"+params,dataType:"json",context:this,xhrFields:{withCredentials:true},success:function(r){if(r&&r[0]){this.set("results",$.extend({},r[0].items));this.trigger("processSuccessResponse")}else{this.set("results",null);this.trigger("processErrorResponse")}this.trigger("hideLoadingIndicator")},error:function(r){this.set("results",null);this.trigger("processErrorResponse");this.trigger("hideLoadingIndicator")}})}});var resultView=Backbone.View.extend({initialize:function(){this.render()},render:function(){this.hightLightText(this.model.attributes);var type=this.model.attributes.itemType;switch(type){case"book":var item=this.model.attributes.subtitle?c_common_result_3_lines(this.model.attributes):c_common_result_2_lines(this.model.attributes);break;case"dac":var item=this.model.attributes.subtitle?c_common_result_3_lines(this.model.attributes):c_common_result_2_lines(this.model.attributes);break;case"ebook":var item=this.model.attributes.subtitle?c_common_result_3_lines(this.model.attributes):c_common_result_2_lines(this.model.attributes);break;case"course":var item=c_common_result_course(this.model.attributes);break;case"major":var item=c_common_result_major(this.model.attributes);break;case"careerInterest":var item=c_common_result_careerInterest(this.model.attributes);break;case"academicInterest":var item=c_common_result_academicInterest(this.model.attributes);break;case"school":case"allschools":var item=c_common_result_school(this.model.attributes);break;case"highschools":var item=c_common_result_school(this.model.attributes);break;case"lastItemLink":var item=c_common_result_last_link(this.model.attributes);break;default:var item=this.model.attributes.subtitle?c_common_result_3_lines(this.model.attributes):c_common_result_2_lines(this.model.attributes)}var container=this.options.fullWidth?c_common_result_container_full({attributes:this.model.attributes,result:item}):c_common_result_container({attributes:this.model.attributes,result:item});this.$el.attr("data-url",this.model.attributes["data-url"]);this.$el.attr("data-ii",this.model.attributes["data-ii"]);if(this.options.suppressIcon==true){this.$el.addClass("suppress-icon")}if(this.model.attributes.itemType=="lastItemLink"){this.$el.addClass("last-item-link")}this.$el.html(container);if(type=="book"||type=="dac"||type=="ebook"){Eggshell.create("C.common.bookcover",{el:this.$el.find(".book-cover-container")}).trigger("set book image",this.model.attributes.img["url"]).trigger("turn off shadow").trigger("set book alt",this.model.attributes.img["alt"])}},events:{mousedown:"doClick"},doClick:function(e){if($(e.target).closest("li").hasClass("autosuggest-disabled-item")){e.preventDefault();e.stopPropagation();return false}this.options.eggshell.trigger("autosuggest form submitted");if(this.options.callback){e.preventDefault();e.stopPropagation();this.options.eggshell.trigger("callback fired",this.model);this.options.eggshell.trigger("autosuggest clicked",this.model.toJSON())}},hightLightText:function(){var replacement='<span class="chg-suggest-term">$1</span>';var replaceTerm=this.options.val;var regex=new RegExp("("+this.regExpQuote(replaceTerm)+")","i");var safeReplaceHeader=$("<div/>").html(this.model.get("header")).text();if(this.model.get("header")){var decoratedHeader=safeReplaceHeader.replace(regex,replacement);this.model.set("header",decoratedHeader)}if(this.model.get("subHeader")){var decoratedSubheader=this.model.get("subHeader").replace(regex,replacement);this.model.set("subHeader",decoratedSubheader)}if(this.model.get("detail")){var decoratedDetail=this.model.get("detail").replace(regex,replacement);this.model.set("detail",decoratedDetail)}},regExpQuote:function(str){return(str+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}});var resultModel=Backbone.Model.extend({initialize:function(){this.bulletSeperatorHTML="&nbsp;&bull;&nbsp;";this.on("change",this.transformData())},defaults:{header:null,subHeader:false,detail:null,img:{alt:null,url:null},itemType:null,school:null,"data-url":null,"data-ii":null},transformData:function(){switch(this.get("itemType")){case"book":var header=this.get("title")+(this.get("editionNo")?' <span class="this-header-small">('+this.toOrdinal(this.get("editionNo"))+" Edition)</span>":"");var metaItems=$.extend({},this.get("itemPromo"));this.set("header",header);this.set("subHeader",this.get("subtitle")?this.get("subtitle"):false);this.set("detail",this.get("author")+this.bulletSeperatorHTML+this.buildISBNText(this));this.set("img",this.get("img"));this.set("itemType",this.get("itemType"));this.set("school",null);this.set("meta",this.buildBookPromoContent(metaItems));this.set("data-url",this.get("attributes")["data-url"]);break;case"ebook":var header=this.get("title")+(this.get("editionNo")?' <span class="this-header-small">('+this.toOrdinal(this.get("editionNo"))+" Edition)</span>":"");

var metaItems=$.extend({},this.get("itemPromo"));metaItems.isEbook=true;this.set("header",header);this.set("subHeader",this.get("subtitle")?this.get("subtitle"):false);this.set("detail",this.get("author")+this.bulletSeperatorHTML+this.buildISBNText(this));this.set("img",this.get("img"));this.set("itemType",this.get("itemType"));this.set("school",null);this.set("meta",this.buildBookPromoContent(metaItems));this.set("data-url",this.get("attributes")["data-url"]);break;case"dac":var header=this.get("title")+(this.get("editionNo")?' <span class="this-header-small">('+this.toOrdinal(this.get("editionNo"))+" Edition)</span>":"");var metaItems=$.extend({},this.get("itemPromo"));this.set("header",header);this.set("subHeader",this.get("subtitle")?this.get("subtitle"):false);this.set("detail",this.get("author")+this.bulletSeperatorHTML+this.buildISBNText(this));this.set("img",this.get("img"));this.set("itemType",this.get("itemType"));this.set("school",null);this.set("meta",this.buildBookPromoContent(metaItems));this.set("data-url",this.get("attributes")["data-url"]);break;case"course":this.set("header",this.get("title"));this.set("subHeader",this.get("subtitle"));this.set("itemType",this.get("itemType"));this.set("school",this.get("attributes")["data-schoolName"]);this.set("data-url",this.get("attributes")["data-url"]);break;case"major":this.set("header",this.get("title"));this.set("data-url",this.get("attributes")["data-id"]);this.set("itemType",this.get("itemType"));break;case"careerInterest":this.set("header",this.get("title"));this.set("data-url",this.attributes["data-id"]);this.set("itemType",this.get("itemType"));break;case"academicInterest":this.set("header",this.get("title"));this.set("data-url",this.get("attributes")["data-id"]);this.set("itemType",this.get("itemType"));break;case"school":this.set("header",this.get("title"));this.set("data-url",this.get("attributes")["data-schoolId"]);this.set("itemType",this.get("itemType"));break;case"lastItemLink":this.set("header",this.get("title"));this.set("data-schoolId",this.get("attributes")["data-schoolId"]);break;case"solution":break;case"user":break}},toOrdinal:function(i){var j=i%10;if(j==1&&i!=11){return i+"st"}if(j==2&&i!=12){return i+"nd"}if(j==3&&i!=13){return i+"rd"}return i+"th"},buildISBNText:function(result){var printIsbn=result.get("isbnText");printIsbn=printIsbn.replace("&amp;nbsp;",this.bulletSeperatorHTML);if(result.get("itemType")=="ebook"){printIsbn=printIsbn.replace("ISBN","eISBN");printIsbn=printIsbn.replace("ISBN13","eISBN13")}return printIsbn},buildBookPromoContent:function(metaInfo){if(typeof metaInfo=="object"&&(metaInfo.hasTBS||metaInfo.isEbook||metaInfo.hasInstantAccess||metaInfo.hasEbook)){var bookPromoContent="";var hasTBS=metaInfo.hasTBS?metaInfo.hasTBS:false;var hasInstantAccess=metaInfo.hasInstantAccess?metaInfo.hasInstantAccess:false;var hasEbook=metaInfo.hasEbook?metaInfo.hasEbook:false;var isEbook=metaInfo.isEbook?metaInfo.isEbook:false;if(hasEbook===true||hasTBS===true||isEbook===true||hasInstantAccess===true){if(hasInstantAccess){bookPromoContent+='<span class="results-meta-item">';bookPromoContent+='<span class="results-meta-icon results-meta-icon-instant"></span> <span class="results-meta-label">Free 7-day eTextbook Access</span></span>'}if(hasEbook){bookPromoContent+='<span class="results-meta-item">';bookPromoContent+='<span class="results-meta-icon results-meta-icon-ebook"></span> <span class="results-meta-label"><strong>eTextbook</strong> available</span></span>'}if(hasTBS){bookPromoContent+='<span class="results-meta-item">';bookPromoContent+='<span class="results-meta-icon results-meta-icon-tbs"></span> <span class="results-meta-label"><strong>Guided Solutions</strong> available</span></span>'}if(isEbook){bookPromoContent+='<span class="results-meta-item">';bookPromoContent+='<span class="results-meta-icon results-meta-icon-ebook"></span> <span class="results-meta-label"><strong>eTextbook</strong></span></span>'}}return bookPromoContent}}});var resultModelCollection=Backbone.Collection.extend({model:resultModel});var View=Backbone.View.extend({model:new Model,tmpl_field:_.template('<input name="autosuggest-input" class="autosuggest-input-field <%- text.inputFieldClass %>" type="text" placeholder="<%- text.placeholder %>" autocomplete="off"/>'+'<span class="loadingIndicator"></span>'+'<div class="autosuggest-results-container"><ul class="autosuggest-results-list"></ul><div class="autosuggest-contextual-content"></div></div>'),tmpl_form:_.template('<form class="chg-search-form" action="/search" onsubmit="return false">'+'<a data-type="button" class="autosuggest-search-btn search-magnify-btn  <%- text.submitButtonClass %>" href="#"><%= text.submit %></a>'+'<a class="autosuggest-search-cancel search-magnify-btn-close autosuggest-search-cancel-<%- text.inputFieldClass %>" href="#"><span class="icon-x"><%- text.close %></span></a>'+'<input name="autosuggest-input" class="autosuggest-input-field <%- text.inputFieldClass %>" type="text" placeholder="<%- text.placeholder %>" autocomplete="off" />'+"</form>"+'<div class="autosuggest-results-container"><ul class="autosuggest-results-list"></ul><div class="autosuggest-contextual-content"></div></div>'),initialize:function(){this.model=new Model;this.model.on("processSuccessResponse",this.processSuccessResponse,this);this.model.on("processErrorResponse",this.processErrorResponse,this);this.model.on("showLoadingIndicator",this.showLoadingIndicator,this);this.model.on("hideLoadingIndicator",this.hideLoadingIndicator,this);this.registerListeners();this.trackId=this.generateTrackId();this.mouseInDropdown=false},events:{"keyup .autosuggest-input-field":"onKeyUp","keydown .autosuggest-input-field":"onKeyDown","keydown .autosuggest-results-container":"onKeyDown","focus .autosuggest-input-field":"onTextboxFocus","blur .autosuggest-input-field":"onTextboxBlur","click .autosuggest-search-cancel":"resetSearch","click .autosuggest-search-btn":"clickSubmit","click li":"onSelectionClick","mouseenter .autosuggest-results-container":"onMouseEnter","mouseleave .autosuggest-results-container":"onMouseLeave"},mouseOverEvent:{"mouseover li":"onMouseOverSelection"},registerListeners:function(){this.Eggshell.listen("render",function(event,payload){this.render()});this.Eggshell.listen("set result type",function(event,payload){this.model.set("resultType",payload)});this.Eggshell.listen("set min chars",function(event,payload){if(payload&&payload===parseInt(payload)){this.model.set("minChars",payload)}});this.Eggshell.listen("set first result",function(event,payload){if(payload){this.model.set("firstResult",payload)}});this.Eggshell.listen("set last result",function(event,payload){if(payload){this.model.set("lastResult",payload)}});this.Eggshell.listen("set full width",function(event,payload){this.model.set("fullWidth",true);this.$el.addClass("fullWidth")});this.Eggshell.listen("set render as form",function(event,payload){this.model.set("renderAsForm",true);this.$el.addClass("form-display")});this.Eggshell.listen("set tracking",function(event,payload){if(payload){this.model.set("track",payload)}});this.Eggshell.listen("enable global session tracking",function(event,payload){this.model.set("globalSessionTracking",true)});this.Eggshell.listen("set callback",function(event,payload){this.model.set("callback",true)});this.Eggshell.listen("set contextual content",function(event,payload){if(payload){this.model.set("contextualContent",true)}});this.Eggshell.listen("suppress result meta",function(event,payload){this.model.set("suppressMeta",true)});this.Eggshell.listen("suppress icons",function(event,payload){if(payload&&typeof payload=="boolean"){this.model.set("suppressIcons",payload)}});this.Eggshell.listen("set placeholder text",function(event,payload){this.model.set("placeholderText",payload);this.text=$.extend(this.text,{placeholder:this.model.get("placeholderText")})});this.Eggshell.listen("set submit button text",function(event,payload){this.model.set("submitButtonText",payload)});this.Eggshell.listen("set value",function(event,payload){if(typeof payload=="string"){this.$inputField.val(payload)}});this.Eggshell.listen("set input field class",function(event,payload){if(payload&&typeof payload=="string"){this.model.set("inputFieldClass",payload)}});this.Eggshell.listen("set submit button class",function(event,payload){if(payload&&typeof payload=="string"){this.model.set("submitButtonClass",payload)}});this.Eggshell.listen("set max majors",function(event,payload){if(payload&&typeof payload=="number"){this.model.set("maxMajors",payload)}});this.Eggshell.listen("set max schools",function(event,payload){if(payload&&typeof payload=="number"){this.model.set("maxSchools",payload)}});this.Eggshell.listen("disable ajax spinner",function(event,payload){if(payload&&typeof payload=="boolean"){this.model.set("disableAjaxLoader",payload)}});this.Eggshell.listen("set sohp autosuggest",function(event,payload){if(payload&&typeof payload=="boolean"){this.model.set("sohpAutosuggest",payload)}});this.Eggshell.listen("delegate mouse over selection event",function(event,payload){this.delegateEvents(payload?_.extend(this.events,this.mouseOverEvent):this.events)});this.Eggshell.listen("set disabled items",function(event,payload){this.setDisabledItems(payload)});this.Eggshell.listen("add disabled items",function(event,payload){this.addDisabledItems(payload)});this.Eggshell.listen("remove disabled items",function(event,payload){this.removeDisabledItems(payload)});this.Eggshell.listen("hide results",function(event){this.hideResults()});this.Eggshell.listen("inline submit button",function(event){this.inlineSubmitButton()});this.Eggshell.listen("set max results block height",function(event,payload){this.model.set("maxResultsBlockHeight",payload)});Eggshell.find(this).on("focus on search input",function(){if(this.$inputField){this.$inputField.focus()}})},render:function(){var fullWidth=this.model.get("fullWidth");var renderAsForm=this.model.get("renderAsForm");var sohpAutosuggest=this.model.get("sohpAutosuggest");this.submitButton='<span class="icn-magnify">'+this.model.get("submitButtonText")+"</span>";this.text={placeholder:this.model.get("placeholderText"),close:C.resource.fetch("C.common.autosuggest.close"),submit:this.submitButton,submitButtonClass:this.model.get("submitButtonClass"),inputFieldClass:this.model.get("inputFieldClass")};if(renderAsForm==true){this.$el.html(this.tmpl_form({text:this.text}))}else{this.$el.html(this.tmpl_field({text:this.text}))}this.$inputField=this.$el.find(".autosuggest-input-field");this.$resultsContainer=this.$el.find(".autosuggest-results-container");this.$resultsList=this.$el.find("ul.autosuggest-results-list");this.$searchButton=this.$el.find(".autosuggest-search-btn");this.$cancelButton=this.$el.find(".autosuggest-search-cancel");this.$form=this.$el.find(".chg-search-form");this.$loadingIndicatorContainer=this.$el.find(".loadingIndicator");this.$contextualContentContainer=this.$el.find(".autosuggest-contextual-content");this.$curLi=null;this.submitButtonWidth=this.$searchButton.outerWidth();if(this.model.get("suppressMeta")){this.$resultsList.addClass("suppress-result-meta")}if(renderAsForm==true&&fullWidth==false){var positionRight="";if(sohpAutosuggest==true){var positionRight="5px";var positionTop="5px";this.$form.css("margin-right","0px");this.$searchButton.css({background:"#F07D00",right:positionRight,top:positionTop,width:this.submitButtonWidth});var cancelButtonPositionRight=this.submitButtonWidth+5+"px";this.$cancelButton.css({right:cancelButtonPositionRight})}else{var positionRight="-"+(this.submitButtonWidth+5)+"px";this.$form.css("margin-right",this.submitButtonWidth);this.$searchButton.css({right:positionRight,width:this.submitButtonWidth})}}this.Eggshell.trigger("rendered")},processSuccessResponse:function(){if(this.blockAllResponses){return}var lastResult=this.model.get("lastResult");var response=this.model.get("results");if(!response){return}var data=typeof response=="object"?response:jQuery.parseJSON(response);var collection=new resultModelCollection;$.each(data,$.proxy(function(i,dataObject){var result=new resultModel(dataObject);result.set("data-ii",parseInt(i)+1);collection.add(result)},this));var resultSet="";if(collection.length>0){resultSet=this.buildResultSet(collection);this.renderResultSet(resultSet);var height=this.$resultsContainer.height()+this.$contextualContentContainer.height();this.model.set("resultContainerHeight",height);if(this.model.get("hideResultsOnReload")!=true){this.showResults();this.model.set("hideResultsOnReload",false)}}else{resultSet=this.buildResultSet("");this.renderResultSet(resultSet);var height=this.$resultsContainer.height()+this.$contextualContentContainer.height();this.model.set("resultContainerHeight",height);if(lastResult){this.showResults()}}},getInputValue:function(){var trim=function(val){return val.length?$.trim(val):""};var val=this.$inputField.val()||"";return trim(val).replace(/([.?*+^$[\]\\/()"{}<>|])/g,"")},processErrorResponse:function(){var lastResult=this.model.get("lastResult");var nullResult=c_common_result_none({query:this.getInputValue(),noresults:C.resource.fetch("C.common.autosuggest.noresultsfound"),didyoumean:C.resource.fetch("C.common.autosuggest.didyoumean")});var container=this.options.fullWidth?c_common_result_container_full({attributes:{"data-url":"#"},result:nullResult}):c_common_result_container({attributes:{"data-url":"#"},result:nullResult});this.renderResultSet(container);if(lastResult){var lastEl=this.buildLastResult(lastResult);this.$resultsList.append(lastEl)}var height=this.$resultsContainer.height()+this.$contextualContentContainer.height();this.model.set("resultContainerHeight",height);this.showResults()},buildResultSet:function(results){var firstResult=this.model.get("firstResult");var lastResult=this.model.get("lastResult");var contextualContent=this.model.get("contextualContent");var fullWidth=this.model.get("fullWidth");this.$resultsList.html("");if(firstResult){this.$resultsList.prepend(firstResult)}if(results.length>0){results.each($.proxy(function(result,i){var el=$('<li class="result"></li>');var val=this.getInputValue();var callback=this.model.get("callback")?this.model.get("callback"):false;var suppressIcons=this.model.get("suppressIcons");if(this.isItemDisabled(result.attributes))el.addClass("autosuggest-disabled-item");resultHTML=new resultView({model:result,el:el,val:val,callback:callback,fullWidth:fullWidth,eggshell:Eggshell.find(this),suppressIcon:suppressIcons});this.$resultsList.append(el)},this))}if(lastResult){var lastEl=this.buildLastResult(lastResult);this.$resultsList.append(lastEl)}if(contextualContent){this.buildContextualContent()}},buildLastResult:function(lastResult){var el=$('<li class="result"></li>');if(this.isItemDisabled(lastResult.attributes))el.addClass("autosuggest-disabled-item");var lastResultItem=new resultModel(lastResult);var callback=this.model.get("callback")?this.model.get("callback"):false;var lastResultItemHtml=new resultView({model:lastResultItem,el:el,eggshell:Eggshell.find(this),callback:callback});this.$resultsList.append(el);return el},buildContextualContent:function(){this.$contextualContentContainer.html("");var contextualContent=Eggshell.create("C.common.autosuggestContextualContent",{el:this.$contextualContentContainer});Eggshell.trigger(contextualContent,"set contextual content",this.getInputValue());Eggshell.trigger(contextualContent,"get contextual content");this.Eggshell.trigger("rendered contextual content")},renderResultSet:function(resultSet){this.$resultsList.html(resultSet)},showResults:function(){if(!!this.model.get("maxResultsBlockHeight")&&!_.isNaN(parseInt(this.model.get("maxResultsBlockHeight")))){this.$resultsContainer.css({"overflow-y":"scroll","max-height":this.model.get("maxResultsBlockHeight")})}if(this.model.get("fullWidth")==false||this.model.get("renderAsForm")==false){var rw=this.$inputField.outerWidth();this.$resultsContainer.width(rw)}if(this.$resultsContainer.height()>0){this.$resultsContainer.slideDown(300);Eggshell.find("C.common.overlay.tooltip").trigger("hide")}var val=this.getInputValue();if(parseInt(val.length)>0){this.$cancelButton.show()}},hideResults:function(){this.$resultsContainer.hide();var val=this.getInputValue();if(parseInt(val.length)==0){this.$cancelButton.hide()}var $lis=$(this.$resultsList).find("li");$lis.removeClass("selected")},inlineSubmitButton:function(){this.$searchButton=this.$el.find(".autosuggest-search-btn");this.$searchButton.css({right:"0px"})},onKeyDown:function(e){if(e.keyCode==40){this.doNextSelection(e);var currItem=$(this.$resultsList).find("li.selected");this.scroll("down",currItem);e.preventDefault()}else if(e.keyCode==38){this.doPrevSelection(e);var currItem=$(this.$resultsList).find("li.selected");this.scroll("up",currItem);e.preventDefault()}else if(e.keyCode==27){this.$inputField.val("");this.$inputField.blur();this.hideResults();this.$curLi=null}else if(e.keyCode==13){this.doSessionLogging(e);this.onSubmit(e)}else{var $lis=$(this.$resultsList).find("li").not($(this.$resultsList).find("li li"));$lis.removeClass("selected");this.$curLi=null}},scroll:function(direction,currItem){var wrapper=this.$resultsContainer;var item=currItem,wrapperHeight=$(wrapper).height(),itemHeight=$(item).height(),itemPosTop=item.position().top+itemHeight,scrollTo=itemPosTop;switch(direction){case"up":if(itemPosTop<=0){var index=this.scrollCounter.dec();$(wrapper).scrollTop(wrapperHeight*index)}else if(itemPosTop>wrapperHeight){var itemsCount=$(this.$resultsList).find("li").not($(this.$resultsList).find("li li")).length;$(wrapper).scrollTop(9999);this.scrollCounter.set(Math.round(itemHeight*itemsCount/wrapperHeight))}break;case"down":if(itemPosTop>wrapperHeight){var index=this.scrollCounter.inc();$(wrapper).scrollTop((scrollTo-itemHeight)*index)}else if(itemPosTop<0){$(wrapper).scrollTop(0);this.scrollCounter.reset()}break}},scrollCounter:function(){var counter=0;return{inc:function(){return counter+=1},dec:function(){return counter-=1},reset:function(){counter=0},set:function(value){counter=value}}}(),onKeyUp:function(e){if(e.keyCode==13){this.hideResults();this.$curLi=null;this.setResponseBlocker();return}var val=this.getInputValue();var lastQuery=this.model.get("lastQuery");if(lastQuery==val){return}this.evalQuery(val)},setResponseBlocker:function(){this.blockAllResponses=true;setTimeout($.proxy(function(){this.blockAllResponses=false},this),1e3)},evalQuery:function(val){var minChars=this.model.get("minChars");var lastQuery=this.model.get("lastQuery");if(val===""||val.length<minChars){this.hideResults();this.$curLi=null;return}if(val.length>=minChars&&val!=lastQuery){var params=this.buildUrl(val);this.model.preGetResults(params);this.$curLi=null}else if(val.length>=minChars){this.showResults();this.$curLi=null}this.model.set("lastQuery",val)},buildUrl:function(val){var resultType=this.model.get("resultType");var maxMajors=this.model.get("maxMajors");var maxSchools=this.model.get("maxSchools");var params="";if(resultType&&Object.prototype.toString.call(resultType)==="[object Array]"){var i,max,resultType;params+="type=";for(i=0,max=resultType.length;i<max;i++){params+=resultType[i];if(i<max&&max!=1&&i+1!=max){params+="|"}}if(resultType.length>1){params+="&combine_results=items&"}else{params+="&"}if(maxMajors!=null&&typeof maxMajors=="number"){params+="majors_max="+maxMajors+"&"}if(maxSchools!=null&&typeof maxSchools=="number"){params+="schools_max="+maxSchools+"&"}}else{params="type=all&"}return"?search_by="+encodeURIComponent(val)+"&"+params+"trackid="+this.trackId},resetSearch:function(e){e.preventDefault();e.stopPropagation();this.$inputField.val("");this.$resultsList.html("");this.hideResults();this.$curLi=null},onTextboxFocus:function(){var val=this.getInputValue();this.model.set("lastQuery",val);this.evalQuery(val);Eggshell.find(this).trigger("search input focused")},onTextboxBlur:function(){if(!this.mouseInDropdown){if(!this.$inputField.is(":focus")){this.hideResults();this.$curLi=null}}Eggshell.find(this).trigger("search input blurred")},onMouseEnter:function(){if(this.mouseInDropdown){return}this.mouseInDropdown=true},onMouseLeave:function(){var $lis=$(this.$resultsList).find("li").not($(this.$resultsList).find("li li"));$lis.removeClass("selected");this.$curLi=null;return},doNextSelection:function(e){var $lis=$(this.$resultsList).find("li").not($(this.$resultsList).find("li li"));var index=$lis.index($(this.$resultsList).find("li.selected"));var $cur;$lis.removeClass("selected");if(index==-1||index>=$lis.length-1){$cur=$lis.eq(0).addClass("selected")}else{$cur=$lis.eq(index+1).addClass("selected")}if($cur.hasClass("autosuggest-disabled-item")){this.doNextSelection(e);return}this.changeSelection($cur)},doPrevSelection:function(e){var $lis=$(this.$resultsList).find("li").not($(this.$resultsList).find("li li"));var index=$lis.index($(this.$resultsList).find("li.selected"));var $cur;$lis.removeClass("selected");if(index==-1||index===0){$cur=$lis.eq($lis.length-1).addClass("selected")}else{$cur=$lis.eq(index-1).addClass("selected")}if($cur.hasClass("autosuggest-disabled-item")){this.doPrevSelection(e);return}this.changeSelection($cur)},onMouseOverSelection:function(e){var $cur=$(e.target).closest("li");if($cur.not($(this.$resultsList).find("li li")).length==0){return}if($cur.hasClass("autosuggest-disabled-item")){return}var container=e.currentTarget;if($cur.length){this.$resultsList.find("li").removeClass("selected");$cur.addClass("selected")}this.changeSelection($cur)},changeSelection:function($el){this.$curLi=$el;var $clickedHeader=this.$curLi.find(".result-header");if($clickedHeader.length){this.model.set("selectedResult",$clickedHeader.text())}else{this.model.set("selectedResult",null)}},evaluateSchoolData:function(gid){savedId=C.utility.getLocal("schoolId");savedName=C.utility.getLocal("schoolName");if(!gid){return false}if(gid&&savedId&&savedName&&gid==savedId){this.schoolInfo={schoolName:savedName,schoolId:savedId};return true}else{this.getSchool(gid)}},clickSubmit:function(e){this.onSubmit(e);this.doSessionLogging(e)},onSubmit:function(e){e.preventDefault();e.stopPropagation();var isForm=this.model.get("renderAsForm");var track=this.model.get("track");var selectedResult=this.model.get("selectedResult");var callback=this.model.get("callback");var $selectedLi=$(this.$resultsList).find("li.selected");this.Eggshell.trigger("autosuggest form submitted");this.hideResults();if(callback){if(isForm&&!this.$curLi){this.Eggshell.trigger("callback fired",{inputValue:this.getInputValue()});this.Eggshell.trigger("autosuggest clicked",{inputValue:this.getInputValue()})}else{$selectedLi.mousedown()}}else{if(isForm&&!this.$curLi){if(track&&typeof track=="string"){var trk=track.split("=");this.$form.append('<input type="hidden" name="'+trk[0]+'" value="'+trk[1]+'" />')}C.utility.navigate(C.global.cheggSiteUrl+"search/"+encodeURIComponent(this.getInputValue())+"/books");return true}this.navigateToNewPage(this.$curLi);return}},navigateToNewPage:function($curLi){var track=this.model.get("track");var inputVal=this.model.get("lastQuery");if(this.$curLi!=null){var url=this.$curLi.attr("data-url");url=_.unescape(url);var ii=this.$curLi.attr("data-ii");this.updateInputVal();if(ii!=undefined){url=url.indexOf("?")==-1?url+"?ii="+ii:url+"&ii="+ii;if(track){url+="&"+track}}else if(url!=undefined){C.utility.navigate(url);return true}else{url="/search/"+inputVal+"/books"}C.utility.navigate(url);return false}else{var url=this.$curLi.find("a").attr("href");C.utility.navigate(url);return false}return true},onSelectionClick:function(e){var callback=this.model.get("callback");if(e.which!==1){return}var $curLi=$(e.target).closest("li");if($curLi.hasClass("autosuggest-disabled-item")){e.preventDefault();e.stopPropagation();return}this.$curLi=$curLi;this.changeSelection(this.$curLi);this.hideResults();if(!callback){this.navigateToNewPage(this.$curLi)}this.doSessionLogging(e);this.Eggshell.trigger("clicked result");return false},updateInputVal:function(){var selectedResult=this.model.get("selectedResult");if(selectedResult){this.$inputField.val(selectedResult);this.$inputField.blur();this.$resultsList.html("");var params=this.buildUrl(selectedResult);this.model.set("hideResultsOnReload",true);this.model.preGetResults(params);this.model.set("selectedResult",null)}},showLoadingIndicator:function(){if(this.model.get("disableAjaxLoader")){return}if(!this.model.get("loadingIndicatorVisible")){var canvasLoader='<canvas class="loading" width="15" height="15"><img src="//c.cheggcdn.com/s/_global/images/ajax-loader.gif"></canvas>';if(this.model.get("renderAsForm")){this.$searchButton.html(canvasLoader);var cvLoading=this.$searchButton.find("canvas.loading")}else{this.$loadingIndicatorContainer.html(canvasLoader);var cvLoading=this.$loadingIndicatorContainer.find("canvas.loading")}if(this.model.get("fullWidth")&&this.model.get("renderAsForm")){var color="#ffffff"}else{var color="#666666"}var spinner=new C.widget.spinner({canvas:cvLoading,color:color});this.model.set("loadingIndicatorVisible",true)}},hideLoadingIndicator:function(){if(this.model.get("disableAjaxLoader")){return}if(this.model.get("loadingIndicatorVisible")){this.$searchButton.html(this.submitButton);this.$loadingIndicatorContainer.html("");this.model.set("loadingIndicatorVisible",false)}},generateTrackId:function(){var trackid=Math.abs(Math.random()*4294967295<<0).toString(16);return("000000000"+trackid).slice(-8)},doSessionLogging:function(e){e.preventDefault();var selectedResult=this.model.get("selectedResult");var globalTracking=this.model.get("globalSessionTracking");if(globalTracking){if($(e.currentTarget).hasClass("autosuggest-input-field")){if(selectedResult!=null){C.logger.doSessionLog({src:"header"})}else{C.logger.doSessionLog({src:"header",action:"enter"})}}if($(e.currentTarget).hasClass("autosuggest-search-btn")){C.logger.doSessionLog({src:"header",action:"button"})}if($(e.currentTarget).hasClass("result")){C.logger.doSessionLog({src:"header"})}}},getDisabledItems:function(){var disabledItems=this.model.get("disabledItems");if(!disabledItems||typeof disabledItems!=="object"){return[]}return disabledItems},setDisabledItems:function(items){this.model.set("disabledItems",this.convertItemsToArray(items));return this},addDisabledItems:function(items){var newItems=_.union(this.getDisabledItems(),this.convertItemsToArray(items));return this.setDisabledItems(newItems)},removeDisabledItems:function(items){var newItems=_.difference(this.getDisabledItems(),this.convertItemsToArray(items));return this.setDisabledItems(newItems)},convertItemsToArray:function(items){if(!items)return[];if(typeof items!=="object")return[items];return items},isItemDisabled:function(attributes){var dataUrl=attributes&&attributes["data-url"]?attributes["data-url"]:null;if(!dataUrl||typeof dataUrl!=="string")return false;return _.indexOf(this.getDisabledItems(),dataUrl)>-1}});return View}());var c_common_result_container=_.template('<a href="<%= attributes["data-url"] %>">'+"<%= result %>"+"</a>");var c_common_result_container_full=_.template('<a href="<%= attributes["data-url"] %>">'+'<span class="autosuggest-width"><span class="autosuggest-row row"><span class="col-12 col-first col-last">'+"<%= result %>"+"</span></span></span>"+"</a>");var c_common_result_3_lines=_.template('<div class="result-data result-3-lines result-<%- itemType %> <% if(typeof(meta)!= "undefined"){ %> result-data-margin-right<% } %>">'+'<span class="book-cover-container"></span>'+'<div class="result-info">'+'<span class="result-header"><%= header %></span>'+'<span class="result-sub-header"><%= subHeader %></span>'+'<span class="result-detail"><%= detail %></span>'+'<% if(typeof(meta)!= "undefined" && _.size(meta) != 0){ %><div class="results-meta"><%= meta %></div><% } %>'+"</div>"+"</div>");var c_common_result_2_lines=_.template('<div class="result-data result-2-lines result-<%- itemType %> <% if(typeof(meta)!= "undefined"){ %> result-data-margin-right<% } %>">'+'<span class="book-cover-container"></span>'+'<div class="result-info">'+'<span class="result-header"><%= header %></span>'+'<span class="result-detail"><%= detail %></span>'+'<% if(typeof(meta)!= "undefined" && _.size(meta) != 0){ %><div class="results-meta"><%= meta %></div><% } %>'+"</div>"+"</div>");var c_common_result_course=_.template('<div class="result-data result-2-lines result-<%- itemType %> <% if(typeof(meta)!= "undefined"){ %> result-data-margin-right<% } %>">'+'<span class="img-wrapper autosuggest-icon autosuggest-icon-course"> <% if(typeof(img) != "undefined" && typeof(img.url) != "undefined" && typeof(img.alt) != "undefined"){ %> <img src="<%- img.url %>" alt="<%- img.alt %>"> <% } %></span>'+'<div class="result-info">'+'<div class="result-bookinfo">'+'<span class="result-header"><%= header %><span class="light"> at <%= school %> </span></span>'+'<span class="result-sub-header"><%= subHeader %></span>'+'<% if(typeof(meta)!= "undefined" && _.size(meta) != 0){ %><div class="result-meta"><%= meta %></div><% } %>'+"</div>"+"</div>"+"</div>");var c_common_result_major=_.template('<div class="result-data result-1-lines result-<%- itemType %>">'+'<span class="img-wrapper autosuggest-icon autosuggest-icon-major"><% if(typeof(img) != "undefined" && typeof(img.url) != "undefined" && typeof(img.alt) != "undefined"){ %> <img src="<%- img.url %>" alt="<%- img.alt %>"> <% } %></span>'+'<div class="result-info">'+'<span class="result-header"><%= header %></span>'+"</div>"+"</div>");var c_common_result_careerInterest=_.template('<div class="result-data result-1-lines result-<%- itemType %>">'+'<div class="result-info">'+'<span class="result-header"><%= header %></span>'+"</div>"+"</div>");var c_common_result_academicInterest=_.template('<div class="result-data result-1-lines result-<%- itemType %>">'+'<div class="result-info">'+'<span class="result-header"><%= header %></span>'+"</div>"+"</div>");var c_common_result_school=_.template('<div class="result-data result-2-lines result-<%- itemType %>">'+'<span class="img-wrapper autosuggest-icon autosuggest-icon-school"><% if(typeof(img) != "undefined" && typeof(img.url) != "undefined" && typeof(img.alt) != "undefined"){ %> <img src="<%- img.url %>" alt="<%- img.alt %>"> <% } %></span>'+'<div class="result-info">'+'<div class="result-bookinfo">'+'<span class="result-header"><%= header %></span>'+"</div>"+"</div>"+"</div>");var c_common_result_1_1_1=_.template('<div class="result-data result-<%- itemType %>">'+'<span class="img-wrapper">  <% if(typeof(img) != "undefined" && typeof(img.url) != "undefined" && typeof(img.alt) != "undefined"){ %> <img src="<%- img.url %>" alt="<%- img.alt %>"> <% } %></span>'+'<div class="result-info">'+'<div class="result-bookinfo">'+'<span class="result-header"><%= header %> <% if(typeof(school) != "undefined" && typeof(school.schoolName) != "undefined"){ %><span class="light"> at <%= school.schoolName %></span> <% } %></span>'+"</div>"+"</div>"+"</div>");var c_common_result_last_link=_.template("<%= header %>");var c_common_result_none=_.template('<div class="result-data result-2-lines result-noresults">'+'<div class="result-info">'+'<div class="result-bookinfo">'+'<span class="result-header"><%= noresults %> <span class="chg-suggest-term"><%= query %></span></span>'+"</div>"+"</div>"+"</div>");C("addbook");C.addbook.bookView=C.View.extend({objName:"C.addbook.bookView",className:"book clearfix",tmpl:_.template('<div class="book-img-1">'+'<img class="book-cover" src="<%=img.url%>"/>'+"</div>"+'<div class="mini-biblio">'+'<p class="txt-body-bold book-title"><%=title%></p>'+'<p class="book-author"><%=author%></p>'+'<p>ISBN: <span class="txt-body"><%-isbn%></span>&nbsp;'+'ISBN13: <span class="txt-body"><%-ean%></span></p>'+"</div>"),initialize:function(){this.model.on("destroy",this.destroy,this)},render:function(){this.$el.append($(this.tmpl(this.model.toJSON())));return this;

},destroy:function(){this.remove()}});C.addbook.course=C.Model.extend({objName:"C.addbook.course"});C.addbook.courses=Backbone.Collection.extend({objName:"C.addbook.courses",model:C.addbook.course});C.addbook.courseView=C.View.extend({objName:"C.addbook.courseView",className:"courseRow clearfix",tmpl:_.template('<div class="selector">'+'<input type="radio" id="<%=schoolId%><%=subjectCode%><%=catalogNumber%>" name="header" <%if(checked){%>checked="checked"<%}%>/>'+'<label for="<%=schoolId%><%=subjectCode%><%=catalogNumber%>" class="form-radio">&nbsp;</label>'+"</div>"+'<div class="course">'+'<div class="dept-icon"><img src="/s/_global/images/dept-icons/0.png" alt=""></div>'+'<div class="course-title"><span class="txt-body-bold subject"><%=title%></span><br/><span class="subtitle"><%=subtitle%></span></div>'+"</div>"),events:{"click input":"onClickRadio"},initialize:function(){this.model.on("destroy",this.destroy,this)},render:function(){this.$el.append($(this.tmpl({schoolId:this.model.get("schoolId"),subjectCode:this.model.get("subjectCode"),catalogNumber:this.model.get("catalogNumber"),title:this.model.get("title"),subtitle:this.model.get("subtitle")||"",checked:false})));return this},onClickRadio:function(){this.model.trigger("select",this.model)},destroy:function(){this.remove()}});C.addbook.coursesView=C.View.extend({objName:"C.addbook.coursesView",className:"courses",tmpl:_.template('<h2 class="txt-hdr-sec">Which course is this book for?</h2>'+"<h3>(Get access to Q&A, Notes and more for your course)</h3>"+'<div class="courseRow courseInputRow">'+'<div class="selector">'+'<input type="radio" id="userCourse" name="header" checked="checked">'+'<label for="userCourse" class="form-radio">&nbsp;</label>'+"</div>"+'<input type="text" name="courseName" class="courseInput chg-form-lg" placeholder="Enter course name."/>'+"</div>"),initialize:function(){this.collection.on("add",this.onAdd,this)},render:function(){this.$el.append($(this.tmpl()));return this},setupAutoComplete:function(){new C.widget.autoComplete({el:this.$("input.courseInput"),type:"courses",callback:_.bind(this.onSelectCourse,this)})},onSelectCourse:function(e,$li){var course=$li.data("itemDetail");this.$(".courseInputRow").hide();this.collection.add({schoolId:course.attributes["data-schoolId"],subjectCode:course.attributes["data-subjectCode"],catalogNumber:course.attributes["data-catalogNumber"],title:course.title,subtitle:course.subtitle,checked:true})},onAdd:function(course){var courseView=new C.addbook.courseView({model:course});courseView.render().$el.insertBefore(this.$(".courseInputRow"))}});C.addbook.model=C.Model.extend({objName:"C.addbook.model",initialize:function(){this.courses=new C.addbook.courses;this.courses.on("select",this.onSelectCourse,this);this.courses.on("add",this.onAddCourse,this)},destroy:function(){this.trigger("destroy")},onSelectCourse:function(course){this.selectedCourse=course},onAddCourse:function(course){if(course.get("checked")){this.selectedCourse=course}},fetchCourse:function(){var url="/_ajax/book/course",data={year:this.get("year"),term:this.get("term"),ean:this.get("ean")};$.ajax({context:this,type:"post",dataType:"json",url:url,data:data,success:function(response){this.trigger("fetchCourse:success");this.courses.add(response.courses)}})},submit:function(){if(!this.selectedCourse){return false}var url="/_ajax/course/combined/ratingbookownership/add",data={year:this.get("year"),term:this.get("term"),ean:this.get("ean"),subject:this.selectedCourse.get("subjectCode"),code:this.selectedCourse.get("catalogNumber"),owned:true,token:C.global.csrfToken};$.ajax({context:this,type:"post",dataType:"json",url:url,data:data,success:function(response){this.trigger("submit:success")}})}});C.addbook.view=C.View.extend({objName:"C.addbook.view",tmpl:_.template('<div id="addbook-container" class="dialog-4">'+'<div class="dialog-hdr"><h2 class="dialog-title"><%- title%></h2><div class="dialog-close-wrapper"><button class="btn-secondary-sm chg-dialog-close"><span class="icn-cross">Close</span> </button></div></div>'+'<form class="find-books">'+'<div class="dialog-content">'+'<fieldset class="chg-util-autosuggest-form">'+'<input type="text" class="chg-form-sm has-default" placeholder="Enter ISBN, Title or Author\'s Name" name="search_by" autocomplete="off" />'+"</fieldset>"+"</div>"+'<div class="dialog-ftr">'+"</div>"+"</form>"+"</div>"),events:{"click .chg-dialog-close":"onClickCancel"},initialize:function(options){this.options=options;this.model.on("destroy",this.destroy,this);this.model.on("fetchCourse:success",this.onFetchCourseSuccess,this);this.model.on("submit:success",this.options.onSubmitSuccess||this.onSubmitSuccess,this);this.model.on("error",this.onError,this)},destroy:function(){this.remove();if(this.dialog){this.dialog.destroy()}},render:function(){this.$el.html(this.tmpl({btnTxt:this.options.btnTxt||"Add",title:this.options.title||"Add book"}));this.showDialog();return this},showDialog:function(){this.log("showDialog");if(this.dialog){this.dialog.destroy()}this.dialog=new C.widget.dialog({content:this.$el});if(this.autoComplete){this.autoComplete.destroy()}this.autoComplete=new C.widget.autoComplete({el:".chg-util-autosuggest-form input",type:this.options.type||"books",onTextboxBlur:_.bind(this.onTextboxBlur,this),callback:_.bind(this.options.autoCompleteCallback||this.onSelectBook,this),overrideSolutionsImage:true})},onTextboxBlur:function(e){},onSelectBook:function(e,$li){this.$(".chg-util-autosuggest-form").hide();var book=$li.data("itemDetail");this.model.set(book);var bookView=new C.addbook.bookView({model:this.model});this.$(".dialog-content").append(bookView.render().$el);if(!this.model.selectedCourse){this.model.fetchCourse()}},onClickCancel:function(e){e.preventDefault();if(this.autoComplete){this.autoComplete.destroy()}this.destroy()},onClickSubmit:function(e){e.preventDefault();this.model.submit()},onFetchCourseSuccess:function(){var coursesView=new C.addbook.coursesView({collection:this.model.courses});coursesView.render().$el.appendTo(this.$(".dialog-content"));coursesView.setupAutoComplete()},onSubmitSuccess:function(){this.destroy();this.reloadPage()},reloadPage:function(){window.location.reload()},onError:function(model,error){}});Eggshell.define("C.common.rating",{inputs:["set rating","set large version","enable interaction","set non-interactable star color"],outputs:["rated"]},Backbone.View.extend({initialize:function(){this.model=new Backbone.Model({stars:0});this.render();this.$el.addClass("interaction");Eggshell.find(this).on("enable interaction",this.enableInteraction).on("set large version",this.setLargeSize).on("set non-interactable star color",this.setColor).on("set rating",this.setRating)},enableInteraction:function(event,payload){if(payload){this.$el.addClass("interaction")}else{this.$el.removeClass("interaction")}},setLargeSize:function(){this.$(".star-rating-input").addClass("large")},setRating:function(event,payload){if(typeof payload!="number"||payload===null){throw"Invalid payload. Payload needs to be a number"}this.model.set("stars",Math.min(parseInt(payload),5));this.updateStarsDisplay(this.model.get("stars"))},setColor:function(event,payload){if(this.$el.hasClass("interaction")){throw"Cannot set interactable star color. Please disable interaction first."}if(payload!=="gray"&&payload!=="yellow"){throw"Invalid color. Only gray and yellow are allowed."}if(payload==="gray"){this.$el.addClass("gray")}else{this.$el.removeClass("gray")}},render:function(opts){this.$el.html(this.template());this.updateStarsDisplay(this.model.get("stars"))},template:_.template('<div class="rate-my-course-input-container">'+'<ul class="star-rating-input">'+'<li data-id="1"></li>'+'<li data-id="2"></li>'+'<li data-id="3"></li>'+'<li data-id="4"></li>'+'<li data-id="5"></li>'+"</ul>"+"</div>"),events:{"hover .interaction .star-rating-input li":"mouseOver","mouseout .interaction .star-rating-input":"mouseOut","click .interaction .star-rating-input li":"click"},mouseOver:function(e){var starValue=$(e.currentTarget).attr("data-id");this.updateStarsDisplay(starValue)},mouseOut:function(){this.updateStarsDisplay(this.model.get("stars"))},click:function(e){var starValue=$(e.currentTarget).attr("data-id");this.model.set("stars",parseInt(starValue));this.updateStarsDisplay(starValue);Eggshell.find(this).trigger("rated",starValue)},updateStarsDisplay:function(starValue){var starParent=$(this.el).find(".star-rating-input");var stars=$(starParent).find("li");$.each(stars,function(i,x){$(x).removeClass("active");if(i<=starValue-1){$(x).addClass("active")}})}}));Eggshell.define("C.common.advertisements",{inputs:["render","setup ads","clear adDivIds","setup custom targeting","display ads"],outputs:{"slot rendered":{payload:null},"has adBlock":{payload:null},"advertisement rendered":{}},singleton:true},function(){if(window.googletag&&window.googletag.hasOwnProperty("destroySlots")){window.googletag.destroySlots()}else{window.googletag=null}var provider="/7223/";var baseAdIdName="chg-bp-";var adsLinkImg="//pubads.g.doubleclick.net/gampad/ad?iu=";var isInitialized=false;var isInitializedRendered=false;var adElements={};var countElement=0;var numJsAds=0;var numRendered=0;var hasAdBlocker=false;var adBlockerInitialize=false;var AdBlockTest=false;var onLoadActions={};var adDivIds=[];var logData=[];var sessionLogger=Eggshell.create("C.common.log");var towerShowed=false;Eggshell.shell(this).on("render",function(event){this.initRender()}).on("destroy",function(event){this.destruct()});this.render=function(){adElements=$(".chg-display");if(adElements.length>0){if(isInitialized!==true){isInitialized=true;this.initialize();this._setListeners();this.setUserData()}Eggshell.shell(this).trigger("setup ads",{obj:adElements}).trigger("setup custom targeting").trigger("display ads")}if(isInitializedRendered===false&&hasAdBlocker===false){isInitializedRendered=true;Eggshell.find(this).trigger("advertisement rendered")}};this.initRender=function(){if(adBlockerInitialize===false&&hasAdBlocker===false&&AdBlockTest===false){if(this.detectFF42())this.detectIncognitoMode();this.checkForAdBlocker()}else if(adBlockerInitialize===true&&hasAdBlocker===false&&AdBlockTest===true){this.render()}else if(hasAdBlocker===true){}else{}};this._setListeners=function(){var that=this;Eggshell.shell(this).on("clear adDivIds",this.clearAdDivIds).on("setup ads",function(e,payload){that.setupAdSlots(payload.obj)}).on("setup custom targeting",this.setupCustomTargeting).on("display ads",this.displayAds)};this.clearAdDivIds=function(){adDivIds=[]};this.reset=function(){adElements={};adDivIds=[];logData=[]};this.initialize=function(){var that=this;if(!C.global.gptLoadsEarlier){C.utility.loadScript("//www.googletagservices.com/tag/js/gpt.js",$.proxy(function(){this.onScriptLoad()},this))}googletag=window.googletag||{};googletag.cmd=googletag.cmd||[];googletag.cmd.push(function(){googletag.pubads().enableSingleRequest();googletag.pubads().collapseEmptyDivs();googletag.enableServices();googletag.pubads().addEventListener("slotRenderEnded",$.proxy(that.slotRendered,that));if(C.global.adsDebugging){googletag.pubads().addEventListener("slotOnload",function(){console.timeEnd("from slot rendered to slot load")})}})};this.countElement=function(){return $(".chg-display").length};this.setUserData=function(){if(hasAdBlocker===false&&this.countElement()>0){var that=this;$.ajax({url:"/_ajax/adTargeting",type:"POST",context:this,dataType:"json",async:false,success:function(response,status){that.userData=$.parseJSON(response)}})}};this.getUserData=function(){return this.userData};this.setupAdSlots=function(element){this.reset();$.each(element,$.proxy(function(index,_this){this.setupElement(_this)},this))};this.setupElement=function(_this){countElement++;var $el=$(_this);if($el.attr("id")!==undefined){if(adDivIds.indexOf($el.attr("id"))==-1){adDivIds.push($el.attr("id"))}return}var adUnit=provider+$el.data("unit");var eleId=baseAdIdName+countElement;var sizes=$el.data("size").toLowerCase().split(","),slotSizes=[];sizes.forEach(function(size){var s=size.toLowerCase().split("x");var width=parseInt(s[0],10);var height=parseInt(s[1],10);slotSizes.push([width,height])});if(slotSizes.length==1){slotSizes=slotSizes[0]}googletag.cmd.push(function(){googletag.defineSlot(adUnit,slotSizes,eleId).addService(googletag.pubads()).set("container-id",eleId)});$el.attr("id",eleId);var nojs=$el.data("nojs");if(nojs!==undefined){this.addNonJSAd($el);return}adDivIds.push(eleId);numJsAds++;if($el.is("[data-autoresize]")){$el.addClass("autoresize").css({paddingBottom:Math.round(1e3*height/width)/10+"%"})}else if($el.is("[data-fullwidth]")){$el.addClass("fullwidth")}var onLoadAction=$el.data("onload");if(onLoadAction!==undefined){onLoadActions[eleId]=onLoadAction}};this.getLinkCustomTargeting=function(){var targets=this.getCustomTargeting();var allTarget=[];if(targets!=null&&targets!==undefined){$.each(targets,function(key,value){allTarget.push(key+"="+value)});return"&t="+encodeURIComponent(allTarget.join("&"))}return""};this.getCustomTargeting=function(){if(this.userData==null){this.setUserData()}var userData=this.getUserData()!=null?this.getUserData():{};return $.extend({},C.global.adTargeting,userData)};this.setupCustomTargeting=function(){var targeting=this.getCustomTargeting();if(targeting!=null){this.setupDFPTargeting(targeting)}};this.setupDFPTargeting=function(targets){if(targets!=null){$.each(targets,function(key,value){googletag.cmd.push(function(){googletag.pubads().setTargeting(key,value+"")})})}};this.slotRendered=function(event){var slotName=event.slot.getName();var eleId=event.slot.get("container-id");var hasAd=event.isEmpty===true?"no":"yes";if(C.global.adsDebugging){console.timeEnd("from render ads to slot render");console.time("from slot rendered to slot load")}numRendered++;this._queueAdLogData(slotName,"js",hasAd);if(event.isEmpty===false&&onLoadActions[eleId]!==undefined){}if(numJsAds===numRendered){this._logAds()}Eggshell.find(this).trigger("slot rendered",{id:eleId,name:slotName,nonempty:!event.isEmpty,event:event})};this.displayAds=function(){var that=this;$.each(adDivIds,function(k,eleId){that.displayAdsAction(eleId);googletag.cmd.push(function(){googletag.display(eleId)})})};this.executeOnLoadAction=function(name){switch(name){case"tower-slider":if(!towerShowed){C.utility.showTower();towerShowed=true}break;default:break}};this.displayAdsAction=function(eleId){if(onLoadActions[eleId]!==undefined){this.executeOnLoadAction(onLoadActions[eleId])}};this._queueAdLogData=function(slotName,adType,isEmpty){logData.push({ad_slot:slotName,ad_type:adType,ad_displayed:isEmpty})};this._logAds=function(){var data={dfp_ads:JSON.stringify(logData)};sessionLogger.trigger("session log",data)};this.onScriptLoad=function(){};this.checkForAdBlocker=function(){if(adBlockerInitialize===false){var gads=document.createElement("script");gads.async=true;gads.type="text/javascript";gads.src="/s/_common/advertisements/adsense.js";adBlockerInitialize=true;var node=document.getElementsByTagName("script")[0];node.parentNode.insertBefore(gads,node);var that=this;gads.onerror=function(){that._hasBlocker()};gads.onload=function(){};that.setAdBlockTest(true);that.render()}};this.setAdBlockTest=function(bool){AdBlockTest=bool};this.addNonJSAd=function(obj){var $obj=$(obj);$(obj).append(this._defaultAdTemplate({adImageSrc:this.getLinkAds()+this.getProvider()+$obj.data("unit"),size:$obj.data("size"),time:this.getUnixTimeStamp(),targeting:this.getLinkCustomTargeting()}));this._queueAdLogData(obj.data("unit"),"html","unknown")};this.getProvider=function(){return provider};this.getLinkAds=function(){var useSSL="https:"===document.location.protocol;return(useSSL?"https:":"http:")+adsLinkImg};this.getUnixTimeStamp=function(){return Math.round(+new Date/1e3)};this._defaultAdTemplate=function(data){return'<img src="'+data.adImageSrc+"&sz="+data.size+"&c="+data.time+""+data.targeting+'" />'};this._hasBlocker=function(){hasAdBlocker=true;var data={ad_blocker_detected:hasAdBlocker};sessionLogger.trigger("session log",data);Eggshell.find(this).trigger("has adBlock")};var is_private;this.detectIncognitoMode=function(){var db;var that=this;try{db=window.indexedDB.open("test")}catch(e){is_private=true}if(typeof is_private==="undefined"){this.retry(function isDone(){return db.readyState==="done"?true:false},function next(is_timeout){if(!is_timeout){is_private=db.result?false:true}})}this.retry(function isDone(){return typeof is_private!=="undefined"?true:false},function next(is_timeout){if(is_private){that._hasBlocker()}})};this.retry=function(isDone,next){var current_trial=0,max_retry=50,interval=10,is_timeout=false;var id=window.setInterval(function(){if(isDone()){window.clearInterval(id);next(is_timeout)}if(current_trial++>max_retry){window.clearInterval(id);is_timeout=true;next(is_timeout)}},interval)};this.detectFF42=function(){var checkVersion=42;if(navigator.userAgent.search("Firefox")>=0){var position=navigator.userAgent.search("Firefox")+8;var version=navigator.userAgent.substring(position);if(parseFloat(version)>=parseFloat(checkVersion)){return true}}return false};this.destruct=function(){if(window.googletag&&window.googletag.hasOwnProperty("destroySlots")){window.googletag.destroySlots()}if(towerShowed){C.utility.hideTower();towerShowed=false}onLoadActions={}}});Eggshell.define("C.common.bookcover.centered",{inputs:["set book image","set book link","set book alt","turn on shadow","turn off shadow","add class"],outputs:["ready","error","clicked"]},Backbone.View.extend({initialize:function(){console.log("C.common.bookcover.centered is deprecated, use C.common.bookcover instead");this.model=new Backbone.Model;this.enableShadow();Eggshell.find(this).on("set book image",this.setBookImage).on("set book link",this.setBookLink).on("turn on shadow",this.enableShadow).on("turn off shadow",this.disableShadow).on("set book alt",this.setBookAlt).trigger("ready")},enableShadow:function(){this.$el.addClass("shadow-enabled")},disableShadow:function(){this.$el.removeClass("shadow-enabled")},setBookAlt:function(event,payload){var img=this.$("img");$(img).attr("alt",payload)},setBookImage:function(event,payload){if(!payload&&typeof payload!=="string"){throw"Invalid book image url. Image url needs to be a non-empty string"}this.model.set("image",payload);this.render()},setBookLink:function(event,payload){if(!payload&&typeof payload!=="string"){throw"Invalid book link url. Link needs to be a non-empty string"}this.model.set("link",payload);this.render()},render:function(){this.$el.empty();var $parent=this.$el;if(this.model.get("image")){if(this.model.get("link")){$parent=$("<a></a>").attr("href",this.model.get("link")).appendTo(this.$el)}$parent.addClass("img-wrapper");var $img=$("<img/>").appendTo($parent);$img.error($.proxy(function(){this.$el.addClass("error");this.$("img").remove();this.Eggshell.trigger("error")},this));$img.attr("src",this.model.get("image"))}},events:{"click a":"bookOnClick"},bookOnClick:function(e){Eggshell.find(this).trigger("clicked")}}));Eggshell.define("C.common.bookcover.enhance",{inputs:[],outputs:["ready","error","clicked"],newNode:false},Backbone.View.extend({events:{"click a":"bookOnClick"},initialize:function(){},bookOnClick:function(event){this.Eggshell.trigger("clicked")}}));Eggshell.define("C.common.bookcover",{inputs:["show","hide","set book image","set book alt","set book link","set book cover size","set book cover type","set book data","get book data","turn on shadow","turn off shadow","add class"],outputs:["ready","error","clicked","returned book data"]},Backbone.View.extend({events:{"click a":"bookOnClick"},initialize:function(){this.model=new Backbone.Model;this.$el.addClass("centered shadow-enabled");if(typeof $.browser!=="undefined"&&$.browser&&$.browser.msie&&$.browser.version<=8){this.$el.addClass("ie-old")}Eggshell.find(this).on("set book cover type",this.setBookCoverType).on("set book cover size",this.setBookCoverSize).on("set book image",this.setBookImage).on("set book alt",this.setBookAlt).on("set book link",this.setBookLink).on("add class",this.setBookClassName).on("turn on shadow",this.enableShadow).on("turn off shadow",this.disableShadow).on("set book data",this.setData).on("get book data",this.getData).trigger("ready")},setData:function(event,payload){this.model.set("data",payload)},getData:function(){Eggshell.find(this).trigger("returned book data",this.model.get("data"))},render:function(){this.$el.removeClass("img-wrapper");this.$el.empty();var $parent=this.$el;if(this.model.get("image")){if(this.model.get("link")){$parent=$("<a></a>").attr("href",this.model.get("link")).appendTo(this.$el)}if(this.$el.hasClass("centered")){$parent.addClass("img-wrapper")}var $img=$("<img/>").appendTo($parent);$img.error($.proxy(function(){this.$el.addClass("error");this.$("img").remove();this.Eggshell.trigger("error")},this));$img.attr("src",this.model.get("image"))}},setBookCoverType:function(event,payload){if(!payload||typeof payload!=="string"){throw"Invalid book cover type. Type needs to be a string value."}this.$el.removeClass("flexible centered shadow-enabled img-wrapper");if(payload==="flexible"){this.$el.addClass("flexible")}else if(payload==="centered"){this.$el.addClass("centered shadow-enabled")}},setBookCoverSize:function(event,payload){if(!payload||typeof payload!=="string"){throw"Invalid book cover size. Size needs to be a string value."}this.$el.removeClass("large medium small");if(payload==="small"){this.$el.addClass("small")}else if(payload==="medium"){this.$el.addClass("medium")}else if(payload==="large"){this.$el.addClass("large")}},setBookImage:function(event,payload){if(!payload&&typeof payload!=="string"){throw"Invalid book image url. Url needs to be a string value."}this.model.set("image",payload);this.render()},setBookAlt:function(event,payload){if(!payload&&typeof payload!=="string"){throw"Invalid book alt. Alt needs to be a string value."}this.$("img").attr("alt",payload)},setBookLink:function(event,payload){if(!payload&&typeof payload!=="string"){throw"Invalid link. Link needs to be a string value."}this.model.set("link",payload);this.render()},setBookClassName:function(event,payload){if(!payload&&typeof payload!=="string"){throw"Invalid class name"}this.$("img").addClass(payload)},enableShadow:function(){this.$el.addClass("shadow-enabled")},disableShadow:function(){this.$el.removeClass("shadow-enabled")},bookOnClick:function(event){this.Eggshell.trigger("clicked")}}));Eggshell.defineInterface("C.common.dialog.interface",{inputs:["set id","set headline","set sub headline","set icon","set icon size","set content html","set content component","get content area","destroy content","set control","get control area","show","hide","show headline","hide headline","show sub headline","hide sub headline","show icon","hide icon","enable default control","show control","set primary button","set secondary button","set link","show primary button","hide primary button","disable primary button","enable primary button","show secondary button","hide secondary button","disable secondary button","enable secondary button","show link","hide link","hide control","enable screen blocker click","disable screen blocker click","disable default padding","hide close button","configure dialog","configure controls","set content","show loading","hide loading"],outputs:["content component created","content area","control component created","control area","shown","hidden","headline clicked","sub headline clicked","icon clicked","close button clicked","screen blocker clicked","primary button clicked","secondary button clicked","link clicked","content clicked"]});Eggshell.define("C.common.dialog",{"interface":"C.common.dialog.interface"},Backbone.View.extend({componentNS:null,controlNS:null,options:{icon:false,iconSize:false,headline:"",subHeadline:"",controls:{primaryText:"Ok",secondaryText:"Cancel",primaryCallback:$.noop,secondaryCallback:$.noop},screenBlockerClickEnabled:true,screenBlockerScrollEnabled:false,noPadding:false,hideClose:false,closeTitle:C.resource.fetch("C.Eggshell.dialog.close.title"),html:""},initialize:function(options){this.bindEvents();this.bindV2Interface();this.configureDialog(options);if(options&&options.control){this.configureControls(options.control)}if(options&&options.html){this.setContent(options.html)}this.render();Eggshell.find(this).on("destroy",this.destroy)},render:function(){this.renderDialog();this.$(".screenBlocker").css("z-index",C.utility.getMaxIndex());this.$(".dialog").css("z-index",C.utility.getMaxIndex()+1)},renderDialog:function(){var html=this.templates.dialog(this.options);this.$el.html(html);this.renderHeader();this.renderContent();this.renderControls()},renderHeader:function(){var html=this.templates.header(this.options);this.$(".header").first().html(html)},renderContent:function(){this.$(".content").first().show().removeClass("disabled").html(this.options.html);if(!this.options.html){this.$(".content").hide().addClass("disabled")}},renderControls:function(){if(this.controlNS){this.controlNS.destroy()}this.controlNS=Eggshell.create("C.Eggshell.dialog.control.standard",{el:$.extend({},this.$(".control"))}).trigger("set primary button",this.options.controls.primaryText).trigger("set secondary button",this.options.controls.secondaryText).on("primary button clicked",this.options.controls.primaryCallback,this).on("secondary button clicked",this.options.controls.secondaryCallback,this);if(!this.loading){this.loading=Eggshell.create("C.Eggshell.loading.inline",{el:$.extend({},this.$(".control"))})}this.loading.trigger("hide")},bindV2Interface:function(){Eggshell.find(this).on("configure dialog",function(e,payload){this.configureDialog(payload);this.render()},this).on("configure controls",function(e,payload){this.configureControls(payload);this.renderControls()},this).on("set content",function(e,payload){this.setContent(payload);this.renderContent()},this)},configureDialog:function(payload){var i;for(i in payload){if(payload.hasOwnProperty(i)&&i!=="controls"){this.options[i]=payload[i]}}},configureControls:function(payload){var i;for(i in payload){if(payload.hasOwnProperty(i)){this.options.controls[i]=payload[i]}}},setContent:function(payload){if(payload){this.options.html=payload}},destroy:function(){this.hide();this.destroyContent();this.destroyControl()},bindEvents:function(){Eggshell.find(this).on("set id",function(event,payload){this.$(".dialog").attr("id",payload)}).on("set headline",function(event,payload){if(typeof payload!=="string"){throw"Invalid headline"}this.configureDialog({headline:payload});this.renderHeader()}).on("set sub headline",function(event,payload){if(typeof payload!=="string"){throw"Invalid sub headline"}this.configureDialog({subHeadline:payload});this.renderHeader()}).on("set icon",function(event,payload){if(typeof payload!=="boolean"&&typeof payload!=="string"){throw"Invalid icon class name"}this.configureDialog({icon:payload});this.renderHeader()}).on("set icon size",function(event,payload){if(typeof payload!=="boolean"&&typeof payload!=="string"){throw"Invalid icon class name"}this.configureDialog({iconSize:payload});this.renderHeader()}).on("set content html",function(event,payload){if(typeof payload!=="string"){throw"Invalid content html"}this.destroyContent();this.setContent(payload);this.renderContent()}).on("disable screen blocker click",function(event,payload){this.configureDialog({screenBlockerClickEnabled:false})}).on("enable screen blocker click",function(event,payload){this.configureDialog({screenBlockerClickEnabled:true})}).on("enable screen blocker scroll",function(event,payload){this.configureDialog({screenBlockerScrollEnabled:true});this.$(".screenBlocker").addClass("scrollable");this.$(".content").css("max-height","none")}).on("disable screen blocker scroll",function(event,payload){this.configureDialog({screenBlockerScrollEnabled:false});this.$(".screenBlocker").removeClass("scrollable");this.resize()}).on("disable default padding",function(event,payload){this.configureDialog({noPadding:true});this.render()}).on("hide close button",function(event,payload){this.configureDialog({hideClose:true});this.renderHeader()}).on("enable default control",function(event,payload){if(!payload&&typeof payload!=="boolean"){throw"Invalid control enable flag"}this.$(".control").show().removeClass("disabled");this.destroyControl();this.controlNS=Eggshell.create("C.Eggshell.dialog.control.standard",{el:$.extend({},this.$(".control"))});Eggshell.connect(Eggshell.find(this).getNamespace(),"set primary button",this.controlNS);Eggshell.connect(Eggshell.find(this).getNamespace(),"set secondary button",this.controlNS);Eggshell.connect(Eggshell.find(this).getNamespace(),"set link",this.controlNS);Eggshell.connect(Eggshell.find(this).getNamespace(),"show primary button",this.controlNS);Eggshell.connect(Eggshell.find(this).getNamespace(),"hide primary button",this.controlNS);Eggshell.connect(Eggshell.find(this).getNamespace(),"disable primary button",this.controlNS);Eggshell.connect(Eggshell.find(this).getNamespace(),"enable primary button",this.controlNS);Eggshell.connect(Eggshell.find(this).getNamespace(),"show secondary button",this.controlNS);Eggshell.connect(Eggshell.find(this).getNamespace(),"hide secondary button",this.controlNS);Eggshell.connect(Eggshell.find(this).getNamespace(),"disable secondary button",this.controlNS);Eggshell.connect(Eggshell.find(this).getNamespace(),"enable secondary button",this.controlNS);Eggshell.connect(Eggshell.find(this).getNamespace(),"set text below button",this.controlNS);Eggshell.connect(Eggshell.find(this).getNamespace(),"show text below button",this.controlNS);Eggshell.connect(Eggshell.find(this).getNamespace(),"hide text below button",this.controlNS);Eggshell.connect(Eggshell.find(this).getNamespace(),"show link",this.controlNS);Eggshell.connect(Eggshell.find(this).getNamespace(),"hide link",this.controlNS);Eggshell.connect(Eggshell.find(this).getNamespace(),"enable screen blocker",this.controlNS);Eggshell.connect(this.controlNS,"primary button clicked",Eggshell.find(this).getNamespace());Eggshell.connect(this.controlNS,"secondary button clicked",Eggshell.find(this).getNamespace());Eggshell.connect(this.controlNS,"link clicked",Eggshell.find(this).getNamespace());this.controlNS.trigger("show")}).on("set content component",function(event,payload){if(!payload&&typeof payload!=="string"){throw"Invalid content component constructor"}this.destroyContent();this.componentNS=Eggshell.create(payload,$.extend({},this.$(".content")));Eggshell.find(this).trigger("content component created",this.componentNS)}).on("get content area",function(event,payload){Eggshell.find(this).trigger("content area",$.extend({},this.$(".content")))}).on("destroy content",function(event,payload){this.destroyContent()}).on("set control",function(event,payload){if(!payload||typeof payload!=="string"){throw"Invalid control constructor"}if(this.controlNS){this.controlNS.destroy()}this.controlNS=Eggshell.create(payload,{el:$.extend({},this.$(".control"))});this.$(".control").show().removeClass("disabled");Eggshell.find(this).trigger("control component created",this.controlNS)}).on("get control area",function(event,payload){Eggshell.find(this).trigger("control area",$.extend({},this.$(".control")))}).on("show",function(){this.show()}).on("hide",function(){this.hide()}).on("show headline",function(event,payload){this.$(".headline").show()}).on("hide headline",function(event,payload){this.$(".headline").hide()}).on("show sub headline",function(event,payload){this.$(".subHeadline").show()}).on("hide sub headline",function(event,payload){this.$(".subHeadline").hide()}).on("show icon",function(event,payload){this.$(".icon").show()}).on("hide icon",function(event,payload){this.$(".icon").hide()}).on("show control",function(event,payload){this.$(".control").show().removeClass("disabled")}).on("hide control",function(event,payload){this.$(".control").hide().addClass("disabled");

}).on("show loading",function(event,payload){this.controlNS.trigger("hide");this.loading.trigger("show")}).on("hide loading",function(event,payload){this.loading.trigger("hide");this.controlNS.trigger("show")}).on("scroll to top",function(){if(this.$(".content").offset().top<0){$(".screenBlocker",this.$el).animate({scrollTop:0},100)}});var resizeTrackerNS=Eggshell.create("C.Eggshell.window.resize.tracker");resizeTrackerNS.on("resize",$.proxy(this.resize,this))},destroyContent:function(){if(this.componentNS){this.componentNS.destroy()}this.$(".content").html("")},destroyControl:function(){if(this.controlNS){this.controlNS.destroy()}this.$(".control").html("")},show:function(){var lockScreen=navigator.userAgent.match(/iPad/i)?false:true;Eggshell.find("C.common.overlay.tooltip").trigger("acitvate tooltip");this.resizable=true;if(lockScreen){this.lockViewport()}this.$el.show();this.$(".dialog").show();this.resize();this.$(".dialog").hide();this.$(".dialog").fadeIn(300,$.proxy(function(){Eggshell.find(this).trigger("shown");this.resize()},this))},hide:function(){this.resizable=false;this.$(".dialog").fadeOut(300,$.proxy(function(){this.unlockViewport();this.$el.hide();Eggshell.find(this).trigger("hidden")},this));Eggshell.find("C.common.overlay.tooltip").trigger("deacitvate tooltip")},lockViewport:function(){$("html, body").css({overflow:"hidden"})},unlockViewport:function(){$("html, body").css({overflow:"visible"})},resize:function(){if(this.options.screenBlockerScrollEnabled){return}var $dialog=this.$(".dialog");var $control=this.$(".control");var height=$dialog.height();var viewportHeight=$(window).height();var contentHeight=viewportHeight-2*parseInt($dialog.css("top"),10);var headerHeight=this.$(".header").height();if(headerHeight){contentHeight-=headerHeight}if($control.is(":visible")){contentHeight-=$control.outerHeight(true)}var padding=$dialog.css("padding");if(!padding){padding=$dialog.css("padding-top")}if(padding){contentHeight-=2*parseInt(padding.replace("px"))}if(contentHeight<=0){contentHeight=0}this.$(".content").css("max-height",contentHeight)},events:{"click .close":"closeOnClick","click .screenBlocker":"screenBlockerOnClick","click .headline":"headlineOnClick","click .subHeadline":"subHeadlineOnClick","click .icon":"iconOnClick","click .content":"contentOnClick"},closeOnClick:function(e){e.preventDefault();e.stopPropagation();Eggshell.find(this).trigger("close button clicked");this.hide()},screenBlockerOnClick:function(e){if(this.options.screenBlockerClickEnabled===false){return}if($(e.target).hasClass("screenBlocker")){Eggshell.find(this).trigger("screen blocker clicked");this.hide()}},headlineOnClick:function(){Eggshell.find(this).trigger("headline clicked")},subHeadlineOnClick:function(){Eggshell.find(this).trigger("sub headline clicked")},iconOnClick:function(){Eggshell.find(this).trigger("icon clicked")},contentOnClick:function(e){Eggshell.find(this).trigger("content clicked",e)},templates:{dialog:_.template('<div class="screenBlocker">'+'<div class="dialog<% if (noPadding) { %> no-padding<% } %>">'+'<div class="header"></div>'+'<div class="content"></div>'+'<div class="control"></div>'+"</div>"+"</div>"),header:_.template('<div class="close<% if (hideClose) { %> hidden<% } %>" title="<%- closeTitle %>"></div>'+'<div class="icon<% if (icon) { %> <%= icon %><% } else { %> hidden<% } %><% if (iconSize) { %><%= iconSize %><% } %>"></div>'+'<h3 class="headline<% if (!headline) { %> hidden<% } %>"><%= headline %></h3>'+'<p class="subHeadline<% if (!subHeadline) { %> hidden<% } %>"><%= subHeadline %></p>')}}));C.resource.add("C.common.dialog.close.title","Close");(function(){var Utils={};Utils.escapeCss=function(name){name=name.replace(/[!\"#$%&'\(\)\*\+,\.\/:;<=>\?\@\[\\\]\^`\{\|\}~]/g,"-");return name};Utils.escapeHtml=function(s){var entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return String(s).replace(/[&<>"']/g,function(s){return entityMap[s]})};Utils.hasClass=function(element,className){return className&&new RegExp("\\b"+className+"\\b").test(element.className)};Utils.addClass=function(element,className){var classesArray=className.split(/\s+/),i;for(i=0;i<classesArray.length;i++){if(!Utils.hasClass(element,classesArray[i])){element.className+=(element.className?" ":"")+classesArray[i]}}};Utils.removeClass=function(element,className){var classesArray=className.split(/\s+/),classes=element.className.split(/\s+/);for(var i=0;i<classesArray.length;i++){var index=classes.indexOf(classesArray[i]);if(index>-1){classes.splice(index,1)}}element.className=classes.join(" ")};Utils.getElement=function(el){var element=null;if(typeof el=="string"){element=document.getElementById(el)}else if(typeof el==="object"){element=el[0]||el}return element};Utils.getClassElement=function(el){var element=null;element=document.getElementsByClassName(el);return element};Utils.removeElement=function(element){if(element&&element.parentNode)element.parentNode.removeChild(element)};Utils.scrollTop=function(){var body=document.body,docEl=document.documentElement;return window.pageYOffset||docEl.scrollTop||body.scrollTop};Utils.scrollLeft=function(){var body=document.body,docEl=document.documentElement;return window.pageXOffset||docEl.scrollLeft||body.scrollLeft};var supportsBoundingClientRect="getBoundingClientRect"in document.documentElement;Utils.getOffset=supportsBoundingClientRect?function(element,noscroll){var box=element.getBoundingClientRect(),body=document.body,docEl=document.documentElement,scrollTop=noscroll?0:Utils.scrollTop(),scrollLeft=noscroll?0:Utils.scrollLeft(),clientTop=docEl.clientTop||body.clientTop||0,clientLeft=docEl.clientLeft||body.clientLeft||0;return{top:Math.round(box.top+scrollTop-clientTop),left:Math.round(box.left+scrollLeft-clientLeft)}}:function(element,noscroll){var top=0,left=0;while(element){top+=parseFloat(element.offsetTop);left+=parseFloat(element.offsetLeft);element=element.offsetParent}if(noscroll){top-=Utils.scrollTop();left-=Utils.scrollLeft()}return{top:top,left:left}};Utils.getWidth=supportsBoundingClientRect?function(element){var box=element.getBoundingClientRect();return box.width}:function(element){return element.offsetWidth};Utils.getHeight=supportsBoundingClientRect?function(element){var box=element.getBoundingClientRect();return box.height}:function(element){return element.offsetHeight};Utils.createQueryString=function(o){var q="";if(typeof o=="string"){q=o}else if(o){var chunks=[];for(key in o)if(o.hasOwnProperty(key)){chunks.push(encodeURIComponent(key)+"="+encodeURIComponent(o[key]))}q=chunks.join("&")}return q};Utils.ajax=function(opts){var xhr=new XMLHttpRequest;var url=opts.url,method=opts.method&&opts.method.toUpperCase()||"GET",dataSend="",async=typeof opts.async!=="undefined"?!!opts.async:true;if(method=="GET"){var qs=Utils.createQueryString(opts.data);if(qs){url+=url.indexOf("?")===-1?"?":"";url+=url.substr(-1)!=="?"?"&":"";url+=qs}}xhr.onreadystatechange=function(){if(xhr.readyState!=XMLHttpRequest.DONE)return;if(xhr.status==200){var responseData=xhr.responseText;try{responseData=JSON.parse(responseData)}catch(ex){}opts.success&&opts.success.call(opts.context||null,responseData,xhr)}else{opts.error&&opts.error.call(opts.context||null,xhr)}};xhr.open(method,url,async);if(method=="POST"){xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded");dataSend=Utils.createQueryString(opts.data)}xhr.send(dataSend);return xhr};Utils.isMobileDevice=function(){var agent=navigator.userAgent.toLowerCase();return agent.indexOf("android")!==-1&&agent.indexOf("mobile")!==-1||/webos|iphone|ipod|blackberry|iemobile|windows phone|windows ce|opera mini/i.test(agent)};Utils.isMobileExperience=function(){return Math.max(document.documentElement.clientWidth,window.innerWidth||0)<768};Utils.isMobile=function(){return this.isMobileDevice()&&this.isMobileExperience()};var PROMO=function(Eggshell){if(!Eggshell||this.initialized){return}this.initialized=true;var Constructor=function(options){this.el=options.el?options.el[0]||options.el:null;if(!this.el){this.el=document.createElement("div");this.el.setAttribute("id",Utils.escapeCss(Eggshell.find(this).getNamespace()));this.el.setAttribute("class",Utils.escapeCss(Eggshell.find(this).getConstructorNamespace()))}this.bound=function(fn){if(!this.bound[fn]){if(this[fn]){this.bound[fn]=this[fn].bind(this)}else{return}}return this.bound[fn]};if(this.bind){for(var i=0,fn;fn=this.bind[i];i++){this.bound(fn)}}Eggshell.find(this).on("initialize",this.initialize)};Eggshell.define("C.common.crosspromo",{inputs:{render:{payload:"object"}},outputs:{},strict:false},function(){var Promo=function(){Constructor.apply(this,arguments)};Promo.prototype={initialize:function(){Eggshell.find(this).on("render",this.render).on("destroy",this.destroy)},render:function(ev,payload){if(this.interrupt){this.interrupt.trigger("destroy")}this.interrupt=Eggshell.create(payload.type,{el:this.el}).trigger("render",payload)},destroy:function(){if(this.interrupt){this.interrupt.trigger("destroy")}}};return Promo}());Eggshell.define("C.common.crosspromo.modal",{inputs:{render:{payload:{overlay:"object",tooltip:"object"}},hide:{payload:null}},outputs:{"action clicked":{payload:null},"cancel clicked":{payload:null},"outside clicked":{payload:null}},singleton:true,immuneToDestroyAll:true},function(){var Modal=function(){Constructor.apply(this,arguments)};Modal.prototype={initialize:function(){Eggshell.find(this).on("destroy",this.destroy).on("render",this.render).on("hide",this.hide);this.overlay=Eggshell.create("C.common.crosspromo.overlay");this.tooltip=Eggshell.create("C.common.crosspromo.tooltip")},render:function(ev,payload){this.overlay.trigger("render",payload.overlay);this.tooltip.trigger("render",payload.tooltip);this.doConnects()},doConnects:function(){this.overlay.on("clicked",this.overlayClicked,this);this.tooltip.on("action clicked",this.actionClicked,this);this.tooltip.on("cancel clicked",this.cancelClicked,this)},doDisconnects:function(){this.overlay.off("clicked",this.overlayClicked,this);this.tooltip.off("action clicked",this.actionClicked,this);this.tooltip.off("cancel clicked",this.cancelClicked,this)},overlayClicked:function(){this.hide();Eggshell.find(this).trigger("outside clicked")},actionClicked:function(){this.hide();Eggshell.find(this).trigger("action clicked")},cancelClicked:function(){this.hide();Eggshell.find(this).trigger("cancel clicked")},hide:function(){this.overlay.trigger("hide");this.tooltip.trigger("hide");this.doDisconnects()},destroy:function(){this.hide()}};return Modal}());Eggshell.define("C.common.crosspromo.overlay",{inputs:{render:{payload:{opacity:"float",zIndex:"integer",gap:{el:"HTMLElement",top:"number",left:"number",width:"number",height:"number"},parentEl:"HTMLElement",blockScroll:"bool"}},hide:{payload:null}},outputs:{clicked:{payload:null}},singleton:true,immuneToDestroyAll:true},function(){var Overlay=function(){Constructor.apply(this,arguments)};Overlay.prototype={bind:["onClick","locateGapOverTarget"],zIndexDefault:1500,gapShadowWidth:10,template:'<div class="content">'+'<div class="gap"></div>'+"</div>",initialize:function(){this.bodyOverflow=null;this.gapTarget=null;this.gapElement=null;Eggshell.find(this).on("destroy",this.destroy).on("render",this.render).on("hide",this.hide)},render:function(ev,payload){this.needScrollBlock=payload.blockScroll!==undefined?!!payload.blockScroll:true;this.blockScroll();this.el.innerHTML=this.template;this.el.style.zIndex=payload.zIndex!==undefined?payload.zIndex:this.zIndexDefault;if(payload.opacity!==undefined){this.el.getElementsByClassName("content")[0].style.opacity=payload.opacity}if(payload.gap){this.setupGap(payload.gap)}else{this.setupNoGap()}(Utils.getElement(payload.parentEl)||document.body).appendChild(this.el);this.el.addEventListener("click",this.bound.onClick)},setupNoGap:function(){Utils.removeElement(this.gapElement);this.gapElement=null},setupGap:function(opts){this.gapElement=this.el.getElementsByClassName("gap")[0];this.gapElement.style.width=(parseFloat(opts.width)||0+2*this.gapShadowWidth)+"px";this.gapElement.style.height=(parseFloat(opts.height)||0+2*this.gapShadowWidth)+"px";if(opts.el){this.gapTarget=Utils.getElement(opts.el);if(this.gapTarget){this.addWindowEvents();this.locateGapOverTarget()}else{this.setupNoGap()}}else{this.setGapPos(parseFloat(opts.left),parseFloat(opts.top))}},locateGapOverTarget:function(){var offset=Utils.getOffset(this.gapTarget,true),x=offset.left,y=offset.top;x+=Utils.getWidth(this.gapTarget)/2;y+=Utils.getHeight(this.gapTarget)/2;this.setGapPos(x,y)},setGapPos:function(x,y){this.gapElement.style.left=x+"px";this.gapElement.style.top=y+"px"},addWindowEvents:function(){window.addEventListener("resize",this.bound.locateGapOverTarget);window.addEventListener("scroll",this.bound.locateGapOverTarget)},removeWindowEvents:function(){window.removeEventListener("resize",this.bound.locateGapOverTarget);window.removeEventListener("scroll",this.bound.locateGapOverTarget)},hide:function(){this.removeWindowEvents();this.unblockScroll();Utils.removeElement(this.el)},blockScroll:function(){if(this.needScrollBlock&&this.bodyOverflow===null){this.bodyOverflow=document.body.style.overflow;document.body.style.overflow="hidden"}},unblockScroll:function(){if(this.needScrollBlock&&null!==this.bodyOverflow){document.body.style.overflow=this.bodyOverflow||"visible";this.bodyOverflow=null}},onClick:function(){Eggshell.find(this).trigger("clicked")},destroy:function(){this.hide()}};return Overlay}());Eggshell.define("C.common.crosspromo.fullPageInterrupt",{inputs:{render:{payload:{statusMessage:"string",icon:"string",bodyBg:"string",bodyPlain:"bool",title:"string",subTitle:"string",body:"string",image:"string",action:"string",actionText:"string",actionType:"string",legaleseText:"string",cancelText:"string",parentEl:"string",bodyImg:"string",titleInverse:"bool",bodyInverse:"bool",actionColor:"bool",inline:"bool"}}},outputs:{"action clicked":{payload:null},"cancel clicked":{payload:null}},singleton:true,immuneToDestroyAll:true},function(){var Interrupt=function(){Constructor.apply(this,arguments)};Interrupt.prototype={bind:["onOK","onCancel"],classnames:"",template:'<div class="fullPage">'+'<div class="tempHeader">'+'<div class="chg-hdr-content-temp">'+'<a class="chg-logo-temp" href="/">Chegg</a>'+"</div>"+"</div>"+'<div class="fullContent">'+'<div class="statusOverall">'+'<div class="icon"><img src=""></div>'+'<div class="status"> </div>'+"</div>"+'<div class = "promo">'+'<div class="imageContainer">'+'<div class="image"><img src=""></div>'+"</div>"+'<div class="textPassage">'+'<div class="title"></div>'+'<div class="sub-title"></div>'+'<div class="content"></div>'+'<div class="buttons">'+'<div class="cancel"><a href="#">No, thanks</a></div>'+'<div class="CTA">'+'<div class="action"><button>Show me</button></div>'+'<div class="sub-text"></div>'+"</div>"+"</div>"+"</div>"+"</div>"+"</div>"+"</div>",templateWeb:'<div class="fullPage">'+'<div class="tempHeader">'+'<div class="chg-hdr-content-temp">'+'<a class="chg-logo-temp" href="/">Chegg</a>'+"</div>"+"</div>"+'<div class="fullContent">'+'<div class="statusOverall">'+'<div class="icon"><img src=""></div>'+'<div class="status"> </div>'+"</div>"+'<div class="promo">'+'<div class="title"></div>'+'<div class="image"><img src=""></div>'+'<div class="sub-title"></div>'+'<div class="content"></div>'+'<div class="action"><button>Show me</button></div>'+'<div class="sub-text"></div>'+'<div class="cancel"><a href="#">No, thanks</a></div>'+"</div>"+"</div>"+"</div>",initialize:function(){Eggshell.find(this).on("render",this.render).on("destroy",this.destroy).on("hide",this.hide)},render:function(ev,payload){var isMobile=payload.mobile!==undefined?!!payload.mobile:Utils.isMobile();if(isMobile){this.el.innerHTML=this.templateWeb;this.classnames+="mobile"}else{this.el.innerHTML=this.template}if(payload.inline){this.classnames+="inline"}if(this.classnames){Utils.addClass(this.el,this.classnames)}this.el.style.zIndex=1501;if(payload.bodyBg||payload.bodyImg){var test=this.el.getElementsByClassName("promo")[0];if(payload.bodyImg){test.style.backgroundImage="url('"+payload.bodyImg+"')";test.style.backgroundRepeat="no-repeat"}else{test.style.backgroundColor=payload.bodyBg}this.el.getElementsByClassName("promo")[0]=test}if(payload.statusMessage){this.el.getElementsByClassName("status")[0].innerHTML=Utils.escapeHtml(payload.statusMessage)}if(payload.icon){if(payload.icon=="check"){this.el.getElementsByClassName("icon")[0].getElementsByTagName("img")[0].src="https://c.cheggcdn.com/assets/icons/success-large.png"}else{this.el.getElementsByClassName("icon")[0].getElementsByTagName("img")[0].src="https://c.cheggcdn.com/assets/icons/info-large.png"}}if(payload.statusMessage||payload.icon){this.el.getElementsByClassName("statusOverall")[0].className="statusOverallFilled";this.el.getElementsByClassName("status")[0].className="statusFilled";this.el.getElementsByClassName("icon")[0].className="iconFilled"}var title=this.el.getElementsByClassName("title")[0];title.innerHTML=Utils.escapeHtml(payload.title);var subTitle=this.el.getElementsByClassName("sub-title")[0];subTitle.innerHTML=Utils.escapeHtml(payload.subTitle);var content=this.el.getElementsByClassName("content")[0];var bodyText=payload.body||"";if(payload.bodyPlain){bodyText=Utils.escapeHtml(bodyText)}content.innerHTML=bodyText;this.el.getElementsByClassName("image")[0].getElementsByTagName("img")[0].src=payload.image;this.actionURL=payload.action;this.actionType=payload.actionType;var button=this.el.getElementsByClassName("action")[0].getElementsByTagName("button")[0];if(payload.actionText){button.innerHTML=Utils.escapeHtml(payload.actionText)}button.addEventListener("click",this.bound.onOK);var cancel=this.el.getElementsByClassName("cancel")[0].getElementsByTagName("a")[0];if(payload.cancelText){cancel.innerHTML=Utils.escapeHtml(payload.cancelText)}cancel.addEventListener("click",this.bound.onCancel);var subText=this.el.getElementsByClassName("sub-text")[0];subText.innerHTML=Utils.escapeHtml(payload.legaleseText);if(payload.titleInverse){Utils.addClass(title,"inverse");Utils.addClass(subTitle,"inverse");Utils.addClass(subText,"inverse")}if(payload.bodyInverse){Utils.addClass(content,"inverse")}if(!payload.actionColor){Utils.addClass(cancel,"inverse");Utils.addClass(button,"inverseButton")}(Utils.getElement(payload.parentEl)||document.body).appendChild(this.el)},onOK:function(e){if(this.actionURL){var type=typeof this.actionType=="string"&&this.actionType||"";switch(type.toLowerCase()){case"ajax":Utils.ajax({url:this.actionURL});break;default:window.location=this.actionURL}}Eggshell.find(this).trigger("action clicked")},onCancel:function(e){e.preventDefault();this.hide();Eggshell.find(this).trigger("cancel clicked")},hide:function(){if(this.classnames){Utils.removeClass(this.el,this.classnames);this.classnames=""}Utils.removeElement(this.el)},destroy:function(){this.hide()}};return Interrupt}());Eggshell.define("C.common.crosspromo.tooltip",{inputs:{render:{payload:{title:"string",subTitle:"string",action:"string",image:"string",actionText:"string",actionType:"string",cancelText:"string",zIndex:"integer",position:{top:"number",left:"number"},caret:"string",parentEl:"HTMLElement"}},hide:{payload:null}},outputs:{"action clicked":{payload:null},"cancel clicked":{payload:null}},singleton:true,immuneToDestroyAll:true},function(){var Tooltip=function(){Constructor.apply(this,arguments)};Tooltip.prototype={bind:["onOK","onCancel"],zIndexDefault:1501,template:'<div class="content">'+'<div class="title"></div>'+'<div class="sub-title"></div>'+'<div class="image"><img src=""></div>'+'<div class="action"><button>Show me</button></div>'+'<div class="cancel"><a href="#">No, thanks</a></div>'+'<div class="caret"></div>'+"</div>",initialize:function(){Eggshell.find(this).on("destroy",this.destroy).on("render",this.render).on("hide",this.hide)},render:function(ev,payload){this.el.innerHTML=this.template;this.el.style.zIndex=payload.zIndex!==undefined?payload.zIndex:this.zIndexDefault;var content=this.el.getElementsByClassName("content")[0];if(payload.position){content.style.left=(parseFloat(payload.position.left)||0)+"px";content.style.top=(parseFloat(payload.position.top)||0)+"px"}else{Utils.addClass(content,"center")}if(payload.caret){Utils.addClass(content,"caret-"+payload.caret)}this.el.getElementsByClassName("title")[0].innerHTML=Utils.escapeHtml(payload.title||"");this.el.getElementsByClassName("sub-title")[0].innerHTML=Utils.escapeHtml(payload.subTitle||"");if(payload.image){this.el.getElementsByClassName("image")[0].getElementsByTagName("img")[0].src=payload.image.replace(/^https?:/i,"")}this.actionURL=payload.action;this.actionType=payload.actionType;var button=this.el.getElementsByClassName("action")[0].getElementsByTagName("button")[0];if(payload.actionText){button.innerHTML=Utils.escapeHtml(payload.actionText)}button.addEventListener("click",this.bound.onOK);var cancel=this.el.getElementsByClassName("cancel")[0].getElementsByTagName("a")[0];if(payload.cancelText){cancel.innerHTML=Utils.escapeHtml(payload.cancelText)}cancel.addEventListener("click",this.bound.onCancel);(Utils.getElement(payload.parentEl)||document.body).appendChild(this.el)},hide:function(){Utils.removeElement(this.el)},onOK:function(e){if(this.actionURL){var type=typeof this.actionType=="string"&&this.actionType||"";switch(type.toLowerCase()){case"ajax":Utils.ajax({url:this.actionURL});break;default:window.location=this.actionURL}}Eggshell.find(this).trigger("action clicked")},onCancel:function(e){e.preventDefault();Eggshell.find(this).trigger("cancel clicked")},destroy:function(){this.hide()}};return Tooltip}());Eggshell.define("C.common.crosspromo.popup",{inputs:{render:{payload:{title:"string",subTitle:"string",body:"string",action:"string",image:"string",titleInverse:"bool",titleBg:"string",subTitleInverse:"bool",bodyPlain:"bool",bodyInverse:"bool",bodyBg:"string",bodyImg:"string",actionText:"string",actionType:"string",actionColor:"string",cancelText:"string",cancelColor:"string",legaleseText:"string",zIndex:"integer",inline:"bool",customClassname:"string",parentEl:"HTMLElement",overlay:"object"}},hide:{payload:null}},outputs:{"action clicked":{payload:null},"cancel clicked":{payload:null},"close clicked":{payload:null},"overlay clicked":{payload:null}},singleton:true,immuneToDestroyAll:true},function(){var Popup=function(){Constructor.apply(this,arguments)};Popup.prototype={zIndexDefault:1501,classnames:"",template:'<div class="content">'+'<div class="body">'+'<div class="title"></div>'+'<div class="sub-title"></div>'+'<div class="image"><img src=""></div>'+'<div class="text"></div>'+"</div>"+'<div class="footer">'+'<div class="cancel">'+"<span>Cancel</span>"+"</div>"+'<div class="button">'+"<button>Continue</button>"+'<div class="legalese"></div>'+"</div>"+"</div>"+'<div class="close"></div>'+"</div>",initialize:function(){Eggshell.find(this).on("destroy",this.destroy).on("render",this.render).on("hide",this.hide)},render:function(ev,payload){var mobile=payload.mobile!==undefined?!!payload.mobile:Utils.isMobile();if(typeof payload.overlay=="undefined"){payload.overlay={}}if(payload.inline){payload.overlay=false}if(payload.overlay){this.overlay=Eggshell.create("C.common.crosspromo.overlay").trigger("render",typeof payload.overlay=="object"?payload.overlay:{});this.overlayAutohide=payload.overlay.autoHide===undefined||!!payload.overlay.autoHide}if(mobile){this.classnames+=" mobile"}if(payload.inline){this.classnames+=" inline"}if(payload.customClassname){this.classnames+=" "+payload.customClassname}this.classnames&&Utils.addClass(this.el,this.classnames);this.el.innerHTML=this.template;this.el.style.zIndex=payload.zIndex!==undefined?payload.zIndex:payload.inline?"auto":this.zIndexDefault;var title=this.el.getElementsByClassName("title")[0];title.innerHTML=payload.title;payload.titleInverse&&Utils.addClass(title,"inverse");if(payload.titleBg){title.style.background=payload.titleBg;Utils.addClass(title,"bg")}var subTitle=this.el.getElementsByClassName("sub-title")[0];subTitle.innerHTML=payload.subTitle;payload.subTitleInverse&&Utils.addClass(subTitle,"inverse");var text=this.el.getElementsByClassName("text")[0];var bodyText=payload.body||"";if(payload.bodyPlain){bodyText=Utils.escapeHtml(bodyText)}text.innerHTML=bodyText;payload.bodyInverse&&Utils.addClass(text,"inverse");var body=this.el.getElementsByClassName("body")[0];if(payload.bodyImg){body.style.backgroundImage="url("+payload.bodyImg.replace(/^https?:/i,"")+")"}else if(payload.bodyBg){body.style.background=payload.bodyBg}var img=this.el.getElementsByClassName("image")[0].getElementsByTagName("img")[0];if(payload.image){img.src=payload.image.replace(/^https?:/i,"")}else{Utils.removeElement(img)}this.actionURL=payload.action;this.actionType=payload.actionType;var button=this.el.getElementsByClassName("button")[0].getElementsByTagName("button")[0];payload.actionText&&(button.innerHTML=Utils.escapeHtml(payload.actionText));payload.actionColor&&(button.style.backgroundColor=payload.actionColor);button.addEventListener("click",this.bound("onOK"));var cancel=this.el.getElementsByClassName("cancel")[0].getElementsByTagName("span")[0];payload.cancelText&&(cancel.innerHTML=Utils.escapeHtml(payload.cancelText));payload.cancelColor&&(cancel.style.color=payload.cancelColor);cancel.addEventListener("click",this.bound("onCancel"));if(payload.legaleseText){var legalese=this.el.getElementsByClassName("legalese")[0];legalese.innerHTML=Utils.escapeHtml(payload.legaleseText)}this.el.getElementsByClassName("close")[0].addEventListener("click",this.bound("onClose"));(Utils.getElement(payload.parentEl)||document.body).appendChild(this.el);this.doConnects()},doConnects:function(){if(this.overlay){this.overlay.on("clicked",this.overlayClicked,this)}},doDisconnects:function(){if(this.overlay){this.overlay.off("clicked",this.overlayClicked,this);this.overlay=null}},overlayClicked:function(){if(this.overlayAutohide){this.hide()}Eggshell.find(this).trigger("overlay clicked")},hide:function(){this.classnames&&Utils.removeClass(this.el,this.classnames);this.classnames="";Utils.removeElement(this.el);if(this.overlay){this.overlay.trigger("hide")}this.doDisconnects()},onOK:function(e){if(this.actionURL){var type=typeof this.actionType=="string"&&this.actionType||"";switch(type.toLowerCase()){case"ajax":Utils.ajax({url:this.actionURL});break;default:window.location=this.actionURL}}Eggshell.find(this).trigger("action clicked")},onCancel:function(e){this.hide();Eggshell.find(this).trigger("cancel clicked");e.preventDefault();e.stopPropagation()},onClose:function(e){this.hide();Eggshell.find(this).trigger("close clicked")},destroy:function(){this.hide()}};return Popup}())};PROMO(window.Eggshell);window.requirejs&&window.define&&define(function(){return PROMO})})();$(function(){var gaClient=Eggshell.create("C.report.GA");var GASendClick=function(page,section,link,event){gaClient.trigger("report custom event",{page:page,section:section,link:link});if(event){var url=$(event.currentTarget).attr("href");if(url){event.stopImmediatePropagation();Eggshell.find("C.global.header.rightsection.usermenu").trigger("hide menu");Eggshell.find("C.global.header.searchbox").trigger("collapse search box")}if(url&&(url.indexOf("mailto:")===0||url.indexOf("//")===0||url.indexOf("#")===0||url.indexOf("/#")!==-1)){if(url.indexOf("#")===0&&$(url).length>0){var offset=$(url).offset().top,jumpto=offset-60;window.location.replace(url);window.scrollTo(0,jumpto);event.preventDefault()}return}else if(url&&!event.ctrlKey&&!event.metaKey){event.preventDefault();setTimeout(function($target,url){return function(){if($(event.target).hasClass("chg-global-nav-home")||$(event.target).hasClass("chg-global-nav-list-section-home")){C.utility.openGlobalNav(animate=true)}else if($(event.target).hasClass("chg-logo")){if($(event.target).next()&&$(event.target).next().hasClass("chg-menu")){C.utility.openGlobalNav(animate=true)}}else{C.utility.closeGlobalNav(animate=true)}if($target.attr("data-noajax")!=null){if($target.attr("data-noredirect")!=null){return}self.location=url}else{C.utility.navigate(url)}}}($(event.currentTarget),url),200)}}};$(".chg-global-nav .track-nav-profile").on("click",function(e){GASendClick("SIHP","Menu","Profile",e)});$(".chg-global-nav .track-nav-courses").on("click",function(e){GASendClick("SIHP","Menu","Courses",e)});$(".chg-global-nav .track-nav-qna").on("click",function(e){GASendClick("SIHP","Menu","Q&A",e)});$(".chg-global-nav .track-nav-solutions").on("click",function(e){GASendClick("SIHP","Menu","Solutions",e)});$(".chg-global-nav .track-nav-books").on("click",function(e){GASendClick("SIHP","Menu","Books",e)});$(".chg-global-nav .track-nav-scholarships").on("click",function(e){GASendClick("SIHP","Menu","Scholarships",e)});$(".chg-global-nav .track-nav-internship").on("click",function(e){GASendClick("SIHP","Menu","Internships",e)});$(".chg-global-nav .track-career-center").on("click",function(e){GASendClick("SIHP","Menu","Career Center",e)});$(".chg-global-nav .track-nav-freshmen").on("click",function(e){GASendClick("SIHP","Menu","Freshmen",e)});$(".chg-global-nav .track-nav-live-tutors").on("click",function(e){GASendClick("SIHP","Menu","Live Tutors",e)});$(".chg-global-nav .track-nav-admission").on("click",function(e){GASendClick("SIHP","Menu","Admissions",e)});$(".chg-global-nav .track-nav-deal-center").on("click",function(e){GASendClick("SIHP","Menu","Deal Center",e)});$(".chg-global-nav .track-nav-online-courses").on("click",function(e){GASendClick("SIHP","Menu","Online Courses",e)});$(".chg-global-nav .track-nav-home").on("click",function(e){GASendClick("SIHP","Menu","Home",e)});$(".chg-global-nav .track-nav-home-icon").on("click",function(e){GASendClick("SIHP","Menu","Home Icon",e)});C.dom.$content.observe("click",".apple-store-btn",function(e){GASendClick("SIHP","App Promo","iOS",e)},this);C.dom.$content.observe("click",".google-play-btn",function(e){GASendClick("SIHP","App Promo","Android",e)},this);C.dom.$content.observe("click",".recent-books .sellbook",function(e){GASendClick("SIHP","Books & Solutions","Buyback",e)},this);C.dom.$content.observe("click",".recent-books li.track-instant",function(e){GASendClick("SIHP","Books & Solutions","Instant Access",e)},this);C.dom.$content.observe("click",".recent-books li.track-ebook",function(e){GASendClick("SIHP","Books & Solutions","eTextbook",e)},this);C.dom.$content.observe("click","li.solution",function(e){GASendClick("SIHP","Books & Solutions","TBS",e)},this);C.dom.$content.observe("click","li.potentialSolution",function(e){GASendClick("SIHP","Books & Solutions","Potential TBS",e)},this);C.dom.$content.observe("click","li.track-book",function(e){GASendClick("SIHP","Books & Solutions","Physical Book",e)},this);C.dom.$content.observe("click","a.track-see-all-books",function(e){GASendClick("SIHP","Books & Solutions","See All Books",e)},this);C.dom.$content.observe("click","div#courses .course.view",function(e){GASendClick("SIHP","Courses","Course",e)},this);C.dom.$content.observe("click","div#courses .course.add",function(e){GASendClick("SIHP","Courses","Add Course",e)},this);C.dom.$content.observe("click","a.see-all-courses",function(e){GASendClick("SIHP","Courses","See All Courses",e)},this);C.dom.$content.observe("click","#whats-next .track-view-order",function(e){GASendClick("SIHP","What's Next","View Order",e)},this);C.dom.$content.observe("click","#whats-next .track-early-return",function(e){GASendClick("SIHP","What's Next","Early Return",e)},this);C.dom.$content.observe("click","#whats-next .track-enter-school",function(e){GASendClick("SIHP","What's Next","Enter School",e)},this);C.dom.$content.observe("click","#whats-next .track-add-courses",function(e){GASendClick("SIHP","What's Next","Enter Courses",e)},this);C.dom.$content.observe("click","#whats-next .track-review-course",function(e){GASendClick("SIHP","What's Next","Review Course",e);

},this);C.dom.$content.observe("click","#whats-next .track-scholarships",function(e){GASendClick("SIHP","What's Next","Scholarships",e)},this);C.dom.$content.observe("click","#whats-next .track-return-books",function(e){GASendClick("SIHP","What's Next","Return Books",e)},this);C.dom.$content.observe("click","a.track-find-tbs",function(e){GASendClick("SIHP","TBS and Q&A","Find Solutions",e)},this);C.dom.$content.observe("click",".tbs-row",function(e){GASendClick("SIHP","TBS and Q&A","TBS",e)},this);C.dom.$content.observe("click",".tbs-show-more",function(e){GASendClick("SIHP","TBS and Q&A","TBS Show More",e)},this);C.dom.$content.observe("click","a.track-ask",function(e){GASendClick("SIHP","TBS and Q&A","Ask a Question",e)},this);C.dom.$content.observe("click","a.track-answer",function(e){GASendClick("SIHP","TBS and Q&A","Answer Questions",e)},this);C.dom.$content.observe("click","a.track-my-questions",function(e){GASendClick("SIHP","TBS and Q&A","My Questions",e)},this);C.dom.$content.observe("click","a.track-my-answers",function(e){GASendClick("SIHP","TBS and Q&A","My Answers",e)},this);C.dom.$content.observe("click",".my-scholarships .scholarship",function(e){GASendClick("SIHP","Scholarships","Scholarship",e)},this);C.dom.$content.observe("click",".my-scholarships .more",function(e){GASendClick("SIHP","Scholarships","More Matches",e)},this);C.dom.$content.observe("click",".my-scholarships .see-all-scholarships",function(e){GASendClick("SIHP","Scholarships","See All Scholarships",e)},this);var userId=C.global.userId;if(userId&&userId!=""){$("a.chg-global-nav-home").on("click",function(e){GASendClick("Header","House","Signed In",e)});$("a.chg-logo").on("click",function(e){GASendClick("Header","Chegg Logo","Signed In",e)});$("a.track-homework-help-signedin").on("click",function(e){GASendClick("Header","Homework Help","Signed In",e)});$("a.chg-cart-area.chg-menu-item.track-cart").on("click",function(e){GASendClick("Header","Cart","Signed In",e)});$("div.track-coupon").on("click",function(e){GASendClick("Header","Coupon","Signed In",e)});C.dom.$header.observe("click",".chg-header-username",function(e){var link=e.currentTarget;if(!$(link).hasClass("pop-active")){GASendClick("Header","Dropdown","Open Dropdown",e)}},this);C.dom.$header.observe("click",".hdr-nav .track-my-account",function(e){GASendClick("Header","Dropdown","My Account",e)},this);C.dom.$header.observe("click",".hdr-nav .track-my-profile",function(e){GASendClick("Header","Dropdown","My Profile",e)},this);C.dom.$header.observe("click",".hdr-nav .track-user-avatar",function(e){console.log("coming here");GASendClick("Header","Dropdown","User Avatar",e)},this);C.dom.$header.observe("click",".hdr-nav .track-track-books",function(e){GASendClick("Header","Dropdown","Track Books",e)},this);C.dom.$header.observe("click",".hdr-nav a.track-return-books",function(e){GASendClick("Header","Dropdown","Return Books",e)},this);C.dom.$header.observe("click",".hdr-nav a.track-extend",function(e){GASendClick("Header","Dropdown","Extend/Purchase",e)},this);C.dom.$header.observe("click",".hdr-nav a.track-sell-books",function(e){GASendClick("Header","Dropdown","Sell Books",e)},this);C.dom.$header.observe("click",".hdr-nav a.track-view-orders",function(e){GASendClick("Header","Dropdown","View Orders",e)},this);C.dom.$header.observe("click",".hdr-nav a.track-help",function(e){GASendClick("Header","Dropdown","Help",e)},this);C.dom.$header.observe("click",".hdr-nav a.track-signout",function(e){GASendClick("Header","Dropdown","Sign Out",e)},this)}else{$("a.chg-global-nav-home").on("click",function(e){GASendClick("Header","House","Signed Out",e)});$("a.chg-logo").on("click",function(e){GASendClick("Header","Chegg Logo","Signed Out",e)});$("a.track-homework-help-signedout").on("click",function(e){GASendClick("Header","Homework Help","Signed Out",e)});$("a.chg-cart-area.chg-menu-item.track-cart").on("click",function(e){GASendClick("Header","Cart","Signed Out",e)});$("div.track-coupon").on("click",function(e){GASendClick("Header","Coupon","Signed Out",e)});$("a.track-signin").on("click",function(e){GASendClick("Header","Signed In","",e)});C.dom.$header.observe("click",".chg-menu-item.chg-header-more",function(e){var link=e.currentTarget;if(!$(link).hasClass("pop-active")){GASendClick("Header","More","Open Dropdown",e)}},this);C.dom.$header.observe("click",".hdr-list .track-signup",function(e){GASendClick("Header","More","Sign Up",e)},this);C.dom.$header.observe("click",".hdr-list .track-selltextbooks",function(e){GASendClick("Header","More","Sell your books",e)},this);C.dom.$header.observe("click",".hdr-list .track-help",function(e){GASendClick("Header","More","Help",e)},this);C.dom.$header.observe("click",".hdr-list .track-returnbooks",function(e){GASendClick("Header","More","Return your books",e)},this)}$(".chg-footer .sell-textbooks").on("click",function(e){GASendClick("Footer","Help","Sell Textbooks",e)});C.dom.$content.observe("click",".courseCollector .continue-btn-container .btn-continue",function(e){var ccc=$(e.currentTarget).closest(".courseCollector");var cc1=$(ccc).find("form.courses");var ccRadios=$(cc1).find("input[type=radio]");ccRadios.each(function(index){if($(this).attr("checked")){GASendClick("Post-Checkout","Course Collection","Added Courses",e)}});var cc2=$(ccc).find("ul#otherCourseContainer");var cc2Num=$(cc2).find("li").length;if(cc2Num>=1){GASendClick("Post-Checkout","Course Collection","Other Courses",e)}},this)});C("global");C.global.cachedJS=[];C.global.pageObject={};C.global.instanceCounter=C.global.instanceCounter||0;C.global.pageCounter=C.global.pageCounter||0;C.global.adTargeting=C.global.adTargeting||{};$(function(){var renderAds=function(){var adsWidget=Eggshell.find("C.common.advertisements");if(adsWidget.getId()==undefined){adsWidget=Eggshell.create("C.common.advertisements")}Eggshell.trigger(adsWidget,"render");if(C.global.adsDebugging){console.time("from render ads to slot render")}};if(C.global.adsDebugging){console.log("C.global.adsRenderEarlier",C.global.adsRenderEarlier)}if(C.global.adsRenderEarlier){renderAds()}var embed=Eggshell.create("C.global.tutors.embed").trigger("render");Eggshell.immuneToDestroyAll(embed);if(!C.global.webConstellation){var headerNav=Eggshell.create("C.global.header").trigger("render");Eggshell.immuneToDestroyAll(headerNav)}var crossPromo=Eggshell.create("C.common.crosspromo");Eggshell.immuneToDestroyAll(crossPromo);Eggshell.enableErrorHandling(!C.global.disableErrorhandling);setInterval(C.utility.updateCsrfToken,18e5);var tracking=Eggshell.create("C.common.tracking");Eggshell.immuneToDestroyAll(tracking);Eggshell.immuneToDestroyAll(Eggshell.create("C.common.beacon"));var pageStack=[],pageIndex=0,pageData={},pageStyled=false,pageInited=false,resourceCounterCSS=[],resourceCounterJS=[],pageSpinnerTimeout;var showSpinner=C.utility.showSpinner=function(){hideSpinner();C.dom.$content.stop().css({visibility:"hidden",opacity:0});pageSpinnerTimeout=setTimeout(function(){$(".chg-global-content").append('<div class="chg-page-loading" style="display: none"><div class="chg-load"></div></div>');$(".chg-page-loading").fadeIn()},0)};var hideSpinner=C.utility.hideSpinner=function(){clearTimeout(pageSpinnerTimeout);$(".chg-page-loading").remove();C.dom.$content.stop().css("visibility","visible").animate({opacity:1})};var overrideHref=function(event){var url=event.currentTarget.getAttribute("href");if(url&&(url.indexOf("mailto:")===0||url.indexOf("//")===0||url.indexOf("#")===0||url.indexOf("/#")!==-1)){if(url.indexOf("#")===0&&$(url).length>0){var offset=$(url).offset().top,jumpto=offset-60;window.location.replace(url);window.scrollTo(0,jumpto);event.preventDefault()}return}if(event.ctrlKey||event.metaKey){return}else{if($(event.target).hasClass("chg-global-nav-home")||$(event.target).hasClass("chg-global-nav-list-section-home")){C.utility.openGlobalNav(animate=true)}else if($(event.target).hasClass("chg-logo")){if($(event.target).next()&&$(event.target).next().hasClass("chg-menu")){C.utility.openGlobalNav(animate=true)}}else{C.utility.closeGlobalNav(animate=true)}event.preventDefault();C.utility.navigate(url)}};var handleRequest=C.utility._handleRequest=function(url){C.dom.$html.find("*").off(".chg-page-widget");if(History.getStateByIndex(-2)){C.logger.referrer_url=History.getStateByIndex(-2).url}else{C.logger.referrer_url=location.href}setTimeout(showSpinner,0);window.scrollTo(0,0);C.dom.$html.css("cursor","progress");pageStack.push($.ajax({type:"post",url:url,data:{orig_referrer:C.logger.referrer_url},dataType:"json",success:handleResponse,error:function(){C.log("Failed to load page: "+url);location.replace(url)}}));C.global.adTargeting={};C.utility.hideTower();C.utility.profiler.reset();C.global.navigationStart=(new Date).getTime();if(typeof C.global.pageObject.destroy==="function"){C.global.pageObject.destroy()}Eggshell.find("C.common.tracking").trigger("reset").trigger("push class matcher","C.common.autosuggest");Eggshell.destroyAll();var ajaxClientNS=Eggshell.create("C.eggshell.component.ajax.client");Eggshell.trigger(ajaxClientNS,"flush all");C.dom.$window.trigger("pageunload")};var handleAdobeAnalyticsAjaxLogging=function(pageData){var pre_track,post_track;if(typeof C.global.adobe==="undefined"){C("global.adobe")}C.global.adobe=pageData.adobeDataObject||{};C.global.adobe.pageType=pageData.pageType;if(pre_track=C.utility.access("adobe_track.pre",pageData)){C.adobeAnalytics.track(pre_track)}if(pageData&&pageData.digitalData){C.adobeAnalytics.setData(pageData.digitalData)}if(post_track=C.utility.access("adobe_track.post",pageData)){C.adobeAnalytics.track(post_track)}C.adobeAnalytics.track("pageView")};var handleResponse=function(data,status,xhr){if(data.clusterPrefix){C.global.clusterPrefix=data.clusterPrefix}else{C.global.clusterPrefix=""}if(!C.support.touch){$(window).off("scroll");$(window).scroll(function(){$(".chg-header, .chgg-hdr").css({left:-$(this).scrollLeft()})})}Eggshell.find("C.search.trackid").trigger("page refreshed");if(C.global.headerAutosuggest&&!C.global.webConstellation){Eggshell.find(C.global.headerAutosuggest).trigger("disable all overrides").trigger("render",{ajaxEndpoint:"/_ajax/search/globallist",target:$(".chg-header .autosuggest-input-field"),filters:{type:"group"}})}else{Eggshell.find(C.global.headerAutosuggest).trigger("disable all overrides").trigger("render",{ajaxEndpoint:"/_ajax/search/globallist",target:$(".chgg-hdr .autosuggest-input-field"),filters:{type:"group"}})}var couponComponent=Eggshell.find("C.global.coupon");if(couponComponent){couponComponent.trigger("ajax page loaded")}var loc=window.location.pathname;if(loc.indexOf("/test-prep")!==-1&&data.headerMarkup&&!C.global.webConstellation){$(".chg-hdr-v3").remove();$(".chg-body").prepend(data.headerMarkup);var headerNav=Eggshell.create("C.global.header").trigger("render");Eggshell.immuneToDestroyAll(headerNav)}if(!C.global.webConstellation){var header=Eggshell.find("C.global.header");header.trigger("show user distractions").trigger("enable auto collapse of searchbox").trigger("collapse search box").trigger("page refreshed")}else{var translucent=false;var hideDistractions=false;var hideSearch=false;var searchOnScroll=false;var noSearch=false;var expandSearch=false;var type="home";if(loc==="/"){hideSearch=true;searchOnScroll=true;translucent=true}if(loc.indexOf("/books")!==-1||loc.indexOf("/sell-textbooks")!==-1){type="books";hideSearch=true;searchOnScroll=true;translucent=true}if(loc.indexOf("/sell-textbooks/payment")!==-1||loc.indexOf("/sell-textbooks/return")!==-1){translucent=false}if(loc.indexOf("/bookstore")!==-1||loc.indexOf("/occp")!==-1||loc.indexOf("/etextbooks")!==-1||loc.indexOf("/shoppingcart")!==-1||loc.indexOf("/used-textbooks")!==-1||loc.indexOf("/cheap-textbooks")!==-1||loc.indexOf("/college-textbooks")!==-1){type="books";hideSearch=false;searchOnScroll=false;translucent=false}if(loc.indexOf("/search")!==-1&&loc.indexOf("/sell-textbooks/search")===-1){type="home";translucent=false;expandSearch=true;hideSearch=false;searchOnScroll=false}if(loc.indexOf("/textbooks")!==-1){type="books";hideSearch=false;searchOnScroll=false}if(loc==="/study"||loc.indexOf("/study/")!==-1){type="study";hideSearch=true;searchOnScroll=true;translucent=true}if(loc.indexOf("/study/qa/post")!==-1){translucent=false}if(loc.indexOf("/csorderconfirm")!==-1||loc.indexOf("/my/expertqa")!==-1||loc.indexOf("/homework-help")!==-1){type="study"}if(loc.indexOf("/tutoringpolicy")!==-1){type="tutors"}if(loc.indexOf("/test-prep")!==-1){type="testprep";translucent=true;hideSearch=true;noSearch=true}if(loc.indexOf("/test-prep/pricing/")!==-1||loc.indexOf("/test-prep/orderconfirmation")!==-1){translucent=false}if(loc.indexOf("/app/internships")!==-1||loc.indexOf("/career-center")!==-1){type="internships";hideSearch=true;noSearch=true;translucent=true}if(loc.indexOf("/career-center/explore/")!==-1&&loc!=="/career-center/explore/"||loc.indexOf("/career-center/advice/")!==-1&&loc!=="/career-center/advice/"){translucent=false}if(loc.indexOf("/schools")!==-1||loc.indexOf("/admissions")!==-1||loc.indexOf("/scholarships")!==-1||loc.indexOf("/majors")!==-1){type="colleges";hideSearch=true;noSearch=true;translucent=false}if(loc.indexOf("/auth")!==-1&&loc.indexOf("/author")===-1||loc.indexOf("/checkout")!==-1||loc.indexOf("/guidedsolutions")!==-1){hideDistractions=true;translucent=false}if(hideDistractions){window.globalChggHeader.trigger("hide user distractions")}else{window.globalChggHeader.trigger("show user distractions")}window.globalChggHeader.trigger("page refreshed");window.globalChggHeader.trigger("update type",type);if(hideSearch){window.globalChggHeader.trigger("hide search box")}else{window.globalChggHeader.trigger("show search box")}window.globalChggHeader.trigger("set no search",noSearch);window.globalChggHeader.trigger("set search on scroll",searchOnScroll);if(translucent){window.globalChggHeader.trigger("enable translucent background")}else{window.globalChggHeader.trigger("disable translucent background")}if(expandSearch){window.globalChggHeader.trigger("expand search")}else{window.globalChggHeader.trigger("collapse search")}}Eggshell.find("C.global.tutors.chat").trigger("page refreshed");var i=0;for(i=0;i<pageStack.length;i++){if(pageStack[i]===xhr){break}}if(i>=pageIndex){pageIndex=i}else{return}pageData=data;if(!pageData.redirect){if(pageData.hasHiddenSearchBox===true){if(!C.global.webConstellation){Eggshell.find("C.global.header").trigger("hide search box")}else{Eggshell.find("C.global.cheggheader").trigger("hide search box")}C.global.hasHiddenSearchBox=true}else{if(!C.global.webConstellation){Eggshell.find("C.global.header").trigger("show search box")}else{Eggshell.find("C.global.cheggheader").trigger("show search box")}C.global.hasHiddenSearchBox=false}}C.global.domLoading=(new Date).getTime();resourceCounterCSS[pageIndex]=0;resourceCounterJS[pageIndex]=0;pageStyled=false;pageInited=false;if(typeof pageData.cssName!=="undefined"){$(".chg-content").attr("class","").addClass("chg-content "+pageData.cssName)}C.logger.loadTime=pageData.loadTime;C.logger.pageTrackId=pageData.pageTrackId;C("global.cs");if(pageData.redirect){C.utility.replace(pageData.redirect);return}C.dom.$content.empty();$('link[data-scope="content"]').each(function(){this.disabled=true});$("title").html(pageData.title);if(pageData.fixedWidth){C.dom.$container.addClass("no-resize")}else{C.dom.$container.removeClass("no-resize")}if(pageData.hiddenGlobalNav){$(".chg-body").addClass("no-nav")}else{$(".chg-body").removeClass("no-nav")}if(!pageData.nav||jQuery.isEmptyObject(pageData.nav)){$(".chg-body").addClass("no-subnav")}else{$(".chg-body").removeClass("no-subnav")}if(pageData.showViewMobileSiteButton){showViewMobileSiteButton()}updateNavigation(pageData.nav);resourceCounterCSS[pageIndex]+=pageData.css.length;resourceCounterJS[pageIndex]+=pageData.js.length;checkResourceComplete();for(var css in pageData.css){css=pageData.css[css];var currentIndex=pageIndex;loadStylesheet(css,function(){resourceLoaded("css",currentIndex)})}for(var js in pageData.js){js=pageData.js[js];(function(url,index){C.dom.$window.queue("chg-js-"+index,function(next){loadScript(url,function(){resourceLoaded("js",index)})})})(js,pageIndex)}$(function(){timer=setTimeout(function(){Eggshell.find("C.global.coupon").trigger("show coupon tooltip")},1e3)});C.dom.$window.dequeue("chg-js-"+pageIndex);Eggshell.create("C.report.GA").trigger("submit custom command",["send","pageview",location.href])};var updateNavigation=function(nav){if(!nav||jQuery.isEmptyObject(nav)){C.dom.$nav.html("");return}var html="";var selected="main";if(nav["main"]["selected"])selected="main selected";var mainLabel=nav["main"]["label"];if(mainLabel&&mainLabel.length>20)mainLabel=mainLabel.substr(0,17)+"...";mainLabel=C.utility.escapeHtml(mainLabel);var mainUrl=C.utility.escapeHtml(nav["main"]["url"]);html+='<a href="'+mainUrl+'" class="'+selected+'">'+'<span class="nav-label">'+mainLabel+"</span>"+"</a> ";if(nav["list"]){for(var item in nav["list"]){item=nav["list"][item];selected="";if(item["selected"])selected="selected";var url=C.utility.escapeHtml(item["url"]);var img=C.utility.escapeHtml(item["img"]);var label=C.utility.escapeHtml(item["label"]);html+='<a href="'+url+'" class="'+img+" "+selected+'">'+'<span class="nav-label">'+label+"</span>"+"</a> "}}html='<div class="row"><div class="col-12 col-first col-last">'+html+"</div></div>";C.dom.$nav.html(html)};var resourceLoaded=function(type,index){if(type=="css"){resourceCounterCSS[index]--}else if(type=="js"){C.dom.$window.dequeue("chg-js-"+index);resourceCounterJS[index]--}checkResourceComplete()};var checkResourceComplete=function(){if(resourceCounterCSS[pageIndex]==0){allStylesheetsLoaded()}if(resourceCounterJS[pageIndex]==0&&resourceCounterCSS[pageIndex]==0){allStylesheetsAndScriptsLoaded()}};var loadedStyle={};var loadStylesheet=function(url,callback){var i,timer,$linkEl;if(!loadedStyle[url]){$linkEl=$('<link id="css_'+url+'" rel="stylesheet" type="text/css" href="'+url+'" media="all" data-scope="content" />').appendTo(document.head);loadedStyle[url]=$linkEl;timer=setTimeout(function(){timer=null;callback()},1e3);i=new Image;i.src=url;i.onerror=function(){if(!timer)return;clearTimeout(timer);setTimeout(function(){callback()},250)}}else{loadedStyle[url][0].disabled=false;callback()}};var loadScript=function(url,callback){if(!C.global.cachedJS[url]){C.utility.loadScript(url,function(){C.global.cachedJS[url]=true;callback()})}else{callback()}};var allStylesheetsLoaded=function(){if(pageStyled){return}else{pageStyled=true}C.dom.$content.html(pageData.html);setTimeout(hideSpinner,0)};var allStylesheetsAndScriptsLoaded=function(){if(pageInited){return}else{pageInited=true}C.utility.closeGlobalNav(animate=false);C.global.domInteractive=(new Date).getTime();if(pageData.init){$.globalEval("C.global.pageObject = "+pageData.init);if(typeof C.global.pageObject.postConstruct=="function"){C.global.pageObject.postConstruct()}}else{C.global.pageObject={}}C.global.pageOnload();C.dom.$html.css("cursor","auto");if(!window.navigateEvent){window.navigateEvent=document.createEvent("Event");window.navigateEvent.initEvent("navigatePage",true,true)}window.dispatchEvent(window.navigateEvent);handleAdobeAnalyticsAjaxLogging(pageData)};try{C.global.navigationStart=performance.timing.navigationStart;C.global.domLoading=performance.timing.domLoading;C.global.domInteractive=performance.timing.domInteractive;C.dom.$window.load(function(){setTimeout(function(){C.global.domComplete=performance.timing.domComplete},0)})}catch(e){C.global.navigationStart=0;C.global.domLoading=0;C.global.domInteractive=0;C.global.domComplete=0}C.global.pageOnload=function(){C.utility.processPlaceholders();C.utility.reflowSubNav();if(C.support.touch){C.dom.$nav.css("position","absolute")}this.coupon=Eggshell.create("C.global.coupon",{el:$(".chg-hdr-coupon-area",this.$el)});Eggshell.immuneToDestroyAll(this.coupon);C.utility.showCouponDialog=$.proxy(function(couponMessage,couponExpiration,couponCode){var couponInfo={title:couponMessage,disclaimer:couponExpiration,code:couponCode};this.trigger("open coupon dialog",couponInfo)},this.coupon);C.global.domComplete=(new Date).getTime();C.utility.profiler.show();C.utility.checkPollution();if(!C.global.adsRenderEarlier){renderAds()}};if(History.enabled&&C.global.ajaxPageLoading){C.dom.$body.observe("click.cheggNavigation","a:not([data-noajax]):not([href^=javascript]):not([target=_blank])",overrideHref,C.dom.$window);C.dom.$window.on("statechange",function(){handleRequest(History.getState().url)});setTimeout(function(){C.dom.$body.unobserve("click.cheggNavigation",C.dom.$window)},30*60*1e3)}C.logger.referrer_url=document.referrer;C.dom.$window.observe("resize",C.utility.reflowSubNav,C.dom.$window);C.dom.$nav.observe("click","a",function(e){C.dom.$nav.find(".selected").removeClass("selected");$(e.currentTarget).addClass("selected");if(!History.enabled){showSpinner()}},C.dom.$window);$(".chg-banner").observe("click",function(){new C.widget.dialog({type:"ajax",content:"/_ajax/dialog/browserupgrade"})},C.dom.$window);if(C.support.touch){$(".chg-header, .chgg-hdr").addClass("chg-pos-absolute")}else{$(window).scroll(function(){$(".chg-header, .chgg-hdr").css({left:-$(this).scrollLeft()})})}C.dom.$body.observe("click",".chg-dialog-link",function(e){e.preventDefault();new C.widget.dialog({type:"ajax",content:e.currentTarget.href,fixed:false});return false},this);var showViewMobileSiteButton=function(){if($(".C-eggshell-viewfullsite-button").length<1){this.viewFullSiteButtonNS=Eggshell.create("C.eggshell.viewfullsite.button",{el:$(".chg-container-content")}).getNs();Eggshell.output(this.viewFullSiteButtonNS,"show")}};if(C.global.showViewMobileSiteButton){showViewMobileSiteButton()}});$(function(){this.parseUrl=function(url){var key=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"];var parser=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\?([^#]*))?(?:#(.*))?)/;var m=parser.exec(url),uri={},i=14,isAjax=false;while(i--){if(m[i]){uri[key[i]]=m[i]}}if(uri.path){var split=uri.path.split("/");uri.splits=split;if(split[1]==="_ajax"){isAjax=true}}uri.isAjax=isAjax;return uri};$.ajaxPrefilter($.proxy(function(opts){if(opts.dataType!=="jsonp"){var parsed=this.parseUrl(opts.url),prefix=C.global.clusterPrefix;if(parsed.isAjax&&prefix&&prefix!==""){var newUrl="/"+prefix+parsed.path;if(parsed.query){newUrl+="?"+parsed.query}opts.url=newUrl}}},this))});Eggshell.define("C.global.tutors.embed",{inputs:["render"],output:["rendered"]},function(opts){window.lightningjs||function(e){function r(r,o){var d="1";return o&&(o+=(/\?/.test(o)?"&":"?")+"lv="+d),e[r]||function(){var d=window,c=document,u=r,p=c.location.protocol,v="load",f=0;!function(){function r(){m.P(v),m.w=1,e[u]("_load")}e[u]=function(){function r(){return r.id=c,e[u].apply(r,arguments)}var a=arguments,o=this,c=++f,p=o&&o!=d?o.id||0:0;return(m.s=m.s||[]).push([c,p,a]),r.then=function(e,a,o){var d=m.fh[c]=m.fh[c]||[],u=m.eh[c]=m.eh[c]||[],p=m.ph[c]=m.ph[c]||[];return e&&d.push(e),a&&u.push(a),o&&p.push(o),r},r};var m=e[u]._={};m.fh={},m.eh={},m.ph={},m.l=o?o.replace(/^\/\//,("https:"==p?p:"http:")+"//"):o,m.p={0:+new Date},m.P=function(e){m.p[e]=new Date-m.p[0]},m.w&&r(),d.addEventListener?d.addEventListener(v,r,!1):d.attachEvent("on"+v,r);var w=function(){function e(){return["<head></head><",r,' onload="var d=',P,";d.getElementsByTagName('head')[0].",p,"(d.",v,"('script')).",f,"='",m.l,"'\"></",r,">"].join("")}var r="body",o=c[r];if(!o)return setTimeout(w,100);m.P(1);var d,p="appendChild",v="createElement",f="src",y=c[v]("div"),E=y[p](c[v]("div")),C=c[v]("iframe"),P="document",B="domain",T="contentWindow";y.style.visibility="hidden",y.style.height="0px",o.insertBefore(y,o.firstChild).id=a+"-"+u,C.frameBorder="0",C.id=a+"-frame-"+u,/MSIE[ ]+6/.test(navigator.userAgent)&&(C[f]="javascript:false"),C.allowTransparency="true",E[p](C);try{C[T][P].open()}catch(b){m[B]=c[B],d="javascript:var d="+P+".open();d.domain='"+c.domain+"';",C[f]=d+"void(0);"}try{var D=C[T][P];D.write(e()),D.close()}catch(L){C[f]=d+'d.write("'+e().replace(/"/g,String.fromCharCode(92)+'"')+'");d.close();'}m.P(2)};m.l&&w()}()}(),e[r].lv=d,e[r]}var a="lightningjs",lightningjs=window[a]=r(a);lightningjs.require=r,lightningjs.modules=e}({});var tutorsCDN=C.global.tutorsCdnUrl||"/tutors/";var embed=window.lightningjs.require("embed",tutorsCDN+"publish/static/js/embed.js");this.render=function(){embed("config",{uid:C.global.userUuid,CHEGG_UUID_CHECKSUM:C.global.uuidChecksum,CSS_URL:tutorsCDN+"publish/static/css/embed-chegg.css"});embed("on",{redirect:function(redirectURL){window.location.href=redirectURL}});var chat=Eggshell.create("C.global.tutors.chat").trigger("render");Eggshell.immuneToDestroyAll(chat)};this.setListeners=function(){Eggshell.find(this).on("render",this.render)};this.initialize=function(){if(!C.global.instaEdu){return}this.setListeners()};this.initialize()});Eggshell.define("C.global.tutors.chat",{inputs:["render","page refreshed","toggle chat list","auth loaded"],output:["rendered"]},function(opts){var $div=$("<div class='embed-js' id='chat-component'></div>");$("body").append($div);var chat=window.lightningjs.require("chat"),authPages=new RegExp(["^[/]login","^[/]auth"].join("|")),hookedIntoAuth=false;var hookIntoAuth=function(){if(hookedIntoAuth){return}var auth=Eggshell.find("C.common.auth");if(auth.getId()){auth.trigger("disable redirect",true).on("authentication successful",onSignup);hookedIntoAuth=true}};var checkAuthPage=function(){if(authPages.test(window.location.pathname)){chat("hasDeferred",function(hasDeferred){if(hasDeferred){hookIntoAuth()}});chat("minimizeWindows");return true}return false};var checkSignedOut=function(){if(window.location.pathname==="/signout"){C.utility.setCookie("sessionid","",-1);chat("signOut")}};var onSignup=function(){chat("deferFinish",function(){Eggshell.find("C.common.auth").trigger("do redirect")})};var doAuth=function(type,opts){chat("deferSave",type,opts,function(){C.utility.navigate("/auth")})};this.authLoaded=function(){checkAuthPage()};this.start=function(){checkSignedOut();checkAuthPage();chat("onChegg",{"sign-up":function(uid){doAuth("queueMessage",uid)},"sign-up:meet-now":function(data){doAuth("saveMeetNow",data)}});chat("start")};this.render=function(){chat("render",$div[0],{OMNIBAR_MINIMIZE:true});this.start()};this.pageRefreshed=function(){checkSignedOut();if(!checkAuthPage()&&!C.global.userUuid){chat("deferSave",null)}chat("hideOmnibar")};this.toggleChatList=function(ev,expand){chat("toggleOmnibar",!!expand)};this.setListeners=function(){Eggshell.find(this).on("render",this.render).on("toggle chat list",this.toggleChatList).on("page refreshed",this.pageRefreshed).on("auth loaded",this.authLoaded)};this.initialize=function(){if(!C.global.instaEdu){return}this.setListeners()};this.initialize()});Eggshell.define("C.common.message",{inputs:["set type","set size","set header","set body","set call to action link","enable close button","scrollOnShow"],outputs:["call to action link clicked","close button clicked"]},C.View.extend({initialize:function(){this.model=new C.Model({type:"information",size:"lg",header:"",body:"",linkText:"",linkUrl:"",closeButton:false,scrollOnShow:false});this.model.on("change",this.render,this);Eggshell.find(this).on("set type",this.setType).on("set size",this.setSize).on("set header",this.setHeader).on("set body",this.setBody).on("set call to action link",this.setLink).on("enable close button",this.enableCloseButton).on("scrollOnShow",this.setScrollOnShow)},setType:function(event,payload){if(payload!="information"&&payload!="error"&&payload!="success"&&payload!="important"&&payload!="custom"){throw"Invalid message type."}payload=payload=="information"?"info":payload;this.model.set("type",payload)},setSize:function(event,payload){if(payload!="large"&&payload!="small"){throw"Invalid message size."}this.model.set("size",payload=="large"?"lg":"sm")},setHeader:function(event,payload){if(!payload||typeof payload!="string"){throw"Invalid message header."}this.model.set("header",payload)},setBody:function(event,payload){if(!payload||typeof payload!="string"){throw"Invalid message body."}this.model.set("body",payload)},setLink:function(event,payload){if(!payload||!payload.text||typeof payload.text!="string"){throw"Invalid link text."}if(!payload||!payload.url||typeof payload.url!="string"){throw"Invalid link URL."}this.model.set("linkText",payload.text);this.model.set("linkUrl",payload.url)},enableCloseButton:function(event,payload){if(typeof payload!="boolean"){throw"Invalid close button flag."}this.model.set("closeButton",payload)},setScrollOnShow:function(event,payload){if(typeof payload!="boolean"){throw"Invalid close button flag."}this.model.set("scrollOnShow",payload);if(this.model.get("scrollOnShow")){Eggshell.find(this).on("show",function(){this.$el.show();if(C.utility.isIE()){window.scroll(0,0)}else{$("body").animate({scrollTop:"0px"},300)}})}else{Eggshell.find(this).on("show",function(){this.$el.show()})}},render:function(){var headerClass=!this.model.get("body")&&!this.model.get("linkUrl")?"msg-header-only":"";this.$el.empty().html(this.template($.extend(this.model.toJSON(),{headerClass:headerClass})));if(!this.model.get("linkUrl")){this.$("a.message-call-to-action").remove()}if(!this.model.get("header")||this.model.get("size")=="sm"){this.$(".msg-header").remove()}if(!this.model.get("closeButton")){this.$(".msg-close").remove()}return this},template:_.template('<div class="msg-<%- type %>-<%- size %>">'+'	<div class="msg-icon">'+'		<div class="msg-header <%- headerClass %>"><%= header %></div>'+'		<div class="msg-text"><%= body %>'+'			<a class="message-call-to-action" href="<%- linkUrl %>"><%= linkText %></a> '+'			<span class="msg-close"></span>'+"		</div>"+"	</div>"+"</div>"),events:{"click a.message-call-to-action":"handleLinkOnClicked","click .msg-close":"closeMessage"},handleLinkOnClicked:function(e){Eggshell.find(this).trigger("call to action link clicked")},closeMessage:function(e){this.$el.slideUp("fast");Eggshell.find(this).trigger("close button clicked")}}));Eggshell.define("C.global.coupon",{inputs:{render:{payload:null},"open coupon dialog":{payload:null},"apply coupon and open coupon dialog":{payload:"string"},"show coupon tooltip":{payload:null},"refresh coupon":{payload:null},"apply headline button clicked":{payload:null},"apply coupon headline on checkout":{payload:null},"get coupon status":{payload:null},"ajax page loaded":{payload:null}},outputs:{"active coupon":{payload:null},"applied coupon successfully":{cpnCode:null},"failed to apply coupon":{payload:null}},newNode:false,singleton:true,strict:true},function(){var Model=Backbone.Model.extend({initialize:function(){},fetchCoupon:function(cpnCode){$.ajax({url:"/_ajax/global/coupon/get",type:"post",dataType:"json",context:this,success:$.proxy(function(r){if(!r.id){return}this.set("couponNode",r);this.trigger("loaded")},this),error:function(r){}})},addCoupon:function(cpnCode,URLcoupon){$.ajax({url:"/_ajax/global/coupon/apply",type:"get",data:{cp:cpnCode,token:C.global.csrfToken},context:this,success:function(r){if(!r.id||r.id==null){return}if(URLcoupon){this.set("couponNode",r);this.trigger("couponApplied");this.trigger("coupon",r);return}this.set("couponNode",r);this.trigger("couponApplied")},error:function(r){}})}});var View=Backbone.View.extend({initialize:function(){this.GAevent=Eggshell.create("C.report.GA");this.sessionLogger=Eggshell.create("C.common.log");Eggshell.immuneToDestroyAll(this.sessionLogger);this.model=new Model;this.model.on("loaded",this.render,this);this.model.on("couponApplied",this.handleCouponApplied,this);this.model.fetchCoupon();Eggshell.find(this).on("refresh coupon",function(event,payload){this.model.fetchCoupon()}).on("show coupon tooltip",this.createCpnHeadline).on("open coupon dialog",this.openCouponDialogBox).on("get coupon status",this.checkStatus).on("apply coupon and open coupon dialog",function(event,payload){
this.options.openAppliedCouponInDialog=true;this.model.addCoupon(payload)}).on("ajax page loaded",function(){if(this.dialog){this.dialog.destroy();this.dialog=null}})},handleCouponApplied:function(){if(this.options.openAppliedCouponInDialog){this.couponDialogBox(this.model.get("couponNode"))}Eggshell.find(this).trigger("applied coupon successfully",{cpnCode:this.model.get("couponNode").code})},render:function(){this.createCpnHeadline()},createCpnHeadline:function(){this.checkURLcoupon();var couponNode=this.model.get("couponNode");this.headlineCpn=Eggshell.create("C.global.coupon.headline",{el:$(".chg-content")}).on("coupon headline displayed",function(){if(couponNode.applied===false){var data={couponCode:couponNode.code,action:"Coupon Displayed"};this.sessionLogger.trigger("session log",data)}},this).trigger("render",couponNode).on("apply headline button clicked",this.applyCoupon,this)},checkStatus:function(){var couponNode=this.model.get("couponNode");if(couponNode.applied===true){Eggshell.find(this).trigger("active coupon")}},reportApplyEvent:function(){var payload=this.model.get("couponNode");var data={couponCode:payload.code,action:"Coupon Applied"};this.sessionLogger.trigger("session log",data);this.GAevent.trigger("report custom event",{page:"Header",section:"coupon",link:"apply"})},openCouponDialogBox:function(e,payload){var couponMessage=payload.title;var couponExpiration=payload.disclaimer;var couponCode=payload.code;var url_params=C.utility.getParams();if(typeof url_params.noApply=="undefined"){this.model.addCoupon(payload.code,true)}this.model.on("coupon",$.proxy(function(e,payload){this.couponDialogBox(this.model.get("couponNode"),couponMessage,couponExpiration);e.stopPropagation()},this))},applyCoupon:function(){Eggshell.find(this).trigger("active coupon");var couponNode=this.model.get("couponNode");if(typeof couponNode!="undefined"){this.couponDialogBox(this.model.get("couponNode"));this.headlineCpn.trigger("show applied msg")}else{this.model.on("couponApplied",$.proxy(function(){this.couponDialogBox(this.model.get("couponNode"));this.headlineCpn.trigger("show applied msg")},this))}this.model.addCoupon(couponNode.code);this.reportApplyEvent()},checkURLcoupon:function(){var coupon=this.getQueryVariable("cp");if(coupon!="noCp"){if(coupon==""){C.utility.setCookie("HeadlineNoShow","true",1)}else{this.model.addCoupon(coupon,true);this.model.on("coupon",this.couponDialogBox,this)}}},getQueryVariable:function(variable){var query=window.location.search.substring(1);var vars=query.split("&");for(var i=0;i<vars.length;i++){var pair=vars[i].split("=");if(pair[0]==variable){return pair[1]}}return"noCp"},couponDialogBox:function(couponNode,couponMessage,couponExpiration){if(couponMessage&&couponExpiration){var title=couponMessage;var disclaimer=couponExpiration}else{var title=couponNode.title;var disclaimer=couponNode.disclaimer}var head_html='<div class="coupon-added-msg"><span class="coupon-icon icon-chegg-Deal"></span>Coupon</div>';var html='<div class="auto-apply-coupon-dialog">'+'<div class="coupon-message">'+title+"</div>"+'<div class="coupon-expiration">'+disclaimer+"</div>"+'<div id="msg-success-sm"></div>'+"</div>";if(!this.dialog){this.dialog=Eggshell.create("C.Eggshell.dialog").trigger("set headline",head_html).trigger("disable default padding").trigger("hide sub headline").trigger("hide icon").trigger("set content html",html).trigger("show").on("close button clicked",$.proxy(function(){$.ajax({url:"/_ajax/coupon/shown"})},this));Eggshell.create("C.common.message",{el:$(".auto-apply-coupon-dialog #msg-success-sm")}).trigger("set type","success").trigger("set size","small").trigger("set body","Coupon will be applied at checkout")}else{Eggshell.trigger(this.dialog,"show")}$(".auto-apply-coupon-dialog button").on("click",$.proxy(function(){var currentPath=window.location.pathname.split("/");if(currentPath[1]==="checkout"&&(currentPath[2]==="sp"||currentPath[2]==="spc")){Eggshell.trigger(this.dialog,"hide")}else if(currentPath[1]==="checkout"&&(currentPath[2]==="confirm"||currentPath[2]==="review")){Eggshell.trigger(this.dialog,"hide");C.utility.refresh()}else{Eggshell.trigger(this.dialog,"hide")}},this))}});return View}());Eggshell.define("C.global.promo",{inputs:{render:{payload:null},"open dialog":{payload:null}},outputs:{},newNode:false,singleton:true,strict:true},function(){var Model=Backbone.Model.extend({initialize:function(){},fetchPromo:function(){var urlParams=C.utility.getParams();if(!urlParams.mep){this.set("promoInfo",null);return}$.ajax({url:"/_ajax/global/promo/get",type:"POST",dataType:"json",data:{promoCode:urlParams.mep},context:this,success:$.proxy(function(r){if(r==null){return}this.set("promoInfo",r);this.set("promoCode",urlParams.mep);this.trigger("loaded")},this),error:function(r){}})}});var View=Backbone.View.extend({initialize:function(){this.model=new Model;this.model.on("loaded",this.render,this);this.model.fetchPromo();Eggshell.find(this).on("open dialog",this.openDialog).on("render",this.render)},render:function(){this.openDialog()},openDialog:function(e,payload){var promoInfo=this.model.get("promoInfo");if(promoInfo.title&&promoInfo.body&&promoInfo.btnText){this.promoDialogBox(promoInfo)}},promoDialogBox:function(promoInfo){var html='<div class="auto-apply-coupon-dialog">'+'<div class="coupon-message">'+promoInfo.title+"</div>"+'<div class="coupon-expiration">'+promoInfo.body+"</div>"+'<button class="btn-primary-sm">'+promoInfo.btnText+"</button>"+'<div class="coupon-disclaimer">'+promoInfo.disclaimer+"</div>"+"</div>";if(!this.dialog){this.dialog=Eggshell.create("C.common.dialog").trigger("disable default padding").trigger("hide sub headline").trigger("hide icon").trigger("hide control").trigger("set content html",html).trigger("show");this.dialogShown(this.model.get("promoCode"))}else{Eggshell.trigger(this.dialog,"show")}$(".auto-apply-coupon-dialog button").on("click",$.proxy(function(){Eggshell.trigger(this.dialog,"hide")},this))},dialogShown:function(promoCode){$.ajax({url:"/_ajax/global/promo/shown",type:"POST",dataType:"json",data:{promoCode:promoCode},context:this})}});return View}());Eggshell.define("C.global.coupon.headline",{inputs:{render:{payload:{id:"string",code:"string",title:"string",disclaimer:"string",applied:"boolean",path:"string"}},"show headline coupon":{payload:null},"show applied msg":{payload:null}},outputs:{"apply headline button clicked":{payload:null},"coupon headline displayed":{payload:null}}},Backbone.View.extend({initialize:function(){Eggshell.find(this).on("render",this.render).on("show headline coupon",this.showCpnHeadline).on("show applied msg",this.showAppliedMsg)},render:function(e,payload){this.showCpnHeadline(payload);this.delegateEvents()},tmplCouponHeadline:_.template('<div class="C-global-coupon-headline">'+'<div class="headline-wrapper">'+'<div class="apply-coupon">'+'<div class="coupon-icon icon-chegg-Deal"></div>'+'<h1><strong><%- coupon.title %></strong><a href="javascript:void(0)" class="show-disclaimer">See details...</a></h1>'+"</div>"+'<div class="coupon-code">'+'<div class="coupon-code-wrapper">'+"<% if (coupon.applied) { %>"+'<h2><span class="icon-chegg-Check"></span>Coupon will be applied at checkout</h2>'+"<% }else{ %>"+"<h2>Code: <strong><%- coupon.code %></strong></h2>"+'<button class="btn-special-outline btn-sm coupon-btn">Apply coupon</button>'+"<% } %>"+"</div>"+"</div>"+'<div class="disclaimer"><h3><%- coupon.disclaimer %></h3></div>'+"</div>"+"</div>"),showCpnHeadline:function(payload){var paths=payload.path;var noShow=C.utility.getCookie("HeadlineNoShow");if(paths!=null&&noShow!="true"){var pathsArray=paths.split(" ");var currentPath=window.location.pathname.split("/");var currentPathLength=currentPath.length;var isCorrectPath=false;for(var i=0;i<pathsArray.length;i++){ConfigPath=pathsArray[i].split("/");var countPlace=0;for(place in ConfigPath){countPlace+=1;if(countPlace<=currentPathLength){if(ConfigPath[place]==currentPath[place]||ConfigPath[place]=="*"){isCorrectPath=true}else{isCorrectPath=false;break}}}if(isCorrectPath==true||pathsArray[i]===window.location.pathname){if($(".C-global-coupon-headline")){$(".C-global-coupon-headline").remove()}$(".chg-content").prepend(this.tmplCouponHeadline({coupon:{title:payload.title,code:payload.code,disclaimer:payload.disclaimer,expireDate:payload.expireDate,id:payload.id,applied:payload.applied}}));this.registerHealineListerner(payload);Eggshell.find(this).trigger("coupon headline displayed");if(C.global.stickyCoupon){$(".C-global-coupon-headline .show-disclaimer").hide()}var bookstoreCookie=C.utility.getCookie("bookstore_school");if(!payload.applied&&(currentPath[1]!=""&&currentPath[1]!="books")&&C.global.stickyCoupon&&bookstoreCookie!=="bowdoin"){$(window).scroll(function(event){var scroll=$(window).scrollTop();if(!$(".C-global-coupon-headline").hasClass("fix-coupon")&&scroll>30){$(".C-global-coupon-headline").addClass("fix-coupon");$(".C-global-coupon-headline.fix-coupon").slideDown("fast")}else if($(".C-global-coupon-headline").hasClass("fix-coupon")&&scroll<30){$(".C-global-coupon-headline").removeClass("fix-coupon");$(".C-global-coupon-headline").show()}})}return}}}},showAppliedMsg:function(){$(".C-global-coupon-headline .coupon-code h2").html("<span class='icon-chegg-Check'></span>Coupon will be applied at checkout");$(".C-global-coupon-headline .coupon-code button").hide()},registerHealineListerner:function(payload){var currentPath=window.location.pathname.split("/");if(currentPath[1]==""||currentPath[1]=="books"){$(".C-global-coupon-headline .apply-coupon").click($.proxy(function(e){e.stopPropagation();this.checkHowApply(payload)},this))}$(".C-global-coupon-headline button").click($.proxy(function(e){e.stopPropagation();this.checkHowApply(payload)},this));if(C.global.stickyCoupon){$(".C-global-coupon-headline").css("cursor","pointer");$(".C-global-coupon-headline").click($.proxy(function(e){e.stopPropagation();this.checkHowApply(payload)},this))}$(".C-global-coupon-headline .show-disclaimer").click($.proxy(function(){this.showDisclaimer()},this))},showDisclaimer:function(e){$(".C-global-coupon-headline .disclaimer").css("display","block");$(".C-global-coupon-headline .show-disclaimer").css("display","none");$(".C-global-coupon-headline .apply-coupon").css("padding-bottom","0px");$(".C-global-coupon-headline .headline-wrapper").css("height","67px")},checkHowApply:function(payload){Eggshell.find(this).trigger("apply headline button clicked")}}));Eggshell.define("C.common.overlay.tooltip",{inputs:{"set target":{payload:"jquery"},"set tooltip size":{payload:"string"},"position caret on top right":{payload:null},"add custom css class":{payload:null},"position caret center":{payload:null},"set tooltip border color":{payload:"string"},"get tooltip content node":{payload:null},show:{payload:null},hide:{payload:null},toggle:{payload:null},"enable tooltip on hover":{payload:null},"disable tooltip on hover":{payload:null},"set tooltip below target":{payload:null},"set tooltip above target":{payload:null},"set tooltip on the left of target":{payload:null},"set tooltip on the right of target":{payload:null},"set text":{payload:"string"},"hide tooltip when user click anywhere else":{payload:null},"acitvate tooltip":{payload:null},"deacitvate tooltip":{payload:null},"enable tooltip slide with screen resize":{payload:null},"position tooltip relative to target":{payload:null},"set tooltip the width":{payload:"number"},"set tooltip color":{payload:"string"},"set title text":{payload:"string"},"enable close button":{payload:null},disable_max_z_index:{payload:null},"set animation":{payload:"string"}},outputs:{"return tooltip content node":{payload:"jquery"}}},Backbone.View.extend({position:"bottom",tooltipWidthDefault:200,events:{"click .close-btn":"hide"},initialize:function(){this.tooltipWidth=this.tooltipWidthDefault;Eggshell.find(this).on("destroy",this.destroy).on("set target",this.setTarget).on("set tooltip size",this.setSize).on("get tooltip content node",this.getContentNode).on("enable tooltip on hover",this.enableHover).on("disable tooltip on hover",this.disableHover).on("show",this.show).on("hide",this.hide).on("toggle",this.toggle).on("set text",this.setText).on("set tooltip color",this.setBackgroundColor).on("position caret on top right",this.positionCaretRight).on("position caret center",this.positionCaretCenter).on("set tooltip border color",this.setBorderColor).on("set title text",this.setTitle).on("enable close button",this.setCloseBtn).on("disable_max_z_index",this.disableMaxZIndex).on("add custom css class",this.addCustomCssClass).on("enable tooltip slide with screen resize",function(){this.moveWithScreen=true}).on("set tooltip zindex",function(e,payload){this.zindex=payload}).on("position tooltip relative to target",function(){this.positionRelative=true}).on("acitvate tooltip",function(){this.dialogOpen=true}).on("deacitvate tooltip",function(){this.dialogOpen=false}).on("hide tooltip when user click anywhere else",function(){this.clickWindow=true}).on("set tooltip below target",function(){this.setPosition(null,"bottom")}).on("set tooltip above target",function(){this.setPosition(null,"top")}).on("set tooltip on the left of target",function(){this.setPosition(null,"left")}).on("set tooltip on the right of target",function(){this.setPosition(null,"right")}).on("set tooltip the width",function(e,payload){this.tooltipWidth=payload}).on("set animation",function(e,payload){this.tooltipAnimationClass=payload});this.render()},destroy:function(){this.hide()},stopParentEvent:function(e){e.stopPropagation()},render:function(){this.$el.html(this.template());this.$el.on("mouseover",$.proxy(this.stopWait,this));this.$el.on("mouseleave",$.proxy(this.waitAndHide,this));this.hide();this.addResizeAbility();this.addScrollDetection();return this},positionCaretRight:function(){this.$(".tooltip-arrow-top").css("margin-left","240px");this.caretRight=true},positionCaretCenter:function(){this.$(".tooltip-arrow-top, .tooltip-arrow-bottom").css("margin","auto");this.caretCenter=true},setSize:function(event,payload){if(payload!=="small"&&payload!=="large"){throw"Invalid tooltip size. Only large and small are supported"}this.$el.removeClass("large small").addClass(payload);if(this.shown){this.hide();this.show()}},setBorderColor:function(event,payload){if(payload!=="orange"&&payload!=="teal"){throw"Invalid tooltip border color. Only orange or teal is supported"}this.$(".tooltip-content").removeClass("orange-border grey-border").addClass(payload+"-border");if(this.position==="bottom"){this.$(".tooltip-arrow-top").removeClass("tooltip-arrow-top-grey").addClass("tooltip-arrow-top-"+payload)}else if(this.position==="top"||this.position==="right"||this.position==="left"){this.$(".tooltip-arrow-bottom").removeClass("tooltip-arrow-bottom-grey").addClass("tooltip-arrow-bottom-"+payload)}},addResizeAbility:function(){$(window).resize($.proxy(function(){if(this.shown){this.hide();this.show()}},this))},addScrollDetection:function(){$(window).scroll($.proxy(function(){if(this.shown){this.hide();this.show()}},this))},template:_.template('<div class="tooltip">'+'   <div class="tooltip-arrow-top tooltip-arrow-top-grey"></div>'+'   <div class="tooltip-content grey-border"></div>'+'   <div class="tooltip-left-shadow"></div><div class="tooltip-arrow-bottom tooltip-arrow-bottom-grey"></div><div class="tooltip-right-shadow"></div>'+"</div>"),setTarget:function(event,payload){if(this.$target){throw"Target can only be set once"}if(payload&&payload.jquery){this.$target=payload}else if(payload&&typeof payload!="string"){this.$target=$(payload)}else{throw"Invalid target node"}this.$target=$.extend({},this.$target);this.enableHover()},setPosition:function(event,payload){if(payload!="top"&&payload!="bottom"&&payload!="left"&&payload!="right"){throw"Invalid position. Position value has to be either top, bottom, left, or right."}this.position=payload},enableHover:function(){if(this.$target){this.disableHover();this.$target.on("mouseover",$.proxy(this.handleTargetMouseOverEvent,this));this.$target.on("mouseleave",$.proxy(this.waitAndHide,this))}else{throw"Please set the target element first"}this.$el.on("mouseover",$.proxy(this.stopWait,this));this.$el.on("mouseleave",$.proxy(this.waitAndHide,this))},disableHover:function(){if(this.$target){this.$target.off("mouseover");this.$target.off("mouseleave")}else{throw"Please set the target element first"}this.$el.off("mouseover");this.$el.off("mouseleave")},getContentNode:function(){Eggshell.find(this).trigger("return tooltip content node",$.extend({},this.$(".tooltip-content")))},setText:function(ev,payload){if(payload.length>0){this.$(".tooltip-content").html(payload)}},setTitle:function(ev,payload){var $title=$('<div class="tooltip-title"></div>');$title.html(payload).insertBefore(this.$(".tooltip-content"));this.$el.addClass("header-enabled")},setCloseBtn:function(){this.$(".tooltip").append('<span class="close-btn"></span>')},disableMaxZIndex:function(){this.disableMaxZIndexFlag=true},addCustomCssClass:function(e,elementInfo){if(elementInfo&&this.$(elementInfo.cssSelector).size()>0){this.$el.addClass(elementInfo.cssClass)}},fadeIn:function(){this.$el.show().css("opacity",1)},fadeOut:function(){this.$el.show().css("opacity",0)},hide:function(){this.shown=false;this.$el.css({visibility:"hidden",opacity:0})},show:function(){if(this.dialogOpen==true||this.$target.css("display")==="none"||this.$target.css("visibility")==="hidden"||this.$target.offset().top===0&&this.$target.offset().left===0){return}this.shown=true;var customWidth=this.tooltipWidth!==this.tooltipWidthDefault;if(customWidth){this.$el.addClass("custom-width");this.$(".tooltip").css({width:this.tooltipWidth+"px"})}this.$(".tooltip-arrow-bottom").css({"margin-top":"0px"});this.$el.show().removeClass("tooltip-top tooltip-bottom tooltip-left tooltip-right");if(this.positionRelative==true){var pos=this.$target.position()}else{var pos=this.$target.offset()}if(!this.disableMaxZIndexFlag){this.$el.css({"z-index":this.zindex||C.utility.getMaxIndex()+1})}if(this.position==="bottom"){this.$el.addClass("tooltip-bottom");var left=pos.left-Math.floor(this.$el.outerWidth()/2)+Math.floor(this.$target.outerWidth()/2)+4;var top=pos.top+this.$target.outerHeight();if(left+this.$el.width()>$(window).width()&&this.moveWithScreen==true){if($(window).width()<700){left=700-this.$el.width()}else{left=$(window).width()-this.$el.width()}}if(this.caretRight){left-=100}else if(this.caretCenter){this.$el.addClass("center-caret")}if(this.tooltipAnimationClass){this.$el.addClass(this.tooltipAnimationClass)}this.$el.css({top:top+"px",left:left+"px",visibility:"visible",opacity:1});this.$(".tooltip-arrow-bottom").css({"margin-top":"0px"})}else if(this.position==="top"){this.$el.addClass("tooltip-top");var left=pos.left-Math.floor(this.$el.outerWidth()/2)+Math.floor(this.$target.outerWidth()/2)+4;var top=pos.top-this.$el.outerHeight()+1;if(left+this.$el.width()>$(window).width()&&this.moveWithScreen==true){if($(window).width()<700){left=700-this.$el.width()}else{left=$(window).width()-this.$el.width()}}this.$el.css({top:top+"px",left:left+"px",visibility:"visible",opacity:1});this.$(".tooltip-arrow-bottom").css({"margin-top":"0px"});if(this.caretCenter){this.$el.addClass("center-caret")}}else if(this.position==="left"){this.$el.addClass("tooltip-left");var left=pos.left-this.tooltipWidth-15+1;var top=Math.floor(pos.top+this.$target.outerHeight()/2-(this.$el.outerHeight()-20)/2);this.$el.css({top:top+"px",left:left+"px",visibility:"visible",opacity:1});this.$(".tooltip-arrow-bottom").css({"margin-top":-1*Math.floor(this.$el.outerHeight()/2)+"px"})}else if(this.position==="right"){this.$el.addClass("tooltip-right");var left=pos.left+this.$target.outerWidth()+14;var top=Math.floor(pos.top+this.$target.outerHeight()/2-(this.$el.outerHeight()-20)/2);this.$el.css({top:top+"px",left:left+"px",visibility:"visible",opacity:1});this.$(".tooltip-arrow-bottom").css({"margin-top":-1*Math.floor(this.$el.outerHeight()/2)+"px"})}if(this.clickWindow==true){this.windowClickHide()}},windowClickHide:function(){this.$el.off("click").on("click",this.stopParentEvent);$("*").on("click."+this.$el.attr("id"),$.proxy(function(){if(this.$(".tooltip:hover").length==0&&!this.$target.is(":hover"))this.hide()},this))},toggle:function(){if(this.$el.css("visibility")==="hidden"){this.show()}else{this.hide()}},waitAndHide:function(){this.timer=setTimeout($.proxy(function(){this.hide()},this),100)},stopWait:function(){clearTimeout(this.timer)},handleTargetMouseOverEvent:function(){Eggshell.find("C.common.overlay.tooltip").trigger("hide");this.show();this.stopWait()},setBackgroundColor:function(e,color){this.$el.addClass(color)}}));(function(){var last=0,LIMIT=100,queue=[],base_url="",timeout;function executeQueue(){var args=queue.shift();if(args){run(args)}}function setLastTimer(){last=+new Date}function startTimeout(){timeout=setTimeout(function(){executeQueue();if(queue.length)startTimeout();else timeout=null},LIMIT)}function addRequestToQueue(args){var now=+new Date,diff=now-last;setLastTimer();queue.push(args);if(timeout){return}if(diff>100){executeQueue();return}startTimeout()}function run(args){var x=new XMLHttpRequest,payload=[];function parseResponse(fn){var res;setLastTimer();if(!fn)return;try{res=JSON.parse(x.responseText)}catch(e){res={}}fn(res)}x.open("POST",base_url+"/_ajax/odinconcat");x.withCredentials=true;x.setRequestHeader("Content-Type","application/json");x.onload=parseResponse.bind(this,args.success);x.onerror=parseResponse.bind(this,args.error);if(!args.requests)return;if(args.requests.length>10){throw"can only use up to 10 requests at a time"}args.requests.forEach(function(request){payload.push({url:request.url,method:request.method||"get",payload:request.payload||null,action:request.action,child_request:request.child_request||null,use_board:!!request.use_board,headers:request.headers||{},timeout:request.timeout||null})});x.send(JSON.stringify({requests:payload,headers:args.headers}))}Eggshell.define("C.odin.concat",{inputs:["fetch","set base url"]},function(){this.Eggshell.listen("fetch",function(e,args){addRequestToQueue(args)});this.Eggshell.listen("set base url",function(e,args){base_url=args.url})})})();Eggshell.define("C.common.guarantee.badge",{inputs:["render"],outputs:[]},function(){var View=C.View.extend({tmpl:_.template('<div class="badge">'+'<span class="badge-icon"></span>'+"</div>"),tooltipTmpl:_.template('<div class="guarantee-tooltip">'+'<span class="badge-icon"></span>'+'<h1 class="title">Rental Price Guarantee</h1>'+'<span class="description">Find a lower price, we\'ll match it. <span class="show-modal">See details</span></span>'+"</div>"),initialize:function(){this.render()},render:function(){this.$el.html(this.tmpl());this.renderTooltip();this.renderGuaranteeModel()},renderTooltip:function(){this.badgeTooltip=Eggshell.create("C.common.overlay.tooltip").trigger("set target",this.$(".badge")).trigger("set tooltip the width",300).trigger("set tooltip above target").trigger("enable tooltip on hover").trigger("set tooltip color","green").on("return tooltip content node",function(ev,payload){var $el=payload;$el.html(this.tooltipTmpl())},this).trigger("get tooltip content node")},renderGuaranteeModel:function(){this.pricematchmodal=Eggshell.create("C.common.pricematchmodal").trigger("render");var tooltipId=this.badgeTooltip.getId();tooltipId=tooltipId.replace(".","-");$("#"+tooltipId+" .guarantee-tooltip .show-modal").click($.proxy(function(e){this.showModal()},this))},showModal:function(){this.pricematchmodal.trigger("show")}});return View}());